<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="ipynb_website:version" content="0.9.7" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="twitter:card" content="summary_large_image"></meta>
<meta property="og:title" content="US Macroeconomic Data Explorer | US Seaport Volumes" />
<meta property="og:type" content="article" />
<meta property="og:description" content="A look at shipping port traffic, according to TEU reports from each of the top 10 port authorities." />
<meta property="og:image" content="https://pymoment.github.io/us-macro/analysis/transportation-ocean.png" />
<meta property="og:url" content="https://pymoment.github.io/us-macro/analysis/transportation-ocean.html" />

<!-- begin stylesheets -->

<link rel="stylesheet"
    href="../css/jt.css">
<link rel="stylesheet"
    href="../css/toc2.css">
<link rel="stylesheet"
    href="../site_libs/jqueryui-1.11.4/jquery-ui.css">
<link rel="stylesheet"
    href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
<link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
<link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/styles/default.min.css">
    
<link rel="stylesheet" type="text/css" href="../css/readable.css">
<!-- end stylesheets -->

<!-- begin javascript -->

<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- Bootstrap 4 -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

<!-- Vega/Vegalite -->
<script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-lite@4"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/highlight.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    
<!-- end javascript -->


<script>hljs.initHighlightingOnLoad();</script>
<script type="text/javascript">
    if (window.hljs &&
        document.readyState &&
        document.readyState === "complete") {
       window.setTimeout(() => {
          hljs.initHighlighting();
       }, 0);
    }
</script>
    

<script src="../js/doc_toc.js"></script>
<script src="../js/docs.js"></script>


<script>
    MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": {
            preferredFont: "TeX",
            availableFonts: ["TeX"],
            styles: {
                scale: 110,
                ".MathJax_Display": {
                    "font-size": "110%%",
                }
            }
        }
    });
</script>
    

<script>
function filterDataFrame(id) {
    var input = document.getElementById("search_" + id);
    var filter = input.value.toUpperCase();
    var table = document.getElementById("dataframe_" + id);
    var tr = table.getElementsByTagName("tr");
    // Loop through all table rows, and hide those who don't match the search query
    for (var i = 1; i < tr.length; i++) {
        for (var j = 0; j < tr[i].cells.length; ++j) {
            var matched = false;
            if (tr[i].cells[j].innerHTML.toUpperCase().indexOf(filter) != -1) {
                tr[i].style.display = "";
                matched = true
                break;
            }
            if (!matched)
                tr[i].style.display = "none";
        }
    }
}

function sortDataFrame(id, n, dtype) {
    var table = document.getElementById("dataframe_" + id);
    var tb = table.tBodies[0]; // use `<tbody>` to ignore `<thead>` and `<tfoot>` rows
    var tr = Array.prototype.slice.call(tb.rows, 0); // put rows into array
    if (dtype === 'numeric') {
        var fn = (a, b) =>
            parseFloat(a.cells[n].textContent) <= parseFloat(b.cells[n].textContent) ? -1 : 1;
    } else {
        var fn = function(a, b) {
            var c = a.cells[n].textContent.trim().localeCompare(b.cells[n].textContent.trim());
            return c > 0 ? 1 : (c < 0 ? -1 : 0) }
    }
    var isSorted = function(array, fn) {
        if (array.length < 2)
            return 1;
        var direction = fn(array[0], array[1]);
        for (var i = 1; i < array.length - 1; ++i) {
            var d = fn(array[i], array[i+1]);
            if (d == 0)
                continue;
            else if (direction == 0)
                direction = d;
            else if (direction != d)
                return 0;
            }
        return direction;
    }
    var sorted = isSorted(tr, fn);
    if (sorted == 1 || sorted == -1) {
        // if sorted already, reverse it
        for(var i = tr.length - 1; i >= 0; --i)
            tb.appendChild(tr[i]); // append each row in order
    } else {
        tr = tr.sort(fn);
        for(var i = 0; i < tr.length; ++i)
            tb.appendChild(tr[i]); // append each row in order
    }
}
</script>




<script>
    // manage active state of menu based on current page
    $(document).ready(function () {
      // active menu anchor
      href = window.location.pathname
      href = href.substr(href.lastIndexOf('/') + 1)
      if (href === "")
        href = "index.html";
      var menuAnchor = $('a[href*="' + href + '"]');
      // mark it active
      menuAnchor.parent().addClass('active');
      // if it's got a parent navbar menu mark it active as well
      menuAnchor.closest('li.dropdown').addClass('active');
    });
</script>
    

<div class="container-fluid main-container">

<!-- tabsets -->
<script src="../site_libs/navigation-1.1/tabsets.js"></script>
<script>
    $(document).ready(function () {
      window.buildTabsets("TOC");
    });
</script>



<title>US Macroeconomic Data Explorer | US Seaport Volumes</title>

<style type = "text/css">
    body {
      
    }
</style>
</head>

<body>
<div tabindex="-1" id="notebook" class="border-box-sizing">
<div class="container" id="notebook-container">

<!-- code folding -->


<nav class="navbar navbar-expand-lg sticky-top navbar-light bg-light">
    <a class="navbar-brand" href="../index.html">US Macroeconomic Data Explorer</a>
    <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#navbar" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="navbar-nav mr-auto">
        
<li class="nav-item">
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
</li>
        
<li class="nav-item dropdown">
  <a class="nav-link dropdown-toggle btn" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="background-color: steelblue; color: white;">
    Explore other charts
  </a>
  <div class="dropdown-menu" aria-labelledby="navbarDropdown">
  

    <a class="dropdown-item" href="../analysis/autos.html">Autos</a>
        
    <a class="dropdown-item" href="../analysis/construction.html">Construction</a>
        
    <a class="dropdown-item" href="../analysis/creditcards.html">Creditcards</a>
        
    <a class="dropdown-item" href="../analysis/dairy.html">Dairy</a>
        
    <a class="dropdown-item" href="../analysis/electricity.html">Electricity</a>
        
    <a class="dropdown-item" href="../analysis/international-trade.html">International Trade</a>
        
    <a class="dropdown-item" href="../analysis/labor.html">Labor</a>
        
    <a class="dropdown-item" href="../analysis/manufacturing.html">Manufacturing</a>
        
    <a class="dropdown-item" href="../analysis/oil-gas-inventories.html">Oil Gas Inventories</a>
        
    <a class="dropdown-item" href="../analysis/residential-realestate-zillow.html">Residential Realestate Zillow</a>
        
    <a class="dropdown-item" href="../analysis/residential-realestate.html">Residential Realestate</a>
        
    <a class="dropdown-item" href="../analysis/retailsales.html">Retailsales</a>
        
    <a class="dropdown-item" href="../analysis/sentiment.html">Sentiment</a>
        
    <a class="dropdown-item" href="../analysis/services.html">Services</a>
        
    <a class="dropdown-item" href="../analysis/sp500-returns-and-performance.html">Sp500 Returns And Performance</a>
        
    <a class="dropdown-item" href="../analysis/transportation-air-waterway.html">Transportation Air Waterway</a>
        
    <a class="dropdown-item" href="../analysis/transportation-cass.html">Transportation Cass</a>
        
    <a class="dropdown-item" href="../analysis/transportation-ocean.html">Transportation Ocean</a>
        
    <a class="dropdown-item" href="../analysis/transportation-rail.html">Transportation Rail</a>
        
    <a class="dropdown-item" href="../analysis/us-treasury-auctions.html">Us Treasury Auctions</a>
        
    <a class="dropdown-item" href="../analysis/us-treasury-rates.html">Us Treasury Rates</a>
        
  </div>
</li>
      </ul>
        
<ul class="navbar-nav">
<li class="nav-item">
   <a class="nav-link" href="http://github.com/pymoment/us-macro"> source </a>
</li>
</ul>
        
    </div><!--/.nav-collapse -->
</nav><!--/.navbar -->
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="US-Seaport-Volumes">US Seaport Volumes<a class="anchor-link" href="#US-Seaport-Volumes">&#182;</a></h1><hr>
<h4 id="For-the-top-10-ports-(80%25-of-all-TEUs)">For the top 10 ports (80% of all TEUs)<a class="anchor-link" href="#For-the-top-10-ports-(80%25-of-all-TEUs)">&#182;</a></h4><p>Note: TEU means "Twenty-foot [container] Equivalent Unit"</p>
<p>A look at shipping port traffic, according to TEU reports from each of the top 10 port authorities.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">json</span> <span class="kn">import</span> <span class="n">loads</span><span class="p">,</span> <span class="n">JSONDecodeError</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">environ</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>
<span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">HTML</span>

<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">from</span> <span class="nn">joblib</span> <span class="kn">import</span> <span class="n">Memory</span>

<span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span><span class="p">,</span> <span class="n">Request</span>
<span class="kn">from</span> <span class="nn">urllib.error</span> <span class="kn">import</span> <span class="n">HTTPError</span><span class="p">,</span> <span class="n">URLError</span>

<span class="kn">from</span> <span class="nn">tabula</span> <span class="kn">import</span> <span class="n">read_pdf</span>

<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.support.ui</span> <span class="kn">import</span> <span class="n">WebDriverWait</span>
<span class="kn">from</span> <span class="nn">selenium.common.exceptions</span> <span class="kn">import</span> <span class="n">WebDriverException</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.chrome.options</span> <span class="kn">import</span> <span class="n">Options</span>
<span class="kn">import</span> <span class="nn">selenium.webdriver.support.expected_conditions</span> <span class="k">as</span> <span class="nn">EC</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.by</span> <span class="kn">import</span> <span class="n">By</span>

<span class="k">def</span> <span class="nf">ajaxComplete</span><span class="p">(</span><span class="n">driver</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span> <span class="o">==</span> <span class="n">driver</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s2">&quot;return jQuery.active&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">WebDriverException</span><span class="p">:</span>
        <span class="k">pass</span>
    
<span class="n">chrome_options</span> <span class="o">=</span> <span class="n">Options</span><span class="p">()</span>
<span class="n">chrome_options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--disable-extensions&quot;</span><span class="p">)</span>
<span class="n">chrome_options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--disable-gpu&quot;</span><span class="p">)</span>
<span class="n">chrome_options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--headless&quot;</span><span class="p">)</span>
<span class="c1">#chrome_options.add_argument(&quot;download.default_directory=/tmp&quot;)</span>
<span class="n">chrome_options</span><span class="o">.</span><span class="n">add_experimental_option</span><span class="p">(</span><span class="s2">&quot;prefs&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="s2">&quot;download.default_directory&quot;</span> <span class="p">:</span> <span class="s2">&quot;/tmp&quot;</span> <span class="p">})</span>

<span class="k">if</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;GITHUB_WORKFLOW&quot;</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Requires manual updates&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">doChart</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Oakland&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Full-Total&#39;</span><span class="p">):</span>
    <span class="c1">#metric = &#39;Full-Total&#39;</span>

    <span class="k">return</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[[</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">&#39;dt:T&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)),</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s1">:Q&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Volume [TEUs]&#39;</span><span class="p">)),</span>
        <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="n">alt</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">&quot;dt:T&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%b %Y&quot;</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s2">:Q&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;,.02f&quot;</span><span class="p">)]</span>
    <span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Port of </span><span class="si">{</span><span class="n">location</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s1"> Container Volume&#39;</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">750</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">400</span>
    <span class="p">)</span>

<span class="k">def</span> <span class="nf">doYoyChart</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Oakland&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Full-Total&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

    <span class="n">brush</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;interval&#39;</span><span class="p">,</span> <span class="n">encodings</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span>
    
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">{</span> <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="nb">format</span> <span class="p">}</span>
    <span class="n">base</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[[</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">&#39;dt:T&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">impute</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">ImputeParams</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">)),</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s1">:Q&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Volume [TEUs]&#39;</span><span class="p">)),</span>
        <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="n">alt</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">&quot;dt:T&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%b %Y&quot;</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;nolarge:Q&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;,.02f&quot;</span><span class="p">)]</span>
    <span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">750</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">400</span>
    <span class="p">)</span>

    <span class="n">upper</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">transform_window</span><span class="p">(</span>
        <span class="n">window</span><span class="o">=</span><span class="p">[</span><span class="n">alt</span><span class="o">.</span><span class="n">WindowFieldDef</span><span class="p">(</span><span class="s2">&quot;lag&quot;</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span> <span class="s1">&#39;as&#39;</span><span class="p">:</span> <span class="s1">&#39;previous&#39;</span> <span class="p">})],</span>
        <span class="n">sort</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;dt&quot;</span><span class="p">}],</span>
    <span class="p">)</span><span class="o">.</span><span class="n">transform_calculate</span><span class="p">(</span>
        <span class="n">yoy</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;((datum[&#39;</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s2">&#39;] - datum.previous) / datum.previous) * 100&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">&#39;dt:T&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="n">brush</span><span class="p">),</span> <span class="n">impute</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">ImputeParams</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">)),</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;yoy:Q&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Year-over-Year Volume Growth [%]&#39;</span><span class="p">),</span> <span class="n">impute</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">ImputeParams</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">keyvals</span><span class="o">=</span><span class="p">[</span><span class="mi">400</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])),</span>
        <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;datum[&#39;yoy&#39;] &lt; 0&quot;</span><span class="p">,</span>
            <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;lightsalmon&#39;</span><span class="p">),</span>
            <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;royalblue&#39;</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Port of </span><span class="si">{</span><span class="n">location</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s1"> Container Volume&#39;</span><span class="p">,</span>
    <span class="p">)</span>
    
    <span class="n">lower</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">100</span>
    <span class="p">)</span><span class="o">.</span><span class="n">add_selection</span><span class="p">(</span><span class="n">brush</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">upper</span> <span class="o">&amp;</span> <span class="n">lower</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">background</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
    

<span class="n">uaString</span> <span class="o">=</span> <span class="s1">&#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.1916.47 Safari/537.36&#39;</span>

<span class="n">memory</span> <span class="o">=</span> <span class="n">Memory</span><span class="p">(</span><span class="s1">&#39;data/&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;&lt;h4&gt;&lt;i&gt;(data current as of </span><span class="si">{}</span><span class="s2">)&lt;/i&gt;&lt;/h4&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%B </span><span class="si">%d</span><span class="s2">, %Y&quot;</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[3]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result"><h4><i>(data current as of April 27, 2022)</i></h4></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Port-of-Los-Angeles">Port of Los Angeles<a class="anchor-link" href="#Port-of-Los-Angeles">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Port of Los Angeles</span>
<span class="c1"># https://www.portoflosangeles.org/business/statistics/container-statistics</span>

<span class="c1"># 1995</span>
<span class="c1"># https://www.portoflosangeles.org/business/statistics/container-statistics/historical-teu-statistics-2019</span>

<span class="nd">@memory</span><span class="o">.</span><span class="n">cache</span>
<span class="k">def</span> <span class="nf">fetchLaData</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;skiprows&#39;</span><span class="p">:</span> <span class="mi">1</span> <span class="p">}):</span>
 
    <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span> <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="n">uaString</span> <span class="p">})</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>

    <span class="n">tmp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">()),</span> <span class="o">**</span><span class="n">args</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">cols</span>
    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1">#print(tmp.head())</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        
    <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">year</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%B-%Y&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">tmp</span>

<span class="k">def</span> <span class="nf">fetchLaDataNoCache</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;skiprows&#39;</span><span class="p">:</span> <span class="mi">1</span> <span class="p">}):</span>
 
    <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span> <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="n">uaString</span> <span class="p">})</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>

    <span class="n">tmp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">()),</span> <span class="o">**</span><span class="n">args</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">cols</span>
    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1">#print(tmp.head())</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        
    <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">year</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%B-%Y&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">tmp</span>

<span class="n">colsPre96</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Loaded Imports&#39;</span><span class="p">,</span> <span class="s1">&#39;Empty Imports&#39;</span><span class="p">,</span> <span class="s1">&#39;Total Imports&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Loaded Export&#39;</span><span class="p">,</span> <span class="s1">&#39;Empty Exports&#39;</span><span class="p">,</span> <span class="s1">&#39;Total TEUs&#39;</span><span class="p">,</span> <span class="s1">&#39;Prior Year Change&#39;</span><span class="p">]</span>

<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Loaded Imports&#39;</span><span class="p">,</span> <span class="s1">&#39;Empty Imports&#39;</span><span class="p">,</span> <span class="s1">&#39;Total Imports&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Loaded Export&#39;</span><span class="p">,</span> <span class="s1">&#39;Empty Exports&#39;</span><span class="p">,</span> <span class="s1">&#39;Total Exports&#39;</span><span class="p">,</span> <span class="s1">&#39;Total TEUs&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Prior Year Change&#39;</span><span class="p">]</span>

<span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;skiprows&#39;</span><span class="p">:</span> <span class="mi">1</span>
<span class="p">}</span>

<span class="n">urlFor</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="s2">&quot;https://www.portoflosangeles.org/business/statistics/container-statistics/historical-teu-statistics-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="n">currentYear</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">year</span>

<span class="n">dfs_la</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1995</span><span class="p">,</span> <span class="n">currentYear</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">urlFor</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="c1">#print(url)</span>
    <span class="k">if</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mi">1996</span><span class="p">:</span>
        <span class="n">dfs_la</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fetchLaData</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">colsPre96</span><span class="p">,</span> <span class="n">args</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">y</span> <span class="o">==</span> <span class="n">currentYear</span><span class="p">:</span>
        <span class="n">dfs_la</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fetchLaDataNoCache</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="p">{}))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dfs_la</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fetchLaData</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="p">{}))</span>

<span class="n">df_la</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dfs_la</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span> <span class="c1">#.tail()</span>

<span class="n">df_la</span><span class="p">[</span><span class="n">cols</span><span class="p">[:</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df_la</span><span class="p">[</span><span class="n">cols</span><span class="p">[:</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">)</span>

<span class="n">extractValue</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;\.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df_la</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="s1">&#39;Prior Year Change&#39;</span><span class="p">]:</span>
        <span class="k">continue</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">df_la</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_la</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="n">df_la</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_la</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">extractValue</span><span class="p">)</span>

<span class="c1">#df_la.head()</span>

<span class="c1">#df_la_smoothed = df_la.set_index(&#39;dt&#39;).resample(&#39;2M&#39;).mean().reset_index()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_la</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Los Angeles&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Loaded Imports&#39;</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;transportation-ocean.png&#39;</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



   
        
            
<div class="output_html rendered_html output_subarea ">
<div id="altair-viz-61613cb04acf482bb47cf828b477adef"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-61613cb04acf482bb47cf828b477adef") {
      outputDiv = document.getElementById("altair-viz-61613cb04acf482bb47cf828b477adef");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector001"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Los Angeles Loaded Imports Container Volume", "transform": [{"window": [{"op": "lag", "field": "Loaded Imports", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Loaded Imports'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Loaded Imports"}}, "height": 100, "selection": {"selector001": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-9a95d8f5c8fd6dd52a2e1187ce11887c"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-9a95d8f5c8fd6dd52a2e1187ce11887c": [{"dt": "1996-01-01T00:00:00", "Loaded Imports": 96275.55}, {"dt": "1996-02-01T00:00:00", "Loaded Imports": 87376.8}, {"dt": "1996-03-01T00:00:00", "Loaded Imports": 82048.45}, {"dt": "1996-04-01T00:00:00", "Loaded Imports": 95875.55}, {"dt": "1996-05-01T00:00:00", "Loaded Imports": 103847.85}, {"dt": "1996-06-01T00:00:00", "Loaded Imports": 107809.45}, {"dt": "1996-07-01T00:00:00", "Loaded Imports": 118129.65}, {"dt": "1996-08-01T00:00:00", "Loaded Imports": 123216.85}, {"dt": "1996-09-01T00:00:00", "Loaded Imports": 123341.35}, {"dt": "1996-10-01T00:00:00", "Loaded Imports": 130603.75}, {"dt": "1996-11-01T00:00:00", "Loaded Imports": 116594.15}, {"dt": "1996-12-01T00:00:00", "Loaded Imports": 108355.15}, {"dt": "1997-01-01T00:00:00", "Loaded Imports": 115349.0}, {"dt": "1997-02-01T00:00:00", "Loaded Imports": 100956.55}, {"dt": "1997-03-01T00:00:00", "Loaded Imports": 102389.0}, {"dt": "1997-04-01T00:00:00", "Loaded Imports": 117035.2}, {"dt": "1997-05-01T00:00:00", "Loaded Imports": 123100.3}, {"dt": "1997-06-01T00:00:00", "Loaded Imports": 127693.25}, {"dt": "1997-07-01T00:00:00", "Loaded Imports": 130480.85}, {"dt": "1997-08-01T00:00:00", "Loaded Imports": 132618.55}, {"dt": "1997-09-01T00:00:00", "Loaded Imports": 132919.35}, {"dt": "1997-10-01T00:00:00", "Loaded Imports": 133849.15}, {"dt": "1997-11-01T00:00:00", "Loaded Imports": 123957.55}, {"dt": "1997-12-01T00:00:00", "Loaded Imports": 122273.15}, {"dt": "1998-01-01T00:00:00", "Loaded Imports": 116863.55}, {"dt": "1998-02-01T00:00:00", "Loaded Imports": 109819.0}, {"dt": "1998-03-01T00:00:00", "Loaded Imports": 142929.1}, {"dt": "1998-04-01T00:00:00", "Loaded Imports": 141028.2}, {"dt": "1998-05-01T00:00:00", "Loaded Imports": 155896.05}, {"dt": "1998-06-01T00:00:00", "Loaded Imports": 148826.0}, {"dt": "1998-07-01T00:00:00", "Loaded Imports": 147328.7}, {"dt": "1998-08-01T00:00:00", "Loaded Imports": 161600.95}, {"dt": "1998-09-01T00:00:00", "Loaded Imports": 147914.45}, {"dt": "1998-10-01T00:00:00", "Loaded Imports": 161150.95}, {"dt": "1998-11-01T00:00:00", "Loaded Imports": 150339.05}, {"dt": "1998-12-01T00:00:00", "Loaded Imports": 131718.3}, {"dt": "1999-01-01T00:00:00", "Loaded Imports": 132118.15}, {"dt": "1999-02-01T00:00:00", "Loaded Imports": 134281.3}, {"dt": "1999-03-01T00:00:00", "Loaded Imports": 133886.8}, {"dt": "1999-04-01T00:00:00", "Loaded Imports": 146258.45}, {"dt": "1999-05-01T00:00:00", "Loaded Imports": 175535.2}, {"dt": "1999-06-01T00:00:00", "Loaded Imports": 161750.75}, {"dt": "1999-07-01T00:00:00", "Loaded Imports": 176444.6}, {"dt": "1999-08-01T00:00:00", "Loaded Imports": 180684.75}, {"dt": "1999-09-01T00:00:00", "Loaded Imports": 180795.8}, {"dt": "1999-10-01T00:00:00", "Loaded Imports": 198681.1}, {"dt": "1999-11-01T00:00:00", "Loaded Imports": 174939.0}, {"dt": "1999-12-01T00:00:00", "Loaded Imports": 170476.75}, {"dt": "2000-01-01T00:00:00", "Loaded Imports": 185913.65}, {"dt": "2000-02-01T00:00:00", "Loaded Imports": 167829.75}, {"dt": "2000-03-01T00:00:00", "Loaded Imports": 180682.35}, {"dt": "2000-04-01T00:00:00", "Loaded Imports": 211262.3}, {"dt": "2000-05-01T00:00:00", "Loaded Imports": 204191.85}, {"dt": "2000-06-01T00:00:00", "Loaded Imports": 211118.5}, {"dt": "2000-07-01T00:00:00", "Loaded Imports": 232730.4}, {"dt": "2000-08-01T00:00:00", "Loaded Imports": 235529.25}, {"dt": "2000-09-01T00:00:00", "Loaded Imports": 220572.95}, {"dt": "2000-10-01T00:00:00", "Loaded Imports": 250875.35}, {"dt": "2000-11-01T00:00:00", "Loaded Imports": 199387.15}, {"dt": "2000-12-01T00:00:00", "Loaded Imports": 192452.8}, {"dt": "2001-01-01T00:00:00", "Loaded Imports": 201491.75}, {"dt": "2001-02-01T00:00:00", "Loaded Imports": 154024.25}, {"dt": "2001-03-01T00:00:00", "Loaded Imports": 206780.1}, {"dt": "2001-04-01T00:00:00", "Loaded Imports": 210732.05}, {"dt": "2001-05-01T00:00:00", "Loaded Imports": 203241.95}, {"dt": "2001-06-01T00:00:00", "Loaded Imports": 232201.85}, {"dt": "2001-07-01T00:00:00", "Loaded Imports": 238957.6}, {"dt": "2001-08-01T00:00:00", "Loaded Imports": 252137.2}, {"dt": "2001-09-01T00:00:00", "Loaded Imports": 267579.75}, {"dt": "2001-10-01T00:00:00", "Loaded Imports": 265721.7}, {"dt": "2001-11-01T00:00:00", "Loaded Imports": 234132.15}, {"dt": "2001-12-01T00:00:00", "Loaded Imports": 216656.7}, {"dt": "2002-01-01T00:00:00", "Loaded Imports": 210394.25}, {"dt": "2002-02-01T00:00:00", "Loaded Imports": 234405.15}, {"dt": "2002-03-01T00:00:00", "Loaded Imports": 218697.5}, {"dt": "2002-04-01T00:00:00", "Loaded Imports": 258026.4}, {"dt": "2002-05-01T00:00:00", "Loaded Imports": 274449.3}, {"dt": "2002-06-01T00:00:00", "Loaded Imports": 291966.3}, {"dt": "2002-07-01T00:00:00", "Loaded Imports": 260811.15}, {"dt": "2002-08-01T00:00:00", "Loaded Imports": 327471.85}, {"dt": "2002-09-01T00:00:00", "Loaded Imports": 320577.65}, {"dt": "2002-10-01T00:00:00", "Loaded Imports": 252909.65}, {"dt": "2002-11-01T00:00:00", "Loaded Imports": 291571.45}, {"dt": "2002-12-01T00:00:00", "Loaded Imports": 291130.5}, {"dt": "2003-01-01T00:00:00", "Loaded Imports": 264680.65}, {"dt": "2003-02-01T00:00:00", "Loaded Imports": 270731.25}, {"dt": "2003-03-01T00:00:00", "Loaded Imports": 293532.75}, {"dt": "2003-04-01T00:00:00", "Loaded Imports": 319620.55}, {"dt": "2003-05-01T00:00:00", "Loaded Imports": 340164.7}, {"dt": "2003-06-01T00:00:00", "Loaded Imports": 301151.35}, {"dt": "2003-07-01T00:00:00", "Loaded Imports": 326753.45}, {"dt": "2003-08-01T00:00:00", "Loaded Imports": 354433.85}, {"dt": "2003-09-01T00:00:00", "Loaded Imports": 342068.0}, {"dt": "2003-10-01T00:00:00", "Loaded Imports": 365198.85}, {"dt": "2003-11-01T00:00:00", "Loaded Imports": 334215.45}, {"dt": "2003-12-01T00:00:00", "Loaded Imports": 301922.4}, {"dt": "2004-01-01T00:00:00", "Loaded Imports": 340907.8}, {"dt": "2004-02-01T00:00:00", "Loaded Imports": 242928.3}, {"dt": "2004-03-01T00:00:00", "Loaded Imports": 334547.75}, {"dt": "2004-04-01T00:00:00", "Loaded Imports": 339942.9}, {"dt": "2004-05-01T00:00:00", "Loaded Imports": 361413.3}, {"dt": "2004-06-01T00:00:00", "Loaded Imports": 340625.2}, {"dt": "2004-07-01T00:00:00", "Loaded Imports": 361584.3}, {"dt": "2004-08-01T00:00:00", "Loaded Imports": 339428.1}, {"dt": "2004-09-01T00:00:00", "Loaded Imports": 318722.15}, {"dt": "2004-10-01T00:00:00", "Loaded Imports": 347354.6}, {"dt": "2004-11-01T00:00:00", "Loaded Imports": 335855.4}, {"dt": "2004-12-01T00:00:00", "Loaded Imports": 277110.1}, {"dt": "2005-01-01T00:00:00", "Loaded Imports": 298435.35}, {"dt": "2005-02-01T00:00:00", "Loaded Imports": 289415.4}, {"dt": "2005-03-01T00:00:00", "Loaded Imports": 255389.9}, {"dt": "2005-04-01T00:00:00", "Loaded Imports": 329094.2}, {"dt": "2005-05-01T00:00:00", "Loaded Imports": 313026.85}, {"dt": "2005-06-01T00:00:00", "Loaded Imports": 334823.5}, {"dt": "2005-07-01T00:00:00", "Loaded Imports": 352416.8}, {"dt": "2005-08-01T00:00:00", "Loaded Imports": 343029.25}, {"dt": "2005-09-01T00:00:00", "Loaded Imports": 350754.85}, {"dt": "2005-10-01T00:00:00", "Loaded Imports": 368524.2}, {"dt": "2005-11-01T00:00:00", "Loaded Imports": 325089.9}, {"dt": "2005-12-01T00:00:00", "Loaded Imports": 321326.15}, {"dt": "2006-01-01T00:00:00", "Loaded Imports": 321696.7}, {"dt": "2006-02-01T00:00:00", "Loaded Imports": 247693.0}, {"dt": "2006-03-01T00:00:00", "Loaded Imports": 340793.55}, {"dt": "2006-04-01T00:00:00", "Loaded Imports": 365187.9}, {"dt": "2006-05-01T00:00:00", "Loaded Imports": 362494.6}, {"dt": "2006-06-01T00:00:00", "Loaded Imports": 380852.5}, {"dt": "2006-07-01T00:00:00", "Loaded Imports": 404664.55}, {"dt": "2006-08-01T00:00:00", "Loaded Imports": 405303.05}, {"dt": "2006-09-01T00:00:00", "Loaded Imports": 425473.75}, {"dt": "2006-10-01T00:00:00", "Loaded Imports": 412554.4}, {"dt": "2006-11-01T00:00:00", "Loaded Imports": 382404.65}, {"dt": "2006-12-01T00:00:00", "Loaded Imports": 359066.6}, {"dt": "2007-01-01T00:00:00", "Loaded Imports": 360191.45}, {"dt": "2007-02-01T00:00:00", "Loaded Imports": 353009.95}, {"dt": "2007-03-01T00:00:00", "Loaded Imports": 318279.3}, {"dt": "2007-04-01T00:00:00", "Loaded Imports": 368682.95}, {"dt": "2007-05-01T00:00:00", "Loaded Imports": 361683.05}, {"dt": "2007-06-01T00:00:00", "Loaded Imports": 387314.3}, {"dt": "2007-07-01T00:00:00", "Loaded Imports": 382247.05}, {"dt": "2007-08-01T00:00:00", "Loaded Imports": 374225.9}, {"dt": "2007-09-01T00:00:00", "Loaded Imports": 403658.8}, {"dt": "2007-10-01T00:00:00", "Loaded Imports": 385529.75}, {"dt": "2007-11-01T00:00:00", "Loaded Imports": 375271.45}, {"dt": "2007-12-01T00:00:00", "Loaded Imports": 340075.65}, {"dt": "2008-01-01T00:00:00", "Loaded Imports": 343529.2}, {"dt": "2008-02-01T00:00:00", "Loaded Imports": 318444.95}, {"dt": "2008-03-01T00:00:00", "Loaded Imports": 295955.6}, {"dt": "2008-04-01T00:00:00", "Loaded Imports": 328403.4}, {"dt": "2008-05-01T00:00:00", "Loaded Imports": 371026.95}, {"dt": "2008-06-01T00:00:00", "Loaded Imports": 339102.25}, {"dt": "2008-07-01T00:00:00", "Loaded Imports": 367496.5}, {"dt": "2008-08-01T00:00:00", "Loaded Imports": 401137.35}, {"dt": "2008-09-01T00:00:00", "Loaded Imports": 367159.25}, {"dt": "2008-10-01T00:00:00", "Loaded Imports": 370986.9}, {"dt": "2008-11-01T00:00:00", "Loaded Imports": 338905.3}, {"dt": "2008-12-01T00:00:00", "Loaded Imports": 296442.7}, {"dt": "2009-01-01T00:00:00", "Loaded Imports": 317493.1}, {"dt": "2009-02-01T00:00:00", "Loaded Imports": 206034.5}, {"dt": "2009-03-01T00:00:00", "Loaded Imports": 277569.8}, {"dt": "2009-04-01T00:00:00", "Loaded Imports": 279194.15}, {"dt": "2009-05-01T00:00:00", "Loaded Imports": 304109.9}, {"dt": "2009-06-01T00:00:00", "Loaded Imports": 281175.05}, {"dt": "2009-07-01T00:00:00", "Loaded Imports": 305225.75}, {"dt": "2009-08-01T00:00:00", "Loaded Imports": 323629.2}, {"dt": "2009-09-01T00:00:00", "Loaded Imports": 309078.3}, {"dt": "2009-10-01T00:00:00", "Loaded Imports": 338734.75}, {"dt": "2009-11-01T00:00:00", "Loaded Imports": 298777.4}, {"dt": "2009-12-01T00:00:00", "Loaded Imports": 283364.4}, {"dt": "2010-01-01T00:00:00", "Loaded Imports": 296304.95}, {"dt": "2010-02-01T00:00:00", "Loaded Imports": 267361.15}, {"dt": "2010-03-01T00:00:00", "Loaded Imports": 269634.1}, {"dt": "2010-04-01T00:00:00", "Loaded Imports": 302224.6}, {"dt": "2010-05-01T00:00:00", "Loaded Imports": 342171.1}, {"dt": "2010-06-01T00:00:00", "Loaded Imports": 371888.6}, {"dt": "2010-07-01T00:00:00", "Loaded Imports": 369388.9}, {"dt": "2010-08-01T00:00:00", "Loaded Imports": 399150.65}, {"dt": "2010-09-01T00:00:00", "Loaded Imports": 373249.35}, {"dt": "2010-10-01T00:00:00", "Loaded Imports": 349545.4}, {"dt": "2010-11-01T00:00:00", "Loaded Imports": 333710.15}, {"dt": "2010-12-01T00:00:00", "Loaded Imports": 299304.45}, {"dt": "2011-01-01T00:00:00", "Loaded Imports": 338606.65}, {"dt": "2011-02-01T00:00:00", "Loaded Imports": 275886.5}, {"dt": "2011-03-01T00:00:00", "Loaded Imports": 297023.1}, {"dt": "2011-04-01T00:00:00", "Loaded Imports": 312359.9}, {"dt": "2011-05-01T00:00:00", "Loaded Imports": 360969.25}, {"dt": "2011-06-01T00:00:00", "Loaded Imports": 333894.3}, {"dt": "2011-07-01T00:00:00", "Loaded Imports": 357667.7}, {"dt": "2011-08-01T00:00:00", "Loaded Imports": 376189.55}, {"dt": "2011-09-01T00:00:00", "Loaded Imports": 372655.2}, {"dt": "2011-10-01T00:00:00", "Loaded Imports": 368842.95}, {"dt": "2011-11-01T00:00:00", "Loaded Imports": 354313.1}, {"dt": "2011-12-01T00:00:00", "Loaded Imports": 318355.65}, {"dt": "2012-01-01T00:00:00", "Loaded Imports": 356394.7}, {"dt": "2012-02-01T00:00:00", "Loaded Imports": 254359.6}, {"dt": "2012-03-01T00:00:00", "Loaded Imports": 324758.0}, {"dt": "2012-04-01T00:00:00", "Loaded Imports": 364555.15}, {"dt": "2012-05-01T00:00:00", "Loaded Imports": 370721.75}, {"dt": "2012-06-01T00:00:00", "Loaded Imports": 353930.55}, {"dt": "2012-07-01T00:00:00", "Loaded Imports": 371859.15}, {"dt": "2012-08-01T00:00:00", "Loaded Imports": 360762.1}, {"dt": "2012-09-01T00:00:00", "Loaded Imports": 385250.3}, {"dt": "2012-10-01T00:00:00", "Loaded Imports": 364881.9}, {"dt": "2012-11-01T00:00:00", "Loaded Imports": 288273.5}, {"dt": "2012-12-01T00:00:00", "Loaded Imports": 296874.45}, {"dt": "2013-01-01T00:00:00", "Loaded Imports": 337428.3}, {"dt": "2013-02-01T00:00:00", "Loaded Imports": 318547.0}, {"dt": "2013-03-01T00:00:00", "Loaded Imports": 231396.7}, {"dt": "2013-04-01T00:00:00", "Loaded Imports": 326780.95}, {"dt": "2013-05-01T00:00:00", "Loaded Imports": 326114.6}, {"dt": "2013-06-01T00:00:00", "Loaded Imports": 328324.9}, {"dt": "2013-07-01T00:00:00", "Loaded Imports": 370745.55}, {"dt": "2013-08-01T00:00:00", "Loaded Imports": 355682.75}, {"dt": "2013-09-01T00:00:00", "Loaded Imports": 370785.7}, {"dt": "2013-10-01T00:00:00", "Loaded Imports": 346137.55}, {"dt": "2013-11-01T00:00:00", "Loaded Imports": 342247.2}, {"dt": "2013-12-01T00:00:00", "Loaded Imports": 322500.6}, {"dt": "2014-01-01T00:00:00", "Loaded Imports": 360036.6}, {"dt": "2014-02-01T00:00:00", "Loaded Imports": 284812.35}, {"dt": "2014-03-01T00:00:00", "Loaded Imports": 327497.05}, {"dt": "2014-04-01T00:00:00", "Loaded Imports": 364126.05}, {"dt": "2014-05-01T00:00:00", "Loaded Imports": 351403.6}, {"dt": "2014-06-01T00:00:00", "Loaded Imports": 382666.15}, {"dt": "2014-07-01T00:00:00", "Loaded Imports": 363393.5}, {"dt": "2014-08-01T00:00:00", "Loaded Imports": 383551.35}, {"dt": "2014-09-01T00:00:00", "Loaded Imports": 411506.95}, {"dt": "2014-10-01T00:00:00", "Loaded Imports": 370938.2}, {"dt": "2014-11-01T00:00:00", "Loaded Imports": 333152.95}, {"dt": "2014-12-01T00:00:00", "Loaded Imports": 336674.95}, {"dt": "2015-01-01T00:00:00", "Loaded Imports": 259206.45}, {"dt": "2015-02-01T00:00:00", "Loaded Imports": 254225.3}, {"dt": "2015-03-01T00:00:00", "Loaded Imports": 430898.05}, {"dt": "2015-04-01T00:00:00", "Loaded Imports": 328140.25}, {"dt": "2015-05-01T00:00:00", "Loaded Imports": 348427.0}, {"dt": "2015-06-01T00:00:00", "Loaded Imports": 368708.5}, {"dt": "2015-07-01T00:00:00", "Loaded Imports": 350627.85}, {"dt": "2015-08-01T00:00:00", "Loaded Imports": 407804.4}, {"dt": "2015-09-01T00:00:00", "Loaded Imports": 372991.5}, {"dt": "2015-10-01T00:00:00", "Loaded Imports": 358601.5}, {"dt": "2015-11-01T00:00:00", "Loaded Imports": 358423.45}, {"dt": "2015-12-01T00:00:00", "Loaded Imports": 321407.7}, {"dt": "2016-01-01T00:00:00", "Loaded Imports": 367208.8}, {"dt": "2016-02-01T00:00:00", "Loaded Imports": 372744.3}, {"dt": "2016-03-01T00:00:00", "Loaded Imports": 287231.25}, {"dt": "2016-04-01T00:00:00", "Loaded Imports": 343574.1}, {"dt": "2016-05-01T00:00:00", "Loaded Imports": 400765.95}, {"dt": "2016-06-01T00:00:00", "Loaded Imports": 355622.9}, {"dt": "2016-07-01T00:00:00", "Loaded Imports": 368696.85}, {"dt": "2016-08-01T00:00:00", "Loaded Imports": 411366.85}, {"dt": "2016-09-01T00:00:00", "Loaded Imports": 388958.5}, {"dt": "2016-10-01T00:00:00", "Loaded Imports": 417311.05}, {"dt": "2016-11-01T00:00:00", "Loaded Imports": 437050.2}, {"dt": "2016-12-01T00:00:00", "Loaded Imports": 394217.15}, {"dt": "2017-01-01T00:00:00", "Loaded Imports": 415422.7}, {"dt": "2017-02-01T00:00:00", "Loaded Imports": 298974.95}, {"dt": "2017-03-01T00:00:00", "Loaded Imports": 373548.95}, {"dt": "2017-04-01T00:00:00", "Loaded Imports": 372040.9}, {"dt": "2017-05-01T00:00:00", "Loaded Imports": 413021.3}, {"dt": "2017-06-01T00:00:00", "Loaded Imports": 372272.1}, {"dt": "2017-07-01T00:00:00", "Loaded Imports": 417090.75}, {"dt": "2017-08-01T00:00:00", "Loaded Imports": 432479.15}, {"dt": "2017-09-01T00:00:00", "Loaded Imports": 388670.05}, {"dt": "2017-10-01T00:00:00", "Loaded Imports": 383385.0}, {"dt": "2017-11-01T00:00:00", "Loaded Imports": 463690.9}, {"dt": "2017-12-01T00:00:00", "Loaded Imports": 385492.05}, {"dt": "2018-01-01T00:00:00", "Loaded Imports": 422831.95}, {"dt": "2018-02-01T00:00:00", "Loaded Imports": 383089.55}, {"dt": "2018-03-01T00:00:00", "Loaded Imports": 264460.05}, {"dt": "2018-04-01T00:00:00", "Loaded Imports": 361108.3}, {"dt": "2018-05-01T00:00:00", "Loaded Imports": 405586.8}, {"dt": "2018-06-01T00:00:00", "Loaded Imports": 382964.0}, {"dt": "2018-07-01T00:00:00", "Loaded Imports": 438164.55}, {"dt": "2018-08-01T00:00:00", "Loaded Imports": 420573.25}, {"dt": "2018-09-01T00:00:00", "Loaded Imports": 414281.5}, {"dt": "2018-10-01T00:00:00", "Loaded Imports": 485823.55}, {"dt": "2018-11-01T00:00:00", "Loaded Imports": 422792.65}, {"dt": "2018-12-01T00:00:00", "Loaded Imports": 468905.85}, {"dt": "2019-01-01T00:00:00", "Loaded Imports": 429922.75}, {"dt": "2019-02-01T00:00:00", "Loaded Imports": 348315.75}, {"dt": "2019-03-01T00:00:00", "Loaded Imports": 297186.95}, {"dt": "2019-04-01T00:00:00", "Loaded Imports": 360744.65}, {"dt": "2019-05-01T00:00:00", "Loaded Imports": 427789.0}, {"dt": "2019-06-01T00:00:00", "Loaded Imports": 396306.5}, {"dt": "2019-07-01T00:00:00", "Loaded Imports": 476438.2}, {"dt": "2019-08-01T00:00:00", "Loaded Imports": 437613.25}, {"dt": "2019-09-01T00:00:00", "Loaded Imports": 402319.85}, {"dt": "2019-10-01T00:00:00", "Loaded Imports": 392768.6}, {"dt": "2019-11-01T00:00:00", "Loaded Imports": 371349.7}, {"dt": "2019-12-01T00:00:00", "Loaded Imports": 373511.0}, {"dt": "2020-01-01T00:00:00", "Loaded Imports": 414730.85}, {"dt": "2020-02-01T00:00:00", "Loaded Imports": 270025.05}, {"dt": "2020-03-01T00:00:00", "Loaded Imports": 220254.55}, {"dt": "2020-04-01T00:00:00", "Loaded Imports": 370111.0}, {"dt": "2020-05-01T00:00:00", "Loaded Imports": 306323.0}, {"dt": "2020-06-01T00:00:00", "Loaded Imports": 369188.9}, {"dt": "2020-07-01T00:00:00", "Loaded Imports": 456028.7}, {"dt": "2020-08-01T00:00:00", "Loaded Imports": 516285.95}, {"dt": "2020-09-01T00:00:00", "Loaded Imports": 471794.5}, {"dt": "2020-10-01T00:00:00", "Loaded Imports": 506613.2}, {"dt": "2020-11-01T00:00:00", "Loaded Imports": 464819.7}, {"dt": "2020-12-01T00:00:00", "Loaded Imports": 460865.0}, {"dt": "2021-01-01T00:00:00", "Loaded Imports": 437609.2}, {"dt": "2021-02-01T00:00:00", "Loaded Imports": 412884.25}, {"dt": "2021-03-01T00:00:00", "Loaded Imports": 490115.0}, {"dt": "2021-04-01T00:00:00", "Loaded Imports": 490126.85}, {"dt": "2021-05-01T00:00:00", "Loaded Imports": 535714.2}, {"dt": "2021-06-01T00:00:00", "Loaded Imports": 467763.25}, {"dt": "2021-07-01T00:00:00", "Loaded Imports": 469360.85}, {"dt": "2021-08-01T00:00:00", "Loaded Imports": 485672.15}, {"dt": "2021-09-01T00:00:00", "Loaded Imports": 468059.15}, {"dt": "2021-10-01T00:00:00", "Loaded Imports": 467286.65}, {"dt": "2021-11-01T00:00:00", "Loaded Imports": 403443.9}, {"dt": "2021-12-01T00:00:00", "Loaded Imports": 385250.7}, {"dt": "2022-01-01T00:00:00", "Loaded Imports": 427207.7}, {"dt": "2022-02-01T00:00:00", "Loaded Imports": 424072.85}, {"dt": "2022-03-01T00:00:00", "Loaded Imports": 495195.8}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_la</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Los Angeles&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Loaded Export&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[6]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-311c0cc6e90e42caa81082e822cb31c5"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-311c0cc6e90e42caa81082e822cb31c5") {
      outputDiv = document.getElementById("altair-viz-311c0cc6e90e42caa81082e822cb31c5");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector002"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Los Angeles Loaded Export Container Volume", "transform": [{"window": [{"op": "lag", "field": "Loaded Export", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Loaded Export'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Loaded Export"}}, "height": 100, "selection": {"selector002": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-633dbe6ce042e25730e8942a54692b14"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-633dbe6ce042e25730e8942a54692b14": [{"dt": "1996-01-01T00:00:00", "Loaded Export": 70385.7}, {"dt": "1996-02-01T00:00:00", "Loaded Export": 63690.35}, {"dt": "1996-03-01T00:00:00", "Loaded Export": 71969.1}, {"dt": "1996-04-01T00:00:00", "Loaded Export": 67039.65}, {"dt": "1996-05-01T00:00:00", "Loaded Export": 60772.15}, {"dt": "1996-06-01T00:00:00", "Loaded Export": 67356.15}, {"dt": "1996-07-01T00:00:00", "Loaded Export": 67884.1}, {"dt": "1996-08-01T00:00:00", "Loaded Export": 72171.55}, {"dt": "1996-09-01T00:00:00", "Loaded Export": 66293.5}, {"dt": "1996-10-01T00:00:00", "Loaded Export": 77459.8}, {"dt": "1996-11-01T00:00:00", "Loaded Export": 74874.0}, {"dt": "1996-12-01T00:00:00", "Loaded Export": 76539.65}, {"dt": "1997-01-01T00:00:00", "Loaded Export": 72537.0}, {"dt": "1997-02-01T00:00:00", "Loaded Export": 71375.5}, {"dt": "1997-03-01T00:00:00", "Loaded Export": 83445.75}, {"dt": "1997-04-01T00:00:00", "Loaded Export": 77211.2}, {"dt": "1997-05-01T00:00:00", "Loaded Export": 76327.25}, {"dt": "1997-06-01T00:00:00", "Loaded Export": 73399.35}, {"dt": "1997-07-01T00:00:00", "Loaded Export": 71622.55}, {"dt": "1997-08-01T00:00:00", "Loaded Export": 70892.1}, {"dt": "1997-09-01T00:00:00", "Loaded Export": 65614.75}, {"dt": "1997-10-01T00:00:00", "Loaded Export": 74447.3}, {"dt": "1997-11-01T00:00:00", "Loaded Export": 66021.4}, {"dt": "1997-12-01T00:00:00", "Loaded Export": 68031.7}, {"dt": "1998-01-01T00:00:00", "Loaded Export": 61184.65}, {"dt": "1998-02-01T00:00:00", "Loaded Export": 66589.0}, {"dt": "1998-03-01T00:00:00", "Loaded Export": 76610.2}, {"dt": "1998-04-01T00:00:00", "Loaded Export": 71112.0}, {"dt": "1998-05-01T00:00:00", "Loaded Export": 68261.0}, {"dt": "1998-06-01T00:00:00", "Loaded Export": 64001.05}, {"dt": "1998-07-01T00:00:00", "Loaded Export": 61964.65}, {"dt": "1998-08-01T00:00:00", "Loaded Export": 67823.4}, {"dt": "1998-09-01T00:00:00", "Loaded Export": 60648.2}, {"dt": "1998-10-01T00:00:00", "Loaded Export": 65691.6}, {"dt": "1998-11-01T00:00:00", "Loaded Export": 68248.25}, {"dt": "1998-12-01T00:00:00", "Loaded Export": 62534.05}, {"dt": "1999-01-01T00:00:00", "Loaded Export": 57550.2}, {"dt": "1999-02-01T00:00:00", "Loaded Export": 61073.55}, {"dt": "1999-03-01T00:00:00", "Loaded Export": 68857.1}, {"dt": "1999-04-01T00:00:00", "Loaded Export": 63470.25}, {"dt": "1999-05-01T00:00:00", "Loaded Export": 70211.0}, {"dt": "1999-06-01T00:00:00", "Loaded Export": 67376.65}, {"dt": "1999-07-01T00:00:00", "Loaded Export": 66948.15}, {"dt": "1999-08-01T00:00:00", "Loaded Export": 68901.1}, {"dt": "1999-09-01T00:00:00", "Loaded Export": 66206.75}, {"dt": "1999-10-01T00:00:00", "Loaded Export": 75968.2}, {"dt": "1999-11-01T00:00:00", "Loaded Export": 77652.75}, {"dt": "1999-12-01T00:00:00", "Loaded Export": 73364.85}, {"dt": "2000-01-01T00:00:00", "Loaded Export": 73881.05}, {"dt": "2000-02-01T00:00:00", "Loaded Export": 76561.15}, {"dt": "2000-03-01T00:00:00", "Loaded Export": 82893.05}, {"dt": "2000-04-01T00:00:00", "Loaded Export": 85232.4}, {"dt": "2000-05-01T00:00:00", "Loaded Export": 81592.0}, {"dt": "2000-06-01T00:00:00", "Loaded Export": 79134.6}, {"dt": "2000-07-01T00:00:00", "Loaded Export": 80864.1}, {"dt": "2000-08-01T00:00:00", "Loaded Export": 87338.5}, {"dt": "2000-09-01T00:00:00", "Loaded Export": 78539.95}, {"dt": "2000-10-01T00:00:00", "Loaded Export": 93795.3}, {"dt": "2000-11-01T00:00:00", "Loaded Export": 82848.85}, {"dt": "2000-12-01T00:00:00", "Loaded Export": 81969.95}, {"dt": "2001-01-01T00:00:00", "Loaded Export": 82384.4}, {"dt": "2001-02-01T00:00:00", "Loaded Export": 80339.6}, {"dt": "2001-03-01T00:00:00", "Loaded Export": 88237.8}, {"dt": "2001-04-01T00:00:00", "Loaded Export": 88057.15}, {"dt": "2001-05-01T00:00:00", "Loaded Export": 87323.5}, {"dt": "2001-06-01T00:00:00", "Loaded Export": 88133.45}, {"dt": "2001-07-01T00:00:00", "Loaded Export": 86878.9}, {"dt": "2001-08-01T00:00:00", "Loaded Export": 87938.95}, {"dt": "2001-09-01T00:00:00", "Loaded Export": 81806.15}, {"dt": "2001-10-01T00:00:00", "Loaded Export": 90827.65}, {"dt": "2001-11-01T00:00:00", "Loaded Export": 89680.8}, {"dt": "2001-12-01T00:00:00", "Loaded Export": 86186.35}, {"dt": "2002-01-01T00:00:00", "Loaded Export": 83122.55}, {"dt": "2002-02-01T00:00:00", "Loaded Export": 92400.75}, {"dt": "2002-03-01T00:00:00", "Loaded Export": 92662.25}, {"dt": "2002-04-01T00:00:00", "Loaded Export": 91114.35}, {"dt": "2002-05-01T00:00:00", "Loaded Export": 96684.7}, {"dt": "2002-06-01T00:00:00", "Loaded Export": 95285.1}, {"dt": "2002-07-01T00:00:00", "Loaded Export": 83739.65}, {"dt": "2002-08-01T00:00:00", "Loaded Export": 91421.45}, {"dt": "2002-09-01T00:00:00", "Loaded Export": 89503.25}, {"dt": "2002-10-01T00:00:00", "Loaded Export": 70208.4}, {"dt": "2002-11-01T00:00:00", "Loaded Export": 95772.3}, {"dt": "2002-12-01T00:00:00", "Loaded Export": 111941.95}, {"dt": "2003-01-01T00:00:00", "Loaded Export": 105485.1}, {"dt": "2003-02-01T00:00:00", "Loaded Export": 100162.5}, {"dt": "2003-03-01T00:00:00", "Loaded Export": 107152.0}, {"dt": "2003-04-01T00:00:00", "Loaded Export": 97540.75}, {"dt": "2003-05-01T00:00:00", "Loaded Export": 102253.5}, {"dt": "2003-06-01T00:00:00", "Loaded Export": 89532.25}, {"dt": "2003-07-01T00:00:00", "Loaded Export": 97374.5}, {"dt": "2003-08-01T00:00:00", "Loaded Export": 88080.75}, {"dt": "2003-09-01T00:00:00", "Loaded Export": 83858.0}, {"dt": "2003-10-01T00:00:00", "Loaded Export": 93824.25}, {"dt": "2003-11-01T00:00:00", "Loaded Export": 98896.0}, {"dt": "2003-12-01T00:00:00", "Loaded Export": 99185.0}, {"dt": "2004-01-01T00:00:00", "Loaded Export": 97093.25}, {"dt": "2004-02-01T00:00:00", "Loaded Export": 95388.25}, {"dt": "2004-03-01T00:00:00", "Loaded Export": 115026.0}, {"dt": "2004-04-01T00:00:00", "Loaded Export": 102541.0}, {"dt": "2004-05-01T00:00:00", "Loaded Export": 100912.5}, {"dt": "2004-06-01T00:00:00", "Loaded Export": 89709.75}, {"dt": "2004-07-01T00:00:00", "Loaded Export": 95940.75}, {"dt": "2004-08-01T00:00:00", "Loaded Export": 86693.25}, {"dt": "2004-09-01T00:00:00", "Loaded Export": 76129.0}, {"dt": "2004-10-01T00:00:00", "Loaded Export": 91494.5}, {"dt": "2004-11-01T00:00:00", "Loaded Export": 90283.25}, {"dt": "2004-12-01T00:00:00", "Loaded Export": 88668.5}, {"dt": "2005-01-01T00:00:00", "Loaded Export": 83252.25}, {"dt": "2005-02-01T00:00:00", "Loaded Export": 87297.75}, {"dt": "2005-03-01T00:00:00", "Loaded Export": 107452.5}, {"dt": "2005-04-01T00:00:00", "Loaded Export": 107048.5}, {"dt": "2005-05-01T00:00:00", "Loaded Export": 105220.25}, {"dt": "2005-06-01T00:00:00", "Loaded Export": 96659.25}, {"dt": "2005-07-01T00:00:00", "Loaded Export": 97547.5}, {"dt": "2005-08-01T00:00:00", "Loaded Export": 95061.25}, {"dt": "2005-09-01T00:00:00", "Loaded Export": 92992.5}, {"dt": "2005-10-01T00:00:00", "Loaded Export": 98189.0}, {"dt": "2005-11-01T00:00:00", "Loaded Export": 98268.25}, {"dt": "2005-12-01T00:00:00", "Loaded Export": 102241.5}, {"dt": "2006-01-01T00:00:00", "Loaded Export": 100408.25}, {"dt": "2006-02-01T00:00:00", "Loaded Export": 96481.25}, {"dt": "2006-03-01T00:00:00", "Loaded Export": 128240.5}, {"dt": "2006-04-01T00:00:00", "Loaded Export": 113398.75}, {"dt": "2006-05-01T00:00:00", "Loaded Export": 118907.25}, {"dt": "2006-06-01T00:00:00", "Loaded Export": 115184.65}, {"dt": "2006-07-01T00:00:00", "Loaded Export": 124134.25}, {"dt": "2006-08-01T00:00:00", "Loaded Export": 119220.25}, {"dt": "2006-09-01T00:00:00", "Loaded Export": 124195.75}, {"dt": "2006-10-01T00:00:00", "Loaded Export": 131335.25}, {"dt": "2006-11-01T00:00:00", "Loaded Export": 122646.0}, {"dt": "2006-12-01T00:00:00", "Loaded Export": 129467.75}, {"dt": "2007-01-01T00:00:00", "Loaded Export": 124433.25}, {"dt": "2007-02-01T00:00:00", "Loaded Export": 118952.75}, {"dt": "2007-03-01T00:00:00", "Loaded Export": 127945.75}, {"dt": "2007-04-01T00:00:00", "Loaded Export": 123079.0}, {"dt": "2007-05-01T00:00:00", "Loaded Export": 134349.5}, {"dt": "2007-06-01T00:00:00", "Loaded Export": 135963.5}, {"dt": "2007-07-01T00:00:00", "Loaded Export": 129591.75}, {"dt": "2007-08-01T00:00:00", "Loaded Export": 137352.0}, {"dt": "2007-09-01T00:00:00", "Loaded Export": 135716.7}, {"dt": "2007-10-01T00:00:00", "Loaded Export": 146906.75}, {"dt": "2007-11-01T00:00:00", "Loaded Export": 145227.75}, {"dt": "2007-12-01T00:00:00", "Loaded Export": 148124.0}, {"dt": "2008-01-01T00:00:00", "Loaded Export": 147949.75}, {"dt": "2008-02-01T00:00:00", "Loaded Export": 154127.15}, {"dt": "2008-03-01T00:00:00", "Loaded Export": 154980.3}, {"dt": "2008-04-01T00:00:00", "Loaded Export": 147056.25}, {"dt": "2008-05-01T00:00:00", "Loaded Export": 164061.75}, {"dt": "2008-06-01T00:00:00", "Loaded Export": 150852.15}, {"dt": "2008-07-01T00:00:00", "Loaded Export": 173650.5}, {"dt": "2008-08-01T00:00:00", "Loaded Export": 175262.5}, {"dt": "2008-09-01T00:00:00", "Loaded Export": 143470.75}, {"dt": "2008-10-01T00:00:00", "Loaded Export": 134784.5}, {"dt": "2008-11-01T00:00:00", "Loaded Export": 126602.25}, {"dt": "2008-12-01T00:00:00", "Loaded Export": 109704.5}, {"dt": "2009-01-01T00:00:00", "Loaded Export": 104503.25}, {"dt": "2009-02-01T00:00:00", "Loaded Export": 111595.25}, {"dt": "2009-03-01T00:00:00", "Loaded Export": 139774.5}, {"dt": "2009-04-01T00:00:00", "Loaded Export": 140829.0}, {"dt": "2009-05-01T00:00:00", "Loaded Export": 152471.75}, {"dt": "2009-06-01T00:00:00", "Loaded Export": 137214.4}, {"dt": "2009-07-01T00:00:00", "Loaded Export": 138268.75}, {"dt": "2009-08-01T00:00:00", "Loaded Export": 150341.5}, {"dt": "2009-09-01T00:00:00", "Loaded Export": 140271.0}, {"dt": "2009-10-01T00:00:00", "Loaded Export": 150656.75}, {"dt": "2009-11-01T00:00:00", "Loaded Export": 149147.9}, {"dt": "2009-12-01T00:00:00", "Loaded Export": 153836.5}, {"dt": "2010-01-01T00:00:00", "Loaded Export": 141243.5}, {"dt": "2010-02-01T00:00:00", "Loaded Export": 147925.6}, {"dt": "2010-03-01T00:00:00", "Loaded Export": 161816.75}, {"dt": "2010-04-01T00:00:00", "Loaded Export": 158338.0}, {"dt": "2010-05-01T00:00:00", "Loaded Export": 160621.25}, {"dt": "2010-06-01T00:00:00", "Loaded Export": 154558.0}, {"dt": "2010-07-01T00:00:00", "Loaded Export": 146368.75}, {"dt": "2010-08-01T00:00:00", "Loaded Export": 147608.75}, {"dt": "2010-09-01T00:00:00", "Loaded Export": 139800.25}, {"dt": "2010-10-01T00:00:00", "Loaded Export": 151048.75}, {"dt": "2010-11-01T00:00:00", "Loaded Export": 170319.25}, {"dt": "2010-12-01T00:00:00", "Loaded Export": 161625.0}, {"dt": "2011-01-01T00:00:00", "Loaded Export": 159050.75}, {"dt": "2011-02-01T00:00:00", "Loaded Export": 150357.0}, {"dt": "2011-03-01T00:00:00", "Loaded Export": 192849.25}, {"dt": "2011-04-01T00:00:00", "Loaded Export": 167448.25}, {"dt": "2011-05-01T00:00:00", "Loaded Export": 184274.5}, {"dt": "2011-06-01T00:00:00", "Loaded Export": 163137.25}, {"dt": "2011-07-01T00:00:00", "Loaded Export": 165135.25}, {"dt": "2011-08-01T00:00:00", "Loaded Export": 184231.5}, {"dt": "2011-09-01T00:00:00", "Loaded Export": 176954.25}, {"dt": "2011-10-01T00:00:00", "Loaded Export": 193547.75}, {"dt": "2011-11-01T00:00:00", "Loaded Export": 195877.75}, {"dt": "2011-12-01T00:00:00", "Loaded Export": 176530.75}, {"dt": "2012-01-01T00:00:00", "Loaded Export": 168427.0}, {"dt": "2012-02-01T00:00:00", "Loaded Export": 164725.25}, {"dt": "2012-03-01T00:00:00", "Loaded Export": 188155.5}, {"dt": "2012-04-01T00:00:00", "Loaded Export": 186838.25}, {"dt": "2012-05-01T00:00:00", "Loaded Export": 185107.5}, {"dt": "2012-06-01T00:00:00", "Loaded Export": 174418.25}, {"dt": "2012-07-01T00:00:00", "Loaded Export": 165581.25}, {"dt": "2012-08-01T00:00:00", "Loaded Export": 164819.0}, {"dt": "2012-09-01T00:00:00", "Loaded Export": 172432.75}, {"dt": "2012-10-01T00:00:00", "Loaded Export": 179810.5}, {"dt": "2012-11-01T00:00:00", "Loaded Export": 145344.0}, {"dt": "2012-12-01T00:00:00", "Loaded Export": 147417.0}, {"dt": "2013-01-01T00:00:00", "Loaded Export": 159257.5}, {"dt": "2013-02-01T00:00:00", "Loaded Export": 156690.75}, {"dt": "2013-03-01T00:00:00", "Loaded Export": 154428.25}, {"dt": "2013-04-01T00:00:00", "Loaded Export": 160129.5}, {"dt": "2013-05-01T00:00:00", "Loaded Export": 154904.5}, {"dt": "2013-06-01T00:00:00", "Loaded Export": 148203.5}, {"dt": "2013-07-01T00:00:00", "Loaded Export": 157585.5}, {"dt": "2013-08-01T00:00:00", "Loaded Export": 158484.5}, {"dt": "2013-09-01T00:00:00", "Loaded Export": 150380.0}, {"dt": "2013-10-01T00:00:00", "Loaded Export": 169568.25}, {"dt": "2013-11-01T00:00:00", "Loaded Export": 179175.75}, {"dt": "2013-12-01T00:00:00", "Loaded Export": 172261.0}, {"dt": "2014-01-01T00:00:00", "Loaded Export": 161938.5}, {"dt": "2014-02-01T00:00:00", "Loaded Export": 146925.75}, {"dt": "2014-03-01T00:00:00", "Loaded Export": 187826.0}, {"dt": "2014-04-01T00:00:00", "Loaded Export": 172945.25}, {"dt": "2014-05-01T00:00:00", "Loaded Export": 158473.0}, {"dt": "2014-06-01T00:00:00", "Loaded Export": 160823.0}, {"dt": "2014-07-01T00:00:00", "Loaded Export": 163294.5}, {"dt": "2014-08-01T00:00:00", "Loaded Export": 168248.0}, {"dt": "2014-09-01T00:00:00", "Loaded Export": 150678.5}, {"dt": "2014-10-01T00:00:00", "Loaded Export": 158181.5}, {"dt": "2014-11-01T00:00:00", "Loaded Export": 150568.0}, {"dt": "2014-12-01T00:00:00", "Loaded Export": 152112.0}, {"dt": "2015-01-01T00:00:00", "Loaded Export": 124365.25}, {"dt": "2015-02-01T00:00:00", "Loaded Export": 131806.5}, {"dt": "2015-03-01T00:00:00", "Loaded Export": 145536.25}, {"dt": "2015-04-01T00:00:00", "Loaded Export": 145655.75}, {"dt": "2015-05-01T00:00:00", "Loaded Export": 152917.0}, {"dt": "2015-06-01T00:00:00", "Loaded Export": 143549.25}, {"dt": "2015-07-01T00:00:00", "Loaded Export": 136402.0}, {"dt": "2015-08-01T00:00:00", "Loaded Export": 143936.0}, {"dt": "2015-09-01T00:00:00", "Loaded Export": 124286.0}, {"dt": "2015-10-01T00:00:00", "Loaded Export": 134963.75}, {"dt": "2015-11-01T00:00:00", "Loaded Export": 142020.25}, {"dt": "2015-12-01T00:00:00", "Loaded Export": 131239.0}, {"dt": "2016-01-01T00:00:00", "Loaded Export": 126240.5}, {"dt": "2016-02-01T00:00:00", "Loaded Export": 146488.75}, {"dt": "2016-03-01T00:00:00", "Loaded Export": 159362.5}, {"dt": "2016-04-01T00:00:00", "Loaded Export": 144103.75}, {"dt": "2016-05-01T00:00:00", "Loaded Export": 162487.0}, {"dt": "2016-06-01T00:00:00", "Loaded Export": 140561.5}, {"dt": "2016-07-01T00:00:00", "Loaded Export": 132490.0}, {"dt": "2016-08-01T00:00:00", "Loaded Export": 153005.0}, {"dt": "2016-09-01T00:00:00", "Loaded Export": 145096.25}, {"dt": "2016-10-01T00:00:00", "Loaded Export": 166406.25}, {"dt": "2016-11-01T00:00:00", "Loaded Export": 177359.75}, {"dt": "2016-12-01T00:00:00", "Loaded Export": 164900.5}, {"dt": "2017-01-01T00:00:00", "Loaded Export": 162420.0}, {"dt": "2017-02-01T00:00:00", "Loaded Export": 155357.65}, {"dt": "2017-03-01T00:00:00", "Loaded Export": 191771.75}, {"dt": "2017-04-01T00:00:00", "Loaded Export": 157661.5}, {"dt": "2017-05-01T00:00:00", "Loaded Export": 169639.0}, {"dt": "2017-06-01T00:00:00", "Loaded Export": 145527.5}, {"dt": "2017-07-01T00:00:00", "Loaded Export": 154925.75}, {"dt": "2017-08-01T00:00:00", "Loaded Export": 159197.0}, {"dt": "2017-09-01T00:00:00", "Loaded Export": 128445.5}, {"dt": "2017-10-01T00:00:00", "Loaded Export": 144209.75}, {"dt": "2017-11-01T00:00:00", "Loaded Export": 177913.0}, {"dt": "2017-12-01T00:00:00", "Loaded Export": 152865.5}, {"dt": "2018-01-01T00:00:00", "Loaded Export": 150035.25}, {"dt": "2018-02-01T00:00:00", "Loaded Export": 157591.25}, {"dt": "2018-03-01T00:00:00", "Loaded Export": 163706.65}, {"dt": "2018-04-01T00:00:00", "Loaded Export": 164703.65}, {"dt": "2018-05-01T00:00:00", "Loaded Export": 168680.75}, {"dt": "2018-06-01T00:00:00", "Loaded Export": 147563.25}, {"dt": "2018-07-01T00:00:00", "Loaded Export": 167991.75}, {"dt": "2018-08-01T00:00:00", "Loaded Export": 162465.5}, {"dt": "2018-09-01T00:00:00", "Loaded Export": 146999.5}, {"dt": "2018-10-01T00:00:00", "Loaded Export": 173823.9}, {"dt": "2018-11-01T00:00:00", "Loaded Export": 152527.0}, {"dt": "2018-12-01T00:00:00", "Loaded Export": 147965.4}, {"dt": "2019-01-01T00:00:00", "Loaded Export": 144993.0}, {"dt": "2019-02-01T00:00:00", "Loaded Export": 142554.5}, {"dt": "2019-03-01T00:00:00", "Loaded Export": 158923.75}, {"dt": "2019-04-01T00:00:00", "Loaded Export": 155532.75}, {"dt": "2019-05-01T00:00:00", "Loaded Export": 167357.25}, {"dt": "2019-06-01T00:00:00", "Loaded Export": 139318.0}, {"dt": "2019-07-01T00:00:00", "Loaded Export": 161340.25}, {"dt": "2019-08-01T00:00:00", "Loaded Export": 146284.0}, {"dt": "2019-09-01T00:00:00", "Loaded Export": 130768.5}, {"dt": "2019-10-01T00:00:00", "Loaded Export": 140331.5}, {"dt": "2019-11-01T00:00:00", "Loaded Export": 138544.5}, {"dt": "2019-12-01T00:00:00", "Loaded Export": 130228.5}, {"dt": "2020-01-01T00:00:00", "Loaded Export": 148206.0}, {"dt": "2020-02-01T00:00:00", "Loaded Export": 134468.5}, {"dt": "2020-03-01T00:00:00", "Loaded Export": 121146.0}, {"dt": "2020-04-01T00:00:00", "Loaded Export": 130321.25}, {"dt": "2020-05-01T00:00:00", "Loaded Export": 104382.0}, {"dt": "2020-06-01T00:00:00", "Loaded Export": 109585.75}, {"dt": "2020-07-01T00:00:00", "Loaded Export": 126353.7}, {"dt": "2020-08-01T00:00:00", "Loaded Export": 131428.75}, {"dt": "2020-09-01T00:00:00", "Loaded Export": 130396.75}, {"dt": "2020-10-01T00:00:00", "Loaded Export": 143935.75}, {"dt": "2020-11-01T00:00:00", "Loaded Export": 130916.5}, {"dt": "2020-12-01T00:00:00", "Loaded Export": 120265.0}, {"dt": "2021-01-01T00:00:00", "Loaded Export": 119326.75}, {"dt": "2021-02-01T00:00:00", "Loaded Export": 101208.15}, {"dt": "2021-03-01T00:00:00", "Loaded Export": 122899.0}, {"dt": "2021-04-01T00:00:00", "Loaded Export": 114448.5}, {"dt": "2021-05-01T00:00:00", "Loaded Export": 109886.0}, {"dt": "2021-06-01T00:00:00", "Loaded Export": 96066.75}, {"dt": "2021-07-01T00:00:00", "Loaded Export": 91439.5}, {"dt": "2021-08-01T00:00:00", "Loaded Export": 101292.0}, {"dt": "2021-09-01T00:00:00", "Loaded Export": 75713.5}, {"dt": "2021-10-01T00:00:00", "Loaded Export": 98251.25}, {"dt": "2021-11-01T00:00:00", "Loaded Export": 82741.35}, {"dt": "2021-12-01T00:00:00", "Loaded Export": 70871.75}, {"dt": "2022-01-01T00:00:00", "Loaded Export": 100185.25}, {"dt": "2022-02-01T00:00:00", "Loaded Export": 95441.0}, {"dt": "2022-03-01T00:00:00", "Loaded Export": 111781.25}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_la</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Los Angeles&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Total Imports&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[7]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-42eebdfaf9b242db8b2604df836fb9e3"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-42eebdfaf9b242db8b2604df836fb9e3") {
      outputDiv = document.getElementById("altair-viz-42eebdfaf9b242db8b2604df836fb9e3");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector003"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Los Angeles Total Imports Container Volume", "transform": [{"window": [{"op": "lag", "field": "Total Imports", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Total Imports'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Total Imports"}}, "height": 100, "selection": {"selector003": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-241404dc2f0b965e4992c36ea156edf1"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-241404dc2f0b965e4992c36ea156edf1": [{"dt": "1996-01-01T00:00:00", "Total Imports": 111493.55}, {"dt": "1996-02-01T00:00:00", "Total Imports": 99784.05}, {"dt": "1996-03-01T00:00:00", "Total Imports": 96905.95}, {"dt": "1996-04-01T00:00:00", "Total Imports": 111203.2}, {"dt": "1996-05-01T00:00:00", "Total Imports": 115512.75}, {"dt": "1996-06-01T00:00:00", "Total Imports": 119421.5}, {"dt": "1996-07-01T00:00:00", "Total Imports": 129983.05}, {"dt": "1996-08-01T00:00:00", "Total Imports": 134295.55}, {"dt": "1996-09-01T00:00:00", "Total Imports": 134656.3}, {"dt": "1996-10-01T00:00:00", "Total Imports": 144429.25}, {"dt": "1996-11-01T00:00:00", "Total Imports": 128520.2}, {"dt": "1996-12-01T00:00:00", "Total Imports": 122427.15}, {"dt": "1997-01-01T00:00:00", "Total Imports": 127064.7}, {"dt": "1997-02-01T00:00:00", "Total Imports": 112732.15}, {"dt": "1997-03-01T00:00:00", "Total Imports": 113062.25}, {"dt": "1997-04-01T00:00:00", "Total Imports": 129796.1}, {"dt": "1997-05-01T00:00:00", "Total Imports": 136711.2}, {"dt": "1997-06-01T00:00:00", "Total Imports": 140218.3}, {"dt": "1997-07-01T00:00:00", "Total Imports": 143755.25}, {"dt": "1997-08-01T00:00:00", "Total Imports": 143388.85}, {"dt": "1997-09-01T00:00:00", "Total Imports": 143699.25}, {"dt": "1997-10-01T00:00:00", "Total Imports": 144424.9}, {"dt": "1997-11-01T00:00:00", "Total Imports": 131876.1}, {"dt": "1997-12-01T00:00:00", "Total Imports": 134314.7}, {"dt": "1998-01-01T00:00:00", "Total Imports": 125929.65}, {"dt": "1998-02-01T00:00:00", "Total Imports": 122976.0}, {"dt": "1998-03-01T00:00:00", "Total Imports": 154946.9}, {"dt": "1998-04-01T00:00:00", "Total Imports": 154521.95}, {"dt": "1998-05-01T00:00:00", "Total Imports": 167203.5}, {"dt": "1998-06-01T00:00:00", "Total Imports": 159637.2}, {"dt": "1998-07-01T00:00:00", "Total Imports": 158947.85}, {"dt": "1998-08-01T00:00:00", "Total Imports": 171151.55}, {"dt": "1998-09-01T00:00:00", "Total Imports": 157266.25}, {"dt": "1998-10-01T00:00:00", "Total Imports": 169363.8}, {"dt": "1998-11-01T00:00:00", "Total Imports": 158254.3}, {"dt": "1998-12-01T00:00:00", "Total Imports": 140164.35}, {"dt": "1999-01-01T00:00:00", "Total Imports": 142115.35}, {"dt": "1999-02-01T00:00:00", "Total Imports": 142079.95}, {"dt": "1999-03-01T00:00:00", "Total Imports": 141925.4}, {"dt": "1999-04-01T00:00:00", "Total Imports": 153558.2}, {"dt": "1999-05-01T00:00:00", "Total Imports": 182974.5}, {"dt": "1999-06-01T00:00:00", "Total Imports": 169681.45}, {"dt": "1999-07-01T00:00:00", "Total Imports": 185016.1}, {"dt": "1999-08-01T00:00:00", "Total Imports": 188280.5}, {"dt": "1999-09-01T00:00:00", "Total Imports": 187080.7}, {"dt": "1999-10-01T00:00:00", "Total Imports": 208162.15}, {"dt": "1999-11-01T00:00:00", "Total Imports": 184661.5}, {"dt": "1999-12-01T00:00:00", "Total Imports": 178492.65}, {"dt": "2000-01-01T00:00:00", "Total Imports": 194179.1}, {"dt": "2000-02-01T00:00:00", "Total Imports": 175889.25}, {"dt": "2000-03-01T00:00:00", "Total Imports": 188437.95}, {"dt": "2000-04-01T00:00:00", "Total Imports": 220156.2}, {"dt": "2000-05-01T00:00:00", "Total Imports": 217748.7}, {"dt": "2000-06-01T00:00:00", "Total Imports": 220070.55}, {"dt": "2000-07-01T00:00:00", "Total Imports": 243695.0}, {"dt": "2000-08-01T00:00:00", "Total Imports": 250550.5}, {"dt": "2000-09-01T00:00:00", "Total Imports": 227847.65}, {"dt": "2000-10-01T00:00:00", "Total Imports": 260468.6}, {"dt": "2000-11-01T00:00:00", "Total Imports": 210208.15}, {"dt": "2000-12-01T00:00:00", "Total Imports": 203020.25}, {"dt": "2001-01-01T00:00:00", "Total Imports": 212322.6}, {"dt": "2001-02-01T00:00:00", "Total Imports": 163331.4}, {"dt": "2001-03-01T00:00:00", "Total Imports": 217283.55}, {"dt": "2001-04-01T00:00:00", "Total Imports": 221464.7}, {"dt": "2001-05-01T00:00:00", "Total Imports": 213859.9}, {"dt": "2001-06-01T00:00:00", "Total Imports": 243053.0}, {"dt": "2001-07-01T00:00:00", "Total Imports": 250343.55}, {"dt": "2001-08-01T00:00:00", "Total Imports": 261704.6}, {"dt": "2001-09-01T00:00:00", "Total Imports": 275558.4}, {"dt": "2001-10-01T00:00:00", "Total Imports": 274953.1}, {"dt": "2001-11-01T00:00:00", "Total Imports": 241729.2}, {"dt": "2001-12-01T00:00:00", "Total Imports": 225885.5}, {"dt": "2002-01-01T00:00:00", "Total Imports": 220809.25}, {"dt": "2002-02-01T00:00:00", "Total Imports": 244166.75}, {"dt": "2002-03-01T00:00:00", "Total Imports": 229953.7}, {"dt": "2002-04-01T00:00:00", "Total Imports": 276372.75}, {"dt": "2002-05-01T00:00:00", "Total Imports": 284384.5}, {"dt": "2002-06-01T00:00:00", "Total Imports": 301446.95}, {"dt": "2002-07-01T00:00:00", "Total Imports": 271932.1}, {"dt": "2002-08-01T00:00:00", "Total Imports": 339689.25}, {"dt": "2002-09-01T00:00:00", "Total Imports": 330966.45}, {"dt": "2002-10-01T00:00:00", "Total Imports": 265217.35}, {"dt": "2002-11-01T00:00:00", "Total Imports": 301332.1}, {"dt": "2002-12-01T00:00:00", "Total Imports": 306098.55}, {"dt": "2003-01-01T00:00:00", "Total Imports": 276481.55}, {"dt": "2003-02-01T00:00:00", "Total Imports": 274739.5}, {"dt": "2003-03-01T00:00:00", "Total Imports": 298495.0}, {"dt": "2003-04-01T00:00:00", "Total Imports": 326708.05}, {"dt": "2003-05-01T00:00:00", "Total Imports": 348275.05}, {"dt": "2003-06-01T00:00:00", "Total Imports": 305891.85}, {"dt": "2003-07-01T00:00:00", "Total Imports": 331740.3}, {"dt": "2003-08-01T00:00:00", "Total Imports": 360045.1}, {"dt": "2003-09-01T00:00:00", "Total Imports": 350475.6}, {"dt": "2003-10-01T00:00:00", "Total Imports": 372111.05}, {"dt": "2003-11-01T00:00:00", "Total Imports": 338378.2}, {"dt": "2003-12-01T00:00:00", "Total Imports": 306983.45}, {"dt": "2004-01-01T00:00:00", "Total Imports": 345411.55}, {"dt": "2004-02-01T00:00:00", "Total Imports": 247709.3}, {"dt": "2004-03-01T00:00:00", "Total Imports": 340748.0}, {"dt": "2004-04-01T00:00:00", "Total Imports": 345338.15}, {"dt": "2004-05-01T00:00:00", "Total Imports": 367128.0}, {"dt": "2004-06-01T00:00:00", "Total Imports": 347055.75}, {"dt": "2004-07-01T00:00:00", "Total Imports": 365900.3}, {"dt": "2004-08-01T00:00:00", "Total Imports": 344108.6}, {"dt": "2004-09-01T00:00:00", "Total Imports": 324345.7}, {"dt": "2004-10-01T00:00:00", "Total Imports": 352717.85}, {"dt": "2004-11-01T00:00:00", "Total Imports": 340050.4}, {"dt": "2004-12-01T00:00:00", "Total Imports": 283267.2}, {"dt": "2005-01-01T00:00:00", "Total Imports": 305102.2}, {"dt": "2005-02-01T00:00:00", "Total Imports": 294022.45}, {"dt": "2005-03-01T00:00:00", "Total Imports": 262173.05}, {"dt": "2005-04-01T00:00:00", "Total Imports": 336086.9}, {"dt": "2005-05-01T00:00:00", "Total Imports": 319472.4}, {"dt": "2005-06-01T00:00:00", "Total Imports": 340581.95}, {"dt": "2005-07-01T00:00:00", "Total Imports": 356715.95}, {"dt": "2005-08-01T00:00:00", "Total Imports": 349654.5}, {"dt": "2005-09-01T00:00:00", "Total Imports": 356912.4}, {"dt": "2005-10-01T00:00:00", "Total Imports": 375050.85}, {"dt": "2005-11-01T00:00:00", "Total Imports": 332036.55}, {"dt": "2005-12-01T00:00:00", "Total Imports": 328244.1}, {"dt": "2006-01-01T00:00:00", "Total Imports": 327009.1}, {"dt": "2006-02-01T00:00:00", "Total Imports": 251811.85}, {"dt": "2006-03-01T00:00:00", "Total Imports": 345401.05}, {"dt": "2006-04-01T00:00:00", "Total Imports": 370170.6}, {"dt": "2006-05-01T00:00:00", "Total Imports": 368863.55}, {"dt": "2006-06-01T00:00:00", "Total Imports": 387956.85}, {"dt": "2006-07-01T00:00:00", "Total Imports": 413357.25}, {"dt": "2006-08-01T00:00:00", "Total Imports": 414004.3}, {"dt": "2006-09-01T00:00:00", "Total Imports": 431282.9}, {"dt": "2006-10-01T00:00:00", "Total Imports": 421693.7}, {"dt": "2006-11-01T00:00:00", "Total Imports": 390208.5}, {"dt": "2006-12-01T00:00:00", "Total Imports": 365590.75}, {"dt": "2007-01-01T00:00:00", "Total Imports": 367095.65}, {"dt": "2007-02-01T00:00:00", "Total Imports": 358600.75}, {"dt": "2007-03-01T00:00:00", "Total Imports": 323472.1}, {"dt": "2007-04-01T00:00:00", "Total Imports": 375511.5}, {"dt": "2007-05-01T00:00:00", "Total Imports": 368874.3}, {"dt": "2007-06-01T00:00:00", "Total Imports": 393187.1}, {"dt": "2007-07-01T00:00:00", "Total Imports": 387573.25}, {"dt": "2007-08-01T00:00:00", "Total Imports": 379027.1}, {"dt": "2007-09-01T00:00:00", "Total Imports": 407914.75}, {"dt": "2007-10-01T00:00:00", "Total Imports": 393947.95}, {"dt": "2007-11-01T00:00:00", "Total Imports": 383240.75}, {"dt": "2007-12-01T00:00:00", "Total Imports": 346140.45}, {"dt": "2008-01-01T00:00:00", "Total Imports": 347141.95}, {"dt": "2008-02-01T00:00:00", "Total Imports": 322978.55}, {"dt": "2008-03-01T00:00:00", "Total Imports": 301288.3}, {"dt": "2008-04-01T00:00:00", "Total Imports": 331840.65}, {"dt": "2008-05-01T00:00:00", "Total Imports": 376786.95}, {"dt": "2008-06-01T00:00:00", "Total Imports": 346791.55}, {"dt": "2008-07-01T00:00:00", "Total Imports": 376945.85}, {"dt": "2008-08-01T00:00:00", "Total Imports": 408236.3}, {"dt": "2008-09-01T00:00:00", "Total Imports": 373351.25}, {"dt": "2008-10-01T00:00:00", "Total Imports": 377272.95}, {"dt": "2008-11-01T00:00:00", "Total Imports": 345764.85}, {"dt": "2008-12-01T00:00:00", "Total Imports": 302760.2}, {"dt": "2009-01-01T00:00:00", "Total Imports": 320379.1}, {"dt": "2009-02-01T00:00:00", "Total Imports": 208178.5}, {"dt": "2009-03-01T00:00:00", "Total Imports": 281693.15}, {"dt": "2009-04-01T00:00:00", "Total Imports": 281674.25}, {"dt": "2009-05-01T00:00:00", "Total Imports": 306164.75}, {"dt": "2009-06-01T00:00:00", "Total Imports": 283982.8}, {"dt": "2009-07-01T00:00:00", "Total Imports": 307907.75}, {"dt": "2009-08-01T00:00:00", "Total Imports": 326905.75}, {"dt": "2009-09-01T00:00:00", "Total Imports": 313286.95}, {"dt": "2009-10-01T00:00:00", "Total Imports": 342412.6}, {"dt": "2009-11-01T00:00:00", "Total Imports": 303494.75}, {"dt": "2009-12-01T00:00:00", "Total Imports": 289010.85}, {"dt": "2010-01-01T00:00:00", "Total Imports": 302692.9}, {"dt": "2010-02-01T00:00:00", "Total Imports": 274939.8}, {"dt": "2010-03-01T00:00:00", "Total Imports": 281748.8}, {"dt": "2010-04-01T00:00:00", "Total Imports": 311343.05}, {"dt": "2010-05-01T00:00:00", "Total Imports": 351737.35}, {"dt": "2010-06-01T00:00:00", "Total Imports": 378967.05}, {"dt": "2010-07-01T00:00:00", "Total Imports": 375800.9}, {"dt": "2010-08-01T00:00:00", "Total Imports": 406691.4}, {"dt": "2010-09-01T00:00:00", "Total Imports": 379784.45}, {"dt": "2010-10-01T00:00:00", "Total Imports": 358240.65}, {"dt": "2010-11-01T00:00:00", "Total Imports": 344324.45}, {"dt": "2010-12-01T00:00:00", "Total Imports": 312860.7}, {"dt": "2011-01-01T00:00:00", "Total Imports": 355119.25}, {"dt": "2011-02-01T00:00:00", "Total Imports": 289163.05}, {"dt": "2011-03-01T00:00:00", "Total Imports": 312802.85}, {"dt": "2011-04-01T00:00:00", "Total Imports": 326846.35}, {"dt": "2011-05-01T00:00:00", "Total Imports": 375127.8}, {"dt": "2011-06-01T00:00:00", "Total Imports": 349423.3}, {"dt": "2011-07-01T00:00:00", "Total Imports": 375299.55}, {"dt": "2011-08-01T00:00:00", "Total Imports": 390877.5}, {"dt": "2011-09-01T00:00:00", "Total Imports": 383434.9}, {"dt": "2011-10-01T00:00:00", "Total Imports": 380437.85}, {"dt": "2011-11-01T00:00:00", "Total Imports": 368338.45}, {"dt": "2011-12-01T00:00:00", "Total Imports": 333164.25}, {"dt": "2012-01-01T00:00:00", "Total Imports": 365824.1}, {"dt": "2012-02-01T00:00:00", "Total Imports": 263458.8}, {"dt": "2012-03-01T00:00:00", "Total Imports": 338742.0}, {"dt": "2012-04-01T00:00:00", "Total Imports": 374035.7}, {"dt": "2012-05-01T00:00:00", "Total Imports": 379574.5}, {"dt": "2012-06-01T00:00:00", "Total Imports": 363603.45}, {"dt": "2012-07-01T00:00:00", "Total Imports": 380920.5}, {"dt": "2012-08-01T00:00:00", "Total Imports": 371591.0}, {"dt": "2012-09-01T00:00:00", "Total Imports": 393946.1}, {"dt": "2012-10-01T00:00:00", "Total Imports": 374385.3}, {"dt": "2012-11-01T00:00:00", "Total Imports": 298760.2}, {"dt": "2012-12-01T00:00:00", "Total Imports": 304971.7}, {"dt": "2013-01-01T00:00:00", "Total Imports": 349141.55}, {"dt": "2013-02-01T00:00:00", "Total Imports": 325505.25}, {"dt": "2013-03-01T00:00:00", "Total Imports": 242547.5}, {"dt": "2013-04-01T00:00:00", "Total Imports": 335032.95}, {"dt": "2013-05-01T00:00:00", "Total Imports": 338131.35}, {"dt": "2013-06-01T00:00:00", "Total Imports": 338636.5}, {"dt": "2013-07-01T00:00:00", "Total Imports": 382783.0}, {"dt": "2013-08-01T00:00:00", "Total Imports": 368697.75}, {"dt": "2013-09-01T00:00:00", "Total Imports": 382673.75}, {"dt": "2013-10-01T00:00:00", "Total Imports": 362452.1}, {"dt": "2013-11-01T00:00:00", "Total Imports": 351992.25}, {"dt": "2013-12-01T00:00:00", "Total Imports": 333121.35}, {"dt": "2014-01-01T00:00:00", "Total Imports": 371733.35}, {"dt": "2014-02-01T00:00:00", "Total Imports": 296537.1}, {"dt": "2014-03-01T00:00:00", "Total Imports": 342885.85}, {"dt": "2014-04-01T00:00:00", "Total Imports": 378044.05}, {"dt": "2014-05-01T00:00:00", "Total Imports": 368010.15}, {"dt": "2014-06-01T00:00:00", "Total Imports": 396092.8}, {"dt": "2014-07-01T00:00:00", "Total Imports": 380192.25}, {"dt": "2014-08-01T00:00:00", "Total Imports": 403003.2}, {"dt": "2014-09-01T00:00:00", "Total Imports": 424221.2}, {"dt": "2014-10-01T00:00:00", "Total Imports": 381558.65}, {"dt": "2014-11-01T00:00:00", "Total Imports": 343236.6}, {"dt": "2014-12-01T00:00:00", "Total Imports": 344398.95}, {"dt": "2015-01-01T00:00:00", "Total Imports": 267943.7}, {"dt": "2015-02-01T00:00:00", "Total Imports": 259956.05}, {"dt": "2015-03-01T00:00:00", "Total Imports": 439209.35}, {"dt": "2015-04-01T00:00:00", "Total Imports": 339593.75}, {"dt": "2015-05-01T00:00:00", "Total Imports": 359685.3}, {"dt": "2015-06-01T00:00:00", "Total Imports": 377780.6}, {"dt": "2015-07-01T00:00:00", "Total Imports": 362001.95}, {"dt": "2015-08-01T00:00:00", "Total Imports": 417318.8}, {"dt": "2015-09-01T00:00:00", "Total Imports": 383963.4}, {"dt": "2015-10-01T00:00:00", "Total Imports": 372415.65}, {"dt": "2015-11-01T00:00:00", "Total Imports": 368714.55}, {"dt": "2015-12-01T00:00:00", "Total Imports": 331046.9}, {"dt": "2016-01-01T00:00:00", "Total Imports": 375215.7}, {"dt": "2016-02-01T00:00:00", "Total Imports": 383368.25}, {"dt": "2016-03-01T00:00:00", "Total Imports": 296849.7}, {"dt": "2016-04-01T00:00:00", "Total Imports": 354203.55}, {"dt": "2016-05-01T00:00:00", "Total Imports": 411709.05}, {"dt": "2016-06-01T00:00:00", "Total Imports": 365177.15}, {"dt": "2016-07-01T00:00:00", "Total Imports": 379453.6}, {"dt": "2016-08-01T00:00:00", "Total Imports": 423190.25}, {"dt": "2016-09-01T00:00:00", "Total Imports": 399978.25}, {"dt": "2016-10-01T00:00:00", "Total Imports": 428196.85}, {"dt": "2016-11-01T00:00:00", "Total Imports": 448311.35}, {"dt": "2016-12-01T00:00:00", "Total Imports": 404880.65}, {"dt": "2017-01-01T00:00:00", "Total Imports": 428397.3}, {"dt": "2017-02-01T00:00:00", "Total Imports": 308581.75}, {"dt": "2017-03-01T00:00:00", "Total Imports": 385636.95}, {"dt": "2017-04-01T00:00:00", "Total Imports": 381516.65}, {"dt": "2017-05-01T00:00:00", "Total Imports": 424501.95}, {"dt": "2017-06-01T00:00:00", "Total Imports": 382783.6}, {"dt": "2017-07-01T00:00:00", "Total Imports": 427677.95}, {"dt": "2017-08-01T00:00:00", "Total Imports": 443038.8}, {"dt": "2017-09-01T00:00:00", "Total Imports": 398366.25}, {"dt": "2017-10-01T00:00:00", "Total Imports": 397958.7}, {"dt": "2017-11-01T00:00:00", "Total Imports": 475788.25}, {"dt": "2017-12-01T00:00:00", "Total Imports": 397301.05}, {"dt": "2018-01-01T00:00:00", "Total Imports": 432128.75}, {"dt": "2018-02-01T00:00:00", "Total Imports": 392682.95}, {"dt": "2018-03-01T00:00:00", "Total Imports": 273842.25}, {"dt": "2018-04-01T00:00:00", "Total Imports": 372526.3}, {"dt": "2018-05-01T00:00:00", "Total Imports": 417372.6}, {"dt": "2018-06-01T00:00:00", "Total Imports": 393365.15}, {"dt": "2018-07-01T00:00:00", "Total Imports": 454681.6}, {"dt": "2018-08-01T00:00:00", "Total Imports": 440676.4}, {"dt": "2018-09-01T00:00:00", "Total Imports": 431310.4}, {"dt": "2018-10-01T00:00:00", "Total Imports": 504387.85}, {"dt": "2018-11-01T00:00:00", "Total Imports": 439966.15}, {"dt": "2018-12-01T00:00:00", "Total Imports": 482353.25}, {"dt": "2019-01-01T00:00:00", "Total Imports": 445730.5}, {"dt": "2019-02-01T00:00:00", "Total Imports": 364550.55}, {"dt": "2019-03-01T00:00:00", "Total Imports": 311053.9}, {"dt": "2019-04-01T00:00:00", "Total Imports": 378343.5}, {"dt": "2019-05-01T00:00:00", "Total Imports": 440313.4}, {"dt": "2019-06-01T00:00:00", "Total Imports": 405824.0}, {"dt": "2019-07-01T00:00:00", "Total Imports": 487604.9}, {"dt": "2019-08-01T00:00:00", "Total Imports": 449085.8}, {"dt": "2019-09-01T00:00:00", "Total Imports": 414680.75}, {"dt": "2019-10-01T00:00:00", "Total Imports": 402425.5}, {"dt": "2019-11-01T00:00:00", "Total Imports": 380437.65}, {"dt": "2019-12-01T00:00:00", "Total Imports": 383794.25}, {"dt": "2020-01-01T00:00:00", "Total Imports": 425761.5}, {"dt": "2020-02-01T00:00:00", "Total Imports": 278735.05}, {"dt": "2020-03-01T00:00:00", "Total Imports": 231607.3}, {"dt": "2020-04-01T00:00:00", "Total Imports": 374186.0}, {"dt": "2020-05-01T00:00:00", "Total Imports": 306366.0}, {"dt": "2020-06-01T00:00:00", "Total Imports": 369256.9}, {"dt": "2020-07-01T00:00:00", "Total Imports": 457196.7}, {"dt": "2020-08-01T00:00:00", "Total Imports": 517024.75}, {"dt": "2020-09-01T00:00:00", "Total Imports": 476681.55}, {"dt": "2020-10-01T00:00:00", "Total Imports": 510812.8}, {"dt": "2020-11-01T00:00:00", "Total Imports": 466067.4}, {"dt": "2020-12-01T00:00:00", "Total Imports": 462655.3}, {"dt": "2021-01-01T00:00:00", "Total Imports": 437863.2}, {"dt": "2021-02-01T00:00:00", "Total Imports": 414154.5}, {"dt": "2021-03-01T00:00:00", "Total Imports": 493465.25}, {"dt": "2021-04-01T00:00:00", "Total Imports": 494681.6}, {"dt": "2021-05-01T00:00:00", "Total Imports": 540803.1}, {"dt": "2021-06-01T00:00:00", "Total Imports": 469553.6}, {"dt": "2021-07-01T00:00:00", "Total Imports": 469481.55}, {"dt": "2021-08-01T00:00:00", "Total Imports": 488873.85}, {"dt": "2021-09-01T00:00:00", "Total Imports": 469570.1}, {"dt": "2021-10-01T00:00:00", "Total Imports": 468713.6}, {"dt": "2021-11-01T00:00:00", "Total Imports": 405309.3}, {"dt": "2021-12-01T00:00:00", "Total Imports": 387523.15}, {"dt": "2022-01-01T00:00:00", "Total Imports": 428474.25}, {"dt": "2022-02-01T00:00:00", "Total Imports": 426812.45}, {"dt": "2022-03-01T00:00:00", "Total Imports": 497775.85}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_la</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Los Angeles&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Total TEUs&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[8]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-8c71c6c642a54828a1f771b865cddf68"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-8c71c6c642a54828a1f771b865cddf68") {
      outputDiv = document.getElementById("altair-viz-8c71c6c642a54828a1f771b865cddf68");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector004"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Los Angeles Total TEUs Container Volume", "transform": [{"window": [{"op": "lag", "field": "Total TEUs", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Total TEUs'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Total TEUs"}}, "height": 100, "selection": {"selector004": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-28c2d4071c5301c7d78107f2fa65525b"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-28c2d4071c5301c7d78107f2fa65525b": [{"dt": "1996-01-01T00:00:00", "Total TEUs": 204484.0}, {"dt": "1996-02-01T00:00:00", "Total TEUs": 186318.7}, {"dt": "1996-03-01T00:00:00", "Total TEUs": 195023.9}, {"dt": "1996-04-01T00:00:00", "Total TEUs": 205654.65}, {"dt": "1996-05-01T00:00:00", "Total TEUs": 210130.2}, {"dt": "1996-06-01T00:00:00", "Total TEUs": 219137.15}, {"dt": "1996-07-01T00:00:00", "Total TEUs": 231425.75}, {"dt": "1996-08-01T00:00:00", "Total TEUs": 250365.55}, {"dt": "1996-09-01T00:00:00", "Total TEUs": 242119.35}, {"dt": "1996-10-01T00:00:00", "Total TEUs": 269682.25}, {"dt": "1996-11-01T00:00:00", "Total TEUs": 239413.5}, {"dt": "1996-12-01T00:00:00", "Total TEUs": 229270.9}, {"dt": "1997-01-01T00:00:00", "Total TEUs": 236040.15}, {"dt": "1997-02-01T00:00:00", "Total TEUs": 217293.05}, {"dt": "1997-03-01T00:00:00", "Total TEUs": 230162.1}, {"dt": "1997-04-01T00:00:00", "Total TEUs": 241520.55}, {"dt": "1997-05-01T00:00:00", "Total TEUs": 251203.15}, {"dt": "1997-06-01T00:00:00", "Total TEUs": 246277.2}, {"dt": "1997-07-01T00:00:00", "Total TEUs": 252564.4}, {"dt": "1997-08-01T00:00:00", "Total TEUs": 259792.6}, {"dt": "1997-09-01T00:00:00", "Total TEUs": 256566.7}, {"dt": "1997-10-01T00:00:00", "Total TEUs": 268372.25}, {"dt": "1997-11-01T00:00:00", "Total TEUs": 245221.55}, {"dt": "1997-12-01T00:00:00", "Total TEUs": 254700.5}, {"dt": "1998-01-01T00:00:00", "Total TEUs": 238457.55}, {"dt": "1998-02-01T00:00:00", "Total TEUs": 235664.05}, {"dt": "1998-03-01T00:00:00", "Total TEUs": 274964.85}, {"dt": "1998-04-01T00:00:00", "Total TEUs": 273994.35}, {"dt": "1998-05-01T00:00:00", "Total TEUs": 300580.6}, {"dt": "1998-06-01T00:00:00", "Total TEUs": 284648.6}, {"dt": "1998-07-01T00:00:00", "Total TEUs": 279476.45}, {"dt": "1998-08-01T00:00:00", "Total TEUs": 313130.35}, {"dt": "1998-09-01T00:00:00", "Total TEUs": 289979.2}, {"dt": "1998-10-01T00:00:00", "Total TEUs": 311275.65}, {"dt": "1998-11-01T00:00:00", "Total TEUs": 299045.7}, {"dt": "1998-12-01T00:00:00", "Total TEUs": 277001.35}, {"dt": "1999-01-01T00:00:00", "Total TEUs": 269137.8}, {"dt": "1999-02-01T00:00:00", "Total TEUs": 263778.4}, {"dt": "1999-03-01T00:00:00", "Total TEUs": 275689.25}, {"dt": "1999-04-01T00:00:00", "Total TEUs": 282746.1}, {"dt": "1999-05-01T00:00:00", "Total TEUs": 335960.7}, {"dt": "1999-06-01T00:00:00", "Total TEUs": 317167.1}, {"dt": "1999-07-01T00:00:00", "Total TEUs": 330245.0}, {"dt": "1999-08-01T00:00:00", "Total TEUs": 348059.95}, {"dt": "1999-09-01T00:00:00", "Total TEUs": 336935.7}, {"dt": "1999-10-01T00:00:00", "Total TEUs": 387165.45}, {"dt": "1999-11-01T00:00:00", "Total TEUs": 347816.25}, {"dt": "1999-12-01T00:00:00", "Total TEUs": 334148.8}, {"dt": "2000-01-01T00:00:00", "Total TEUs": 358234.5}, {"dt": "2000-02-01T00:00:00", "Total TEUs": 336925.2}, {"dt": "2000-03-01T00:00:00", "Total TEUs": 357267.3}, {"dt": "2000-04-01T00:00:00", "Total TEUs": 407031.7}, {"dt": "2000-05-01T00:00:00", "Total TEUs": 408034.8}, {"dt": "2000-06-01T00:00:00", "Total TEUs": 402557.4}, {"dt": "2000-07-01T00:00:00", "Total TEUs": 440731.1}, {"dt": "2000-08-01T00:00:00", "Total TEUs": 464044.8}, {"dt": "2000-09-01T00:00:00", "Total TEUs": 422099.6}, {"dt": "2000-10-01T00:00:00", "Total TEUs": 481502.1}, {"dt": "2000-11-01T00:00:00", "Total TEUs": 414028.6}, {"dt": "2000-12-01T00:00:00", "Total TEUs": 386971.5}, {"dt": "2001-01-01T00:00:00", "Total TEUs": 396993.4}, {"dt": "2001-02-01T00:00:00", "Total TEUs": 330430.8}, {"dt": "2001-03-01T00:00:00", "Total TEUs": 401635.5}, {"dt": "2001-04-01T00:00:00", "Total TEUs": 417429.8}, {"dt": "2001-05-01T00:00:00", "Total TEUs": 400011.15}, {"dt": "2001-06-01T00:00:00", "Total TEUs": 435245.35}, {"dt": "2001-07-01T00:00:00", "Total TEUs": 451855.65}, {"dt": "2001-08-01T00:00:00", "Total TEUs": 477059.0}, {"dt": "2001-09-01T00:00:00", "Total TEUs": 484654.25}, {"dt": "2001-10-01T00:00:00", "Total TEUs": 505020.1}, {"dt": "2001-11-01T00:00:00", "Total TEUs": 455504.75}, {"dt": "2001-12-01T00:00:00", "Total TEUs": 427680.15}, {"dt": "2002-01-01T00:00:00", "Total TEUs": 408236.45}, {"dt": "2002-02-01T00:00:00", "Total TEUs": 435007.7}, {"dt": "2002-03-01T00:00:00", "Total TEUs": 436565.7}, {"dt": "2002-04-01T00:00:00", "Total TEUs": 484299.25}, {"dt": "2002-05-01T00:00:00", "Total TEUs": 531214.2}, {"dt": "2002-06-01T00:00:00", "Total TEUs": 536461.5}, {"dt": "2002-07-01T00:00:00", "Total TEUs": 495690.45}, {"dt": "2002-08-01T00:00:00", "Total TEUs": 605493.8}, {"dt": "2002-09-01T00:00:00", "Total TEUs": 589242.15}, {"dt": "2002-10-01T00:00:00", "Total TEUs": 470970.6}, {"dt": "2002-11-01T00:00:00", "Total TEUs": 545979.5}, {"dt": "2002-12-01T00:00:00", "Total TEUs": 566701.85}, {"dt": "2003-01-01T00:00:00", "Total TEUs": 518538.4}, {"dt": "2003-02-01T00:00:00", "Total TEUs": 541138.8}, {"dt": "2003-03-01T00:00:00", "Total TEUs": 563571.25}, {"dt": "2003-04-01T00:00:00", "Total TEUs": 589034.8}, {"dt": "2003-05-01T00:00:00", "Total TEUs": 651906.25}, {"dt": "2003-06-01T00:00:00", "Total TEUs": 563786.2}, {"dt": "2003-07-01T00:00:00", "Total TEUs": 615714.3}, {"dt": "2003-08-01T00:00:00", "Total TEUs": 650969.4}, {"dt": "2003-09-01T00:00:00", "Total TEUs": 622729.2}, {"dt": "2003-10-01T00:00:00", "Total TEUs": 671106.85}, {"dt": "2003-11-01T00:00:00", "Total TEUs": 627787.05}, {"dt": "2003-12-01T00:00:00", "Total TEUs": 562657.6}, {"dt": "2004-01-01T00:00:00", "Total TEUs": 616086.95}, {"dt": "2004-02-01T00:00:00", "Total TEUs": 482373.7}, {"dt": "2004-03-01T00:00:00", "Total TEUs": 611616.35}, {"dt": "2004-04-01T00:00:00", "Total TEUs": 616897.05}, {"dt": "2004-05-01T00:00:00", "Total TEUs": 660839.15}, {"dt": "2004-06-01T00:00:00", "Total TEUs": 612080.8}, {"dt": "2004-07-01T00:00:00", "Total TEUs": 676399.45}, {"dt": "2004-08-01T00:00:00", "Total TEUs": 627388.8}, {"dt": "2004-09-01T00:00:00", "Total TEUs": 592780.8}, {"dt": "2004-10-01T00:00:00", "Total TEUs": 642935.9}, {"dt": "2004-11-01T00:00:00", "Total TEUs": 630392.85}, {"dt": "2004-12-01T00:00:00", "Total TEUs": 551648.3}, {"dt": "2005-01-01T00:00:00", "Total TEUs": 590178.4}, {"dt": "2005-02-01T00:00:00", "Total TEUs": 554465.05}, {"dt": "2005-03-01T00:00:00", "Total TEUs": 525019.4}, {"dt": "2005-04-01T00:00:00", "Total TEUs": 636972.75}, {"dt": "2005-05-01T00:00:00", "Total TEUs": 610623.9}, {"dt": "2005-06-01T00:00:00", "Total TEUs": 634048.45}, {"dt": "2005-07-01T00:00:00", "Total TEUs": 648379.65}, {"dt": "2005-08-01T00:00:00", "Total TEUs": 651554.45}, {"dt": "2005-09-01T00:00:00", "Total TEUs": 663495.25}, {"dt": "2005-10-01T00:00:00", "Total TEUs": 707740.1}, {"dt": "2005-11-01T00:00:00", "Total TEUs": 640857.95}, {"dt": "2005-12-01T00:00:00", "Total TEUs": 621289.1}, {"dt": "2006-01-01T00:00:00", "Total TEUs": 620275.35}, {"dt": "2006-02-01T00:00:00", "Total TEUs": 480814.95}, {"dt": "2006-03-01T00:00:00", "Total TEUs": 670949.8}, {"dt": "2006-04-01T00:00:00", "Total TEUs": 673393.6}, {"dt": "2006-05-01T00:00:00", "Total TEUs": 695953.3}, {"dt": "2006-06-01T00:00:00", "Total TEUs": 726871.5}, {"dt": "2006-07-01T00:00:00", "Total TEUs": 761326.35}, {"dt": "2006-08-01T00:00:00", "Total TEUs": 790726.55}, {"dt": "2006-09-01T00:00:00", "Total TEUs": 791604.65}, {"dt": "2006-10-01T00:00:00", "Total TEUs": 800063.85}, {"dt": "2006-11-01T00:00:00", "Total TEUs": 745613.1}, {"dt": "2006-12-01T00:00:00", "Total TEUs": 712260.0}, {"dt": "2007-01-01T00:00:00", "Total TEUs": 691602.0}, {"dt": "2007-02-01T00:00:00", "Total TEUs": 649243.0}, {"dt": "2007-03-01T00:00:00", "Total TEUs": 629939.15}, {"dt": "2007-04-01T00:00:00", "Total TEUs": 679657.25}, {"dt": "2007-05-01T00:00:00", "Total TEUs": 681544.55}, {"dt": "2007-06-01T00:00:00", "Total TEUs": 716170.75}, {"dt": "2007-07-01T00:00:00", "Total TEUs": 716319.4}, {"dt": "2007-08-01T00:00:00", "Total TEUs": 714710.2}, {"dt": "2007-09-01T00:00:00", "Total TEUs": 742563.5}, {"dt": "2007-10-01T00:00:00", "Total TEUs": 735546.25}, {"dt": "2007-11-01T00:00:00", "Total TEUs": 736340.15}, {"dt": "2007-12-01T00:00:00", "Total TEUs": 661402.3}, {"dt": "2008-01-01T00:00:00", "Total TEUs": 652236.2}, {"dt": "2008-02-01T00:00:00", "Total TEUs": 613725.7}, {"dt": "2008-03-01T00:00:00", "Total TEUs": 583923.0}, {"dt": "2008-04-01T00:00:00", "Total TEUs": 605466.35}, {"dt": "2008-05-01T00:00:00", "Total TEUs": 686847.8}, {"dt": "2008-06-01T00:00:00", "Total TEUs": 632280.1}, {"dt": "2008-07-01T00:00:00", "Total TEUs": 698159.3}, {"dt": "2008-08-01T00:00:00", "Total TEUs": 757068.85}, {"dt": "2008-09-01T00:00:00", "Total TEUs": 692889.9}, {"dt": "2008-10-01T00:00:00", "Total TEUs": 706308.25}, {"dt": "2008-11-01T00:00:00", "Total TEUs": 660046.5}, {"dt": "2008-12-01T00:00:00", "Total TEUs": 561033.25}, {"dt": "2009-01-01T00:00:00", "Total TEUs": 587004.2}, {"dt": "2009-02-01T00:00:00", "Total TEUs": 413910.3}, {"dt": "2009-03-01T00:00:00", "Total TEUs": 526487.05}, {"dt": "2009-04-01T00:00:00", "Total TEUs": 532124.15}, {"dt": "2009-05-01T00:00:00", "Total TEUs": 574827.8}, {"dt": "2009-06-01T00:00:00", "Total TEUs": 551679.7}, {"dt": "2009-07-01T00:00:00", "Total TEUs": 576203.25}, {"dt": "2009-08-01T00:00:00", "Total TEUs": 612581.5}, {"dt": "2009-09-01T00:00:00", "Total TEUs": 583557.0}, {"dt": "2009-10-01T00:00:00", "Total TEUs": 647423.7}, {"dt": "2009-11-01T00:00:00", "Total TEUs": 580206.15}, {"dt": "2009-12-01T00:00:00", "Total TEUs": 562989.75}, {"dt": "2010-01-01T00:00:00", "Total TEUs": 572969.15}, {"dt": "2010-02-01T00:00:00", "Total TEUs": 525458.6}, {"dt": "2010-03-01T00:00:00", "Total TEUs": 550249.8}, {"dt": "2010-04-01T00:00:00", "Total TEUs": 595283.7}, {"dt": "2010-05-01T00:00:00", "Total TEUs": 689420.7}, {"dt": "2010-06-01T00:00:00", "Total TEUs": 730317.85}, {"dt": "2010-07-01T00:00:00", "Total TEUs": 730745.6}, {"dt": "2010-08-01T00:00:00", "Total TEUs": 763837.2}, {"dt": "2010-09-01T00:00:00", "Total TEUs": 711613.0}, {"dt": "2010-10-01T00:00:00", "Total TEUs": 682384.5}, {"dt": "2010-11-01T00:00:00", "Total TEUs": 666970.5}, {"dt": "2010-12-01T00:00:00", "Total TEUs": 612651.7}, {"dt": "2011-01-01T00:00:00", "Total TEUs": 660517.8}, {"dt": "2011-02-01T00:00:00", "Total TEUs": 554912.8}, {"dt": "2011-03-01T00:00:00", "Total TEUs": 600796.0}, {"dt": "2011-04-01T00:00:00", "Total TEUs": 617272.5}, {"dt": "2011-05-01T00:00:00", "Total TEUs": 692933.7}, {"dt": "2011-06-01T00:00:00", "Total TEUs": 640794.6}, {"dt": "2011-07-01T00:00:00", "Total TEUs": 688325.55}, {"dt": "2011-08-01T00:00:00", "Total TEUs": 723170.55}, {"dt": "2011-09-01T00:00:00", "Total TEUs": 705623.85}, {"dt": "2011-10-01T00:00:00", "Total TEUs": 712586.2}, {"dt": "2011-11-01T00:00:00", "Total TEUs": 694108.7}, {"dt": "2011-12-01T00:00:00", "Total TEUs": 649468.7}, {"dt": "2012-01-01T00:00:00", "Total TEUs": 698715.1}, {"dt": "2012-02-01T00:00:00", "Total TEUs": 525653.45}, {"dt": "2012-03-01T00:00:00", "Total TEUs": 650452.25}, {"dt": "2012-04-01T00:00:00", "Total TEUs": 707182.2}, {"dt": "2012-05-01T00:00:00", "Total TEUs": 731352.9}, {"dt": "2012-06-01T00:00:00", "Total TEUs": 696847.95}, {"dt": "2012-07-01T00:00:00", "Total TEUs": 726375.25}, {"dt": "2012-08-01T00:00:00", "Total TEUs": 706669.8}, {"dt": "2012-09-01T00:00:00", "Total TEUs": 744923.15}, {"dt": "2012-10-01T00:00:00", "Total TEUs": 718406.35}, {"dt": "2012-11-01T00:00:00", "Total TEUs": 582981.7}, {"dt": "2012-12-01T00:00:00", "Total TEUs": 588154.2}, {"dt": "2013-01-01T00:00:00", "Total TEUs": 669000.3}, {"dt": "2013-02-01T00:00:00", "Total TEUs": 614958.75}, {"dt": "2013-03-01T00:00:00", "Total TEUs": 503168.0}, {"dt": "2013-04-01T00:00:00", "Total TEUs": 640330.2}, {"dt": "2013-05-01T00:00:00", "Total TEUs": 636851.6}, {"dt": "2013-06-01T00:00:00", "Total TEUs": 646650.5}, {"dt": "2013-07-01T00:00:00", "Total TEUs": 715640.25}, {"dt": "2013-08-01T00:00:00", "Total TEUs": 709675.75}, {"dt": "2013-09-01T00:00:00", "Total TEUs": 710892.25}, {"dt": "2013-10-01T00:00:00", "Total TEUs": 684207.1}, {"dt": "2013-11-01T00:00:00", "Total TEUs": 683849.0}, {"dt": "2013-12-01T00:00:00", "Total TEUs": 653358.35}, {"dt": "2014-01-01T00:00:00", "Total TEUs": 685549.85}, {"dt": "2014-02-01T00:00:00", "Total TEUs": 559786.35}, {"dt": "2014-03-01T00:00:00", "Total TEUs": 675274.1}, {"dt": "2014-04-01T00:00:00", "Total TEUs": 706036.8}, {"dt": "2014-05-01T00:00:00", "Total TEUs": 689141.65}, {"dt": "2014-06-01T00:00:00", "Total TEUs": 736438.8}, {"dt": "2014-07-01T00:00:00", "Total TEUs": 717407.0}, {"dt": "2014-08-01T00:00:00", "Total TEUs": 757702.45}, {"dt": "2014-09-01T00:00:00", "Total TEUs": 775132.7}, {"dt": "2014-10-01T00:00:00", "Total TEUs": 715682.9}, {"dt": "2014-11-01T00:00:00", "Total TEUs": 663345.6}, {"dt": "2014-12-01T00:00:00", "Total TEUs": 658567.45}, {"dt": "2015-01-01T00:00:00", "Total TEUs": 529427.2}, {"dt": "2015-02-01T00:00:00", "Total TEUs": 502663.3}, {"dt": "2015-03-01T00:00:00", "Total TEUs": 791863.6}, {"dt": "2015-04-01T00:00:00", "Total TEUs": 662973.25}, {"dt": "2015-05-01T00:00:00", "Total TEUs": 694791.05}, {"dt": "2015-06-01T00:00:00", "Total TEUs": 721802.6}, {"dt": "2015-07-01T00:00:00", "Total TEUs": 699127.95}, {"dt": "2015-08-01T00:00:00", "Total TEUs": 786667.8}, {"dt": "2015-09-01T00:00:00", "Total TEUs": 730306.9}, {"dt": "2015-10-01T00:00:00", "Total TEUs": 704588.9}, {"dt": "2015-11-01T00:00:00", "Total TEUs": 709968.7}, {"dt": "2015-12-01T00:00:00", "Total TEUs": 626276.65}, {"dt": "2016-01-01T00:00:00", "Total TEUs": 704398.45}, {"dt": "2016-02-01T00:00:00", "Total TEUs": 713721.0}, {"dt": "2016-03-01T00:00:00", "Total TEUs": 612863.2}, {"dt": "2016-04-01T00:00:00", "Total TEUs": 656177.05}, {"dt": "2016-05-01T00:00:00", "Total TEUs": 770409.3}, {"dt": "2016-06-01T00:00:00", "Total TEUs": 676006.9}, {"dt": "2016-07-01T00:00:00", "Total TEUs": 687891.8}, {"dt": "2016-08-01T00:00:00", "Total TEUs": 798932.75}, {"dt": "2016-09-01T00:00:00", "Total TEUs": 747707.4}, {"dt": "2016-10-01T00:00:00", "Total TEUs": 814574.5}, {"dt": "2016-11-01T00:00:00", "Total TEUs": 877564.2}, {"dt": "2016-12-01T00:00:00", "Total TEUs": 796536.25}, {"dt": "2017-01-01T00:00:00", "Total TEUs": 826639.55}, {"dt": "2017-02-01T00:00:00", "Total TEUs": 625381.15}, {"dt": "2017-03-01T00:00:00", "Total TEUs": 788523.7}, {"dt": "2017-04-01T00:00:00", "Total TEUs": 714755.05}, {"dt": "2017-05-01T00:00:00", "Total TEUs": 796216.7}, {"dt": "2017-06-01T00:00:00", "Total TEUs": 731032.35}, {"dt": "2017-07-01T00:00:00", "Total TEUs": 796804.0}, {"dt": "2017-08-01T00:00:00", "Total TEUs": 847857.05}, {"dt": "2017-09-01T00:00:00", "Total TEUs": 763784.5}, {"dt": "2017-10-01T00:00:00", "Total TEUs": 748762.2}, {"dt": "2017-11-01T00:00:00", "Total TEUs": 924225.75}, {"dt": "2017-12-01T00:00:00", "Total TEUs": 779210.95}, {"dt": "2018-01-01T00:00:00", "Total TEUs": 808728.5}, {"dt": "2018-02-01T00:00:00", "Total TEUs": 725059.45}, {"dt": "2018-03-01T00:00:00", "Total TEUs": 577865.9}, {"dt": "2018-04-01T00:00:00", "Total TEUs": 705535.95}, {"dt": "2018-05-01T00:00:00", "Total TEUs": 768804.35}, {"dt": "2018-06-01T00:00:00", "Total TEUs": 723141.15}, {"dt": "2018-07-01T00:00:00", "Total TEUs": 833567.85}, {"dt": "2018-08-01T00:00:00", "Total TEUs": 826638.4}, {"dt": "2018-09-01T00:00:00", "Total TEUs": 801264.15}, {"dt": "2018-10-01T00:00:00", "Total TEUs": 952553.75}, {"dt": "2018-11-01T00:00:00", "Total TEUs": 832330.9}, {"dt": "2018-12-01T00:00:00", "Total TEUs": 903258.15}, {"dt": "2019-01-01T00:00:00", "Total TEUs": 852449.5}, {"dt": "2019-02-01T00:00:00", "Total TEUs": 705306.55}, {"dt": "2019-03-01T00:00:00", "Total TEUs": 650977.15}, {"dt": "2019-04-01T00:00:00", "Total TEUs": 736465.95}, {"dt": "2019-05-01T00:00:00", "Total TEUs": 828662.15}, {"dt": "2019-06-01T00:00:00", "Total TEUs": 764777.25}, {"dt": "2019-07-01T00:00:00", "Total TEUs": 912154.15}, {"dt": "2019-08-01T00:00:00", "Total TEUs": 861080.8}, {"dt": "2019-09-01T00:00:00", "Total TEUs": 779902.75}, {"dt": "2019-10-01T00:00:00", "Total TEUs": 770188.5}, {"dt": "2019-11-01T00:00:00", "Total TEUs": 728917.9}, {"dt": "2019-12-01T00:00:00", "Total TEUs": 746749.75}, {"dt": "2020-01-01T00:00:00", "Total TEUs": 806143.75}, {"dt": "2020-02-01T00:00:00", "Total TEUs": 544037.3}, {"dt": "2020-03-01T00:00:00", "Total TEUs": 449568.3}, {"dt": "2020-04-01T00:00:00", "Total TEUs": 688999.0}, {"dt": "2020-05-01T00:00:00", "Total TEUs": 581664.75}, {"dt": "2020-06-01T00:00:00", "Total TEUs": 691475.4}, {"dt": "2020-07-01T00:00:00", "Total TEUs": 856389.15}, {"dt": "2020-08-01T00:00:00", "Total TEUs": 961832.75}, {"dt": "2020-09-01T00:00:00", "Total TEUs": 883624.8}, {"dt": "2020-10-01T00:00:00", "Total TEUs": 980728.55}, {"dt": "2020-11-01T00:00:00", "Total TEUs": 889748.15}, {"dt": "2020-12-01T00:00:00", "Total TEUs": 879186.05}, {"dt": "2021-01-01T00:00:00", "Total TEUs": 835516.2}, {"dt": "2021-02-01T00:00:00", "Total TEUs": 799315.4}, {"dt": "2021-03-01T00:00:00", "Total TEUs": 957599.25}, {"dt": "2021-04-01T00:00:00", "Total TEUs": 946966.35}, {"dt": "2021-05-01T00:00:00", "Total TEUs": 1012047.85}, {"dt": "2021-06-01T00:00:00", "Total TEUs": 876430.35}, {"dt": "2021-07-01T00:00:00", "Total TEUs": 890799.8}, {"dt": "2021-08-01T00:00:00", "Total TEUs": 954377.35}, {"dt": "2021-09-01T00:00:00", "Total TEUs": 903864.6}, {"dt": "2021-10-01T00:00:00", "Total TEUs": 902643.9}, {"dt": "2021-11-01T00:00:00", "Total TEUs": 811459.9}, {"dt": "2021-12-01T00:00:00", "Total TEUs": 786588.75}, {"dt": "2022-01-01T00:00:00", "Total TEUs": 865595.35}, {"dt": "2022-02-01T00:00:00", "Total TEUs": 857764.4}, {"dt": "2022-03-01T00:00:00", "Total TEUs": 958674.05}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Port-of-Long-Beach">Port of Long Beach<a class="anchor-link" href="#Port-of-Long-Beach">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># http://www.polb.com/economics/stats/teus_archive.asp</span>

<span class="n">uaString</span> <span class="o">=</span> <span class="s1">&#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.122 Safari/537.36&#39;</span>

<span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="s2">&quot;https://thehelm.polb.com/stellar_custom_table/table100/&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span> <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="n">uaString</span> <span class="p">})</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>

<span class="n">df_lb_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">()),</span> <span class="n">displayed_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">df_lb_raw</span> <span class="o">=</span> <span class="n">df_lb_raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>

<span class="n">df_lb_raw</span><span class="p">[</span><span class="n">df_lb_raw</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span> <span class="o">=</span> <span class="n">df_lb_raw</span><span class="p">[</span><span class="n">df_lb_raw</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">)</span>

<span class="n">df_lb_raw</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_lb_raw</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%b %Y&#39;</span><span class="p">))</span>

<span class="c1">#df_lb_raw.head(16)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_lb_raw</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Long Beach&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Total Loaded&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[10]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-22db428cac9a4811ad427ef0bbd3a465"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-22db428cac9a4811ad427ef0bbd3a465") {
      outputDiv = document.getElementById("altair-viz-22db428cac9a4811ad427ef0bbd3a465");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector005"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Long Beach Total Loaded Container Volume", "transform": [{"window": [{"op": "lag", "field": "Total Loaded", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Total Loaded'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Total Loaded"}}, "height": 100, "selection": {"selector005": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-365ed0dfaf7b0ec2c7aa90dc34b0e6a5"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-365ed0dfaf7b0ec2c7aa90dc34b0e6a5": [{"dt": "2022-03-01T00:00:00", "Total Loaded": 541465}, {"dt": "2022-02-01T00:00:00", "Total Loaded": 508270}, {"dt": "2022-01-01T00:00:00", "Total Loaded": 512394}, {"dt": "2021-12-01T00:00:00", "Total Loaded": 472605}, {"dt": "2021-11-01T00:00:00", "Total Loaded": 472215}, {"dt": "2021-10-01T00:00:00", "Total Loaded": 507214}, {"dt": "2021-09-01T00:00:00", "Total Loaded": 481016}, {"dt": "2021-08-01T00:00:00", "Total Loaded": 526911}, {"dt": "2021-07-01T00:00:00", "Total Loaded": 492890}, {"dt": "2021-06-01T00:00:00", "Total Loaded": 474048}, {"dt": "2021-05-01T00:00:00", "Total Loaded": 580081}, {"dt": "2021-04-01T00:00:00", "Total Loaded": 491220}, {"dt": "2021-03-01T00:00:00", "Total Loaded": 547882}, {"dt": "2021-02-01T00:00:00", "Total Loaded": 493172}, {"dt": "2021-01-01T00:00:00", "Total Loaded": 480509}, {"dt": "2020-12-01T00:00:00", "Total Loaded": 538446}, {"dt": "2020-11-01T00:00:00", "Total Loaded": 499960}, {"dt": "2020-10-01T00:00:00", "Total Loaded": 517086}, {"dt": "2020-09-01T00:00:00", "Total Loaded": 518173}, {"dt": "2020-08-01T00:00:00", "Total Loaded": 490969}, {"dt": "2020-07-01T00:00:00", "Total Loaded": 515408}, {"dt": "2020-06-01T00:00:00", "Total Loaded": 418252}, {"dt": "2020-05-01T00:00:00", "Total Loaded": 447145}, {"dt": "2020-04-01T00:00:00", "Total Loaded": 356042}, {"dt": "2020-03-01T00:00:00", "Total Loaded": 380012}, {"dt": "2020-02-01T00:00:00", "Total Loaded": 374151}, {"dt": "2020-01-01T00:00:00", "Total Loaded": 418585}, {"dt": "2019-12-01T00:00:00", "Total Loaded": 448626}, {"dt": "2019-11-01T00:00:00", "Total Loaded": 416992}, {"dt": "2019-10-01T00:00:00", "Total Loaded": 468697}, {"dt": "2019-09-01T00:00:00", "Total Loaded": 478134}, {"dt": "2019-08-01T00:00:00", "Total Loaded": 447755}, {"dt": "2019-07-01T00:00:00", "Total Loaded": 425004}, {"dt": "2019-06-01T00:00:00", "Total Loaded": 465450}, {"dt": "2019-05-01T00:00:00", "Total Loaded": 411145}, {"dt": "2019-04-01T00:00:00", "Total Loaded": 441687}, {"dt": "2019-03-01T00:00:00", "Total Loaded": 378475}, {"dt": "2019-02-01T00:00:00", "Total Loaded": 408152}, {"dt": "2019-01-01T00:00:00", "Total Loaded": 441126}, {"dt": "2018-12-01T00:00:00", "Total Loaded": 486427}, {"dt": "2018-11-01T00:00:00", "Total Loaded": 435651}, {"dt": "2018-10-01T00:00:00", "Total Loaded": 483921}, {"dt": "2018-09-01T00:00:00", "Total Loaded": 478862}, {"dt": "2018-08-01T00:00:00", "Total Loaded": 462575}, {"dt": "2018-07-01T00:00:00", "Total Loaded": 467483}, {"dt": "2018-06-01T00:00:00", "Total Loaded": 519263}, {"dt": "2018-05-01T00:00:00", "Total Loaded": 503468}, {"dt": "2018-04-01T00:00:00", "Total Loaded": 454175}, {"dt": "2018-03-01T00:00:00", "Total Loaded": 410243}, {"dt": "2018-02-01T00:00:00", "Total Loaded": 473163}, {"dt": "2018-01-01T00:00:00", "Total Loaded": 445159}, {"dt": "2017-12-01T00:00:00", "Total Loaded": 483170}, {"dt": "2017-11-01T00:00:00", "Total Loaded": 445574}, {"dt": "2017-10-01T00:00:00", "Total Loaded": 465163}, {"dt": "2017-09-01T00:00:00", "Total Loaded": 491634}, {"dt": "2017-08-01T00:00:00", "Total Loaded": 473005}, {"dt": "2017-07-01T00:00:00", "Total Loaded": 504918}, {"dt": "2017-06-01T00:00:00", "Total Loaded": 453632}, {"dt": "2017-05-01T00:00:00", "Total Loaded": 455380}, {"dt": "2017-04-01T00:00:00", "Total Loaded": 404467}, {"dt": "2017-03-01T00:00:00", "Total Loaded": 369969}, {"dt": "2017-02-01T00:00:00", "Total Loaded": 369570}, {"dt": "2017-01-01T00:00:00", "Total Loaded": 417224}, {"dt": "2016-12-01T00:00:00", "Total Loaded": 394532}, {"dt": "2016-11-01T00:00:00", "Total Loaded": 391507}, {"dt": "2016-10-01T00:00:00", "Total Loaded": 423481}, {"dt": "2016-09-01T00:00:00", "Total Loaded": 403328}, {"dt": "2016-08-01T00:00:00", "Total Loaded": 480872}, {"dt": "2016-07-01T00:00:00", "Total Loaded": 468420}, {"dt": "2016-06-01T00:00:00", "Total Loaded": 441625}, {"dt": "2016-05-01T00:00:00", "Total Loaded": 469233}, {"dt": "2016-04-01T00:00:00", "Total Loaded": 360121}, {"dt": "2016-03-01T00:00:00", "Total Loaded": 334845}, {"dt": "2016-02-01T00:00:00", "Total Loaded": 418880}, {"dt": "2016-01-01T00:00:00", "Total Loaded": 385230}, {"dt": "2015-12-01T00:00:00", "Total Loaded": 422120}, {"dt": "2015-11-01T00:00:00", "Total Loaded": 431371}, {"dt": "2015-10-01T00:00:00", "Total Loaded": 436303}, {"dt": "2015-09-01T00:00:00", "Total Loaded": 458548}, {"dt": "2015-08-01T00:00:00", "Total Loaded": 497027}, {"dt": "2015-07-01T00:00:00", "Total Loaded": 489787}, {"dt": "2015-06-01T00:00:00", "Total Loaded": 425412}, {"dt": "2015-05-01T00:00:00", "Total Loaded": 463172}, {"dt": "2015-04-01T00:00:00", "Total Loaded": 454922}, {"dt": "2015-03-01T00:00:00", "Total Loaded": 444857}, {"dt": "2015-02-01T00:00:00", "Total Loaded": 315173}, {"dt": "2015-01-01T00:00:00", "Total Loaded": 312129}, {"dt": "2014-12-01T00:00:00", "Total Loaded": 408012}, {"dt": "2014-11-01T00:00:00", "Total Loaded": 423944}, {"dt": "2014-10-01T00:00:00", "Total Loaded": 430927}, {"dt": "2014-09-01T00:00:00", "Total Loaded": 457755}, {"dt": "2014-08-01T00:00:00", "Total Loaded": 427707}, {"dt": "2014-07-01T00:00:00", "Total Loaded": 421741}, {"dt": "2014-06-01T00:00:00", "Total Loaded": 456088}, {"dt": "2014-05-01T00:00:00", "Total Loaded": 459141}, {"dt": "2014-04-01T00:00:00", "Total Loaded": 442210}, {"dt": "2014-03-01T00:00:00", "Total Loaded": 377315}, {"dt": "2014-02-01T00:00:00", "Total Loaded": 415243}, {"dt": "2014-01-01T00:00:00", "Total Loaded": 401826}, {"dt": "2013-12-01T00:00:00", "Total Loaded": 439584}, {"dt": "2013-11-01T00:00:00", "Total Loaded": 448588}, {"dt": "2013-10-01T00:00:00", "Total Loaded": 439728}, {"dt": "2013-09-01T00:00:00", "Total Loaded": 442657}, {"dt": "2013-08-01T00:00:00", "Total Loaded": 481935}, {"dt": "2013-07-01T00:00:00", "Total Loaded": 427216}, {"dt": "2013-06-01T00:00:00", "Total Loaded": 424248}, {"dt": "2013-05-01T00:00:00", "Total Loaded": 452571}, {"dt": "2013-04-01T00:00:00", "Total Loaded": 402201}, {"dt": "2013-03-01T00:00:00", "Total Loaded": 381125}, {"dt": "2013-02-01T00:00:00", "Total Loaded": 419770}, {"dt": "2013-01-01T00:00:00", "Total Loaded": 400632}, {"dt": "2012-12-01T00:00:00", "Total Loaded": 431140}, {"dt": "2012-11-01T00:00:00", "Total Loaded": 416846}, {"dt": "2012-10-01T00:00:00", "Total Loaded": 410201}, {"dt": "2012-09-01T00:00:00", "Total Loaded": 380004}, {"dt": "2012-08-01T00:00:00", "Total Loaded": 403202}, {"dt": "2012-07-01T00:00:00", "Total Loaded": 385807}, {"dt": "2012-06-01T00:00:00", "Total Loaded": 414175}, {"dt": "2012-05-01T00:00:00", "Total Loaded": 379020}, {"dt": "2012-04-01T00:00:00", "Total Loaded": 353415}, {"dt": "2012-03-01T00:00:00", "Total Loaded": 370979}, {"dt": "2012-02-01T00:00:00", "Total Loaded": 311481}, {"dt": "2012-01-01T00:00:00", "Total Loaded": 346208}, {"dt": "2011-12-01T00:00:00", "Total Loaded": 377838}, {"dt": "2011-11-01T00:00:00", "Total Loaded": 342760}, {"dt": "2011-10-01T00:00:00", "Total Loaded": 358573}, {"dt": "2011-09-01T00:00:00", "Total Loaded": 381428}, {"dt": "2011-08-01T00:00:00", "Total Loaded": 388475}, {"dt": "2011-07-01T00:00:00", "Total Loaded": 417282}, {"dt": "2011-06-01T00:00:00", "Total Loaded": 397701}, {"dt": "2011-05-01T00:00:00", "Total Loaded": 405261}, {"dt": "2011-04-01T00:00:00", "Total Loaded": 413790}, {"dt": "2011-03-01T00:00:00", "Total Loaded": 322972}, {"dt": "2011-02-01T00:00:00", "Total Loaded": 355589}, {"dt": "2011-01-01T00:00:00", "Total Loaded": 369991}, {"dt": "2010-12-01T00:00:00", "Total Loaded": 398029}, {"dt": "2010-11-01T00:00:00", "Total Loaded": 417108}, {"dt": "2010-10-01T00:00:00", "Total Loaded": 453749}, {"dt": "2010-09-01T00:00:00", "Total Loaded": 412926}, {"dt": "2010-08-01T00:00:00", "Total Loaded": 437279}, {"dt": "2010-07-01T00:00:00", "Total Loaded": 420055}, {"dt": "2010-06-01T00:00:00", "Total Loaded": 378165}, {"dt": "2010-05-01T00:00:00", "Total Loaded": 403164}, {"dt": "2010-04-01T00:00:00", "Total Loaded": 371400}, {"dt": "2010-03-01T00:00:00", "Total Loaded": 337147}, {"dt": "2010-02-01T00:00:00", "Total Loaded": 331128}, {"dt": "2010-01-01T00:00:00", "Total Loaded": 331108}, {"dt": "2009-12-01T00:00:00", "Total Loaded": 355670}, {"dt": "2009-11-01T00:00:00", "Total Loaded": 342630}, {"dt": "2009-10-01T00:00:00", "Total Loaded": 346258}, {"dt": "2009-09-01T00:00:00", "Total Loaded": 334261}, {"dt": "2009-08-01T00:00:00", "Total Loaded": 380543}, {"dt": "2009-07-01T00:00:00", "Total Loaded": 330139}, {"dt": "2009-06-01T00:00:00", "Total Loaded": 320465}, {"dt": "2009-05-01T00:00:00", "Total Loaded": 329655}, {"dt": "2009-04-01T00:00:00", "Total Loaded": 312027}, {"dt": "2009-03-01T00:00:00", "Total Loaded": 304124}, {"dt": "2009-02-01T00:00:00", "Total Loaded": 242080}, {"dt": "2009-01-01T00:00:00", "Total Loaded": 289098}, {"dt": "2008-12-01T00:00:00", "Total Loaded": 299040}, {"dt": "2008-11-01T00:00:00", "Total Loaded": 377690}, {"dt": "2008-10-01T00:00:00", "Total Loaded": 424977}, {"dt": "2008-09-01T00:00:00", "Total Loaded": 408767}, {"dt": "2008-08-01T00:00:00", "Total Loaded": 436641}, {"dt": "2008-07-01T00:00:00", "Total Loaded": 425714}, {"dt": "2008-06-01T00:00:00", "Total Loaded": 448519}, {"dt": "2008-05-01T00:00:00", "Total Loaded": 426179}, {"dt": "2008-04-01T00:00:00", "Total Loaded": 444130}, {"dt": "2008-03-01T00:00:00", "Total Loaded": 391007}, {"dt": "2008-02-01T00:00:00", "Total Loaded": 410506}, {"dt": "2008-01-01T00:00:00", "Total Loaded": 383244}, {"dt": "2007-12-01T00:00:00", "Total Loaded": 423422}, {"dt": "2007-11-01T00:00:00", "Total Loaded": 453916}, {"dt": "2007-10-01T00:00:00", "Total Loaded": 467970}, {"dt": "2007-09-01T00:00:00", "Total Loaded": 466349}, {"dt": "2007-08-01T00:00:00", "Total Loaded": 468056}, {"dt": "2007-07-01T00:00:00", "Total Loaded": 467491}, {"dt": "2007-06-01T00:00:00", "Total Loaded": 480378}, {"dt": "2007-05-01T00:00:00", "Total Loaded": 443727}, {"dt": "2007-04-01T00:00:00", "Total Loaded": 424329}, {"dt": "2007-03-01T00:00:00", "Total Loaded": 378527}, {"dt": "2007-02-01T00:00:00", "Total Loaded": 393015}, {"dt": "2007-01-01T00:00:00", "Total Loaded": 411654}, {"dt": "2006-12-01T00:00:00", "Total Loaded": 394564}, {"dt": "2006-11-01T00:00:00", "Total Loaded": 440544}, {"dt": "2006-10-01T00:00:00", "Total Loaded": 445006}, {"dt": "2006-09-01T00:00:00", "Total Loaded": 416321}, {"dt": "2006-08-01T00:00:00", "Total Loaded": 453085}, {"dt": "2006-07-01T00:00:00", "Total Loaded": 405978}, {"dt": "2006-06-01T00:00:00", "Total Loaded": 421565}, {"dt": "2006-05-01T00:00:00", "Total Loaded": 443472}, {"dt": "2006-04-01T00:00:00", "Total Loaded": 432799}, {"dt": "2006-03-01T00:00:00", "Total Loaded": 401168}, {"dt": "2006-02-01T00:00:00", "Total Loaded": 362426}, {"dt": "2006-01-01T00:00:00", "Total Loaded": 393595}, {"dt": "2005-12-01T00:00:00", "Total Loaded": 370542}, {"dt": "2005-11-01T00:00:00", "Total Loaded": 412212}, {"dt": "2005-10-01T00:00:00", "Total Loaded": 402625}, {"dt": "2005-09-01T00:00:00", "Total Loaded": 410469}, {"dt": "2005-08-01T00:00:00", "Total Loaded": 416874}, {"dt": "2005-07-01T00:00:00", "Total Loaded": 396435}, {"dt": "2005-06-01T00:00:00", "Total Loaded": 395633}, {"dt": "2005-05-01T00:00:00", "Total Loaded": 394065}, {"dt": "2005-04-01T00:00:00", "Total Loaded": 378529}, {"dt": "2005-03-01T00:00:00", "Total Loaded": 314612}, {"dt": "2005-02-01T00:00:00", "Total Loaded": 341112}, {"dt": "2005-01-01T00:00:00", "Total Loaded": 334365}, {"dt": "2004-12-01T00:00:00", "Total Loaded": 362872}, {"dt": "2004-11-01T00:00:00", "Total Loaded": 395153}, {"dt": "2004-10-01T00:00:00", "Total Loaded": 374414}, {"dt": "2004-09-01T00:00:00", "Total Loaded": 331782}, {"dt": "2004-08-01T00:00:00", "Total Loaded": 354253}, {"dt": "2004-07-01T00:00:00", "Total Loaded": 364258}, {"dt": "2004-06-01T00:00:00", "Total Loaded": 342970}, {"dt": "2004-05-01T00:00:00", "Total Loaded": 327412}, {"dt": "2004-04-01T00:00:00", "Total Loaded": 306871}, {"dt": "2004-03-01T00:00:00", "Total Loaded": 330323}, {"dt": "2004-02-01T00:00:00", "Total Loaded": 230958}, {"dt": "2004-01-01T00:00:00", "Total Loaded": 274627}, {"dt": "2003-12-01T00:00:00", "Total Loaded": 294035}, {"dt": "2003-11-01T00:00:00", "Total Loaded": 298828}, {"dt": "2003-10-01T00:00:00", "Total Loaded": 315479}, {"dt": "2003-09-01T00:00:00", "Total Loaded": 272241}, {"dt": "2003-08-01T00:00:00", "Total Loaded": 282248}, {"dt": "2003-07-01T00:00:00", "Total Loaded": 312090}, {"dt": "2003-06-01T00:00:00", "Total Loaded": 275336}, {"dt": "2003-05-01T00:00:00", "Total Loaded": 273171}, {"dt": "2003-04-01T00:00:00", "Total Loaded": 275771}, {"dt": "2003-03-01T00:00:00", "Total Loaded": 262597}, {"dt": "2003-02-01T00:00:00", "Total Loaded": 226508}, {"dt": "2003-01-01T00:00:00", "Total Loaded": 225812}, {"dt": "2002-12-01T00:00:00", "Total Loaded": 250505}, {"dt": "2002-11-01T00:00:00", "Total Loaded": 244409}, {"dt": "2002-10-01T00:00:00", "Total Loaded": 204384}, {"dt": "2002-09-01T00:00:00", "Total Loaded": 242798}, {"dt": "2002-08-01T00:00:00", "Total Loaded": 305678}, {"dt": "2002-07-01T00:00:00", "Total Loaded": 320118}, {"dt": "2002-06-01T00:00:00", "Total Loaded": 311926}, {"dt": "2002-05-01T00:00:00", "Total Loaded": 315444}, {"dt": "2002-04-01T00:00:00", "Total Loaded": 315913}, {"dt": "2002-03-01T00:00:00", "Total Loaded": 259719}, {"dt": "2002-02-01T00:00:00", "Total Loaded": 285609}, {"dt": "2002-01-01T00:00:00", "Total Loaded": 251472}, {"dt": "2001-12-01T00:00:00", "Total Loaded": 275244}, {"dt": "2001-11-01T00:00:00", "Total Loaded": 269740}, {"dt": "2001-10-01T00:00:00", "Total Loaded": 320440}, {"dt": "2001-09-01T00:00:00", "Total Loaded": 296928}, {"dt": "2001-08-01T00:00:00", "Total Loaded": 304793}, {"dt": "2001-07-01T00:00:00", "Total Loaded": 286135}, {"dt": "2001-06-01T00:00:00", "Total Loaded": 281383}, {"dt": "2001-05-01T00:00:00", "Total Loaded": 277228}, {"dt": "2001-04-01T00:00:00", "Total Loaded": 279199}, {"dt": "2001-03-01T00:00:00", "Total Loaded": 279954}, {"dt": "2001-02-01T00:00:00", "Total Loaded": 230668}, {"dt": "2001-01-01T00:00:00", "Total Loaded": 271811}, {"dt": "2000-12-01T00:00:00", "Total Loaded": 259982}, {"dt": "2000-11-01T00:00:00", "Total Loaded": 303821}, {"dt": "2000-10-01T00:00:00", "Total Loaded": 324052}, {"dt": "2000-09-01T00:00:00", "Total Loaded": 289755}, {"dt": "2000-08-01T00:00:00", "Total Loaded": 322981}, {"dt": "2000-07-01T00:00:00", "Total Loaded": 311739}, {"dt": "2000-06-01T00:00:00", "Total Loaded": 286309}, {"dt": "2000-05-01T00:00:00", "Total Loaded": 315786}, {"dt": "2000-04-01T00:00:00", "Total Loaded": 291738}, {"dt": "2000-03-01T00:00:00", "Total Loaded": 276360}, {"dt": "2000-02-01T00:00:00", "Total Loaded": 259255}, {"dt": "2000-01-01T00:00:00", "Total Loaded": 258763}, {"dt": "1999-12-01T00:00:00", "Total Loaded": 272269}, {"dt": "1999-11-01T00:00:00", "Total Loaded": 300645}, {"dt": "1999-10-01T00:00:00", "Total Loaded": 288591}, {"dt": "1999-09-01T00:00:00", "Total Loaded": 301388}, {"dt": "1999-08-01T00:00:00", "Total Loaded": 295290}, {"dt": "1999-07-01T00:00:00", "Total Loaded": 262741}, {"dt": "1999-06-01T00:00:00", "Total Loaded": 273372}, {"dt": "1999-05-01T00:00:00", "Total Loaded": 293193}, {"dt": "1999-04-01T00:00:00", "Total Loaded": 258615}, {"dt": "1999-03-01T00:00:00", "Total Loaded": 260612}, {"dt": "1999-02-01T00:00:00", "Total Loaded": 252482}, {"dt": "1999-01-01T00:00:00", "Total Loaded": 247073}, {"dt": "1998-12-01T00:00:00", "Total Loaded": 254059}, {"dt": "1998-11-01T00:00:00", "Total Loaded": 276952}, {"dt": "1998-10-01T00:00:00", "Total Loaded": 257890}, {"dt": "1998-09-01T00:00:00", "Total Loaded": 272729}, {"dt": "1998-08-01T00:00:00", "Total Loaded": 272829}, {"dt": "1998-07-01T00:00:00", "Total Loaded": 280088}, {"dt": "1998-06-01T00:00:00", "Total Loaded": 265634}, {"dt": "1998-05-01T00:00:00", "Total Loaded": 248021}, {"dt": "1998-04-01T00:00:00", "Total Loaded": 259518}, {"dt": "1998-03-01T00:00:00", "Total Loaded": 256230}, {"dt": "1998-02-01T00:00:00", "Total Loaded": 209420}, {"dt": "1998-01-01T00:00:00", "Total Loaded": 217178}, {"dt": "1997-12-01T00:00:00", "Total Loaded": 236978}, {"dt": "1997-11-01T00:00:00", "Total Loaded": 242922}, {"dt": "1997-10-01T00:00:00", "Total Loaded": 257096}, {"dt": "1997-09-01T00:00:00", "Total Loaded": 274675}, {"dt": "1997-08-01T00:00:00", "Total Loaded": 247733}, {"dt": "1997-07-01T00:00:00", "Total Loaded": 266208}, {"dt": "1997-06-01T00:00:00", "Total Loaded": 266025}, {"dt": "1997-05-01T00:00:00", "Total Loaded": 235064}, {"dt": "1997-04-01T00:00:00", "Total Loaded": 239003}, {"dt": "1997-03-01T00:00:00", "Total Loaded": 231596}, {"dt": "1997-02-01T00:00:00", "Total Loaded": 214390}, {"dt": "1997-01-01T00:00:00", "Total Loaded": 202421}, {"dt": "1996-12-01T00:00:00", "Total Loaded": 233644}, {"dt": "1996-11-01T00:00:00", "Total Loaded": 212309}, {"dt": "1996-10-01T00:00:00", "Total Loaded": 240472}, {"dt": "1996-09-01T00:00:00", "Total Loaded": 229528}, {"dt": "1996-08-01T00:00:00", "Total Loaded": 222519}, {"dt": "1996-07-01T00:00:00", "Total Loaded": 229985}, {"dt": "1996-06-01T00:00:00", "Total Loaded": 222308}, {"dt": "1996-05-01T00:00:00", "Total Loaded": 207244}, {"dt": "1996-04-01T00:00:00", "Total Loaded": 228365}, {"dt": "1996-03-01T00:00:00", "Total Loaded": 202720}, {"dt": "1996-02-01T00:00:00", "Total Loaded": 203582}, {"dt": "1996-01-01T00:00:00", "Total Loaded": 196789}, {"dt": "1995-12-01T00:00:00", "Total Loaded": 196939}, {"dt": "1995-11-01T00:00:00", "Total Loaded": 199099}, {"dt": "1995-10-01T00:00:00", "Total Loaded": 227605}, {"dt": "1995-09-01T00:00:00", "Total Loaded": 196010}, {"dt": "1995-08-01T00:00:00", "Total Loaded": 217298}, {"dt": "1995-07-01T00:00:00", "Total Loaded": 215181}, {"dt": "1995-06-01T00:00:00", "Total Loaded": 197236}, {"dt": "1995-05-01T00:00:00", "Total Loaded": 204914}, {"dt": "1995-04-01T00:00:00", "Total Loaded": 197397}, {"dt": "1995-03-01T00:00:00", "Total Loaded": 178089}, {"dt": "1995-02-01T00:00:00", "Total Loaded": 181000}, {"dt": "1995-01-01T00:00:00", "Total Loaded": 178865}, {"dt": "1994-12-01T00:00:00", "Total Loaded": 184582}, {"dt": "1994-11-01T00:00:00", "Total Loaded": 187369}, {"dt": "1994-10-01T00:00:00", "Total Loaded": 204707}, {"dt": "1994-09-01T00:00:00", "Total Loaded": 171313}, {"dt": "1994-08-01T00:00:00", "Total Loaded": 194933}, {"dt": "1994-07-01T00:00:00", "Total Loaded": 193591}, {"dt": "1994-06-01T00:00:00", "Total Loaded": 178545}, {"dt": "1994-05-01T00:00:00", "Total Loaded": 186783}, {"dt": "1994-04-01T00:00:00", "Total Loaded": 147596}, {"dt": "1994-03-01T00:00:00", "Total Loaded": 158278}, {"dt": "1994-02-01T00:00:00", "Total Loaded": 153816}, {"dt": "1994-01-01T00:00:00", "Total Loaded": 147438}, {"dt": "1993-12-01T00:00:00", "Total Loaded": 146761}, {"dt": "1993-11-01T00:00:00", "Total Loaded": 152383}, {"dt": "1993-10-01T00:00:00", "Total Loaded": 158142}, {"dt": "1993-09-01T00:00:00", "Total Loaded": 153511}, {"dt": "1993-08-01T00:00:00", "Total Loaded": 170409}, {"dt": "1993-07-01T00:00:00", "Total Loaded": 140693}, {"dt": "1993-06-01T00:00:00", "Total Loaded": 140485}, {"dt": "1993-05-01T00:00:00", "Total Loaded": 137084}, {"dt": "1993-04-01T00:00:00", "Total Loaded": 118783}, {"dt": "1993-03-01T00:00:00", "Total Loaded": 139071}, {"dt": "1993-02-01T00:00:00", "Total Loaded": 100215}, {"dt": "1993-01-01T00:00:00", "Total Loaded": 106945}, {"dt": "1992-12-01T00:00:00", "Total Loaded": 124636}, {"dt": "1992-11-01T00:00:00", "Total Loaded": 121605}, {"dt": "1992-10-01T00:00:00", "Total Loaded": 128193}, {"dt": "1992-09-01T00:00:00", "Total Loaded": 127573}, {"dt": "1992-08-01T00:00:00", "Total Loaded": 122548}, {"dt": "1992-07-01T00:00:00", "Total Loaded": 124510}, {"dt": "1992-06-01T00:00:00", "Total Loaded": 131227}, {"dt": "1992-05-01T00:00:00", "Total Loaded": 117198}, {"dt": "1992-04-01T00:00:00", "Total Loaded": 117882}, {"dt": "1992-03-01T00:00:00", "Total Loaded": 129825}, {"dt": "1992-02-01T00:00:00", "Total Loaded": 112390}, {"dt": "1992-01-01T00:00:00", "Total Loaded": 119628}, {"dt": "1991-12-01T00:00:00", "Total Loaded": 115948}, {"dt": "1991-11-01T00:00:00", "Total Loaded": 124241}, {"dt": "1991-10-01T00:00:00", "Total Loaded": 151747}, {"dt": "1991-09-01T00:00:00", "Total Loaded": 122632}, {"dt": "1991-08-01T00:00:00", "Total Loaded": 117854}, {"dt": "1991-07-01T00:00:00", "Total Loaded": 139432}, {"dt": "1991-06-01T00:00:00", "Total Loaded": 122019}, {"dt": "1991-05-01T00:00:00", "Total Loaded": 142495}, {"dt": "1991-04-01T00:00:00", "Total Loaded": 122260}, {"dt": "1991-03-01T00:00:00", "Total Loaded": 101569}, {"dt": "1991-02-01T00:00:00", "Total Loaded": 102328}, {"dt": "1991-01-01T00:00:00", "Total Loaded": 106920}, {"dt": "1990-12-01T00:00:00", "Total Loaded": 99151}, {"dt": "1990-11-01T00:00:00", "Total Loaded": 102542}, {"dt": "1990-10-01T00:00:00", "Total Loaded": 123397}, {"dt": "1990-09-01T00:00:00", "Total Loaded": 103427}, {"dt": "1990-08-01T00:00:00", "Total Loaded": 113816}, {"dt": "1990-07-01T00:00:00", "Total Loaded": 115435}, {"dt": "1990-06-01T00:00:00", "Total Loaded": 102243}, {"dt": "1990-05-01T00:00:00", "Total Loaded": 120054}, {"dt": "1990-04-01T00:00:00", "Total Loaded": 112029}, {"dt": "1990-03-01T00:00:00", "Total Loaded": 109410}, {"dt": "1990-02-01T00:00:00", "Total Loaded": 98368}, {"dt": "1990-01-01T00:00:00", "Total Loaded": 113095}, {"dt": "1989-12-01T00:00:00", "Total Loaded": 100122}, {"dt": "1989-11-01T00:00:00", "Total Loaded": 120971}, {"dt": "1989-10-01T00:00:00", "Total Loaded": 114259}, {"dt": "1989-09-01T00:00:00", "Total Loaded": 96627}, {"dt": "1989-08-01T00:00:00", "Total Loaded": 123811}, {"dt": "1989-07-01T00:00:00", "Total Loaded": 103458}, {"dt": "1989-06-01T00:00:00", "Total Loaded": 101131}, {"dt": "1989-05-01T00:00:00", "Total Loaded": 114348}, {"dt": "1989-04-01T00:00:00", "Total Loaded": 91559}, {"dt": "1989-03-01T00:00:00", "Total Loaded": 97865}, {"dt": "1989-02-01T00:00:00", "Total Loaded": 92843}, {"dt": "1989-01-01T00:00:00", "Total Loaded": 98476}, {"dt": "1988-12-01T00:00:00", "Total Loaded": 99591}, {"dt": "1988-11-01T00:00:00", "Total Loaded": 115322}, {"dt": "1988-10-01T00:00:00", "Total Loaded": 99843}, {"dt": "1988-09-01T00:00:00", "Total Loaded": 99649}, {"dt": "1988-08-01T00:00:00", "Total Loaded": 119705}, {"dt": "1988-07-01T00:00:00", "Total Loaded": 104374}, {"dt": "1988-06-01T00:00:00", "Total Loaded": 108727}, {"dt": "1988-05-01T00:00:00", "Total Loaded": 103104}, {"dt": "1988-04-01T00:00:00", "Total Loaded": 91467}, {"dt": "1988-03-01T00:00:00", "Total Loaded": 105371}, {"dt": "1988-02-01T00:00:00", "Total Loaded": 91220}, {"dt": "1988-01-01T00:00:00", "Total Loaded": 97786}, {"dt": "1987-12-01T00:00:00", "Total Loaded": 88857}, {"dt": "1987-11-01T00:00:00", "Total Loaded": 98333}, {"dt": "1987-10-01T00:00:00", "Total Loaded": 96138}, {"dt": "1987-09-01T00:00:00", "Total Loaded": 99267}, {"dt": "1987-08-01T00:00:00", "Total Loaded": 96477}, {"dt": "1987-07-01T00:00:00", "Total Loaded": 95346}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_lb_raw</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Long Beach&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Total&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[11]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-ed0980f81be3457dbf48657b70c69433"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-ed0980f81be3457dbf48657b70c69433") {
      outputDiv = document.getElementById("altair-viz-ed0980f81be3457dbf48657b70c69433");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector006"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Long Beach Total Container Volume", "transform": [{"window": [{"op": "lag", "field": "Total", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Total'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Total"}}, "height": 100, "selection": {"selector006": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-f95c6d162e83ae16067a59922698871d"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-f95c6d162e83ae16067a59922698871d": [{"dt": "2022-03-01T00:00:00", "Total": 863156}, {"dt": "2022-02-01T00:00:00", "Total": 796560}, {"dt": "2022-01-01T00:00:00", "Total": 800943}, {"dt": "2021-12-01T00:00:00", "Total": 754314}, {"dt": "2021-11-01T00:00:00", "Total": 745488}, {"dt": "2021-10-01T00:00:00", "Total": 789716}, {"dt": "2021-09-01T00:00:00", "Total": 748472}, {"dt": "2021-08-01T00:00:00", "Total": 807704}, {"dt": "2021-07-01T00:00:00", "Total": 784845}, {"dt": "2021-06-01T00:00:00", "Total": 724297}, {"dt": "2021-05-01T00:00:00", "Total": 907216}, {"dt": "2021-04-01T00:00:00", "Total": 746188}, {"dt": "2021-03-01T00:00:00", "Total": 840387}, {"dt": "2021-02-01T00:00:00", "Total": 771735}, {"dt": "2021-01-01T00:00:00", "Total": 764006}, {"dt": "2020-12-01T00:00:00", "Total": 815885}, {"dt": "2020-11-01T00:00:00", "Total": 783523}, {"dt": "2020-10-01T00:00:00", "Total": 806603}, {"dt": "2020-09-01T00:00:00", "Total": 795580}, {"dt": "2020-08-01T00:00:00", "Total": 725610}, {"dt": "2020-07-01T00:00:00", "Total": 753081}, {"dt": "2020-06-01T00:00:00", "Total": 602180}, {"dt": "2020-05-01T00:00:00", "Total": 628205}, {"dt": "2020-04-01T00:00:00", "Total": 519730}, {"dt": "2020-03-01T00:00:00", "Total": 517664}, {"dt": "2020-02-01T00:00:00", "Total": 538428}, {"dt": "2020-01-01T00:00:00", "Total": 626829}, {"dt": "2019-12-01T00:00:00", "Total": 665262}, {"dt": "2019-11-01T00:00:00", "Total": 599984}, {"dt": "2019-10-01T00:00:00", "Total": 688425}, {"dt": "2019-09-01T00:00:00", "Total": 706955}, {"dt": "2019-08-01T00:00:00", "Total": 663993}, {"dt": "2019-07-01T00:00:00", "Total": 621781}, {"dt": "2019-06-01T00:00:00", "Total": 677168}, {"dt": "2019-05-01T00:00:00", "Total": 573624}, {"dt": "2019-04-01T00:00:00", "Total": 628122}, {"dt": "2019-03-01T00:00:00", "Total": 552821}, {"dt": "2019-02-01T00:00:00", "Total": 596617}, {"dt": "2019-01-01T00:00:00", "Total": 657286}, {"dt": "2018-12-01T00:00:00", "Total": 741647}, {"dt": "2018-11-01T00:00:00", "Total": 621834}, {"dt": "2018-10-01T00:00:00", "Total": 705408}, {"dt": "2018-09-01T00:00:00", "Total": 701205}, {"dt": "2018-08-01T00:00:00", "Total": 679543}, {"dt": "2018-07-01T00:00:00", "Total": 688458}, {"dt": "2018-06-01T00:00:00", "Total": 752189}, {"dt": "2018-05-01T00:00:00", "Total": 687427}, {"dt": "2018-04-01T00:00:00", "Total": 618439}, {"dt": "2018-03-01T00:00:00", "Total": 575258}, {"dt": "2018-02-01T00:00:00", "Total": 661791}, {"dt": "2018-01-01T00:00:00", "Total": 657830}, {"dt": "2017-12-01T00:00:00", "Total": 696919}, {"dt": "2017-11-01T00:00:00", "Total": 612659}, {"dt": "2017-10-01T00:00:00", "Total": 669218}, {"dt": "2017-09-01T00:00:00", "Total": 701619}, {"dt": "2017-08-01T00:00:00", "Total": 692375}, {"dt": "2017-07-01T00:00:00", "Total": 720312}, {"dt": "2017-06-01T00:00:00", "Total": 658727}, {"dt": "2017-05-01T00:00:00", "Total": 648288}, {"dt": "2017-04-01T00:00:00", "Total": 558014}, {"dt": "2017-03-01T00:00:00", "Total": 505382}, {"dt": "2017-02-01T00:00:00", "Total": 498312}, {"dt": "2017-01-01T00:00:00", "Total": 582689}, {"dt": "2016-12-01T00:00:00", "Total": 548929}, {"dt": "2016-11-01T00:00:00", "Total": 534308}, {"dt": "2016-10-01T00:00:00", "Total": 581808}, {"dt": "2016-09-01T00:00:00", "Total": 546804}, {"dt": "2016-08-01T00:00:00", "Total": 641029}, {"dt": "2016-07-01T00:00:00", "Total": 637091}, {"dt": "2016-06-01T00:00:00", "Total": 603339}, {"dt": "2016-05-01T00:00:00", "Total": 640566}, {"dt": "2016-04-01T00:00:00", "Total": 478842}, {"dt": "2016-03-01T00:00:00", "Total": 464855}, {"dt": "2016-02-01T00:00:00", "Total": 561412}, {"dt": "2016-01-01T00:00:00", "Total": 536188}, {"dt": "2015-12-01T00:00:00", "Total": 596448}, {"dt": "2015-11-01T00:00:00", "Total": 619699}, {"dt": "2015-10-01T00:00:00", "Total": 619984}, {"dt": "2015-09-01T00:00:00", "Total": 655624}, {"dt": "2015-08-01T00:00:00", "Total": 703652}, {"dt": "2015-07-01T00:00:00", "Total": 690244}, {"dt": "2015-06-01T00:00:00", "Total": 583621}, {"dt": "2015-05-01T00:00:00", "Total": 635250}, {"dt": "2015-04-01T00:00:00", "Total": 614860}, {"dt": "2015-03-01T00:00:00", "Total": 630084}, {"dt": "2015-02-01T00:00:00", "Total": 413114}, {"dt": "2015-01-01T00:00:00", "Total": 429490}, {"dt": "2014-12-01T00:00:00", "Total": 567237}, {"dt": "2014-11-01T00:00:00", "Total": 581514}, {"dt": "2014-10-01T00:00:00", "Total": 583009}, {"dt": "2014-09-01T00:00:00", "Total": 629771}, {"dt": "2014-08-01T00:00:00", "Total": 573083}, {"dt": "2014-07-01T00:00:00", "Total": 583060}, {"dt": "2014-06-01T00:00:00", "Total": 610516}, {"dt": "2014-05-01T00:00:00", "Total": 599509}, {"dt": "2014-04-01T00:00:00", "Total": 569843}, {"dt": "2014-03-01T00:00:00", "Total": 477209}, {"dt": "2014-02-01T00:00:00", "Total": 517173}, {"dt": "2014-01-01T00:00:00", "Total": 528884}, {"dt": "2013-12-01T00:00:00", "Total": 582443}, {"dt": "2013-11-01T00:00:00", "Total": 569599}, {"dt": "2013-10-01T00:00:00", "Total": 576502}, {"dt": "2013-09-01T00:00:00", "Total": 587114}, {"dt": "2013-08-01T00:00:00", "Total": 630292}, {"dt": "2013-07-01T00:00:00", "Total": 562166}, {"dt": "2013-06-01T00:00:00", "Total": 565476}, {"dt": "2013-05-01T00:00:00", "Total": 583588}, {"dt": "2013-04-01T00:00:00", "Total": 519464}, {"dt": "2013-03-01T00:00:00", "Total": 486699}, {"dt": "2013-02-01T00:00:00", "Total": 530967}, {"dt": "2013-01-01T00:00:00", "Total": 536263}, {"dt": "2012-12-01T00:00:00", "Total": 560120}, {"dt": "2012-11-01T00:00:00", "Total": 555513}, {"dt": "2012-10-01T00:00:00", "Total": 530313}, {"dt": "2012-09-01T00:00:00", "Total": 512020}, {"dt": "2012-08-01T00:00:00", "Total": 543445}, {"dt": "2012-07-01T00:00:00", "Total": 522486}, {"dt": "2012-06-01T00:00:00", "Total": 555359}, {"dt": "2012-05-01T00:00:00", "Total": 497892}, {"dt": "2012-04-01T00:00:00", "Total": 461911}, {"dt": "2012-03-01T00:00:00", "Total": 461590}, {"dt": "2012-02-01T00:00:00", "Total": 388589}, {"dt": "2012-01-01T00:00:00", "Total": 456424}, {"dt": "2011-12-01T00:00:00", "Total": 509944}, {"dt": "2011-11-01T00:00:00", "Total": 459881}, {"dt": "2011-10-01T00:00:00", "Total": 487665}, {"dt": "2011-09-01T00:00:00", "Total": 527175}, {"dt": "2011-08-01T00:00:00", "Total": 535929}, {"dt": "2011-07-01T00:00:00", "Total": 572926}, {"dt": "2011-06-01T00:00:00", "Total": 554269}, {"dt": "2011-05-01T00:00:00", "Total": 536681}, {"dt": "2011-04-01T00:00:00", "Total": 531090}, {"dt": "2011-03-01T00:00:00", "Total": 412235}, {"dt": "2011-02-01T00:00:00", "Total": 458336}, {"dt": "2011-01-01T00:00:00", "Total": 474960}, {"dt": "2010-12-01T00:00:00", "Total": 523311}, {"dt": "2010-11-01T00:00:00", "Total": 558307}, {"dt": "2010-10-01T00:00:00", "Total": 613621}, {"dt": "2010-09-01T00:00:00", "Total": 574790}, {"dt": "2010-08-01T00:00:00", "Total": 611002}, {"dt": "2010-07-01T00:00:00", "Total": 587881}, {"dt": "2010-06-01T00:00:00", "Total": 520100}, {"dt": "2010-05-01T00:00:00", "Total": 524715}, {"dt": "2010-04-01T00:00:00", "Total": 485059}, {"dt": "2010-03-01T00:00:00", "Total": 422774}, {"dt": "2010-02-01T00:00:00", "Total": 413134}, {"dt": "2010-01-01T00:00:00", "Total": 428805}, {"dt": "2009-12-01T00:00:00", "Total": 467237}, {"dt": "2009-11-01T00:00:00", "Total": 448151}, {"dt": "2009-10-01T00:00:00", "Total": 452418}, {"dt": "2009-09-01T00:00:00", "Total": 440364}, {"dt": "2009-08-01T00:00:00", "Total": 493339}, {"dt": "2009-07-01T00:00:00", "Total": 433013}, {"dt": "2009-06-01T00:00:00", "Total": 413347}, {"dt": "2009-05-01T00:00:00", "Total": 419555}, {"dt": "2009-04-01T00:00:00", "Total": 408705}, {"dt": "2009-03-01T00:00:00", "Total": 374131}, {"dt": "2009-02-01T00:00:00", "Total": 318042}, {"dt": "2009-01-01T00:00:00", "Total": 399295}, {"dt": "2008-12-01T00:00:00", "Total": 429946}, {"dt": "2008-11-01T00:00:00", "Total": 557459}, {"dt": "2008-10-01T00:00:00", "Total": 595189}, {"dt": "2008-09-01T00:00:00", "Total": 554837}, {"dt": "2008-08-01T00:00:00", "Total": 572256}, {"dt": "2008-07-01T00:00:00", "Total": 563703}, {"dt": "2008-06-01T00:00:00", "Total": 579675}, {"dt": "2008-05-01T00:00:00", "Total": 529011}, {"dt": "2008-04-01T00:00:00", "Total": 556585}, {"dt": "2008-03-01T00:00:00", "Total": 498114}, {"dt": "2008-02-01T00:00:00", "Total": 529699}, {"dt": "2008-01-01T00:00:00", "Total": 521342}, {"dt": "2007-12-01T00:00:00", "Total": 575355}, {"dt": "2007-11-01T00:00:00", "Total": 611606}, {"dt": "2007-10-01T00:00:00", "Total": 644573}, {"dt": "2007-09-01T00:00:00", "Total": 654109}, {"dt": "2007-08-01T00:00:00", "Total": 657904}, {"dt": "2007-07-01T00:00:00", "Total": 647428}, {"dt": "2007-06-01T00:00:00", "Total": 662219}, {"dt": "2007-05-01T00:00:00", "Total": 606256}, {"dt": "2007-04-01T00:00:00", "Total": 579235}, {"dt": "2007-03-01T00:00:00", "Total": 541107}, {"dt": "2007-02-01T00:00:00", "Total": 541204}, {"dt": "2007-01-01T00:00:00", "Total": 591469}, {"dt": "2006-12-01T00:00:00", "Total": 575227}, {"dt": "2006-11-01T00:00:00", "Total": 654997}, {"dt": "2006-10-01T00:00:00", "Total": 650726}, {"dt": "2006-09-01T00:00:00", "Total": 614739}, {"dt": "2006-08-01T00:00:00", "Total": 675058}, {"dt": "2006-07-01T00:00:00", "Total": 582925}, {"dt": "2006-06-01T00:00:00", "Total": 617002}, {"dt": "2006-05-01T00:00:00", "Total": 644066}, {"dt": "2006-04-01T00:00:00", "Total": 619512}, {"dt": "2006-03-01T00:00:00", "Total": 561194}, {"dt": "2006-02-01T00:00:00", "Total": 515464}, {"dt": "2006-01-01T00:00:00", "Total": 579455}, {"dt": "2005-12-01T00:00:00", "Total": 545772}, {"dt": "2005-11-01T00:00:00", "Total": 610644}, {"dt": "2005-10-01T00:00:00", "Total": 600940}, {"dt": "2005-09-01T00:00:00", "Total": 610269}, {"dt": "2005-08-01T00:00:00", "Total": 615361}, {"dt": "2005-07-01T00:00:00", "Total": 573300}, {"dt": "2005-06-01T00:00:00", "Total": 576604}, {"dt": "2005-05-01T00:00:00", "Total": 564886}, {"dt": "2005-04-01T00:00:00", "Total": 538501}, {"dt": "2005-03-01T00:00:00", "Total": 466019}, {"dt": "2005-02-01T00:00:00", "Total": 497925}, {"dt": "2005-01-01T00:00:00", "Total": 509597}, {"dt": "2004-12-01T00:00:00", "Total": 551339}, {"dt": "2004-11-01T00:00:00", "Total": 582614}, {"dt": "2004-10-01T00:00:00", "Total": 557665}, {"dt": "2004-09-01T00:00:00", "Total": 494376}, {"dt": "2004-08-01T00:00:00", "Total": 520904}, {"dt": "2004-07-01T00:00:00", "Total": 529663}, {"dt": "2004-06-01T00:00:00", "Total": 494098}, {"dt": "2004-05-01T00:00:00", "Total": 468029}, {"dt": "2004-04-01T00:00:00", "Total": 441061}, {"dt": "2004-03-01T00:00:00", "Total": 448398}, {"dt": "2004-02-01T00:00:00", "Total": 314749}, {"dt": "2004-01-01T00:00:00", "Total": 376956}, {"dt": "2003-12-01T00:00:00", "Total": 406021}, {"dt": "2003-11-01T00:00:00", "Total": 424893}, {"dt": "2003-10-01T00:00:00", "Total": 436824}, {"dt": "2003-09-01T00:00:00", "Total": 379811}, {"dt": "2003-08-01T00:00:00", "Total": 390717}, {"dt": "2003-07-01T00:00:00", "Total": 430686}, {"dt": "2003-06-01T00:00:00", "Total": 386516}, {"dt": "2003-05-01T00:00:00", "Total": 388386}, {"dt": "2003-04-01T00:00:00", "Total": 400786}, {"dt": "2003-03-01T00:00:00", "Total": 356532}, {"dt": "2003-02-01T00:00:00", "Total": 322606}, {"dt": "2003-01-01T00:00:00", "Total": 334346}, {"dt": "2002-12-01T00:00:00", "Total": 361962}, {"dt": "2002-11-01T00:00:00", "Total": 335149}, {"dt": "2002-10-01T00:00:00", "Total": 301318}, {"dt": "2002-09-01T00:00:00", "Total": 340339}, {"dt": "2002-08-01T00:00:00", "Total": 427236}, {"dt": "2002-07-01T00:00:00", "Total": 451917}, {"dt": "2002-06-01T00:00:00", "Total": 418977}, {"dt": "2002-05-01T00:00:00", "Total": 428033}, {"dt": "2002-04-01T00:00:00", "Total": 410200}, {"dt": "2002-03-01T00:00:00", "Total": 343606}, {"dt": "2002-02-01T00:00:00", "Total": 362983}, {"dt": "2002-01-01T00:00:00", "Total": 344645}, {"dt": "2001-12-01T00:00:00", "Total": 359543}, {"dt": "2001-11-01T00:00:00", "Total": 372085}, {"dt": "2001-10-01T00:00:00", "Total": 434868}, {"dt": "2001-09-01T00:00:00", "Total": 388379}, {"dt": "2001-08-01T00:00:00", "Total": 405862}, {"dt": "2001-07-01T00:00:00", "Total": 379032}, {"dt": "2001-06-01T00:00:00", "Total": 362658}, {"dt": "2001-05-01T00:00:00", "Total": 367572}, {"dt": "2001-04-01T00:00:00", "Total": 366528}, {"dt": "2001-03-01T00:00:00", "Total": 360279}, {"dt": "2001-02-01T00:00:00", "Total": 311712}, {"dt": "2001-01-01T00:00:00", "Total": 354433}, {"dt": "2000-12-01T00:00:00", "Total": 351390}, {"dt": "2000-11-01T00:00:00", "Total": 410897}, {"dt": "2000-10-01T00:00:00", "Total": 432932}, {"dt": "2000-09-01T00:00:00", "Total": 387593}, {"dt": "2000-08-01T00:00:00", "Total": 434741}, {"dt": "2000-07-01T00:00:00", "Total": 409979}, {"dt": "2000-06-01T00:00:00", "Total": 374895}, {"dt": "2000-05-01T00:00:00", "Total": 406772}, {"dt": "2000-04-01T00:00:00", "Total": 366465}, {"dt": "2000-03-01T00:00:00", "Total": 350764}, {"dt": "2000-02-01T00:00:00", "Total": 335216}, {"dt": "2000-01-01T00:00:00", "Total": 339143}, {"dt": "1999-12-01T00:00:00", "Total": 365240}, {"dt": "1999-11-01T00:00:00", "Total": 397301}, {"dt": "1999-10-01T00:00:00", "Total": 396420}, {"dt": "1999-09-01T00:00:00", "Total": 402710}, {"dt": "1999-08-01T00:00:00", "Total": 399305}, {"dt": "1999-07-01T00:00:00", "Total": 347961}, {"dt": "1999-06-01T00:00:00", "Total": 373975}, {"dt": "1999-05-01T00:00:00", "Total": 394467}, {"dt": "1999-04-01T00:00:00", "Total": 339686}, {"dt": "1999-03-01T00:00:00", "Total": 347974}, {"dt": "1999-02-01T00:00:00", "Total": 324129}, {"dt": "1999-01-01T00:00:00", "Total": 319312}, {"dt": "1998-12-01T00:00:00", "Total": 336648}, {"dt": "1998-11-01T00:00:00", "Total": 368141}, {"dt": "1998-10-01T00:00:00", "Total": 347462}, {"dt": "1998-09-01T00:00:00", "Total": 372746}, {"dt": "1998-08-01T00:00:00", "Total": 372615}, {"dt": "1998-07-01T00:00:00", "Total": 378714}, {"dt": "1998-06-01T00:00:00", "Total": 355036}, {"dt": "1998-05-01T00:00:00", "Total": 331619}, {"dt": "1998-04-01T00:00:00", "Total": 336924}, {"dt": "1998-03-01T00:00:00", "Total": 333334}, {"dt": "1998-02-01T00:00:00", "Total": 276176}, {"dt": "1998-01-01T00:00:00", "Total": 288274}, {"dt": "1997-12-01T00:00:00", "Total": 300992}, {"dt": "1997-11-01T00:00:00", "Total": 310992}, {"dt": "1997-10-01T00:00:00", "Total": 314956}, {"dt": "1997-09-01T00:00:00", "Total": 332470}, {"dt": "1997-08-01T00:00:00", "Total": 297508}, {"dt": "1997-07-01T00:00:00", "Total": 315000}, {"dt": "1997-06-01T00:00:00", "Total": 309629}, {"dt": "1997-05-01T00:00:00", "Total": 278017}, {"dt": "1997-04-01T00:00:00", "Total": 276934}, {"dt": "1997-03-01T00:00:00", "Total": 273922}, {"dt": "1997-02-01T00:00:00", "Total": 250274}, {"dt": "1997-01-01T00:00:00", "Total": 243905}, {"dt": "1996-12-01T00:00:00", "Total": 271381}, {"dt": "1996-11-01T00:00:00", "Total": 252219}, {"dt": "1996-10-01T00:00:00", "Total": 284862}, {"dt": "1996-09-01T00:00:00", "Total": 277529}, {"dt": "1996-08-01T00:00:00", "Total": 268872}, {"dt": "1996-07-01T00:00:00", "Total": 266947}, {"dt": "1996-06-01T00:00:00", "Total": 262324}, {"dt": "1996-05-01T00:00:00", "Total": 240021}, {"dt": "1996-04-01T00:00:00", "Total": 258140}, {"dt": "1996-03-01T00:00:00", "Total": 230200}, {"dt": "1996-02-01T00:00:00", "Total": 226904}, {"dt": "1996-01-01T00:00:00", "Total": 227936}, {"dt": "1995-12-01T00:00:00", "Total": 233866}, {"dt": "1995-11-01T00:00:00", "Total": 243099}, {"dt": "1995-10-01T00:00:00", "Total": 271587}, {"dt": "1995-09-01T00:00:00", "Total": 242453}, {"dt": "1995-08-01T00:00:00", "Total": 264134}, {"dt": "1995-07-01T00:00:00", "Total": 256033}, {"dt": "1995-06-01T00:00:00", "Total": 227698}, {"dt": "1995-05-01T00:00:00", "Total": 240376}, {"dt": "1995-04-01T00:00:00", "Total": 226931}, {"dt": "1995-03-01T00:00:00", "Total": 206438}, {"dt": "1995-02-01T00:00:00", "Total": 216102}, {"dt": "1995-01-01T00:00:00", "Total": 214895}, {"dt": "1994-12-01T00:00:00", "Total": 223298}, {"dt": "1994-11-01T00:00:00", "Total": 235581}, {"dt": "1994-10-01T00:00:00", "Total": 257086}, {"dt": "1994-09-01T00:00:00", "Total": 214136}, {"dt": "1994-08-01T00:00:00", "Total": 241133}, {"dt": "1994-07-01T00:00:00", "Total": 235842}, {"dt": "1994-06-01T00:00:00", "Total": 214494}, {"dt": "1994-05-01T00:00:00", "Total": 227312}, {"dt": "1994-04-01T00:00:00", "Total": 175813}, {"dt": "1994-03-01T00:00:00", "Total": 191748}, {"dt": "1994-02-01T00:00:00", "Total": 173534}, {"dt": "1994-01-01T00:00:00", "Total": 183850}, {"dt": "1993-12-01T00:00:00", "Total": 186592}, {"dt": "1993-11-01T00:00:00", "Total": 193918}, {"dt": "1993-10-01T00:00:00", "Total": 204878}, {"dt": "1993-09-01T00:00:00", "Total": 194024}, {"dt": "1993-08-01T00:00:00", "Total": 214643}, {"dt": "1993-07-01T00:00:00", "Total": 174486}, {"dt": "1993-06-01T00:00:00", "Total": 172527}, {"dt": "1993-05-01T00:00:00", "Total": 168173}, {"dt": "1993-04-01T00:00:00", "Total": 144773}, {"dt": "1993-03-01T00:00:00", "Total": 165900}, {"dt": "1993-02-01T00:00:00", "Total": 126022}, {"dt": "1993-01-01T00:00:00", "Total": 133555}, {"dt": "1992-12-01T00:00:00", "Total": 156059}, {"dt": "1992-11-01T00:00:00", "Total": 153671}, {"dt": "1992-10-01T00:00:00", "Total": 161732}, {"dt": "1992-09-01T00:00:00", "Total": 162454}, {"dt": "1992-08-01T00:00:00", "Total": 157537}, {"dt": "1992-07-01T00:00:00", "Total": 155397}, {"dt": "1992-06-01T00:00:00", "Total": 161737}, {"dt": "1992-05-01T00:00:00", "Total": 146065}, {"dt": "1992-04-01T00:00:00", "Total": 141450}, {"dt": "1992-03-01T00:00:00", "Total": 153789}, {"dt": "1992-02-01T00:00:00", "Total": 133402}, {"dt": "1992-01-01T00:00:00", "Total": 146164}, {"dt": "1991-12-01T00:00:00", "Total": 144858}, {"dt": "1991-11-01T00:00:00", "Total": 153411}, {"dt": "1991-10-01T00:00:00", "Total": 191945}, {"dt": "1991-09-01T00:00:00", "Total": 151132}, {"dt": "1991-08-01T00:00:00", "Total": 147407}, {"dt": "1991-07-01T00:00:00", "Total": 166876}, {"dt": "1991-06-01T00:00:00", "Total": 146007}, {"dt": "1991-05-01T00:00:00", "Total": 162145}, {"dt": "1991-04-01T00:00:00", "Total": 139359}, {"dt": "1991-03-01T00:00:00", "Total": 116096}, {"dt": "1991-02-01T00:00:00", "Total": 122891}, {"dt": "1991-01-01T00:00:00", "Total": 125702}, {"dt": "1990-12-01T00:00:00", "Total": 120504}, {"dt": "1990-11-01T00:00:00", "Total": 124414}, {"dt": "1990-10-01T00:00:00", "Total": 152133}, {"dt": "1990-09-01T00:00:00", "Total": 127823}, {"dt": "1990-08-01T00:00:00", "Total": 140220}, {"dt": "1990-07-01T00:00:00", "Total": 139217}, {"dt": "1990-06-01T00:00:00", "Total": 123231}, {"dt": "1990-05-01T00:00:00", "Total": 146365}, {"dt": "1990-04-01T00:00:00", "Total": 133858}, {"dt": "1990-03-01T00:00:00", "Total": 132889}, {"dt": "1990-02-01T00:00:00", "Total": 118524}, {"dt": "1990-01-01T00:00:00", "Total": 138900}, {"dt": "1989-12-01T00:00:00", "Total": 128420}, {"dt": "1989-11-01T00:00:00", "Total": 156515}, {"dt": "1989-10-01T00:00:00", "Total": 148136}, {"dt": "1989-09-01T00:00:00", "Total": 125983}, {"dt": "1989-08-01T00:00:00", "Total": 156881}, {"dt": "1989-07-01T00:00:00", "Total": 126813}, {"dt": "1989-06-01T00:00:00", "Total": 125342}, {"dt": "1989-05-01T00:00:00", "Total": 138839}, {"dt": "1989-04-01T00:00:00", "Total": 110051}, {"dt": "1989-03-01T00:00:00", "Total": 118687}, {"dt": "1989-02-01T00:00:00", "Total": 115267}, {"dt": "1989-01-01T00:00:00", "Total": 124183}, {"dt": "1988-12-01T00:00:00", "Total": 128177}, {"dt": "1988-11-01T00:00:00", "Total": 149281}, {"dt": "1988-10-01T00:00:00", "Total": 129751}, {"dt": "1988-09-01T00:00:00", "Total": 127693}, {"dt": "1988-08-01T00:00:00", "Total": 152089}, {"dt": "1988-07-01T00:00:00", "Total": 125883}, {"dt": "1988-06-01T00:00:00", "Total": 131678}, {"dt": "1988-05-01T00:00:00", "Total": 124363}, {"dt": "1988-04-01T00:00:00", "Total": 111347}, {"dt": "1988-03-01T00:00:00", "Total": 129294}, {"dt": "1988-02-01T00:00:00", "Total": 108840}, {"dt": "1988-01-01T00:00:00", "Total": 121407}, {"dt": "1987-12-01T00:00:00", "Total": 114261}, {"dt": "1987-11-01T00:00:00", "Total": 128156}, {"dt": "1987-10-01T00:00:00", "Total": 128278}, {"dt": "1987-09-01T00:00:00", "Total": 131277}, {"dt": "1987-08-01T00:00:00", "Total": 129584}, {"dt": "1987-07-01T00:00:00", "Total": 125982}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_lb_raw</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Long Beach&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Total Empties&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[12]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-6acebea0275541e896d6ecd61f396e25"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-6acebea0275541e896d6ecd61f396e25") {
      outputDiv = document.getElementById("altair-viz-6acebea0275541e896d6ecd61f396e25");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector007"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Long Beach Total Empties Container Volume", "transform": [{"window": [{"op": "lag", "field": "Total Empties", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Total Empties'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Total Empties"}}, "height": 100, "selection": {"selector007": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-05499df915bfb2d9ea793b20179314cd"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-05499df915bfb2d9ea793b20179314cd": [{"dt": "2022-03-01T00:00:00", "Total Empties": 321691}, {"dt": "2022-02-01T00:00:00", "Total Empties": 288290}, {"dt": "2022-01-01T00:00:00", "Total Empties": 288550}, {"dt": "2021-12-01T00:00:00", "Total Empties": 281709}, {"dt": "2021-11-01T00:00:00", "Total Empties": 273274}, {"dt": "2021-10-01T00:00:00", "Total Empties": 282502}, {"dt": "2021-09-01T00:00:00", "Total Empties": 267456}, {"dt": "2021-08-01T00:00:00", "Total Empties": 280794}, {"dt": "2021-07-01T00:00:00", "Total Empties": 291955}, {"dt": "2021-06-01T00:00:00", "Total Empties": 250249}, {"dt": "2021-05-01T00:00:00", "Total Empties": 327135}, {"dt": "2021-04-01T00:00:00", "Total Empties": 254968}, {"dt": "2021-03-01T00:00:00", "Total Empties": 292505}, {"dt": "2021-02-01T00:00:00", "Total Empties": 278563}, {"dt": "2021-01-01T00:00:00", "Total Empties": 283497}, {"dt": "2020-12-01T00:00:00", "Total Empties": 277440}, {"dt": "2020-11-01T00:00:00", "Total Empties": 283563}, {"dt": "2020-10-01T00:00:00", "Total Empties": 289517}, {"dt": "2020-09-01T00:00:00", "Total Empties": 277406}, {"dt": "2020-08-01T00:00:00", "Total Empties": 234642}, {"dt": "2020-07-01T00:00:00", "Total Empties": 237672}, {"dt": "2020-06-01T00:00:00", "Total Empties": 183928}, {"dt": "2020-05-01T00:00:00", "Total Empties": 181060}, {"dt": "2020-04-01T00:00:00", "Total Empties": 163688}, {"dt": "2020-03-01T00:00:00", "Total Empties": 137652}, {"dt": "2020-02-01T00:00:00", "Total Empties": 164277}, {"dt": "2020-01-01T00:00:00", "Total Empties": 208244}, {"dt": "2019-12-01T00:00:00", "Total Empties": 216636}, {"dt": "2019-11-01T00:00:00", "Total Empties": 182992}, {"dt": "2019-10-01T00:00:00", "Total Empties": 219728}, {"dt": "2019-09-01T00:00:00", "Total Empties": 228821}, {"dt": "2019-08-01T00:00:00", "Total Empties": 216238}, {"dt": "2019-07-01T00:00:00", "Total Empties": 196777}, {"dt": "2019-06-01T00:00:00", "Total Empties": 211718}, {"dt": "2019-05-01T00:00:00", "Total Empties": 162479}, {"dt": "2019-04-01T00:00:00", "Total Empties": 186435}, {"dt": "2019-03-01T00:00:00", "Total Empties": 174346}, {"dt": "2019-02-01T00:00:00", "Total Empties": 188465}, {"dt": "2019-01-01T00:00:00", "Total Empties": 216160}, {"dt": "2018-12-01T00:00:00", "Total Empties": 255220}, {"dt": "2018-11-01T00:00:00", "Total Empties": 186183}, {"dt": "2018-10-01T00:00:00", "Total Empties": 221487}, {"dt": "2018-09-01T00:00:00", "Total Empties": 222343}, {"dt": "2018-08-01T00:00:00", "Total Empties": 216968}, {"dt": "2018-07-01T00:00:00", "Total Empties": 220975}, {"dt": "2018-06-01T00:00:00", "Total Empties": 232926}, {"dt": "2018-05-01T00:00:00", "Total Empties": 183959}, {"dt": "2018-04-01T00:00:00", "Total Empties": 164264}, {"dt": "2018-03-01T00:00:00", "Total Empties": 165015}, {"dt": "2018-02-01T00:00:00", "Total Empties": 188628}, {"dt": "2018-01-01T00:00:00", "Total Empties": 212671}, {"dt": "2017-12-01T00:00:00", "Total Empties": 213749}, {"dt": "2017-11-01T00:00:00", "Total Empties": 167085}, {"dt": "2017-10-01T00:00:00", "Total Empties": 204055}, {"dt": "2017-09-01T00:00:00", "Total Empties": 209985}, {"dt": "2017-08-01T00:00:00", "Total Empties": 219370}, {"dt": "2017-07-01T00:00:00", "Total Empties": 215394}, {"dt": "2017-06-01T00:00:00", "Total Empties": 205095}, {"dt": "2017-05-01T00:00:00", "Total Empties": 192908}, {"dt": "2017-04-01T00:00:00", "Total Empties": 153547}, {"dt": "2017-03-01T00:00:00", "Total Empties": 135413}, {"dt": "2017-02-01T00:00:00", "Total Empties": 128742}, {"dt": "2017-01-01T00:00:00", "Total Empties": 165465}, {"dt": "2016-12-01T00:00:00", "Total Empties": 154397}, {"dt": "2016-11-01T00:00:00", "Total Empties": 142801}, {"dt": "2016-10-01T00:00:00", "Total Empties": 158327}, {"dt": "2016-09-01T00:00:00", "Total Empties": 143476}, {"dt": "2016-08-01T00:00:00", "Total Empties": 160157}, {"dt": "2016-07-01T00:00:00", "Total Empties": 168671}, {"dt": "2016-06-01T00:00:00", "Total Empties": 161714}, {"dt": "2016-05-01T00:00:00", "Total Empties": 171333}, {"dt": "2016-04-01T00:00:00", "Total Empties": 118721}, {"dt": "2016-03-01T00:00:00", "Total Empties": 130010}, {"dt": "2016-02-01T00:00:00", "Total Empties": 142532}, {"dt": "2016-01-01T00:00:00", "Total Empties": 150958}, {"dt": "2015-12-01T00:00:00", "Total Empties": 174328}, {"dt": "2015-11-01T00:00:00", "Total Empties": 188328}, {"dt": "2015-10-01T00:00:00", "Total Empties": 183681}, {"dt": "2015-09-01T00:00:00", "Total Empties": 197076}, {"dt": "2015-08-01T00:00:00", "Total Empties": 206625}, {"dt": "2015-07-01T00:00:00", "Total Empties": 200457}, {"dt": "2015-06-01T00:00:00", "Total Empties": 158209}, {"dt": "2015-05-01T00:00:00", "Total Empties": 172078}, {"dt": "2015-04-01T00:00:00", "Total Empties": 159938}, {"dt": "2015-03-01T00:00:00", "Total Empties": 185227}, {"dt": "2015-02-01T00:00:00", "Total Empties": 97941}, {"dt": "2015-01-01T00:00:00", "Total Empties": 117361}, {"dt": "2014-12-01T00:00:00", "Total Empties": 159225}, {"dt": "2014-11-01T00:00:00", "Total Empties": 157570}, {"dt": "2014-10-01T00:00:00", "Total Empties": 152082}, {"dt": "2014-09-01T00:00:00", "Total Empties": 172016}, {"dt": "2014-08-01T00:00:00", "Total Empties": 145376}, {"dt": "2014-07-01T00:00:00", "Total Empties": 161319}, {"dt": "2014-06-01T00:00:00", "Total Empties": 154428}, {"dt": "2014-05-01T00:00:00", "Total Empties": 140368}, {"dt": "2014-04-01T00:00:00", "Total Empties": 127633}, {"dt": "2014-03-01T00:00:00", "Total Empties": 99894}, {"dt": "2014-02-01T00:00:00", "Total Empties": 101930}, {"dt": "2014-01-01T00:00:00", "Total Empties": 127058}, {"dt": "2013-12-01T00:00:00", "Total Empties": 142859}, {"dt": "2013-11-01T00:00:00", "Total Empties": 121011}, {"dt": "2013-10-01T00:00:00", "Total Empties": 136774}, {"dt": "2013-09-01T00:00:00", "Total Empties": 144457}, {"dt": "2013-08-01T00:00:00", "Total Empties": 148357}, {"dt": "2013-07-01T00:00:00", "Total Empties": 134950}, {"dt": "2013-06-01T00:00:00", "Total Empties": 141228}, {"dt": "2013-05-01T00:00:00", "Total Empties": 131017}, {"dt": "2013-04-01T00:00:00", "Total Empties": 117263}, {"dt": "2013-03-01T00:00:00", "Total Empties": 105574}, {"dt": "2013-02-01T00:00:00", "Total Empties": 111197}, {"dt": "2013-01-01T00:00:00", "Total Empties": 135631}, {"dt": "2012-12-01T00:00:00", "Total Empties": 128980}, {"dt": "2012-11-01T00:00:00", "Total Empties": 138667}, {"dt": "2012-10-01T00:00:00", "Total Empties": 120112}, {"dt": "2012-09-01T00:00:00", "Total Empties": 132016}, {"dt": "2012-08-01T00:00:00", "Total Empties": 140243}, {"dt": "2012-07-01T00:00:00", "Total Empties": 136679}, {"dt": "2012-06-01T00:00:00", "Total Empties": 141184}, {"dt": "2012-05-01T00:00:00", "Total Empties": 118872}, {"dt": "2012-04-01T00:00:00", "Total Empties": 108496}, {"dt": "2012-03-01T00:00:00", "Total Empties": 90611}, {"dt": "2012-02-01T00:00:00", "Total Empties": 77108}, {"dt": "2012-01-01T00:00:00", "Total Empties": 110216}, {"dt": "2011-12-01T00:00:00", "Total Empties": 132106}, {"dt": "2011-11-01T00:00:00", "Total Empties": 117121}, {"dt": "2011-10-01T00:00:00", "Total Empties": 129092}, {"dt": "2011-09-01T00:00:00", "Total Empties": 145747}, {"dt": "2011-08-01T00:00:00", "Total Empties": 147454}, {"dt": "2011-07-01T00:00:00", "Total Empties": 155644}, {"dt": "2011-06-01T00:00:00", "Total Empties": 156568}, {"dt": "2011-05-01T00:00:00", "Total Empties": 131420}, {"dt": "2011-04-01T00:00:00", "Total Empties": 117300}, {"dt": "2011-03-01T00:00:00", "Total Empties": 89263}, {"dt": "2011-02-01T00:00:00", "Total Empties": 102747}, {"dt": "2011-01-01T00:00:00", "Total Empties": 104969}, {"dt": "2010-12-01T00:00:00", "Total Empties": 125282}, {"dt": "2010-11-01T00:00:00", "Total Empties": 141199}, {"dt": "2010-10-01T00:00:00", "Total Empties": 159872}, {"dt": "2010-09-01T00:00:00", "Total Empties": 161864}, {"dt": "2010-08-01T00:00:00", "Total Empties": 173723}, {"dt": "2010-07-01T00:00:00", "Total Empties": 167826}, {"dt": "2010-06-01T00:00:00", "Total Empties": 141935}, {"dt": "2010-05-01T00:00:00", "Total Empties": 121551}, {"dt": "2010-04-01T00:00:00", "Total Empties": 113659}, {"dt": "2010-03-01T00:00:00", "Total Empties": 85627}, {"dt": "2010-02-01T00:00:00", "Total Empties": 82006}, {"dt": "2010-01-01T00:00:00", "Total Empties": 97697}, {"dt": "2009-12-01T00:00:00", "Total Empties": 111567}, {"dt": "2009-11-01T00:00:00", "Total Empties": 105521}, {"dt": "2009-10-01T00:00:00", "Total Empties": 106160}, {"dt": "2009-09-01T00:00:00", "Total Empties": 106103}, {"dt": "2009-08-01T00:00:00", "Total Empties": 112796}, {"dt": "2009-07-01T00:00:00", "Total Empties": 102874}, {"dt": "2009-06-01T00:00:00", "Total Empties": 92882}, {"dt": "2009-05-01T00:00:00", "Total Empties": 89900}, {"dt": "2009-04-01T00:00:00", "Total Empties": 96678}, {"dt": "2009-03-01T00:00:00", "Total Empties": 70007}, {"dt": "2009-02-01T00:00:00", "Total Empties": 75962}, {"dt": "2009-01-01T00:00:00", "Total Empties": 110197}, {"dt": "2008-12-01T00:00:00", "Total Empties": 130906}, {"dt": "2008-11-01T00:00:00", "Total Empties": 179769}, {"dt": "2008-10-01T00:00:00", "Total Empties": 170212}, {"dt": "2008-09-01T00:00:00", "Total Empties": 146070}, {"dt": "2008-08-01T00:00:00", "Total Empties": 135615}, {"dt": "2008-07-01T00:00:00", "Total Empties": 137989}, {"dt": "2008-06-01T00:00:00", "Total Empties": 131156}, {"dt": "2008-05-01T00:00:00", "Total Empties": 102832}, {"dt": "2008-04-01T00:00:00", "Total Empties": 112455}, {"dt": "2008-03-01T00:00:00", "Total Empties": 107107}, {"dt": "2008-02-01T00:00:00", "Total Empties": 119193}, {"dt": "2008-01-01T00:00:00", "Total Empties": 138098}, {"dt": "2007-12-01T00:00:00", "Total Empties": 151933}, {"dt": "2007-11-01T00:00:00", "Total Empties": 157690}, {"dt": "2007-10-01T00:00:00", "Total Empties": 176603}, {"dt": "2007-09-01T00:00:00", "Total Empties": 187760}, {"dt": "2007-08-01T00:00:00", "Total Empties": 189848}, {"dt": "2007-07-01T00:00:00", "Total Empties": 179937}, {"dt": "2007-06-01T00:00:00", "Total Empties": 181841}, {"dt": "2007-05-01T00:00:00", "Total Empties": 162529}, {"dt": "2007-04-01T00:00:00", "Total Empties": 154906}, {"dt": "2007-03-01T00:00:00", "Total Empties": 162580}, {"dt": "2007-02-01T00:00:00", "Total Empties": 148189}, {"dt": "2007-01-01T00:00:00", "Total Empties": 179815}, {"dt": "2006-12-01T00:00:00", "Total Empties": 180663}, {"dt": "2006-11-01T00:00:00", "Total Empties": 214453}, {"dt": "2006-10-01T00:00:00", "Total Empties": 205720}, {"dt": "2006-09-01T00:00:00", "Total Empties": 198418}, {"dt": "2006-08-01T00:00:00", "Total Empties": 221973}, {"dt": "2006-07-01T00:00:00", "Total Empties": 176947}, {"dt": "2006-06-01T00:00:00", "Total Empties": 195437}, {"dt": "2006-05-01T00:00:00", "Total Empties": 200594}, {"dt": "2006-04-01T00:00:00", "Total Empties": 186713}, {"dt": "2006-03-01T00:00:00", "Total Empties": 160026}, {"dt": "2006-02-01T00:00:00", "Total Empties": 153038}, {"dt": "2006-01-01T00:00:00", "Total Empties": 185860}, {"dt": "2005-12-01T00:00:00", "Total Empties": 175230}, {"dt": "2005-11-01T00:00:00", "Total Empties": 198432}, {"dt": "2005-10-01T00:00:00", "Total Empties": 198315}, {"dt": "2005-09-01T00:00:00", "Total Empties": 199800}, {"dt": "2005-08-01T00:00:00", "Total Empties": 198487}, {"dt": "2005-07-01T00:00:00", "Total Empties": 176865}, {"dt": "2005-06-01T00:00:00", "Total Empties": 180971}, {"dt": "2005-05-01T00:00:00", "Total Empties": 170821}, {"dt": "2005-04-01T00:00:00", "Total Empties": 159972}, {"dt": "2005-03-01T00:00:00", "Total Empties": 151407}, {"dt": "2005-02-01T00:00:00", "Total Empties": 156813}, {"dt": "2005-01-01T00:00:00", "Total Empties": 175232}, {"dt": "2004-12-01T00:00:00", "Total Empties": 188467}, {"dt": "2004-11-01T00:00:00", "Total Empties": 187461}, {"dt": "2004-10-01T00:00:00", "Total Empties": 183251}, {"dt": "2004-09-01T00:00:00", "Total Empties": 162594}, {"dt": "2004-08-01T00:00:00", "Total Empties": 166651}, {"dt": "2004-07-01T00:00:00", "Total Empties": 165405}, {"dt": "2004-06-01T00:00:00", "Total Empties": 151128}, {"dt": "2004-05-01T00:00:00", "Total Empties": 140617}, {"dt": "2004-04-01T00:00:00", "Total Empties": 134190}, {"dt": "2004-03-01T00:00:00", "Total Empties": 118075}, {"dt": "2004-02-01T00:00:00", "Total Empties": 83791}, {"dt": "2004-01-01T00:00:00", "Total Empties": 102329}, {"dt": "2003-12-01T00:00:00", "Total Empties": 111986}, {"dt": "2003-11-01T00:00:00", "Total Empties": 126065}, {"dt": "2003-10-01T00:00:00", "Total Empties": 121345}, {"dt": "2003-09-01T00:00:00", "Total Empties": 107570}, {"dt": "2003-08-01T00:00:00", "Total Empties": 108469}, {"dt": "2003-07-01T00:00:00", "Total Empties": 118596}, {"dt": "2003-06-01T00:00:00", "Total Empties": 111180}, {"dt": "2003-05-01T00:00:00", "Total Empties": 115215}, {"dt": "2003-04-01T00:00:00", "Total Empties": 125015}, {"dt": "2003-03-01T00:00:00", "Total Empties": 93935}, {"dt": "2003-02-01T00:00:00", "Total Empties": 96098}, {"dt": "2003-01-01T00:00:00", "Total Empties": 108534}, {"dt": "2002-12-01T00:00:00", "Total Empties": 111457}, {"dt": "2002-11-01T00:00:00", "Total Empties": 90740}, {"dt": "2002-10-01T00:00:00", "Total Empties": 96934}, {"dt": "2002-09-01T00:00:00", "Total Empties": 97541}, {"dt": "2002-08-01T00:00:00", "Total Empties": 121558}, {"dt": "2002-07-01T00:00:00", "Total Empties": 131799}, {"dt": "2002-06-01T00:00:00", "Total Empties": 107051}, {"dt": "2002-05-01T00:00:00", "Total Empties": 112589}, {"dt": "2002-04-01T00:00:00", "Total Empties": 94287}, {"dt": "2002-03-01T00:00:00", "Total Empties": 83887}, {"dt": "2002-02-01T00:00:00", "Total Empties": 77374}, {"dt": "2002-01-01T00:00:00", "Total Empties": 93173}, {"dt": "2001-12-01T00:00:00", "Total Empties": 84299}, {"dt": "2001-11-01T00:00:00", "Total Empties": 102345}, {"dt": "2001-10-01T00:00:00", "Total Empties": 114428}, {"dt": "2001-09-01T00:00:00", "Total Empties": 91451}, {"dt": "2001-08-01T00:00:00", "Total Empties": 101069}, {"dt": "2001-07-01T00:00:00", "Total Empties": 92897}, {"dt": "2001-06-01T00:00:00", "Total Empties": 81275}, {"dt": "2001-05-01T00:00:00", "Total Empties": 90344}, {"dt": "2001-04-01T00:00:00", "Total Empties": 87329}, {"dt": "2001-03-01T00:00:00", "Total Empties": 80325}, {"dt": "2001-02-01T00:00:00", "Total Empties": 81044}, {"dt": "2001-01-01T00:00:00", "Total Empties": 82622}, {"dt": "2000-12-01T00:00:00", "Total Empties": 91408}, {"dt": "2000-11-01T00:00:00", "Total Empties": 107076}, {"dt": "2000-10-01T00:00:00", "Total Empties": 108880}, {"dt": "2000-09-01T00:00:00", "Total Empties": 97838}, {"dt": "2000-08-01T00:00:00", "Total Empties": 111760}, {"dt": "2000-07-01T00:00:00", "Total Empties": 98240}, {"dt": "2000-06-01T00:00:00", "Total Empties": 88586}, {"dt": "2000-05-01T00:00:00", "Total Empties": 90986}, {"dt": "2000-04-01T00:00:00", "Total Empties": 74727}, {"dt": "2000-03-01T00:00:00", "Total Empties": 74404}, {"dt": "2000-02-01T00:00:00", "Total Empties": 75961}, {"dt": "2000-01-01T00:00:00", "Total Empties": 80380}, {"dt": "1999-12-01T00:00:00", "Total Empties": 92971}, {"dt": "1999-11-01T00:00:00", "Total Empties": 96656}, {"dt": "1999-10-01T00:00:00", "Total Empties": 107829}, {"dt": "1999-09-01T00:00:00", "Total Empties": 101322}, {"dt": "1999-08-01T00:00:00", "Total Empties": 104015}, {"dt": "1999-07-01T00:00:00", "Total Empties": 85220}, {"dt": "1999-06-01T00:00:00", "Total Empties": 100603}, {"dt": "1999-05-01T00:00:00", "Total Empties": 101274}, {"dt": "1999-04-01T00:00:00", "Total Empties": 81071}, {"dt": "1999-03-01T00:00:00", "Total Empties": 87362}, {"dt": "1999-02-01T00:00:00", "Total Empties": 71647}, {"dt": "1999-01-01T00:00:00", "Total Empties": 72239}, {"dt": "1998-12-01T00:00:00", "Total Empties": 82589}, {"dt": "1998-11-01T00:00:00", "Total Empties": 91189}, {"dt": "1998-10-01T00:00:00", "Total Empties": 89572}, {"dt": "1998-09-01T00:00:00", "Total Empties": 100017}, {"dt": "1998-08-01T00:00:00", "Total Empties": 99786}, {"dt": "1998-07-01T00:00:00", "Total Empties": 98626}, {"dt": "1998-06-01T00:00:00", "Total Empties": 89402}, {"dt": "1998-05-01T00:00:00", "Total Empties": 83598}, {"dt": "1998-04-01T00:00:00", "Total Empties": 77406}, {"dt": "1998-03-01T00:00:00", "Total Empties": 77104}, {"dt": "1998-02-01T00:00:00", "Total Empties": 66756}, {"dt": "1998-01-01T00:00:00", "Total Empties": 71096}, {"dt": "1997-12-01T00:00:00", "Total Empties": 64014}, {"dt": "1997-11-01T00:00:00", "Total Empties": 68070}, {"dt": "1997-10-01T00:00:00", "Total Empties": 57860}, {"dt": "1997-09-01T00:00:00", "Total Empties": 57795}, {"dt": "1997-08-01T00:00:00", "Total Empties": 49775}, {"dt": "1997-07-01T00:00:00", "Total Empties": 48792}, {"dt": "1997-06-01T00:00:00", "Total Empties": 43604}, {"dt": "1997-05-01T00:00:00", "Total Empties": 42953}, {"dt": "1997-04-01T00:00:00", "Total Empties": 37931}, {"dt": "1997-03-01T00:00:00", "Total Empties": 42326}, {"dt": "1997-02-01T00:00:00", "Total Empties": 35884}, {"dt": "1997-01-01T00:00:00", "Total Empties": 41484}, {"dt": "1996-12-01T00:00:00", "Total Empties": 37737}, {"dt": "1996-11-01T00:00:00", "Total Empties": 39910}, {"dt": "1996-10-01T00:00:00", "Total Empties": 44390}, {"dt": "1996-09-01T00:00:00", "Total Empties": 48001}, {"dt": "1996-08-01T00:00:00", "Total Empties": 46353}, {"dt": "1996-07-01T00:00:00", "Total Empties": 36962}, {"dt": "1996-06-01T00:00:00", "Total Empties": 40016}, {"dt": "1996-05-01T00:00:00", "Total Empties": 32777}, {"dt": "1996-04-01T00:00:00", "Total Empties": 29775}, {"dt": "1996-03-01T00:00:00", "Total Empties": 27480}, {"dt": "1996-02-01T00:00:00", "Total Empties": 23322}, {"dt": "1996-01-01T00:00:00", "Total Empties": 31147}, {"dt": "1995-12-01T00:00:00", "Total Empties": 36927}, {"dt": "1995-11-01T00:00:00", "Total Empties": 44000}, {"dt": "1995-10-01T00:00:00", "Total Empties": 43982}, {"dt": "1995-09-01T00:00:00", "Total Empties": 46443}, {"dt": "1995-08-01T00:00:00", "Total Empties": 46836}, {"dt": "1995-07-01T00:00:00", "Total Empties": 40852}, {"dt": "1995-06-01T00:00:00", "Total Empties": 30462}, {"dt": "1995-05-01T00:00:00", "Total Empties": 35462}, {"dt": "1995-04-01T00:00:00", "Total Empties": 29534}, {"dt": "1995-03-01T00:00:00", "Total Empties": 28349}, {"dt": "1995-02-01T00:00:00", "Total Empties": 35102}, {"dt": "1995-01-01T00:00:00", "Total Empties": 36030}, {"dt": "1994-12-01T00:00:00", "Total Empties": 38716}, {"dt": "1994-11-01T00:00:00", "Total Empties": 48212}, {"dt": "1994-10-01T00:00:00", "Total Empties": 52379}, {"dt": "1994-09-01T00:00:00", "Total Empties": 42823}, {"dt": "1994-08-01T00:00:00", "Total Empties": 46200}, {"dt": "1994-07-01T00:00:00", "Total Empties": 42251}, {"dt": "1994-06-01T00:00:00", "Total Empties": 35949}, {"dt": "1994-05-01T00:00:00", "Total Empties": 40529}, {"dt": "1994-04-01T00:00:00", "Total Empties": 28217}, {"dt": "1994-03-01T00:00:00", "Total Empties": 33470}, {"dt": "1994-02-01T00:00:00", "Total Empties": 30810}, {"dt": "1994-01-01T00:00:00", "Total Empties": 36412}, {"dt": "1993-12-01T00:00:00", "Total Empties": 39831}, {"dt": "1993-11-01T00:00:00", "Total Empties": 41535}, {"dt": "1993-10-01T00:00:00", "Total Empties": 46736}, {"dt": "1993-09-01T00:00:00", "Total Empties": 40513}, {"dt": "1993-08-01T00:00:00", "Total Empties": 44234}, {"dt": "1993-07-01T00:00:00", "Total Empties": 33793}, {"dt": "1993-06-01T00:00:00", "Total Empties": 32042}, {"dt": "1993-05-01T00:00:00", "Total Empties": 31089}, {"dt": "1993-04-01T00:00:00", "Total Empties": 25990}, {"dt": "1993-03-01T00:00:00", "Total Empties": 26829}, {"dt": "1993-02-01T00:00:00", "Total Empties": 25807}, {"dt": "1993-01-01T00:00:00", "Total Empties": 26610}, {"dt": "1992-12-01T00:00:00", "Total Empties": 31423}, {"dt": "1992-11-01T00:00:00", "Total Empties": 32066}, {"dt": "1992-10-01T00:00:00", "Total Empties": 33539}, {"dt": "1992-09-01T00:00:00", "Total Empties": 34881}, {"dt": "1992-08-01T00:00:00", "Total Empties": 34989}, {"dt": "1992-07-01T00:00:00", "Total Empties": 30887}, {"dt": "1992-06-01T00:00:00", "Total Empties": 30510}, {"dt": "1992-05-01T00:00:00", "Total Empties": 28867}, {"dt": "1992-04-01T00:00:00", "Total Empties": 23568}, {"dt": "1992-03-01T00:00:00", "Total Empties": 23964}, {"dt": "1992-02-01T00:00:00", "Total Empties": 21012}, {"dt": "1992-01-01T00:00:00", "Total Empties": 26536}, {"dt": "1991-12-01T00:00:00", "Total Empties": 28910}, {"dt": "1991-11-01T00:00:00", "Total Empties": 29170}, {"dt": "1991-10-01T00:00:00", "Total Empties": 40198}, {"dt": "1991-09-01T00:00:00", "Total Empties": 28500}, {"dt": "1991-08-01T00:00:00", "Total Empties": 29553}, {"dt": "1991-07-01T00:00:00", "Total Empties": 27444}, {"dt": "1991-06-01T00:00:00", "Total Empties": 23988}, {"dt": "1991-05-01T00:00:00", "Total Empties": 19650}, {"dt": "1991-04-01T00:00:00", "Total Empties": 17099}, {"dt": "1991-03-01T00:00:00", "Total Empties": 14527}, {"dt": "1991-02-01T00:00:00", "Total Empties": 20563}, {"dt": "1991-01-01T00:00:00", "Total Empties": 18782}, {"dt": "1990-12-01T00:00:00", "Total Empties": 21353}, {"dt": "1990-11-01T00:00:00", "Total Empties": 21872}, {"dt": "1990-10-01T00:00:00", "Total Empties": 28736}, {"dt": "1990-09-01T00:00:00", "Total Empties": 24396}, {"dt": "1990-08-01T00:00:00", "Total Empties": 26404}, {"dt": "1990-07-01T00:00:00", "Total Empties": 23782}, {"dt": "1990-06-01T00:00:00", "Total Empties": 20988}, {"dt": "1990-05-01T00:00:00", "Total Empties": 26311}, {"dt": "1990-04-01T00:00:00", "Total Empties": 21829}, {"dt": "1990-03-01T00:00:00", "Total Empties": 23479}, {"dt": "1990-02-01T00:00:00", "Total Empties": 20156}, {"dt": "1990-01-01T00:00:00", "Total Empties": 25805}, {"dt": "1989-12-01T00:00:00", "Total Empties": 28298}, {"dt": "1989-11-01T00:00:00", "Total Empties": 35544}, {"dt": "1989-10-01T00:00:00", "Total Empties": 33877}, {"dt": "1989-09-01T00:00:00", "Total Empties": 29356}, {"dt": "1989-08-01T00:00:00", "Total Empties": 33070}, {"dt": "1989-07-01T00:00:00", "Total Empties": 23355}, {"dt": "1989-06-01T00:00:00", "Total Empties": 24211}, {"dt": "1989-05-01T00:00:00", "Total Empties": 24491}, {"dt": "1989-04-01T00:00:00", "Total Empties": 18492}, {"dt": "1989-03-01T00:00:00", "Total Empties": 20822}, {"dt": "1989-02-01T00:00:00", "Total Empties": 22424}, {"dt": "1989-01-01T00:00:00", "Total Empties": 25707}, {"dt": "1988-12-01T00:00:00", "Total Empties": 28586}, {"dt": "1988-11-01T00:00:00", "Total Empties": 33959}, {"dt": "1988-10-01T00:00:00", "Total Empties": 29908}, {"dt": "1988-09-01T00:00:00", "Total Empties": 28044}, {"dt": "1988-08-01T00:00:00", "Total Empties": 32384}, {"dt": "1988-07-01T00:00:00", "Total Empties": 21509}, {"dt": "1988-06-01T00:00:00", "Total Empties": 22951}, {"dt": "1988-05-01T00:00:00", "Total Empties": 21259}, {"dt": "1988-04-01T00:00:00", "Total Empties": 19880}, {"dt": "1988-03-01T00:00:00", "Total Empties": 23923}, {"dt": "1988-02-01T00:00:00", "Total Empties": 17620}, {"dt": "1988-01-01T00:00:00", "Total Empties": 23621}, {"dt": "1987-12-01T00:00:00", "Total Empties": 25404}, {"dt": "1987-11-01T00:00:00", "Total Empties": 29823}, {"dt": "1987-10-01T00:00:00", "Total Empties": 32140}, {"dt": "1987-09-01T00:00:00", "Total Empties": 32010}, {"dt": "1987-08-01T00:00:00", "Total Empties": 33107}, {"dt": "1987-07-01T00:00:00", "Total Empties": 30636}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_lb_raw</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Long Beach&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Loaded Inbound&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[13]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-45cfde501d3e41769f31e540fe32b38f"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-45cfde501d3e41769f31e540fe32b38f") {
      outputDiv = document.getElementById("altair-viz-45cfde501d3e41769f31e540fe32b38f");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector008"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Long Beach Loaded Inbound Container Volume", "transform": [{"window": [{"op": "lag", "field": "Loaded Inbound", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Loaded Inbound'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Loaded Inbound"}}, "height": 100, "selection": {"selector008": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-689b7969f162ef0ddd1ecf384d9fd73f"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-689b7969f162ef0ddd1ecf384d9fd73f": [{"dt": "2022-03-01T00:00:00", "Loaded Inbound": 427280}, {"dt": "2022-02-01T00:00:00", "Loaded Inbound": 390335}, {"dt": "2022-01-01T00:00:00", "Loaded Inbound": 389334}, {"dt": "2021-12-01T00:00:00", "Loaded Inbound": 358687}, {"dt": "2021-11-01T00:00:00", "Loaded Inbound": 362394}, {"dt": "2021-10-01T00:00:00", "Loaded Inbound": 385000}, {"dt": "2021-09-01T00:00:00", "Loaded Inbound": 370230}, {"dt": "2021-08-01T00:00:00", "Loaded Inbound": 407426}, {"dt": "2021-07-01T00:00:00", "Loaded Inbound": 382940}, {"dt": "2021-06-01T00:00:00", "Loaded Inbound": 357101}, {"dt": "2021-05-01T00:00:00", "Loaded Inbound": 444736}, {"dt": "2021-04-01T00:00:00", "Loaded Inbound": 367151}, {"dt": "2021-03-01T00:00:00", "Loaded Inbound": 408172}, {"dt": "2021-02-01T00:00:00", "Loaded Inbound": 373756}, {"dt": "2021-01-01T00:00:00", "Loaded Inbound": 364255}, {"dt": "2020-12-01T00:00:00", "Loaded Inbound": 406072}, {"dt": "2020-11-01T00:00:00", "Loaded Inbound": 382677}, {"dt": "2020-10-01T00:00:00", "Loaded Inbound": 402408}, {"dt": "2020-09-01T00:00:00", "Loaded Inbound": 405618}, {"dt": "2020-08-01T00:00:00", "Loaded Inbound": 364792}, {"dt": "2020-07-01T00:00:00", "Loaded Inbound": 376807}, {"dt": "2020-06-01T00:00:00", "Loaded Inbound": 300714}, {"dt": "2020-05-01T00:00:00", "Loaded Inbound": 312590}, {"dt": "2020-04-01T00:00:00", "Loaded Inbound": 253540}, {"dt": "2020-03-01T00:00:00", "Loaded Inbound": 234570}, {"dt": "2020-02-01T00:00:00", "Loaded Inbound": 248592}, {"dt": "2020-01-01T00:00:00", "Loaded Inbound": 309961}, {"dt": "2019-12-01T00:00:00", "Loaded Inbound": 323231}, {"dt": "2019-11-01T00:00:00", "Loaded Inbound": 293287}, {"dt": "2019-10-01T00:00:00", "Loaded Inbound": 337062}, {"dt": "2019-09-01T00:00:00", "Loaded Inbound": 354919}, {"dt": "2019-08-01T00:00:00", "Loaded Inbound": 322780}, {"dt": "2019-07-01T00:00:00", "Loaded Inbound": 313350}, {"dt": "2019-06-01T00:00:00", "Loaded Inbound": 331617}, {"dt": "2019-05-01T00:00:00", "Loaded Inbound": 290568}, {"dt": "2019-04-01T00:00:00", "Loaded Inbound": 317883}, {"dt": "2019-03-01T00:00:00", "Loaded Inbound": 247039}, {"dt": "2019-02-01T00:00:00", "Loaded Inbound": 302865}, {"dt": "2019-01-01T00:00:00", "Loaded Inbound": 323838}, {"dt": "2018-12-01T00:00:00", "Loaded Inbound": 373098}, {"dt": "2018-11-01T00:00:00", "Loaded Inbound": 319877}, {"dt": "2018-10-01T00:00:00", "Loaded Inbound": 364084}, {"dt": "2018-09-01T00:00:00", "Loaded Inbound": 357301}, {"dt": "2018-08-01T00:00:00", "Loaded Inbound": 343029}, {"dt": "2018-07-01T00:00:00", "Loaded Inbound": 347736}, {"dt": "2018-06-01T00:00:00", "Loaded Inbound": 384095}, {"dt": "2018-05-01T00:00:00", "Loaded Inbound": 361056}, {"dt": "2018-04-01T00:00:00", "Loaded Inbound": 312376}, {"dt": "2018-03-01T00:00:00", "Loaded Inbound": 267824}, {"dt": "2018-02-01T00:00:00", "Loaded Inbound": 342247}, {"dt": "2018-01-01T00:00:00", "Loaded Inbound": 324656}, {"dt": "2017-12-01T00:00:00", "Loaded Inbound": 345721}, {"dt": "2017-11-01T00:00:00", "Loaded Inbound": 319210}, {"dt": "2017-10-01T00:00:00", "Loaded Inbound": 339013}, {"dt": "2017-09-01T00:00:00", "Loaded Inbound": 366298}, {"dt": "2017-08-01T00:00:00", "Loaded Inbound": 355715}, {"dt": "2017-07-01T00:00:00", "Loaded Inbound": 378820}, {"dt": "2017-06-01T00:00:00", "Loaded Inbound": 335328}, {"dt": "2017-05-01T00:00:00", "Loaded Inbound": 336594}, {"dt": "2017-04-01T00:00:00", "Loaded Inbound": 288207}, {"dt": "2017-03-01T00:00:00", "Loaded Inbound": 249534}, {"dt": "2017-02-01T00:00:00", "Loaded Inbound": 249759}, {"dt": "2017-01-01T00:00:00", "Loaded Inbound": 298990}, {"dt": "2016-12-01T00:00:00", "Loaded Inbound": 271599}, {"dt": "2016-11-01T00:00:00", "Loaded Inbound": 270610}, {"dt": "2016-10-01T00:00:00", "Loaded Inbound": 296711}, {"dt": "2016-09-01T00:00:00", "Loaded Inbound": 282945}, {"dt": "2016-08-01T00:00:00", "Loaded Inbound": 321625}, {"dt": "2016-07-01T00:00:00", "Loaded Inbound": 325608}, {"dt": "2016-06-01T00:00:00", "Loaded Inbound": 313526}, {"dt": "2016-05-01T00:00:00", "Loaded Inbound": 330639}, {"dt": "2016-04-01T00:00:00", "Loaded Inbound": 247316}, {"dt": "2016-03-01T00:00:00", "Loaded Inbound": 207635}, {"dt": "2016-02-01T00:00:00", "Loaded Inbound": 295870}, {"dt": "2016-01-01T00:00:00", "Loaded Inbound": 278491}, {"dt": "2015-12-01T00:00:00", "Loaded Inbound": 296002}, {"dt": "2015-11-01T00:00:00", "Loaded Inbound": 306654}, {"dt": "2015-10-01T00:00:00", "Loaded Inbound": 307995}, {"dt": "2015-09-01T00:00:00", "Loaded Inbound": 332909}, {"dt": "2015-08-01T00:00:00", "Loaded Inbound": 358262}, {"dt": "2015-07-01T00:00:00", "Loaded Inbound": 345912}, {"dt": "2015-06-01T00:00:00", "Loaded Inbound": 297189}, {"dt": "2015-05-01T00:00:00", "Loaded Inbound": 327317}, {"dt": "2015-04-01T00:00:00", "Loaded Inbound": 317376}, {"dt": "2015-03-01T00:00:00", "Loaded Inbound": 317520}, {"dt": "2015-02-01T00:00:00", "Loaded Inbound": 204462}, {"dt": "2015-01-01T00:00:00", "Loaded Inbound": 213667}, {"dt": "2014-12-01T00:00:00", "Loaded Inbound": 276516}, {"dt": "2014-11-01T00:00:00", "Loaded Inbound": 293984}, {"dt": "2014-10-01T00:00:00", "Loaded Inbound": 310482}, {"dt": "2014-09-01T00:00:00", "Loaded Inbound": 339343}, {"dt": "2014-08-01T00:00:00", "Loaded Inbound": 300851}, {"dt": "2014-07-01T00:00:00", "Loaded Inbound": 297615}, {"dt": "2014-06-01T00:00:00", "Loaded Inbound": 316054}, {"dt": "2014-05-01T00:00:00", "Loaded Inbound": 312439}, {"dt": "2014-04-01T00:00:00", "Loaded Inbound": 295712}, {"dt": "2014-03-01T00:00:00", "Loaded Inbound": 223432}, {"dt": "2014-02-01T00:00:00", "Loaded Inbound": 271671}, {"dt": "2014-01-01T00:00:00", "Loaded Inbound": 279415}, {"dt": "2013-12-01T00:00:00", "Loaded Inbound": 291434}, {"dt": "2013-11-01T00:00:00", "Loaded Inbound": 296638}, {"dt": "2013-10-01T00:00:00", "Loaded Inbound": 298271}, {"dt": "2013-09-01T00:00:00", "Loaded Inbound": 307981}, {"dt": "2013-08-01T00:00:00", "Loaded Inbound": 327817}, {"dt": "2013-07-01T00:00:00", "Loaded Inbound": 294926}, {"dt": "2013-06-01T00:00:00", "Loaded Inbound": 290448}, {"dt": "2013-05-01T00:00:00", "Loaded Inbound": 305498}, {"dt": "2013-04-01T00:00:00", "Loaded Inbound": 264337}, {"dt": "2013-03-01T00:00:00", "Loaded Inbound": 224913}, {"dt": "2013-02-01T00:00:00", "Loaded Inbound": 279144}, {"dt": "2013-01-01T00:00:00", "Loaded Inbound": 273918}, {"dt": "2012-12-01T00:00:00", "Loaded Inbound": 295579}, {"dt": "2012-11-01T00:00:00", "Loaded Inbound": 278534}, {"dt": "2012-10-01T00:00:00", "Loaded Inbound": 276698}, {"dt": "2012-09-01T00:00:00", "Loaded Inbound": 265102}, {"dt": "2012-08-01T00:00:00", "Loaded Inbound": 274977}, {"dt": "2012-07-01T00:00:00", "Loaded Inbound": 261233}, {"dt": "2012-06-01T00:00:00", "Loaded Inbound": 280526}, {"dt": "2012-05-01T00:00:00", "Loaded Inbound": 249937}, {"dt": "2012-04-01T00:00:00", "Loaded Inbound": 232963}, {"dt": "2012-03-01T00:00:00", "Loaded Inbound": 226141}, {"dt": "2012-02-01T00:00:00", "Loaded Inbound": 191475}, {"dt": "2012-01-01T00:00:00", "Loaded Inbound": 229125}, {"dt": "2011-12-01T00:00:00", "Loaded Inbound": 248609}, {"dt": "2011-11-01T00:00:00", "Loaded Inbound": 231749}, {"dt": "2011-10-01T00:00:00", "Loaded Inbound": 240248}, {"dt": "2011-09-01T00:00:00", "Loaded Inbound": 263214}, {"dt": "2011-08-01T00:00:00", "Loaded Inbound": 267198}, {"dt": "2011-07-01T00:00:00", "Loaded Inbound": 290314}, {"dt": "2011-06-01T00:00:00", "Loaded Inbound": 271113}, {"dt": "2011-05-01T00:00:00", "Loaded Inbound": 275100}, {"dt": "2011-04-01T00:00:00", "Loaded Inbound": 270107}, {"dt": "2011-03-01T00:00:00", "Loaded Inbound": 191211}, {"dt": "2011-02-01T00:00:00", "Loaded Inbound": 233660}, {"dt": "2011-01-01T00:00:00", "Loaded Inbound": 242445}, {"dt": "2010-12-01T00:00:00", "Loaded Inbound": 256889}, {"dt": "2010-11-01T00:00:00", "Loaded Inbound": 274480}, {"dt": "2010-10-01T00:00:00", "Loaded Inbound": 303168}, {"dt": "2010-09-01T00:00:00", "Loaded Inbound": 288905}, {"dt": "2010-08-01T00:00:00", "Loaded Inbound": 311240}, {"dt": "2010-07-01T00:00:00", "Loaded Inbound": 293878}, {"dt": "2010-06-01T00:00:00", "Loaded Inbound": 262053}, {"dt": "2010-05-01T00:00:00", "Loaded Inbound": 264505}, {"dt": "2010-04-01T00:00:00", "Loaded Inbound": 241245}, {"dt": "2010-03-01T00:00:00", "Loaded Inbound": 206652}, {"dt": "2010-02-01T00:00:00", "Loaded Inbound": 207920}, {"dt": "2010-01-01T00:00:00", "Loaded Inbound": 217925}, {"dt": "2009-12-01T00:00:00", "Loaded Inbound": 232586}, {"dt": "2009-11-01T00:00:00", "Loaded Inbound": 228347}, {"dt": "2009-10-01T00:00:00", "Loaded Inbound": 227064}, {"dt": "2009-09-01T00:00:00", "Loaded Inbound": 224924}, {"dt": "2009-08-01T00:00:00", "Loaded Inbound": 249920}, {"dt": "2009-07-01T00:00:00", "Loaded Inbound": 221719}, {"dt": "2009-06-01T00:00:00", "Loaded Inbound": 206358}, {"dt": "2009-05-01T00:00:00", "Loaded Inbound": 208590}, {"dt": "2009-04-01T00:00:00", "Loaded Inbound": 199051}, {"dt": "2009-03-01T00:00:00", "Loaded Inbound": 186450}, {"dt": "2009-02-01T00:00:00", "Loaded Inbound": 149299}, {"dt": "2009-01-01T00:00:00", "Loaded Inbound": 200588}, {"dt": "2008-12-01T00:00:00", "Loaded Inbound": 205031}, {"dt": "2008-11-01T00:00:00", "Loaded Inbound": 267840}, {"dt": "2008-10-01T00:00:00", "Loaded Inbound": 292456}, {"dt": "2008-09-01T00:00:00", "Loaded Inbound": 279137}, {"dt": "2008-08-01T00:00:00", "Loaded Inbound": 283174}, {"dt": "2008-07-01T00:00:00", "Loaded Inbound": 272350}, {"dt": "2008-06-01T00:00:00", "Loaded Inbound": 288339}, {"dt": "2008-05-01T00:00:00", "Loaded Inbound": 267381}, {"dt": "2008-04-01T00:00:00", "Loaded Inbound": 280553}, {"dt": "2008-03-01T00:00:00", "Loaded Inbound": 228328}, {"dt": "2008-02-01T00:00:00", "Loaded Inbound": 263231}, {"dt": "2008-01-01T00:00:00", "Loaded Inbound": 261543}, {"dt": "2007-12-01T00:00:00", "Loaded Inbound": 280482}, {"dt": "2007-11-01T00:00:00", "Loaded Inbound": 310068}, {"dt": "2007-10-01T00:00:00", "Loaded Inbound": 323131}, {"dt": "2007-09-01T00:00:00", "Loaded Inbound": 331507}, {"dt": "2007-08-01T00:00:00", "Loaded Inbound": 326646}, {"dt": "2007-07-01T00:00:00", "Loaded Inbound": 332402}, {"dt": "2007-06-01T00:00:00", "Loaded Inbound": 339411}, {"dt": "2007-05-01T00:00:00", "Loaded Inbound": 316666}, {"dt": "2007-04-01T00:00:00", "Loaded Inbound": 303138}, {"dt": "2007-03-01T00:00:00", "Loaded Inbound": 252998}, {"dt": "2007-02-01T00:00:00", "Loaded Inbound": 284800}, {"dt": "2007-01-01T00:00:00", "Loaded Inbound": 303344}, {"dt": "2006-12-01T00:00:00", "Loaded Inbound": 282726}, {"dt": "2006-11-01T00:00:00", "Loaded Inbound": 332806}, {"dt": "2006-10-01T00:00:00", "Loaded Inbound": 335688}, {"dt": "2006-09-01T00:00:00", "Loaded Inbound": 317661}, {"dt": "2006-08-01T00:00:00", "Loaded Inbound": 347829}, {"dt": "2006-07-01T00:00:00", "Loaded Inbound": 305117}, {"dt": "2006-06-01T00:00:00", "Loaded Inbound": 319737}, {"dt": "2006-05-01T00:00:00", "Loaded Inbound": 328314}, {"dt": "2006-04-01T00:00:00", "Loaded Inbound": 321044}, {"dt": "2006-03-01T00:00:00", "Loaded Inbound": 282440}, {"dt": "2006-02-01T00:00:00", "Loaded Inbound": 252463}, {"dt": "2006-01-01T00:00:00", "Loaded Inbound": 293855}, {"dt": "2005-12-01T00:00:00", "Loaded Inbound": 266358}, {"dt": "2005-11-01T00:00:00", "Loaded Inbound": 305065}, {"dt": "2005-10-01T00:00:00", "Loaded Inbound": 299203}, {"dt": "2005-09-01T00:00:00", "Loaded Inbound": 313460}, {"dt": "2005-08-01T00:00:00", "Loaded Inbound": 306124}, {"dt": "2005-07-01T00:00:00", "Loaded Inbound": 289518}, {"dt": "2005-06-01T00:00:00", "Loaded Inbound": 294252}, {"dt": "2005-05-01T00:00:00", "Loaded Inbound": 288031}, {"dt": "2005-04-01T00:00:00", "Loaded Inbound": 270920}, {"dt": "2005-03-01T00:00:00", "Loaded Inbound": 210093}, {"dt": "2005-02-01T00:00:00", "Loaded Inbound": 250245}, {"dt": "2005-01-01T00:00:00", "Loaded Inbound": 252785}, {"dt": "2004-12-01T00:00:00", "Loaded Inbound": 269495}, {"dt": "2004-11-01T00:00:00", "Loaded Inbound": 295717}, {"dt": "2004-10-01T00:00:00", "Loaded Inbound": 288590}, {"dt": "2004-09-01T00:00:00", "Loaded Inbound": 255592}, {"dt": "2004-08-01T00:00:00", "Loaded Inbound": 274914}, {"dt": "2004-07-01T00:00:00", "Loaded Inbound": 281817}, {"dt": "2004-06-01T00:00:00", "Loaded Inbound": 260752}, {"dt": "2004-05-01T00:00:00", "Loaded Inbound": 242910}, {"dt": "2004-04-01T00:00:00", "Loaded Inbound": 227046}, {"dt": "2004-03-01T00:00:00", "Loaded Inbound": 235500}, {"dt": "2004-02-01T00:00:00", "Loaded Inbound": 153995}, {"dt": "2004-01-01T00:00:00", "Loaded Inbound": 201652}, {"dt": "2003-12-01T00:00:00", "Loaded Inbound": 210094}, {"dt": "2003-11-01T00:00:00", "Loaded Inbound": 216379}, {"dt": "2003-10-01T00:00:00", "Loaded Inbound": 230527}, {"dt": "2003-09-01T00:00:00", "Loaded Inbound": 206315}, {"dt": "2003-08-01T00:00:00", "Loaded Inbound": 206910}, {"dt": "2003-07-01T00:00:00", "Loaded Inbound": 231118}, {"dt": "2003-06-01T00:00:00", "Loaded Inbound": 204344}, {"dt": "2003-05-01T00:00:00", "Loaded Inbound": 196565}, {"dt": "2003-04-01T00:00:00", "Loaded Inbound": 200476}, {"dt": "2003-03-01T00:00:00", "Loaded Inbound": 179800}, {"dt": "2003-02-01T00:00:00", "Loaded Inbound": 158863}, {"dt": "2003-01-01T00:00:00", "Loaded Inbound": 168186}, {"dt": "2002-12-01T00:00:00", "Loaded Inbound": 186243}, {"dt": "2002-11-01T00:00:00", "Loaded Inbound": 179463}, {"dt": "2002-10-01T00:00:00", "Loaded Inbound": 163776}, {"dt": "2002-09-01T00:00:00", "Loaded Inbound": 188874}, {"dt": "2002-08-01T00:00:00", "Loaded Inbound": 234592}, {"dt": "2002-07-01T00:00:00", "Loaded Inbound": 249618}, {"dt": "2002-06-01T00:00:00", "Loaded Inbound": 236112}, {"dt": "2002-05-01T00:00:00", "Loaded Inbound": 231382}, {"dt": "2002-04-01T00:00:00", "Loaded Inbound": 227953}, {"dt": "2002-03-01T00:00:00", "Loaded Inbound": 171874}, {"dt": "2002-02-01T00:00:00", "Loaded Inbound": 202276}, {"dt": "2002-01-01T00:00:00", "Loaded Inbound": 180528}, {"dt": "2001-12-01T00:00:00", "Loaded Inbound": 191584}, {"dt": "2001-11-01T00:00:00", "Loaded Inbound": 193861}, {"dt": "2001-10-01T00:00:00", "Loaded Inbound": 238185}, {"dt": "2001-09-01T00:00:00", "Loaded Inbound": 220204}, {"dt": "2001-08-01T00:00:00", "Loaded Inbound": 221492}, {"dt": "2001-07-01T00:00:00", "Loaded Inbound": 208179}, {"dt": "2001-06-01T00:00:00", "Loaded Inbound": 202988}, {"dt": "2001-05-01T00:00:00", "Loaded Inbound": 196120}, {"dt": "2001-04-01T00:00:00", "Loaded Inbound": 202575}, {"dt": "2001-03-01T00:00:00", "Loaded Inbound": 195605}, {"dt": "2001-02-01T00:00:00", "Loaded Inbound": 155148}, {"dt": "2001-01-01T00:00:00", "Loaded Inbound": 194738}, {"dt": "2000-12-01T00:00:00", "Loaded Inbound": 180631}, {"dt": "2000-11-01T00:00:00", "Loaded Inbound": 213065}, {"dt": "2000-10-01T00:00:00", "Loaded Inbound": 235511}, {"dt": "2000-09-01T00:00:00", "Loaded Inbound": 208880}, {"dt": "2000-08-01T00:00:00", "Loaded Inbound": 236969}, {"dt": "2000-07-01T00:00:00", "Loaded Inbound": 224865}, {"dt": "2000-06-01T00:00:00", "Loaded Inbound": 203004}, {"dt": "2000-05-01T00:00:00", "Loaded Inbound": 218016}, {"dt": "2000-04-01T00:00:00", "Loaded Inbound": 200724}, {"dt": "2000-03-01T00:00:00", "Loaded Inbound": 178489}, {"dt": "2000-02-01T00:00:00", "Loaded Inbound": 177362}, {"dt": "2000-01-01T00:00:00", "Loaded Inbound": 178672}, {"dt": "1999-12-01T00:00:00", "Loaded Inbound": 185572}, {"dt": "1999-11-01T00:00:00", "Loaded Inbound": 209444}, {"dt": "1999-10-01T00:00:00", "Loaded Inbound": 204242}, {"dt": "1999-09-01T00:00:00", "Loaded Inbound": 219080}, {"dt": "1999-08-01T00:00:00", "Loaded Inbound": 214709}, {"dt": "1999-07-01T00:00:00", "Loaded Inbound": 188586}, {"dt": "1999-06-01T00:00:00", "Loaded Inbound": 194410}, {"dt": "1999-05-01T00:00:00", "Loaded Inbound": 205640}, {"dt": "1999-04-01T00:00:00", "Loaded Inbound": 181575}, {"dt": "1999-03-01T00:00:00", "Loaded Inbound": 171913}, {"dt": "1999-02-01T00:00:00", "Loaded Inbound": 172482}, {"dt": "1999-01-01T00:00:00", "Loaded Inbound": 169397}, {"dt": "1998-12-01T00:00:00", "Loaded Inbound": 166532}, {"dt": "1998-11-01T00:00:00", "Loaded Inbound": 192661}, {"dt": "1998-10-01T00:00:00", "Loaded Inbound": 180719}, {"dt": "1998-09-01T00:00:00", "Loaded Inbound": 198945}, {"dt": "1998-08-01T00:00:00", "Loaded Inbound": 195413}, {"dt": "1998-07-01T00:00:00", "Loaded Inbound": 199138}, {"dt": "1998-06-01T00:00:00", "Loaded Inbound": 183019}, {"dt": "1998-05-01T00:00:00", "Loaded Inbound": 163640}, {"dt": "1998-04-01T00:00:00", "Loaded Inbound": 172247}, {"dt": "1998-03-01T00:00:00", "Loaded Inbound": 167712}, {"dt": "1998-02-01T00:00:00", "Loaded Inbound": 132117}, {"dt": "1998-01-01T00:00:00", "Loaded Inbound": 144758}, {"dt": "1997-12-01T00:00:00", "Loaded Inbound": 145840}, {"dt": "1997-11-01T00:00:00", "Loaded Inbound": 146354}, {"dt": "1997-10-01T00:00:00", "Loaded Inbound": 169995}, {"dt": "1997-09-01T00:00:00", "Loaded Inbound": 183914}, {"dt": "1997-08-01T00:00:00", "Loaded Inbound": 160215}, {"dt": "1997-07-01T00:00:00", "Loaded Inbound": 169964}, {"dt": "1997-06-01T00:00:00", "Loaded Inbound": 165763}, {"dt": "1997-05-01T00:00:00", "Loaded Inbound": 143330}, {"dt": "1997-04-01T00:00:00", "Loaded Inbound": 146110}, {"dt": "1997-03-01T00:00:00", "Loaded Inbound": 125040}, {"dt": "1997-02-01T00:00:00", "Loaded Inbound": 126804}, {"dt": "1997-01-01T00:00:00", "Loaded Inbound": 123456}, {"dt": "1996-12-01T00:00:00", "Loaded Inbound": 133087}, {"dt": "1996-11-01T00:00:00", "Loaded Inbound": 125971}, {"dt": "1996-10-01T00:00:00", "Loaded Inbound": 150796}, {"dt": "1996-09-01T00:00:00", "Loaded Inbound": 147405}, {"dt": "1996-08-01T00:00:00", "Loaded Inbound": 139554}, {"dt": "1996-07-01T00:00:00", "Loaded Inbound": 146839}, {"dt": "1996-06-01T00:00:00", "Loaded Inbound": 132419}, {"dt": "1996-05-01T00:00:00", "Loaded Inbound": 120002}, {"dt": "1996-04-01T00:00:00", "Loaded Inbound": 127583}, {"dt": "1996-03-01T00:00:00", "Loaded Inbound": 101338}, {"dt": "1996-02-01T00:00:00", "Loaded Inbound": 113349}, {"dt": "1996-01-01T00:00:00", "Loaded Inbound": 109235}, {"dt": "1995-12-01T00:00:00", "Loaded Inbound": 104146}, {"dt": "1995-11-01T00:00:00", "Loaded Inbound": 109200}, {"dt": "1995-10-01T00:00:00", "Loaded Inbound": 134836}, {"dt": "1995-09-01T00:00:00", "Loaded Inbound": 114541}, {"dt": "1995-08-01T00:00:00", "Loaded Inbound": 127944}, {"dt": "1995-07-01T00:00:00", "Loaded Inbound": 127008}, {"dt": "1995-06-01T00:00:00", "Loaded Inbound": 113419}, {"dt": "1995-05-01T00:00:00", "Loaded Inbound": 113688}, {"dt": "1995-04-01T00:00:00", "Loaded Inbound": 110518}, {"dt": "1995-03-01T00:00:00", "Loaded Inbound": 94125}, {"dt": "1995-02-01T00:00:00", "Loaded Inbound": 99121}, {"dt": "1995-01-01T00:00:00", "Loaded Inbound": 104774}, {"dt": "1994-12-01T00:00:00", "Loaded Inbound": 107225}, {"dt": "1994-11-01T00:00:00", "Loaded Inbound": 113356}, {"dt": "1994-10-01T00:00:00", "Loaded Inbound": 130606}, {"dt": "1994-09-01T00:00:00", "Loaded Inbound": 107289}, {"dt": "1994-08-01T00:00:00", "Loaded Inbound": 120672}, {"dt": "1994-07-01T00:00:00", "Loaded Inbound": 119556}, {"dt": "1994-06-01T00:00:00", "Loaded Inbound": 107018}, {"dt": "1994-05-01T00:00:00", "Loaded Inbound": 110543}, {"dt": "1994-04-01T00:00:00", "Loaded Inbound": 88647}, {"dt": "1994-03-01T00:00:00", "Loaded Inbound": 89796}, {"dt": "1994-02-01T00:00:00", "Loaded Inbound": 85334}, {"dt": "1994-01-01T00:00:00", "Loaded Inbound": 92327}, {"dt": "1993-12-01T00:00:00", "Loaded Inbound": 85506}, {"dt": "1993-11-01T00:00:00", "Loaded Inbound": 100112}, {"dt": "1993-10-01T00:00:00", "Loaded Inbound": 102581}, {"dt": "1993-09-01T00:00:00", "Loaded Inbound": 99659}, {"dt": "1993-08-01T00:00:00", "Loaded Inbound": 109768}, {"dt": "1993-07-01T00:00:00", "Loaded Inbound": 90361}, {"dt": "1993-06-01T00:00:00", "Loaded Inbound": 88282}, {"dt": "1993-05-01T00:00:00", "Loaded Inbound": 84150}, {"dt": "1993-04-01T00:00:00", "Loaded Inbound": 74272}, {"dt": "1993-03-01T00:00:00", "Loaded Inbound": 84445}, {"dt": "1993-02-01T00:00:00", "Loaded Inbound": 60213}, {"dt": "1993-01-01T00:00:00", "Loaded Inbound": 69508}, {"dt": "1992-12-01T00:00:00", "Loaded Inbound": 75584}, {"dt": "1992-11-01T00:00:00", "Loaded Inbound": 75415}, {"dt": "1992-10-01T00:00:00", "Loaded Inbound": 83401}, {"dt": "1992-09-01T00:00:00", "Loaded Inbound": 83697}, {"dt": "1992-08-01T00:00:00", "Loaded Inbound": 78129}, {"dt": "1992-07-01T00:00:00", "Loaded Inbound": 80306}, {"dt": "1992-06-01T00:00:00", "Loaded Inbound": 81134}, {"dt": "1992-05-01T00:00:00", "Loaded Inbound": 70798}, {"dt": "1992-04-01T00:00:00", "Loaded Inbound": 70929}, {"dt": "1992-03-01T00:00:00", "Loaded Inbound": 74886}, {"dt": "1992-02-01T00:00:00", "Loaded Inbound": 66700}, {"dt": "1992-01-01T00:00:00", "Loaded Inbound": 72396}, {"dt": "1991-12-01T00:00:00", "Loaded Inbound": 73207}, {"dt": "1991-11-01T00:00:00", "Loaded Inbound": 79954}, {"dt": "1991-10-01T00:00:00", "Loaded Inbound": 99992}, {"dt": "1991-09-01T00:00:00", "Loaded Inbound": 79301}, {"dt": "1991-08-01T00:00:00", "Loaded Inbound": 75292}, {"dt": "1991-07-01T00:00:00", "Loaded Inbound": 89778}, {"dt": "1991-06-01T00:00:00", "Loaded Inbound": 74143}, {"dt": "1991-05-01T00:00:00", "Loaded Inbound": 88517}, {"dt": "1991-04-01T00:00:00", "Loaded Inbound": 69988}, {"dt": "1991-03-01T00:00:00", "Loaded Inbound": 56791}, {"dt": "1991-02-01T00:00:00", "Loaded Inbound": 62427}, {"dt": "1991-01-01T00:00:00", "Loaded Inbound": 63739}, {"dt": "1990-12-01T00:00:00", "Loaded Inbound": 60298}, {"dt": "1990-11-01T00:00:00", "Loaded Inbound": 64429}, {"dt": "1990-10-01T00:00:00", "Loaded Inbound": 80234}, {"dt": "1990-09-01T00:00:00", "Loaded Inbound": 66431}, {"dt": "1990-08-01T00:00:00", "Loaded Inbound": 72065}, {"dt": "1990-07-01T00:00:00", "Loaded Inbound": 75135}, {"dt": "1990-06-01T00:00:00", "Loaded Inbound": 66149}, {"dt": "1990-05-01T00:00:00", "Loaded Inbound": 71665}, {"dt": "1990-04-01T00:00:00", "Loaded Inbound": 65114}, {"dt": "1990-03-01T00:00:00", "Loaded Inbound": 63278}, {"dt": "1990-02-01T00:00:00", "Loaded Inbound": 57542}, {"dt": "1990-01-01T00:00:00", "Loaded Inbound": 71890}, {"dt": "1989-12-01T00:00:00", "Loaded Inbound": 63877}, {"dt": "1989-11-01T00:00:00", "Loaded Inbound": 77742}, {"dt": "1989-10-01T00:00:00", "Loaded Inbound": 75310}, {"dt": "1989-09-01T00:00:00", "Loaded Inbound": 65062}, {"dt": "1989-08-01T00:00:00", "Loaded Inbound": 80138}, {"dt": "1989-07-01T00:00:00", "Loaded Inbound": 67663}, {"dt": "1989-06-01T00:00:00", "Loaded Inbound": 62437}, {"dt": "1989-05-01T00:00:00", "Loaded Inbound": 69481}, {"dt": "1989-04-01T00:00:00", "Loaded Inbound": 54290}, {"dt": "1989-03-01T00:00:00", "Loaded Inbound": 56629}, {"dt": "1989-02-01T00:00:00", "Loaded Inbound": 55946}, {"dt": "1989-01-01T00:00:00", "Loaded Inbound": 62071}, {"dt": "1988-12-01T00:00:00", "Loaded Inbound": 64214}, {"dt": "1988-11-01T00:00:00", "Loaded Inbound": 73393}, {"dt": "1988-10-01T00:00:00", "Loaded Inbound": 65134}, {"dt": "1988-09-01T00:00:00", "Loaded Inbound": 64664}, {"dt": "1988-08-01T00:00:00", "Loaded Inbound": 76832}, {"dt": "1988-07-01T00:00:00", "Loaded Inbound": 67196}, {"dt": "1988-06-01T00:00:00", "Loaded Inbound": 67016}, {"dt": "1988-05-01T00:00:00", "Loaded Inbound": 62641}, {"dt": "1988-04-01T00:00:00", "Loaded Inbound": 54212}, {"dt": "1988-03-01T00:00:00", "Loaded Inbound": 61287}, {"dt": "1988-02-01T00:00:00", "Loaded Inbound": 58229}, {"dt": "1988-01-01T00:00:00", "Loaded Inbound": 61545}, {"dt": "1987-12-01T00:00:00", "Loaded Inbound": 55341}, {"dt": "1987-11-01T00:00:00", "Loaded Inbound": 63805}, {"dt": "1987-10-01T00:00:00", "Loaded Inbound": 65637}, {"dt": "1987-09-01T00:00:00", "Loaded Inbound": 67801}, {"dt": "1987-08-01T00:00:00", "Loaded Inbound": 66848}, {"dt": "1987-07-01T00:00:00", "Loaded Inbound": 64843}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Port-of-New-York-/-New-Jersey">Port of New York / New Jersey<a class="anchor-link" href="#Port-of-New-York-/-New-Jersey">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataUrl</span> <span class="o">=</span> <span class="s2">&quot;https://www.panynj.gov/content/port/en.model.json&quot;</span>

<span class="c1">#jqPath = &#39;\&#39;.&quot;:children&quot;.&quot;/port/en/our-port/facts-and-figures&quot;.&quot;:items&quot;.&quot;root&quot;.&quot;:items&quot;.&quot;responsivegrid&quot;.&quot;:items&quot;.&quot;accordionlist_435572874&quot;.&quot;:items&quot;\&#39;&#39;</span>
    
<span class="k">def</span> <span class="nf">doNynjFetch</span><span class="p">(</span><span class="n">retries</span> <span class="o">=</span> <span class="mi">5</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">retries</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">loads</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">dataUrl</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span> <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="n">uaString</span> <span class="p">})</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>

        <span class="n">dict_data</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

        <span class="n">r</span> <span class="o">=</span> <span class="n">dict_data</span><span class="p">[</span><span class="s2">&quot;:children&quot;</span><span class="p">]</span>\
                     <span class="p">[</span><span class="s2">&quot;/port/en/our-port/facts-and-figures&quot;</span><span class="p">]</span>\
                     <span class="p">[</span><span class="s2">&quot;:items&quot;</span><span class="p">]</span>\
                     <span class="p">[</span><span class="s2">&quot;root&quot;</span><span class="p">]</span>\
                     <span class="p">[</span><span class="s2">&quot;:items&quot;</span><span class="p">]</span>\
                     <span class="p">[</span><span class="s2">&quot;responsivegrid&quot;</span><span class="p">]</span>\
                     <span class="p">[</span><span class="s2">&quot;:items&quot;</span><span class="p">]</span>\
                     <span class="p">[</span><span class="s2">&quot;accordionlist_435572874&quot;</span><span class="p">]</span>\
                     <span class="p">[</span><span class="s2">&quot;:items&quot;</span><span class="p">]</span>
        
        <span class="k">return</span> <span class="n">r</span>
    <span class="k">except</span> <span class="n">JSONDecodeError</span><span class="p">:</span>
        <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">doNynjFetch</span><span class="p">(</span><span class="n">retries</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">nynj_dict_content</span> <span class="o">=</span> <span class="n">doNynjFetch</span><span class="p">()</span>
    
<span class="n">post2011Cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Import Loads&#39;</span><span class="p">,</span> <span class="s1">&#39;Import Empties&#39;</span><span class="p">,</span> <span class="s1">&#39;Export Loads&#39;</span><span class="p">,</span> <span class="s1">&#39;Export Empties&#39;</span><span class="p">,</span> <span class="s1">&#39;Total Loads&#39;</span><span class="p">,</span> <span class="s1">&#39;Total Empties&#39;</span><span class="p">,</span> <span class="s1">&#39;Total TEUs&#39;</span><span class="p">,</span> <span class="s1">&#39;Total Rail Lifts&#39;</span><span class="p">]</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Import TEUs&quot;</span><span class="p">,</span> <span class="s2">&quot;Export TEUs&quot;</span><span class="p">,</span> <span class="s2">&quot;Total TEUs&quot;</span><span class="p">,</span> <span class="s2">&quot;Total Rail Lifts&quot;</span><span class="p">]</span>

<span class="n">currentYear</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">year</span>

<span class="n">dfs_nynj</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">nynj_dict_content</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
    <span class="n">year</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;linkAriaLabel&quot;</span><span class="p">]</span>
    <span class="c1">#print(year)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s2">&quot;:items&quot;</span><span class="p">][</span><span class="s2">&quot;text&quot;</span><span class="p">][</span><span class="s2">&quot;text&quot;</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="c1"># text_copy</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s2">&quot;:items&quot;</span><span class="p">][</span><span class="s2">&quot;text_copy&quot;</span><span class="p">][</span><span class="s2">&quot;text&quot;</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">monthData</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tmp</span><span class="p">):</span>
        <span class="c1"># skip the YTD section</span>
        <span class="c1">#if n &lt; 2:</span>
        <span class="c1">#    continue</span>
        
        <span class="n">mtmp</span> <span class="o">=</span> <span class="n">monthData</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">mtmp</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Period&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">post2011Cols</span>
            
            <span class="c1"># cleanup types before doing math</span>
            <span class="n">mtmp</span><span class="p">[</span><span class="n">post2011Cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">mtmp</span><span class="p">[</span><span class="n">post2011Cols</span><span class="p">]</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;[^0-9.]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)))</span>
            <span class="n">mtmp</span><span class="p">[</span><span class="n">post2011Cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">mtmp</span><span class="p">[</span><span class="n">post2011Cols</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">))</span>
            
            <span class="n">mtmp</span><span class="p">[</span><span class="s1">&#39;Import TEUs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mtmp</span><span class="p">[</span><span class="s1">&#39;Import Loads&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">mtmp</span><span class="p">[</span><span class="s1">&#39;Import Empties&#39;</span><span class="p">]</span>
            <span class="n">mtmp</span><span class="p">[</span><span class="s1">&#39;Export TEUs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mtmp</span><span class="p">[</span><span class="s1">&#39;Export Loads&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">mtmp</span><span class="p">[</span><span class="s1">&#39;Export Empties&#39;</span><span class="p">]</span>
            
            <span class="c1"># Monthy is shown Dec-&gt;Jan after 2014, Jan-&gt;Dec before 2014 (and for 2020)</span>
            <span class="n">index</span> <span class="o">=</span> <span class="mi">13</span><span class="o">-</span><span class="n">n</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2014</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">!=</span> <span class="n">currentYear</span> <span class="k">else</span> <span class="n">n</span>
            <span class="n">mtmp</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mtmp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">v</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%m-%Y&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">mtmp</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Period&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">cols</span>
            <span class="n">mtmp</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mtmp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%B %y&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">))</span>
        
            <span class="n">mtmp</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">mtmp</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;[^0-9.]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)))</span>
            <span class="n">mtmp</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">mtmp</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">))</span>
        
        <span class="n">dfs_nynj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mtmp</span><span class="p">)</span>

<span class="n">commonFields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Period&#39;</span><span class="p">,</span> <span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="s1">&#39;Import TEUs&#39;</span><span class="p">,</span> <span class="s1">&#39;Export TEUs&#39;</span><span class="p">,</span> <span class="s1">&#39;Total TEUs&#39;</span><span class="p">]</span>

<span class="n">df_nynj</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dfs_nynj</span><span class="p">)[</span><span class="n">commonFields</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span> <span class="c1">#.tail(30)</span>

<span class="n">df_nynj</span> <span class="o">=</span> <span class="n">df_nynj</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;dt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span> <span class="c1">#.head()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_nynj</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(),</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;New York/New Jersey&quot;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;Import TEUs&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[15]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-4eb2d512c19c40ce8047dc53f487efa5"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-4eb2d512c19c40ce8047dc53f487efa5") {
      outputDiv = document.getElementById("altair-viz-4eb2d512c19c40ce8047dc53f487efa5");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector009"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of New York/New Jersey Import TEUs Container Volume", "transform": [{"window": [{"op": "lag", "field": "Import TEUs", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Import TEUs'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Import TEUs"}}, "height": 100, "selection": {"selector009": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-28951b9b7ddbf5d06b006d8962b6fab7"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-28951b9b7ddbf5d06b006d8962b6fab7": [{"dt": "2005-01-01T00:00:00", "Import TEUs": 191242.0}, {"dt": "2005-02-01T00:00:00", "Import TEUs": 179210.0}, {"dt": "2005-03-01T00:00:00", "Import TEUs": 194984.0}, {"dt": "2005-04-01T00:00:00", "Import TEUs": 184573.0}, {"dt": "2005-05-01T00:00:00", "Import TEUs": 211414.0}, {"dt": "2005-06-01T00:00:00", "Import TEUs": 202916.0}, {"dt": "2005-07-01T00:00:00", "Import TEUs": 211764.0}, {"dt": "2005-08-01T00:00:00", "Import TEUs": 199437.0}, {"dt": "2005-09-01T00:00:00", "Import TEUs": 205132.0}, {"dt": "2005-10-01T00:00:00", "Import TEUs": 216593.0}, {"dt": "2005-11-01T00:00:00", "Import TEUs": 213802.0}, {"dt": "2005-12-01T00:00:00", "Import TEUs": 197055.0}, {"dt": "2006-01-01T00:00:00", "Import TEUs": 196328.5}, {"dt": "2006-02-01T00:00:00", "Import TEUs": 177956.5}, {"dt": "2006-03-01T00:00:00", "Import TEUs": 203648.5}, {"dt": "2006-04-01T00:00:00", "Import TEUs": 219230.5}, {"dt": "2006-05-01T00:00:00", "Import TEUs": 215877.0}, {"dt": "2006-06-01T00:00:00", "Import TEUs": 226168.5}, {"dt": "2006-07-01T00:00:00", "Import TEUs": 222998.0}, {"dt": "2006-08-01T00:00:00", "Import TEUs": 226110.0}, {"dt": "2006-09-01T00:00:00", "Import TEUs": 217306.0}, {"dt": "2006-10-01T00:00:00", "Import TEUs": 228202.0}, {"dt": "2006-11-01T00:00:00", "Import TEUs": 212153.0}, {"dt": "2006-12-01T00:00:00", "Import TEUs": 208295.0}, {"dt": "2007-01-01T00:00:00", "Import TEUs": 190233.0}, {"dt": "2007-02-01T00:00:00", "Import TEUs": 192377.0}, {"dt": "2007-03-01T00:00:00", "Import TEUs": 233233.0}, {"dt": "2007-04-01T00:00:00", "Import TEUs": 190907.0}, {"dt": "2007-05-01T00:00:00", "Import TEUs": 218807.0}, {"dt": "2007-06-01T00:00:00", "Import TEUs": 235998.0}, {"dt": "2007-07-01T00:00:00", "Import TEUs": 230276.0}, {"dt": "2007-08-01T00:00:00", "Import TEUs": 245535.0}, {"dt": "2007-09-01T00:00:00", "Import TEUs": 235112.0}, {"dt": "2007-10-01T00:00:00", "Import TEUs": 224795.0}, {"dt": "2007-11-01T00:00:00", "Import TEUs": 213170.0}, {"dt": "2007-12-01T00:00:00", "Import TEUs": 209149.0}, {"dt": "2008-01-01T00:00:00", "Import TEUs": 199718.0}, {"dt": "2008-02-01T00:00:00", "Import TEUs": 194440.0}, {"dt": "2008-03-01T00:00:00", "Import TEUs": 203279.0}, {"dt": "2008-04-01T00:00:00", "Import TEUs": 202462.0}, {"dt": "2008-05-01T00:00:00", "Import TEUs": 210660.0}, {"dt": "2008-06-01T00:00:00", "Import TEUs": 221509.0}, {"dt": "2008-07-01T00:00:00", "Import TEUs": 229149.0}, {"dt": "2008-08-01T00:00:00", "Import TEUs": 227739.0}, {"dt": "2008-09-01T00:00:00", "Import TEUs": 238844.0}, {"dt": "2008-10-01T00:00:00", "Import TEUs": 230338.0}, {"dt": "2008-11-01T00:00:00", "Import TEUs": 204080.0}, {"dt": "2008-12-01T00:00:00", "Import TEUs": 186756.0}, {"dt": "2009-01-01T00:00:00", "Import TEUs": 176449.0}, {"dt": "2009-02-01T00:00:00", "Import TEUs": 169909.0}, {"dt": "2009-03-01T00:00:00", "Import TEUs": 167592.0}, {"dt": "2009-04-01T00:00:00", "Import TEUs": 170899.0}, {"dt": "2009-05-01T00:00:00", "Import TEUs": 182403.0}, {"dt": "2009-06-01T00:00:00", "Import TEUs": 186985.0}, {"dt": "2009-07-01T00:00:00", "Import TEUs": 207066.0}, {"dt": "2009-08-01T00:00:00", "Import TEUs": 209693.0}, {"dt": "2009-09-01T00:00:00", "Import TEUs": 203622.0}, {"dt": "2009-10-01T00:00:00", "Import TEUs": 206034.0}, {"dt": "2009-11-01T00:00:00", "Import TEUs": 191549.0}, {"dt": "2009-12-01T00:00:00", "Import TEUs": 172834.0}, {"dt": "2010-01-01T00:00:00", "Import TEUs": 185797.0}, {"dt": "2010-02-01T00:00:00", "Import TEUs": 173911.0}, {"dt": "2010-03-01T00:00:00", "Import TEUs": 204311.0}, {"dt": "2010-04-01T00:00:00", "Import TEUs": 197723.0}, {"dt": "2010-05-01T00:00:00", "Import TEUs": 222840.0}, {"dt": "2010-06-01T00:00:00", "Import TEUs": 222671.0}, {"dt": "2010-07-01T00:00:00", "Import TEUs": 251199.0}, {"dt": "2010-08-01T00:00:00", "Import TEUs": 244559.0}, {"dt": "2010-09-01T00:00:00", "Import TEUs": 225947.0}, {"dt": "2010-10-01T00:00:00", "Import TEUs": 232438.0}, {"dt": "2010-11-01T00:00:00", "Import TEUs": 214830.0}, {"dt": "2010-12-01T00:00:00", "Import TEUs": 202868.0}, {"dt": "2011-01-01T00:00:00", "Import TEUs": 219680.5}, {"dt": "2011-02-01T00:00:00", "Import TEUs": 209735.5}, {"dt": "2011-03-01T00:00:00", "Import TEUs": 211585.5}, {"dt": "2011-04-01T00:00:00", "Import TEUs": 220590.5}, {"dt": "2011-05-01T00:00:00", "Import TEUs": 234126.0}, {"dt": "2011-06-01T00:00:00", "Import TEUs": 225197.5}, {"dt": "2011-07-01T00:00:00", "Import TEUs": 239558.5}, {"dt": "2011-08-01T00:00:00", "Import TEUs": 246511.5}, {"dt": "2011-09-01T00:00:00", "Import TEUs": 245655.0}, {"dt": "2011-10-01T00:00:00", "Import TEUs": 226693.0}, {"dt": "2011-11-01T00:00:00", "Import TEUs": 230595.0}, {"dt": "2011-12-01T00:00:00", "Import TEUs": 214969.0}, {"dt": "2012-01-01T00:00:00", "Import TEUs": 233956.0}, {"dt": "2012-02-01T00:00:00", "Import TEUs": 228386.0}, {"dt": "2012-03-01T00:00:00", "Import TEUs": 217105.0}, {"dt": "2012-04-01T00:00:00", "Import TEUs": 230148.0}, {"dt": "2012-05-01T00:00:00", "Import TEUs": 246310.0}, {"dt": "2012-06-01T00:00:00", "Import TEUs": 244428.0}, {"dt": "2012-07-01T00:00:00", "Import TEUs": 261284.0}, {"dt": "2012-08-01T00:00:00", "Import TEUs": 261909.0}, {"dt": "2012-09-01T00:00:00", "Import TEUs": 242199.0}, {"dt": "2012-10-01T00:00:00", "Import TEUs": 202616.0}, {"dt": "2012-11-01T00:00:00", "Import TEUs": 229363.0}, {"dt": "2012-12-01T00:00:00", "Import TEUs": 220102.0}, {"dt": "2013-01-01T00:00:00", "Import TEUs": 220326.0}, {"dt": "2013-02-01T00:00:00", "Import TEUs": 206492.0}, {"dt": "2013-03-01T00:00:00", "Import TEUs": 218430.0}, {"dt": "2013-04-01T00:00:00", "Import TEUs": 219295.0}, {"dt": "2013-05-01T00:00:00", "Import TEUs": 247274.0}, {"dt": "2013-06-01T00:00:00", "Import TEUs": 231570.0}, {"dt": "2013-07-01T00:00:00", "Import TEUs": 253551.0}, {"dt": "2013-08-01T00:00:00", "Import TEUs": 266498.0}, {"dt": "2013-09-01T00:00:00", "Import TEUs": 237845.0}, {"dt": "2013-10-01T00:00:00", "Import TEUs": 258701.0}, {"dt": "2013-11-01T00:00:00", "Import TEUs": 213476.0}, {"dt": "2013-12-01T00:00:00", "Import TEUs": 230543.0}, {"dt": "2014-01-01T00:00:00", "Import TEUs": 234133.0}, {"dt": "2014-02-01T00:00:00", "Import TEUs": 208529.0}, {"dt": "2014-03-01T00:00:00", "Import TEUs": 235462.0}, {"dt": "2014-04-01T00:00:00", "Import TEUs": 231188.0}, {"dt": "2014-05-01T00:00:00", "Import TEUs": 250741.0}, {"dt": "2014-06-01T00:00:00", "Import TEUs": 243714.0}, {"dt": "2014-07-01T00:00:00", "Import TEUs": 269961.0}, {"dt": "2014-08-01T00:00:00", "Import TEUs": 271429.0}, {"dt": "2014-09-01T00:00:00", "Import TEUs": 253846.0}, {"dt": "2014-10-01T00:00:00", "Import TEUs": 275238.0}, {"dt": "2014-11-01T00:00:00", "Import TEUs": 242430.0}, {"dt": "2014-12-01T00:00:00", "Import TEUs": 252965.0}, {"dt": "2015-01-01T00:00:00", "Import TEUs": 237739.0}, {"dt": "2015-02-01T00:00:00", "Import TEUs": 241394.0}, {"dt": "2015-03-01T00:00:00", "Import TEUs": 288749.0}, {"dt": "2015-04-01T00:00:00", "Import TEUs": 252633.0}, {"dt": "2015-05-01T00:00:00", "Import TEUs": 284632.0}, {"dt": "2015-06-01T00:00:00", "Import TEUs": 281099.0}, {"dt": "2015-07-01T00:00:00", "Import TEUs": 298333.0}, {"dt": "2015-08-01T00:00:00", "Import TEUs": 287790.0}, {"dt": "2015-09-01T00:00:00", "Import TEUs": 288104.0}, {"dt": "2015-10-01T00:00:00", "Import TEUs": 271248.0}, {"dt": "2015-11-01T00:00:00", "Import TEUs": 250702.0}, {"dt": "2015-12-01T00:00:00", "Import TEUs": 255181.0}, {"dt": "2016-01-01T00:00:00", "Import TEUs": 249510.0}, {"dt": "2016-02-01T00:00:00", "Import TEUs": 261146.0}, {"dt": "2016-03-01T00:00:00", "Import TEUs": 255114.0}, {"dt": "2016-04-01T00:00:00", "Import TEUs": 247136.0}, {"dt": "2016-05-01T00:00:00", "Import TEUs": 270986.0}, {"dt": "2016-06-01T00:00:00", "Import TEUs": 273154.0}, {"dt": "2016-07-01T00:00:00", "Import TEUs": 276778.0}, {"dt": "2016-08-01T00:00:00", "Import TEUs": 306200.0}, {"dt": "2016-09-01T00:00:00", "Import TEUs": 256330.0}, {"dt": "2016-10-01T00:00:00", "Import TEUs": 291038.0}, {"dt": "2016-11-01T00:00:00", "Import TEUs": 274088.0}, {"dt": "2016-12-01T00:00:00", "Import TEUs": 267405.0}, {"dt": "2017-01-01T00:00:00", "Import TEUs": 262484.0}, {"dt": "2017-02-01T00:00:00", "Import TEUs": 264134.0}, {"dt": "2017-03-01T00:00:00", "Import TEUs": 251335.0}, {"dt": "2017-04-01T00:00:00", "Import TEUs": 281356.0}, {"dt": "2017-05-01T00:00:00", "Import TEUs": 285674.0}, {"dt": "2017-06-01T00:00:00", "Import TEUs": 296902.0}, {"dt": "2017-07-01T00:00:00", "Import TEUs": 293233.0}, {"dt": "2017-08-01T00:00:00", "Import TEUs": 322437.0}, {"dt": "2017-09-01T00:00:00", "Import TEUs": 289305.0}, {"dt": "2017-10-01T00:00:00", "Import TEUs": 307357.0}, {"dt": "2017-11-01T00:00:00", "Import TEUs": 287223.0}, {"dt": "2017-12-01T00:00:00", "Import TEUs": 275520.0}, {"dt": "2018-01-01T00:00:00", "Import TEUs": 310901.0}, {"dt": "2018-02-01T00:00:00", "Import TEUs": 275459.0}, {"dt": "2018-03-01T00:00:00", "Import TEUs": 290033.0}, {"dt": "2018-04-01T00:00:00", "Import TEUs": 273610.0}, {"dt": "2018-05-01T00:00:00", "Import TEUs": 303541.0}, {"dt": "2018-06-01T00:00:00", "Import TEUs": 312052.0}, {"dt": "2018-07-01T00:00:00", "Import TEUs": 323551.0}, {"dt": "2018-08-01T00:00:00", "Import TEUs": 335116.0}, {"dt": "2018-09-01T00:00:00", "Import TEUs": 305443.0}, {"dt": "2018-10-01T00:00:00", "Import TEUs": 340899.0}, {"dt": "2018-11-01T00:00:00", "Import TEUs": 303881.0}, {"dt": "2018-12-01T00:00:00", "Import TEUs": 318426.0}, {"dt": "2019-01-01T00:00:00", "Import TEUs": 328361.0}, {"dt": "2019-02-01T00:00:00", "Import TEUs": 296500.0}, {"dt": "2019-03-01T00:00:00", "Import TEUs": 284283.0}, {"dt": "2019-04-01T00:00:00", "Import TEUs": 299375.0}, {"dt": "2019-05-01T00:00:00", "Import TEUs": 341943.0}, {"dt": "2019-06-01T00:00:00", "Import TEUs": 303309.0}, {"dt": "2019-07-01T00:00:00", "Import TEUs": 338728.0}, {"dt": "2019-08-01T00:00:00", "Import TEUs": 344473.0}, {"dt": "2019-09-01T00:00:00", "Import TEUs": 317587.0}, {"dt": "2019-10-01T00:00:00", "Import TEUs": 340952.0}, {"dt": "2019-11-01T00:00:00", "Import TEUs": 302460.0}, {"dt": "2019-12-01T00:00:00", "Import TEUs": 290508.0}, {"dt": "2020-01-01T00:00:00", "Import TEUs": 324644.0}, {"dt": "2020-02-01T00:00:00", "Import TEUs": 301759.0}, {"dt": "2020-03-01T00:00:00", "Import TEUs": 273348.0}, {"dt": "2020-04-01T00:00:00", "Import TEUs": 285363.0}, {"dt": "2020-05-01T00:00:00", "Import TEUs": 267008.0}, {"dt": "2020-06-01T00:00:00", "Import TEUs": 266836.0}, {"dt": "2020-07-01T00:00:00", "Import TEUs": 328864.0}, {"dt": "2020-08-01T00:00:00", "Import TEUs": 368868.0}, {"dt": "2020-09-01T00:00:00", "Import TEUs": 376756.0}, {"dt": "2020-10-01T00:00:00", "Import TEUs": 405415.0}, {"dt": "2020-11-01T00:00:00", "Import TEUs": 386219.0}, {"dt": "2020-12-01T00:00:00", "Import TEUs": 361246.0}, {"dt": "2021-01-01T00:00:00", "Import TEUs": 354751.5}, {"dt": "2021-02-01T00:00:00", "Import TEUs": 354751.5}, {"dt": "2021-03-01T00:00:00", "Import TEUs": 395535.0}, {"dt": "2021-04-01T00:00:00", "Import TEUs": 361833.0}, {"dt": "2021-05-01T00:00:00", "Import TEUs": 398708.0}, {"dt": "2021-06-01T00:00:00", "Import TEUs": 388449.0}, {"dt": "2021-07-01T00:00:00", "Import TEUs": 396699.0}, {"dt": "2021-08-01T00:00:00", "Import TEUs": 401404.0}, {"dt": "2021-09-01T00:00:00", "Import TEUs": 381158.0}, {"dt": "2021-10-01T00:00:00", "Import TEUs": 401065.0}, {"dt": "2021-11-01T00:00:00", "Import TEUs": 384045.0}, {"dt": "2021-12-01T00:00:00", "Import TEUs": 395373.0}, {"dt": "2022-01-01T00:00:00", "Import TEUs": 386213.0}, {"dt": "2022-02-01T00:00:00", "Import TEUs": 399912.0}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_nynj</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(),</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;New York/New Jersey&quot;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;Export TEUs&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[16]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-eba21061f05347c09ae7955df73b14c7"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-eba21061f05347c09ae7955df73b14c7") {
      outputDiv = document.getElementById("altair-viz-eba21061f05347c09ae7955df73b14c7");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector010"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of New York/New Jersey Export TEUs Container Volume", "transform": [{"window": [{"op": "lag", "field": "Export TEUs", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Export TEUs'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Export TEUs"}}, "height": 100, "selection": {"selector010": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-3c6e354021477b78e166351a32c198ef"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-3c6e354021477b78e166351a32c198ef": [{"dt": "2005-01-01T00:00:00", "Export TEUs": 77692.0}, {"dt": "2005-02-01T00:00:00", "Export TEUs": 74099.0}, {"dt": "2005-03-01T00:00:00", "Export TEUs": 84574.0}, {"dt": "2005-04-01T00:00:00", "Export TEUs": 86723.0}, {"dt": "2005-05-01T00:00:00", "Export TEUs": 86475.0}, {"dt": "2005-06-01T00:00:00", "Export TEUs": 80582.0}, {"dt": "2005-07-01T00:00:00", "Export TEUs": 81790.0}, {"dt": "2005-08-01T00:00:00", "Export TEUs": 78994.0}, {"dt": "2005-09-01T00:00:00", "Export TEUs": 77699.0}, {"dt": "2005-10-01T00:00:00", "Export TEUs": 83920.0}, {"dt": "2005-11-01T00:00:00", "Export TEUs": 86622.0}, {"dt": "2005-12-01T00:00:00", "Export TEUs": 78713.0}, {"dt": "2006-01-01T00:00:00", "Export TEUs": 86985.5}, {"dt": "2006-02-01T00:00:00", "Export TEUs": 83982.0}, {"dt": "2006-03-01T00:00:00", "Export TEUs": 102531.0}, {"dt": "2006-04-01T00:00:00", "Export TEUs": 93565.5}, {"dt": "2006-05-01T00:00:00", "Export TEUs": 98012.5}, {"dt": "2006-06-01T00:00:00", "Export TEUs": 101994.5}, {"dt": "2006-07-01T00:00:00", "Export TEUs": 92502.0}, {"dt": "2006-08-01T00:00:00", "Export TEUs": 99962.5}, {"dt": "2006-09-01T00:00:00", "Export TEUs": 99752.5}, {"dt": "2006-10-01T00:00:00", "Export TEUs": 104896.0}, {"dt": "2006-11-01T00:00:00", "Export TEUs": 105095.0}, {"dt": "2006-12-01T00:00:00", "Export TEUs": 106049.0}, {"dt": "2007-01-01T00:00:00", "Export TEUs": 105311.0}, {"dt": "2007-02-01T00:00:00", "Export TEUs": 99725.0}, {"dt": "2007-03-01T00:00:00", "Export TEUs": 129066.0}, {"dt": "2007-04-01T00:00:00", "Export TEUs": 112554.0}, {"dt": "2007-05-01T00:00:00", "Export TEUs": 127051.0}, {"dt": "2007-06-01T00:00:00", "Export TEUs": 130257.0}, {"dt": "2007-07-01T00:00:00", "Export TEUs": 115576.0}, {"dt": "2007-08-01T00:00:00", "Export TEUs": 128799.0}, {"dt": "2007-09-01T00:00:00", "Export TEUs": 129445.0}, {"dt": "2007-10-01T00:00:00", "Export TEUs": 132851.0}, {"dt": "2007-11-01T00:00:00", "Export TEUs": 131951.0}, {"dt": "2007-12-01T00:00:00", "Export TEUs": 135317.0}, {"dt": "2008-01-01T00:00:00", "Export TEUs": 123021.0}, {"dt": "2008-02-01T00:00:00", "Export TEUs": 130287.0}, {"dt": "2008-03-01T00:00:00", "Export TEUs": 145569.0}, {"dt": "2008-04-01T00:00:00", "Export TEUs": 140235.0}, {"dt": "2008-05-01T00:00:00", "Export TEUs": 145170.0}, {"dt": "2008-06-01T00:00:00", "Export TEUs": 152286.0}, {"dt": "2008-07-01T00:00:00", "Export TEUs": 143869.0}, {"dt": "2008-08-01T00:00:00", "Export TEUs": 140949.0}, {"dt": "2008-09-01T00:00:00", "Export TEUs": 144034.0}, {"dt": "2008-10-01T00:00:00", "Export TEUs": 131009.0}, {"dt": "2008-11-01T00:00:00", "Export TEUs": 118296.0}, {"dt": "2008-12-01T00:00:00", "Export TEUs": 101515.0}, {"dt": "2009-01-01T00:00:00", "Export TEUs": 96314.0}, {"dt": "2009-02-01T00:00:00", "Export TEUs": 113233.0}, {"dt": "2009-03-01T00:00:00", "Export TEUs": 113236.0}, {"dt": "2009-04-01T00:00:00", "Export TEUs": 110700.0}, {"dt": "2009-05-01T00:00:00", "Export TEUs": 122652.0}, {"dt": "2009-06-01T00:00:00", "Export TEUs": 117427.0}, {"dt": "2009-07-01T00:00:00", "Export TEUs": 114782.0}, {"dt": "2009-08-01T00:00:00", "Export TEUs": 121629.0}, {"dt": "2009-09-01T00:00:00", "Export TEUs": 117160.0}, {"dt": "2009-10-01T00:00:00", "Export TEUs": 127107.0}, {"dt": "2009-11-01T00:00:00", "Export TEUs": 124007.0}, {"dt": "2009-12-01T00:00:00", "Export TEUs": 114825.0}, {"dt": "2010-01-01T00:00:00", "Export TEUs": 116759.0}, {"dt": "2010-02-01T00:00:00", "Export TEUs": 108455.0}, {"dt": "2010-03-01T00:00:00", "Export TEUs": 127992.0}, {"dt": "2010-04-01T00:00:00", "Export TEUs": 132954.0}, {"dt": "2010-05-01T00:00:00", "Export TEUs": 134803.0}, {"dt": "2010-06-01T00:00:00", "Export TEUs": 126520.0}, {"dt": "2010-07-01T00:00:00", "Export TEUs": 128654.0}, {"dt": "2010-08-01T00:00:00", "Export TEUs": 128426.0}, {"dt": "2010-09-01T00:00:00", "Export TEUs": 117289.0}, {"dt": "2010-10-01T00:00:00", "Export TEUs": 139182.0}, {"dt": "2010-11-01T00:00:00", "Export TEUs": 134055.0}, {"dt": "2010-12-01T00:00:00", "Export TEUs": 123239.0}, {"dt": "2011-01-01T00:00:00", "Export TEUs": 171856.0}, {"dt": "2011-02-01T00:00:00", "Export TEUs": 161319.5}, {"dt": "2011-03-01T00:00:00", "Export TEUs": 194786.0}, {"dt": "2011-04-01T00:00:00", "Export TEUs": 178882.5}, {"dt": "2011-05-01T00:00:00", "Export TEUs": 192025.0}, {"dt": "2011-06-01T00:00:00", "Export TEUs": 177798.5}, {"dt": "2011-07-01T00:00:00", "Export TEUs": 184784.0}, {"dt": "2011-08-01T00:00:00", "Export TEUs": 178332.0}, {"dt": "2011-09-01T00:00:00", "Export TEUs": 194658.0}, {"dt": "2011-10-01T00:00:00", "Export TEUs": 189801.5}, {"dt": "2011-11-01T00:00:00", "Export TEUs": 176566.0}, {"dt": "2011-12-01T00:00:00", "Export TEUs": 178516.0}, {"dt": "2012-01-01T00:00:00", "Export TEUs": 214725.0}, {"dt": "2012-02-01T00:00:00", "Export TEUs": 201518.0}, {"dt": "2012-03-01T00:00:00", "Export TEUs": 225242.0}, {"dt": "2012-04-01T00:00:00", "Export TEUs": 213628.0}, {"dt": "2012-05-01T00:00:00", "Export TEUs": 234567.0}, {"dt": "2012-06-01T00:00:00", "Export TEUs": 230778.0}, {"dt": "2012-07-01T00:00:00", "Export TEUs": 253494.0}, {"dt": "2012-08-01T00:00:00", "Export TEUs": 251180.0}, {"dt": "2012-09-01T00:00:00", "Export TEUs": 248690.0}, {"dt": "2012-10-01T00:00:00", "Export TEUs": 211464.0}, {"dt": "2012-11-01T00:00:00", "Export TEUs": 192910.0}, {"dt": "2012-12-01T00:00:00", "Export TEUs": 233912.0}, {"dt": "2013-01-01T00:00:00", "Export TEUs": 208041.0}, {"dt": "2013-02-01T00:00:00", "Export TEUs": 196783.0}, {"dt": "2013-03-01T00:00:00", "Export TEUs": 220356.0}, {"dt": "2013-04-01T00:00:00", "Export TEUs": 217284.0}, {"dt": "2013-05-01T00:00:00", "Export TEUs": 229110.0}, {"dt": "2013-06-01T00:00:00", "Export TEUs": 206200.0}, {"dt": "2013-07-01T00:00:00", "Export TEUs": 231291.0}, {"dt": "2013-08-01T00:00:00", "Export TEUs": 261030.0}, {"dt": "2013-09-01T00:00:00", "Export TEUs": 234736.0}, {"dt": "2013-10-01T00:00:00", "Export TEUs": 247156.0}, {"dt": "2013-11-01T00:00:00", "Export TEUs": 208652.0}, {"dt": "2013-12-01T00:00:00", "Export TEUs": 202707.0}, {"dt": "2014-01-01T00:00:00", "Export TEUs": 194785.0}, {"dt": "2014-02-01T00:00:00", "Export TEUs": 179380.0}, {"dt": "2014-03-01T00:00:00", "Export TEUs": 248877.0}, {"dt": "2014-04-01T00:00:00", "Export TEUs": 229669.0}, {"dt": "2014-05-01T00:00:00", "Export TEUs": 244293.0}, {"dt": "2014-06-01T00:00:00", "Export TEUs": 226783.0}, {"dt": "2014-07-01T00:00:00", "Export TEUs": 246283.0}, {"dt": "2014-08-01T00:00:00", "Export TEUs": 257152.0}, {"dt": "2014-09-01T00:00:00", "Export TEUs": 244687.0}, {"dt": "2014-10-01T00:00:00", "Export TEUs": 256064.0}, {"dt": "2014-11-01T00:00:00", "Export TEUs": 242369.0}, {"dt": "2014-12-01T00:00:00", "Export TEUs": 232325.0}, {"dt": "2015-01-01T00:00:00", "Export TEUs": 225263.0}, {"dt": "2015-02-01T00:00:00", "Export TEUs": 203891.0}, {"dt": "2015-03-01T00:00:00", "Export TEUs": 270515.0}, {"dt": "2015-04-01T00:00:00", "Export TEUs": 252041.0}, {"dt": "2015-05-01T00:00:00", "Export TEUs": 274359.0}, {"dt": "2015-06-01T00:00:00", "Export TEUs": 281474.0}, {"dt": "2015-07-01T00:00:00", "Export TEUs": 290585.0}, {"dt": "2015-08-01T00:00:00", "Export TEUs": 286757.0}, {"dt": "2015-09-01T00:00:00", "Export TEUs": 281852.0}, {"dt": "2015-10-01T00:00:00", "Export TEUs": 273429.0}, {"dt": "2015-11-01T00:00:00", "Export TEUs": 249906.0}, {"dt": "2015-12-01T00:00:00", "Export TEUs": 244044.0}, {"dt": "2016-01-01T00:00:00", "Export TEUs": 228395.0}, {"dt": "2016-02-01T00:00:00", "Export TEUs": 239513.0}, {"dt": "2016-03-01T00:00:00", "Export TEUs": 262675.0}, {"dt": "2016-04-01T00:00:00", "Export TEUs": 242175.0}, {"dt": "2016-05-01T00:00:00", "Export TEUs": 254062.0}, {"dt": "2016-06-01T00:00:00", "Export TEUs": 257421.0}, {"dt": "2016-07-01T00:00:00", "Export TEUs": 255659.0}, {"dt": "2016-08-01T00:00:00", "Export TEUs": 279127.0}, {"dt": "2016-09-01T00:00:00", "Export TEUs": 241374.0}, {"dt": "2016-10-01T00:00:00", "Export TEUs": 248054.0}, {"dt": "2016-11-01T00:00:00", "Export TEUs": 253886.0}, {"dt": "2016-12-01T00:00:00", "Export TEUs": 260727.0}, {"dt": "2017-01-01T00:00:00", "Export TEUs": 255184.0}, {"dt": "2017-02-01T00:00:00", "Export TEUs": 242932.0}, {"dt": "2017-03-01T00:00:00", "Export TEUs": 256935.0}, {"dt": "2017-04-01T00:00:00", "Export TEUs": 265657.0}, {"dt": "2017-05-01T00:00:00", "Export TEUs": 279378.0}, {"dt": "2017-06-01T00:00:00", "Export TEUs": 287704.0}, {"dt": "2017-07-01T00:00:00", "Export TEUs": 283714.0}, {"dt": "2017-08-01T00:00:00", "Export TEUs": 308967.0}, {"dt": "2017-09-01T00:00:00", "Export TEUs": 284153.0}, {"dt": "2017-10-01T00:00:00", "Export TEUs": 281491.0}, {"dt": "2017-11-01T00:00:00", "Export TEUs": 279296.0}, {"dt": "2017-12-01T00:00:00", "Export TEUs": 268446.0}, {"dt": "2018-01-01T00:00:00", "Export TEUs": 274963.0}, {"dt": "2018-02-01T00:00:00", "Export TEUs": 246462.0}, {"dt": "2018-03-01T00:00:00", "Export TEUs": 282543.0}, {"dt": "2018-04-01T00:00:00", "Export TEUs": 277507.0}, {"dt": "2018-05-01T00:00:00", "Export TEUs": 290084.0}, {"dt": "2018-06-01T00:00:00", "Export TEUs": 313314.0}, {"dt": "2018-07-01T00:00:00", "Export TEUs": 299008.0}, {"dt": "2018-08-01T00:00:00", "Export TEUs": 316636.0}, {"dt": "2018-09-01T00:00:00", "Export TEUs": 297591.0}, {"dt": "2018-10-01T00:00:00", "Export TEUs": 317809.0}, {"dt": "2018-11-01T00:00:00", "Export TEUs": 279999.0}, {"dt": "2018-12-01T00:00:00", "Export TEUs": 290964.0}, {"dt": "2019-01-01T00:00:00", "Export TEUs": 294170.0}, {"dt": "2019-02-01T00:00:00", "Export TEUs": 288716.0}, {"dt": "2019-03-01T00:00:00", "Export TEUs": 300815.0}, {"dt": "2019-04-01T00:00:00", "Export TEUs": 305888.0}, {"dt": "2019-05-01T00:00:00", "Export TEUs": 301763.0}, {"dt": "2019-06-01T00:00:00", "Export TEUs": 307718.0}, {"dt": "2019-07-01T00:00:00", "Export TEUs": 324266.0}, {"dt": "2019-08-01T00:00:00", "Export TEUs": 335112.0}, {"dt": "2019-09-01T00:00:00", "Export TEUs": 307374.0}, {"dt": "2019-10-01T00:00:00", "Export TEUs": 325429.0}, {"dt": "2019-11-01T00:00:00", "Export TEUs": 297166.0}, {"dt": "2019-12-01T00:00:00", "Export TEUs": 294235.0}, {"dt": "2020-01-01T00:00:00", "Export TEUs": 292380.0}, {"dt": "2020-02-01T00:00:00", "Export TEUs": 277365.0}, {"dt": "2020-03-01T00:00:00", "Export TEUs": 287482.0}, {"dt": "2020-04-01T00:00:00", "Export TEUs": 274566.0}, {"dt": "2020-05-01T00:00:00", "Export TEUs": 270404.0}, {"dt": "2020-06-01T00:00:00", "Export TEUs": 244470.0}, {"dt": "2020-07-01T00:00:00", "Export TEUs": 278599.0}, {"dt": "2020-08-01T00:00:00", "Export TEUs": 319497.0}, {"dt": "2020-09-01T00:00:00", "Export TEUs": 344213.0}, {"dt": "2020-10-01T00:00:00", "Export TEUs": 350022.0}, {"dt": "2020-11-01T00:00:00", "Export TEUs": 352666.0}, {"dt": "2020-12-01T00:00:00", "Export TEUs": 347829.0}, {"dt": "2021-01-01T00:00:00", "Export TEUs": 318450.5}, {"dt": "2021-02-01T00:00:00", "Export TEUs": 318270.5}, {"dt": "2021-03-01T00:00:00", "Export TEUs": 394241.0}, {"dt": "2021-04-01T00:00:00", "Export TEUs": 350966.0}, {"dt": "2021-05-01T00:00:00", "Export TEUs": 397715.0}, {"dt": "2021-06-01T00:00:00", "Export TEUs": 360951.0}, {"dt": "2021-07-01T00:00:00", "Export TEUs": 362111.0}, {"dt": "2021-08-01T00:00:00", "Export TEUs": 379378.0}, {"dt": "2021-09-01T00:00:00", "Export TEUs": 343260.0}, {"dt": "2021-10-01T00:00:00", "Export TEUs": 395639.0}, {"dt": "2021-11-01T00:00:00", "Export TEUs": 375345.0}, {"dt": "2021-12-01T00:00:00", "Export TEUs": 375380.0}, {"dt": "2022-01-01T00:00:00", "Export TEUs": 373035.0}, {"dt": "2022-02-01T00:00:00", "Export TEUs": 365138.0}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_nynj</span><span class="p">[</span><span class="mi">12</span><span class="p">:]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(),</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;New York/New Jersey&quot;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;Total TEUs&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[20]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-1a2f3cad7ea84da8b54bed5d39031fdd"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-1a2f3cad7ea84da8b54bed5d39031fdd") {
      outputDiv = document.getElementById("altair-viz-1a2f3cad7ea84da8b54bed5d39031fdd");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector012"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of New York/New Jersey Total TEUs Container Volume", "transform": [{"window": [{"op": "lag", "field": "Total TEUs", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Total TEUs'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Total TEUs"}}, "height": 100, "selection": {"selector012": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-c9b0fad4cc02dc80d5dc13ec8e60898e"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-c9b0fad4cc02dc80d5dc13ec8e60898e": [{"dt": "2006-01-01T00:00:00", "Total TEUs": 283314.0}, {"dt": "2006-02-01T00:00:00", "Total TEUs": 261938.5}, {"dt": "2006-03-01T00:00:00", "Total TEUs": 306179.5}, {"dt": "2006-04-01T00:00:00", "Total TEUs": 312796.0}, {"dt": "2006-05-01T00:00:00", "Total TEUs": 313889.5}, {"dt": "2006-06-01T00:00:00", "Total TEUs": 328163.0}, {"dt": "2006-07-01T00:00:00", "Total TEUs": 315500.0}, {"dt": "2006-08-01T00:00:00", "Total TEUs": 326072.5}, {"dt": "2006-09-01T00:00:00", "Total TEUs": 317058.5}, {"dt": "2006-10-01T00:00:00", "Total TEUs": 333098.0}, {"dt": "2006-11-01T00:00:00", "Total TEUs": 317248.0}, {"dt": "2006-12-01T00:00:00", "Total TEUs": 314344.5}, {"dt": "2007-01-01T00:00:00", "Total TEUs": 295544.0}, {"dt": "2007-02-01T00:00:00", "Total TEUs": 292102.0}, {"dt": "2007-03-01T00:00:00", "Total TEUs": 362299.0}, {"dt": "2007-04-01T00:00:00", "Total TEUs": 303461.0}, {"dt": "2007-05-01T00:00:00", "Total TEUs": 345858.0}, {"dt": "2007-06-01T00:00:00", "Total TEUs": 366255.0}, {"dt": "2007-07-01T00:00:00", "Total TEUs": 345852.0}, {"dt": "2007-08-01T00:00:00", "Total TEUs": 374334.0}, {"dt": "2007-09-01T00:00:00", "Total TEUs": 364557.0}, {"dt": "2007-10-01T00:00:00", "Total TEUs": 357646.0}, {"dt": "2007-11-01T00:00:00", "Total TEUs": 345121.0}, {"dt": "2007-12-01T00:00:00", "Total TEUs": 344466.0}, {"dt": "2008-01-01T00:00:00", "Total TEUs": 322739.0}, {"dt": "2008-02-01T00:00:00", "Total TEUs": 324727.0}, {"dt": "2008-03-01T00:00:00", "Total TEUs": 348848.0}, {"dt": "2008-04-01T00:00:00", "Total TEUs": 342697.0}, {"dt": "2008-05-01T00:00:00", "Total TEUs": 355830.0}, {"dt": "2008-06-01T00:00:00", "Total TEUs": 373795.0}, {"dt": "2008-07-01T00:00:00", "Total TEUs": 373018.0}, {"dt": "2008-08-01T00:00:00", "Total TEUs": 368688.0}, {"dt": "2008-09-01T00:00:00", "Total TEUs": 382878.0}, {"dt": "2008-10-01T00:00:00", "Total TEUs": 361347.0}, {"dt": "2008-11-01T00:00:00", "Total TEUs": 322376.0}, {"dt": "2008-12-01T00:00:00", "Total TEUs": 288271.0}, {"dt": "2009-01-01T00:00:00", "Total TEUs": 272763.0}, {"dt": "2009-02-01T00:00:00", "Total TEUs": 283142.0}, {"dt": "2009-03-01T00:00:00", "Total TEUs": 280828.0}, {"dt": "2009-04-01T00:00:00", "Total TEUs": 281599.0}, {"dt": "2009-05-01T00:00:00", "Total TEUs": 305055.0}, {"dt": "2009-06-01T00:00:00", "Total TEUs": 304412.0}, {"dt": "2009-07-01T00:00:00", "Total TEUs": 321848.0}, {"dt": "2009-08-01T00:00:00", "Total TEUs": 331322.0}, {"dt": "2009-09-01T00:00:00", "Total TEUs": 320782.0}, {"dt": "2009-10-01T00:00:00", "Total TEUs": 333141.0}, {"dt": "2009-11-01T00:00:00", "Total TEUs": 315556.0}, {"dt": "2009-12-01T00:00:00", "Total TEUs": 287659.0}, {"dt": "2010-01-01T00:00:00", "Total TEUs": 302556.0}, {"dt": "2010-02-01T00:00:00", "Total TEUs": 282366.0}, {"dt": "2010-03-01T00:00:00", "Total TEUs": 332303.0}, {"dt": "2010-04-01T00:00:00", "Total TEUs": 330677.0}, {"dt": "2010-05-01T00:00:00", "Total TEUs": 357643.0}, {"dt": "2010-06-01T00:00:00", "Total TEUs": 349191.0}, {"dt": "2010-07-01T00:00:00", "Total TEUs": 379853.0}, {"dt": "2010-08-01T00:00:00", "Total TEUs": 372985.0}, {"dt": "2010-09-01T00:00:00", "Total TEUs": 343235.5}, {"dt": "2010-10-01T00:00:00", "Total TEUs": 371619.5}, {"dt": "2010-11-01T00:00:00", "Total TEUs": 348885.0}, {"dt": "2010-12-01T00:00:00", "Total TEUs": 326107.0}, {"dt": "2011-01-01T00:00:00", "Total TEUs": 391537.0}, {"dt": "2011-02-01T00:00:00", "Total TEUs": 371055.0}, {"dt": "2011-03-01T00:00:00", "Total TEUs": 406371.0}, {"dt": "2011-04-01T00:00:00", "Total TEUs": 399472.5}, {"dt": "2011-05-01T00:00:00", "Total TEUs": 426150.5}, {"dt": "2011-06-01T00:00:00", "Total TEUs": 402996.0}, {"dt": "2011-07-01T00:00:00", "Total TEUs": 424342.5}, {"dt": "2011-08-01T00:00:00", "Total TEUs": 424843.5}, {"dt": "2011-09-01T00:00:00", "Total TEUs": 440313.0}, {"dt": "2011-10-01T00:00:00", "Total TEUs": 416493.5}, {"dt": "2011-11-01T00:00:00", "Total TEUs": 407161.0}, {"dt": "2011-12-01T00:00:00", "Total TEUs": 393485.0}, {"dt": "2012-01-01T00:00:00", "Total TEUs": 448681.0}, {"dt": "2012-02-01T00:00:00", "Total TEUs": 429904.0}, {"dt": "2012-03-01T00:00:00", "Total TEUs": 442347.0}, {"dt": "2012-04-01T00:00:00", "Total TEUs": 443776.0}, {"dt": "2012-05-01T00:00:00", "Total TEUs": 480876.0}, {"dt": "2012-06-01T00:00:00", "Total TEUs": 475206.0}, {"dt": "2012-07-01T00:00:00", "Total TEUs": 514777.0}, {"dt": "2012-08-01T00:00:00", "Total TEUs": 513088.0}, {"dt": "2012-09-01T00:00:00", "Total TEUs": 490888.0}, {"dt": "2012-10-01T00:00:00", "Total TEUs": 414080.0}, {"dt": "2012-11-01T00:00:00", "Total TEUs": 422273.0}, {"dt": "2012-12-01T00:00:00", "Total TEUs": 454013.0}, {"dt": "2013-01-01T00:00:00", "Total TEUs": 428367.0}, {"dt": "2013-02-01T00:00:00", "Total TEUs": 403275.0}, {"dt": "2013-03-01T00:00:00", "Total TEUs": 438786.0}, {"dt": "2013-04-01T00:00:00", "Total TEUs": 436579.0}, {"dt": "2013-05-01T00:00:00", "Total TEUs": 476384.0}, {"dt": "2013-06-01T00:00:00", "Total TEUs": 437770.0}, {"dt": "2013-07-01T00:00:00", "Total TEUs": 484842.0}, {"dt": "2013-08-01T00:00:00", "Total TEUs": 527528.0}, {"dt": "2013-09-01T00:00:00", "Total TEUs": 472581.0}, {"dt": "2013-10-01T00:00:00", "Total TEUs": 505857.0}, {"dt": "2013-11-01T00:00:00", "Total TEUs": 422128.0}, {"dt": "2013-12-01T00:00:00", "Total TEUs": 433250.0}, {"dt": "2014-01-01T00:00:00", "Total TEUs": 428918.0}, {"dt": "2014-02-01T00:00:00", "Total TEUs": 387909.0}, {"dt": "2014-03-01T00:00:00", "Total TEUs": 484339.0}, {"dt": "2014-04-01T00:00:00", "Total TEUs": 460857.0}, {"dt": "2014-05-01T00:00:00", "Total TEUs": 495034.0}, {"dt": "2014-06-01T00:00:00", "Total TEUs": 470497.0}, {"dt": "2014-07-01T00:00:00", "Total TEUs": 516244.0}, {"dt": "2014-08-01T00:00:00", "Total TEUs": 528581.0}, {"dt": "2014-09-01T00:00:00", "Total TEUs": 498533.0}, {"dt": "2014-10-01T00:00:00", "Total TEUs": 531302.0}, {"dt": "2014-11-01T00:00:00", "Total TEUs": 484799.0}, {"dt": "2014-12-01T00:00:00", "Total TEUs": 485290.0}, {"dt": "2015-01-01T00:00:00", "Total TEUs": 463002.0}, {"dt": "2015-02-01T00:00:00", "Total TEUs": 445285.0}, {"dt": "2015-03-01T00:00:00", "Total TEUs": 559264.0}, {"dt": "2015-04-01T00:00:00", "Total TEUs": 504674.0}, {"dt": "2015-05-01T00:00:00", "Total TEUs": 558991.0}, {"dt": "2015-06-01T00:00:00", "Total TEUs": 562573.0}, {"dt": "2015-07-01T00:00:00", "Total TEUs": 588918.0}, {"dt": "2015-08-01T00:00:00", "Total TEUs": 574547.0}, {"dt": "2015-09-01T00:00:00", "Total TEUs": 569956.0}, {"dt": "2015-10-01T00:00:00", "Total TEUs": 544677.0}, {"dt": "2015-11-01T00:00:00", "Total TEUs": 500608.0}, {"dt": "2015-12-01T00:00:00", "Total TEUs": 499225.0}, {"dt": "2016-01-01T00:00:00", "Total TEUs": 477905.0}, {"dt": "2016-02-01T00:00:00", "Total TEUs": 500659.0}, {"dt": "2016-03-01T00:00:00", "Total TEUs": 517789.0}, {"dt": "2016-04-01T00:00:00", "Total TEUs": 489311.0}, {"dt": "2016-05-01T00:00:00", "Total TEUs": 525048.0}, {"dt": "2016-06-01T00:00:00", "Total TEUs": 530575.0}, {"dt": "2016-07-01T00:00:00", "Total TEUs": 532437.0}, {"dt": "2016-08-01T00:00:00", "Total TEUs": 585327.0}, {"dt": "2016-09-01T00:00:00", "Total TEUs": 497704.0}, {"dt": "2016-10-01T00:00:00", "Total TEUs": 539092.0}, {"dt": "2016-11-01T00:00:00", "Total TEUs": 527974.0}, {"dt": "2016-12-01T00:00:00", "Total TEUs": 528132.0}, {"dt": "2017-01-01T00:00:00", "Total TEUs": 517668.0}, {"dt": "2017-02-01T00:00:00", "Total TEUs": 507066.0}, {"dt": "2017-03-01T00:00:00", "Total TEUs": 508270.0}, {"dt": "2017-04-01T00:00:00", "Total TEUs": 547013.0}, {"dt": "2017-05-01T00:00:00", "Total TEUs": 565052.0}, {"dt": "2017-06-01T00:00:00", "Total TEUs": 584606.0}, {"dt": "2017-07-01T00:00:00", "Total TEUs": 576947.0}, {"dt": "2017-08-01T00:00:00", "Total TEUs": 631404.0}, {"dt": "2017-09-01T00:00:00", "Total TEUs": 573458.0}, {"dt": "2017-10-01T00:00:00", "Total TEUs": 588848.0}, {"dt": "2017-11-01T00:00:00", "Total TEUs": 566519.0}, {"dt": "2017-12-01T00:00:00", "Total TEUs": 543966.0}, {"dt": "2018-01-01T00:00:00", "Total TEUs": 585864.0}, {"dt": "2018-02-01T00:00:00", "Total TEUs": 521921.0}, {"dt": "2018-03-01T00:00:00", "Total TEUs": 572576.0}, {"dt": "2018-04-01T00:00:00", "Total TEUs": 551117.0}, {"dt": "2018-05-01T00:00:00", "Total TEUs": 593625.0}, {"dt": "2018-06-01T00:00:00", "Total TEUs": 625366.0}, {"dt": "2018-07-01T00:00:00", "Total TEUs": 622559.0}, {"dt": "2018-08-01T00:00:00", "Total TEUs": 651752.0}, {"dt": "2018-09-01T00:00:00", "Total TEUs": 603034.0}, {"dt": "2018-10-01T00:00:00", "Total TEUs": 658708.0}, {"dt": "2018-11-01T00:00:00", "Total TEUs": 583880.0}, {"dt": "2018-12-01T00:00:00", "Total TEUs": 609390.0}, {"dt": "2019-01-01T00:00:00", "Total TEUs": 622531.0}, {"dt": "2019-02-01T00:00:00", "Total TEUs": 585216.0}, {"dt": "2019-03-01T00:00:00", "Total TEUs": 585098.0}, {"dt": "2019-04-01T00:00:00", "Total TEUs": 605263.0}, {"dt": "2019-05-01T00:00:00", "Total TEUs": 643706.0}, {"dt": "2019-06-01T00:00:00", "Total TEUs": 611027.0}, {"dt": "2019-07-01T00:00:00", "Total TEUs": 662994.0}, {"dt": "2019-08-01T00:00:00", "Total TEUs": 679585.0}, {"dt": "2019-09-01T00:00:00", "Total TEUs": 624961.0}, {"dt": "2019-10-01T00:00:00", "Total TEUs": 666381.0}, {"dt": "2019-11-01T00:00:00", "Total TEUs": 599626.0}, {"dt": "2019-12-01T00:00:00", "Total TEUs": 584743.0}, {"dt": "2020-01-01T00:00:00", "Total TEUs": 617024.0}, {"dt": "2020-02-01T00:00:00", "Total TEUs": 579124.0}, {"dt": "2020-03-01T00:00:00", "Total TEUs": 560830.0}, {"dt": "2020-04-01T00:00:00", "Total TEUs": 559929.0}, {"dt": "2020-05-01T00:00:00", "Total TEUs": 537412.0}, {"dt": "2020-06-01T00:00:00", "Total TEUs": 511306.0}, {"dt": "2020-07-01T00:00:00", "Total TEUs": 607463.0}, {"dt": "2020-08-01T00:00:00", "Total TEUs": 688365.0}, {"dt": "2020-09-01T00:00:00", "Total TEUs": 720969.0}, {"dt": "2020-10-01T00:00:00", "Total TEUs": 755437.0}, {"dt": "2020-11-01T00:00:00", "Total TEUs": 738885.0}, {"dt": "2020-12-01T00:00:00", "Total TEUs": 709075.0}, {"dt": "2021-01-01T00:00:00", "Total TEUs": 673202.0}, {"dt": "2021-02-01T00:00:00", "Total TEUs": 673202.0}, {"dt": "2021-03-01T00:00:00", "Total TEUs": 789776.0}, {"dt": "2021-04-01T00:00:00", "Total TEUs": 712799.0}, {"dt": "2021-05-01T00:00:00", "Total TEUs": 796693.0}, {"dt": "2021-06-01T00:00:00", "Total TEUs": 749400.0}, {"dt": "2021-07-01T00:00:00", "Total TEUs": 758810.0}, {"dt": "2021-08-01T00:00:00", "Total TEUs": 780782.0}, {"dt": "2021-09-01T00:00:00", "Total TEUs": 724418.0}, {"dt": "2021-10-01T00:00:00", "Total TEUs": 796704.0}, {"dt": "2021-11-01T00:00:00", "Total TEUs": 759390.0}, {"dt": "2021-12-01T00:00:00", "Total TEUs": 770753.0}, {"dt": "2022-01-01T00:00:00", "Total TEUs": 759248.0}, {"dt": "2022-02-01T00:00:00", "Total TEUs": 765050.0}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Georgia-Ports">Georgia Ports<a class="anchor-link" href="#Georgia-Ports">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@memory</span><span class="o">.</span><span class="n">cache</span>
<span class="k">def</span> <span class="nf">doGaFetch</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">retries</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">retries</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span> <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="n">uaString</span> <span class="p">})</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>

        <span class="n">tabs</span> <span class="o">=</span> <span class="n">read_pdf</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">()),</span> <span class="n">pages</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>

        <span class="c1"># noop to test for the table</span>
        <span class="n">tabs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="k">return</span> <span class="n">tabs</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">doGaFetch</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">retries</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    
<span class="n">reportPage</span> <span class="o">=</span> <span class="s1">&#39;https://gaports.com/sales/by-the-numbers/&#39;</span>
<span class="n">currentReport</span> <span class="o">=</span> <span class="o">!</span>curl -s -L <span class="nv">$reportPage</span> <span class="p">|</span> egrep -i <span class="s1">&#39;Monthly.*TEU.*pdf&#39;</span> <span class="p">|</span> perl -pe <span class="s1">&#39;s/.*href=\&quot;([^&quot;]+)\&quot;.*/\1/&#39;</span>

<span class="nb">print</span><span class="p">(</span><span class="n">currentReport</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1">#current = &quot;https://gaports.com/wp-content/uploads/2021/04/Monthly-TEU-Throughput-March-2021.pdf&quot;</span>

<span class="n">tabs</span> <span class="o">=</span> <span class="n">doGaFetch</span><span class="p">(</span><span class="n">currentReport</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Jan&#39;</span><span class="p">,</span> <span class="s1">&#39;Feb&#39;</span><span class="p">,</span> <span class="s1">&#39;Mar&#39;</span><span class="p">,</span> <span class="s1">&#39;Apr&#39;</span><span class="p">,</span> <span class="s1">&#39;May&#39;</span><span class="p">,</span> <span class="s1">&#39;Jun&#39;</span><span class="p">,</span> <span class="s1">&#39;Jul&#39;</span><span class="p">,</span> <span class="s1">&#39;Aug&#39;</span><span class="p">,</span> <span class="s1">&#39;Sep&#39;</span><span class="p">,</span> <span class="s1">&#39;Oct&#39;</span><span class="p">,</span> <span class="s1">&#39;Nov&#39;</span><span class="p">,</span> <span class="s1">&#39;Dec&#39;</span><span class="p">,</span> <span class="s1">&#39;Total&#39;</span><span class="p">]</span>

<span class="n">flatten</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">l</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">parseGpTable</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">17</span><span class="p">):</span>
    <span class="n">gp_raw</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="n">end</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="mi">17</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1">#print(gp_raw.iloc[0, :].values)</span>
    
    <span class="n">firstRowVals</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="n">gp_raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
    <span class="c1">#print(firstRowVals)</span>
    
    <span class="c1"># Use all the month values in order then append the total value as the last element</span>
    <span class="n">firstRow</span> <span class="o">=</span> <span class="p">[</span><span class="n">firstRowVals</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">firstRowVals</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))]</span> <span class="o">+</span> <span class="p">[</span><span class="n">gp_raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="c1">#print(firstRow)</span>

    <span class="n">records</span> <span class="o">=</span> <span class="n">gp_raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">flatten</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="n">s</span><span class="o">.</span><span class="n">values</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#print(records.head(1))</span>
    
    <span class="n">df_ga_melted</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">([</span><span class="n">firstRow</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">records</span><span class="o">.</span><span class="n">values</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
    
    <span class="c1">#print(df_ga_melted[df_ga_melted[&#39;Year&#39;] == &#39;2020&#39;].head(15))</span>
    
    <span class="n">df_ga_melted</span> <span class="o">=</span> <span class="n">df_ga_melted</span><span class="p">[</span><span class="n">df_ga_melted</span><span class="p">[</span><span class="s1">&#39;variable&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;Total&#39;</span><span class="p">]</span>
    <span class="n">df_ga_melted</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_ga_melted</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">df_ga_melted</span><span class="p">[</span><span class="s1">&#39;variable&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y-%b&#39;</span><span class="p">)</span>
    <span class="n">df_ga_melted</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_ga_melted</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">))</span>

    <span class="n">df_ga_tst</span> <span class="o">=</span> <span class="n">df_ga_melted</span><span class="p">[[</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;dt&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;dt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;1M&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;TEU Total&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df_ga_tst</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="n">df_ga_tst</span> <span class="o">=</span> <span class="n">parseGpTable</span><span class="p">(</span><span class="n">tabs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cols2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Key&#39;</span><span class="p">,</span> <span class="s1">&#39;Jan&#39;</span><span class="p">,</span> <span class="s1">&#39;Feb&#39;</span><span class="p">,</span> <span class="s1">&#39;Mar&#39;</span><span class="p">,</span> <span class="s1">&#39;Apr&#39;</span><span class="p">,</span> <span class="s1">&#39;May&#39;</span><span class="p">,</span> <span class="s1">&#39;Jun&#39;</span><span class="p">,</span> <span class="s1">&#39;Jul&#39;</span><span class="p">,</span> <span class="s1">&#39;Aug&#39;</span><span class="p">,</span> <span class="s1">&#39;Sep&#39;</span><span class="p">,</span> <span class="s1">&#39;Oct&#39;</span><span class="p">,</span> <span class="s1">&#39;Nov&#39;</span><span class="p">,</span> <span class="s1">&#39;Dec&#39;</span><span class="p">,</span> <span class="s1">&#39;Total&#39;</span><span class="p">]</span>

<span class="c1">#gp_raw = tabs[0].iloc[3:21].copy()</span>

<span class="n">gp_detail_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">tabs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">18</span><span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()]</span> <span class="o">+</span> <span class="n">tabs</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">gp_detail_raw</span> <span class="o">=</span> <span class="n">gp_detail_raw</span><span class="p">[</span><span class="o">~</span><span class="n">gp_detail_raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>

<span class="c1">#print(gp_detail_raw)</span>

<span class="c1"># Exclude rows with erroneous data</span>
<span class="n">gp_detail_raw</span> <span class="o">=</span> <span class="n">gp_detail_raw</span><span class="p">[</span><span class="o">~</span><span class="n">gp_detail_raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;%&quot;</span><span class="p">)]</span>
<span class="n">gp_detail_raw</span> <span class="o">=</span> <span class="n">gp_detail_raw</span><span class="p">[</span><span class="n">gp_detail_raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(I|E|T|\d)&quot;</span><span class="p">)]</span>

<span class="c1">#print(gp_detail_raw.head(25))</span>

<span class="n">hypenate</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;rt &quot;</span><span class="p">,</span> <span class="s2">&quot;rt-&quot;</span><span class="p">)</span>\
                           <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Total Full&quot;</span><span class="p">,</span> <span class="s2">&quot;Total-Full&quot;</span><span class="p">)</span>\
                           <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Total Empty&quot;</span><span class="p">,</span> <span class="s2">&quot;Total-Empty&quot;</span><span class="p">)</span>\
                           <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Total All&quot;</span><span class="p">,</span> <span class="s2">&quot;Total-All&quot;</span><span class="p">)</span>

<span class="n">gp_detail_raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">gp_detail_raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">hypenate</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd"># Special case for the current year</span>
<span class="sd">firstRowVals2 = flatten(map(lambda v: hypenate(v).split(), gp_detail_raw.iloc[0, :-1].values))</span>
<span class="sd">firstRow2 = [firstRowVals2[n] if n &lt; len(firstRowVals2) else &#39;&#39; for n in range(len(cols2[:-1]))] + [gp_detail_raw.iloc[0, -1]]</span>

<span class="sd"># General case for the historical years</span>
<span class="sd">remainingRows = gp_detail_raw.iloc[1:].apply(lambda s: flatten(map(lambda v: hypenate(v).split(), s.to_list())), axis=1)</span>

<span class="sd">gp_detail = pd.DataFrame.from_records([firstRow2] + [r for r in remainingRows.values], columns=cols2)</span>

<span class="sd">#print(gp_detail.head())</span>

<span class="sd"># Find all the records that don&#39;t have the year in them</span>
<span class="sd">rowsToShift = gp_detail[~gp_detail[&#39;Year&#39;].str.match(&quot;^\d&quot;)].index.values</span>

<span class="sd">#####</span>
<span class="sd"># Note, this is the likely line to toggle between commented&lt;-&gt;uncommented if seeing issues</span>
<span class="sd">#####</span>
<span class="sd"># Shift records not containing the year to the right by one to line things up</span>
<span class="sd">gp_detail.iloc[rowsToShift] = gp_detail.iloc[rowsToShift].apply(lambda v: pd.Series([None] + v.to_list()[:-1]), axis=1)</span>

<span class="sd">gp_detail.iloc[rowsToShift, 0] = pd.to_numeric(&#39;&#39;, errors=&#39;coerce&#39;)</span>
<span class="sd">&quot;&quot;&quot;</span><span class="p">;</span>

<span class="n">gp_detail</span> <span class="o">=</span> <span class="n">gp_detail_raw</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">gp_detail</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">cols2</span>

<span class="c1"># Fill the years for the rest of the rows</span>
<span class="n">gp_detail</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gp_detail</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ffill</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="c1">#print(gp_detail.head(20))</span>

<span class="n">df_ga_detail_melted</span> <span class="o">=</span> <span class="n">gp_detail</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Key&quot;</span><span class="p">,</span> <span class="s2">&quot;Year&quot;</span><span class="p">])</span>

<span class="n">df_ga_detail_melted</span> <span class="o">=</span> <span class="n">df_ga_detail_melted</span><span class="p">[</span><span class="n">df_ga_detail_melted</span><span class="p">[</span><span class="s2">&quot;variable&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;Total&quot;</span><span class="p">]</span>

<span class="n">df_ga_detail_melted</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_ga_detail_melted</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span>\
                                           <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">df_ga_detail_melted</span><span class="p">[</span><span class="s1">&#39;variable&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y-%b&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>

<span class="n">df_ga_detail_melted</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_ga_detail_melted</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>\
                                    <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>\
                                    <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">))</span>

<span class="c1">#print(df_ga_detail_melted.fillna(&#39;nan&#39;).dropna().tail())</span>

<span class="n">df_ga_ts</span> <span class="o">=</span> <span class="n">df_ga_detail_melted</span><span class="p">[[</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="s1">&#39;Key&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Key&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df_ga_ts</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="s1">&#39;Export Empty&#39;</span><span class="p">,</span> <span class="s1">&#39;Export Full&#39;</span><span class="p">,</span> <span class="s1">&#39;Export Total&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;Import Empty&#39;</span><span class="p">,</span> <span class="s1">&#39;Import Full&#39;</span><span class="p">,</span> <span class="s1">&#39;Import Total&#39;</span><span class="p">,</span> <span class="s1">&#39;Total All&#39;</span><span class="p">,</span> <span class="s1">&#39;Total Empty&#39;</span><span class="p">,</span> <span class="s1">&#39;Total Full&#39;</span><span class="p">]</span>

<span class="n">df_ga_ts</span> <span class="o">=</span> <span class="n">df_ga_ts</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_ga_ts</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Georgia&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Total All&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_ga_ts</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Georgia&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Import Empty&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_ga_ts</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Georgia&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Import Full&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_ga_ts</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Georgia&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Export Total&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_ga_ts</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Georgia&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Export Empty&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_ga_ts</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Georgia&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Export Full&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Northwest-Seaport-Alliance-(Ports-of-Seattle-and-Tacoma)">Northwest Seaport Alliance (Ports of Seattle and Tacoma)<a class="anchor-link" href="#Northwest-Seaport-Alliance-(Ports-of-Seattle-and-Tacoma)">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="o">!</span>curl -s <span class="s1">&#39;https://www.nwseaportalliance.com/about-us/cargo-statistics&#39;</span> <span class="p">|</span> grep <span class="s1">&#39;xlsx&#39;</span>

<span class="c1">#pageCount = re.findall(&quot;of ([0-9]+)&quot;, &quot;&quot;.join(rawPg))[0]</span>

<span class="n">currentReport</span> <span class="o">=</span> <span class="p">[</span><span class="n">u</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;href=&quot;([^&quot;]+)&quot;&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">))</span> <span class="k">if</span> <span class="s2">&quot;xls&quot;</span> <span class="ow">in</span> <span class="n">u</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="c1">#print(currentReport)</span>

<span class="n">df_nwsea</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">currentReport</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">df_nwsea</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Month&quot;</span><span class="p">,</span> <span class="s2">&quot;Measure&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df_nwsea</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">2</span><span class="p">:]</span>

<span class="n">df_nwsea</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_nwsea</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ffill</span><span class="p">()</span>

<span class="n">df_nwsea</span> <span class="o">=</span> <span class="n">df_nwsea</span><span class="p">[</span><span class="o">~</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">df_nwsea</span><span class="p">[</span><span class="s1">&#39;Measure&#39;</span><span class="p">])]</span>

<span class="n">df_nwsea</span> <span class="o">=</span> <span class="n">df_nwsea</span><span class="p">[</span><span class="o">~</span><span class="n">df_nwsea</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;%|Total&quot;</span><span class="p">)]</span>

<span class="n">df_nwsea_melt</span> <span class="o">=</span> <span class="n">df_nwsea</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="s1">&#39;Measure&#39;</span><span class="p">])</span>

<span class="n">df_nwsea_melt</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_nwsea_melt</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">df_nwsea_melt</span><span class="p">[</span><span class="s1">&#39;variable&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%b-%Y&#39;</span><span class="p">)</span>\
                        <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">MonthEnd</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1">#df_nwsea_melt.tail(25)</span>

<span class="n">df_nwsea_tab</span> <span class="o">=</span> <span class="n">df_nwsea_melt</span><span class="p">[[</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="s1">&#39;Measure&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Measure&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>

<span class="n">df_nwsea_tab</span> <span class="o">=</span> <span class="n">df_nwsea_tab</span><span class="p">[</span><span class="n">df_nwsea_tab</span><span class="p">[</span><span class="s1">&#39;Total TEUs&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
<span class="c1">#df_nwsea_tab.head()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_nwsea_tab</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_nwsea_tab</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;International Exports Full&quot;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;Seattle/Tacoma&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%b-%y&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_nwsea_tab</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;International Exports Empty&quot;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;Seattle/Tacoma&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%b-%y&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Port-of-Houston">Port of Houston<a class="anchor-link" href="#Port-of-Houston">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@memory</span><span class="o">.</span><span class="n">cache</span>
<span class="k">def</span> <span class="nf">fetchHouston</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">retries</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">retries</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span> <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="n">uaString</span> <span class="p">})</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>

        <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">,</span> <span class="s2">&quot;Loaded Imports&quot;</span><span class="p">,</span> <span class="s2">&quot;Loaded Exports&quot;</span><span class="p">,</span> <span class="s2">&quot;Loaded Total&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Empty Imports&quot;</span><span class="p">,</span> <span class="s2">&quot;Empty Exports&quot;</span><span class="p">,</span> <span class="s2">&quot;Empty Total&quot;</span><span class="p">,</span> <span class="s2">&quot;Loaded and Empty Total&quot;</span><span class="p">]</span>

        <span class="n">dfs_hs</span> <span class="o">=</span> <span class="n">read_pdf</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">()),</span> <span class="n">pages</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">pandas_options</span><span class="o">=</span><span class="p">{</span> <span class="s1">&#39;names&#39;</span><span class="p">:</span> <span class="n">cols</span> <span class="p">})</span> <span class="c1">#.head(20)</span>

        <span class="n">df_hs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">dfs_hs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">5</span><span class="p">:]]</span> <span class="o">+</span> <span class="n">dfs_hs</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

        <span class="n">df_hs</span><span class="p">[</span><span class="n">df_hs</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]]</span> <span class="o">=</span> <span class="n">df_hs</span><span class="p">[</span><span class="n">df_hs</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]]</span>\
                <span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">v</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">))</span>

        <span class="n">df_hs</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_hs</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%b-%y&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">df_hs</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fetchHouston</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">retries</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">res</span> <span class="o">=</span> <span class="o">!</span>curl -s <span class="s1">&#39;https://porthouston.com/about-us/statistics/&#39;</span> <span class="p">|</span> grep <span class="s1">&#39;TEU-stats&#39;</span>
    
<span class="n">currentUrl</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;href=&quot;([^&quot;]+)&quot;&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">res</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1">#print(currentUrl)</span>
    
<span class="c1"># TODO - automate detection of this url from here: https://porthouston.com/about-us/statistics/</span>
<span class="n">df_hs</span> <span class="o">=</span> <span class="n">fetchHouston</span><span class="p">(</span><span class="n">currentUrl</span><span class="p">)</span>
<span class="c1">#df_hs.tail()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_hs</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;Empty Imports&quot;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;Houston&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_hs</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;Empty Exports&quot;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;Houston&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_hs</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;Loaded Total&quot;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;Houston&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Port-of-Charleston"><del>Port of Charleston</del><a class="anchor-link" href="#Port-of-Charleston">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">fetchCharleston</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">retries</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">retries</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span> <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="n">uaString</span> <span class="p">})</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

        <span class="n">dfs_ch</span> <span class="o">=</span> <span class="n">read_pdf</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">()),</span> <span class="n">pages</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>

        <span class="c1"># noop</span>
        <span class="n">dfs_ch</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="k">return</span> <span class="n">dfs_ch</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Response code: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">getcode</span><span class="p">()))</span>
        <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fetchCharleston</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">retries</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">URLError</span><span class="p">:</span>
        <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fetchCharleston</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">retries</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">dfs_ch</span> <span class="o">=</span> <span class="n">fetchCharleston</span><span class="p">(</span><span class="s2">&quot;http://scspa.com/wp-content/uploads/gl078-pc-teu-history.pdf&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">fixColumns</span><span class="p">(</span><span class="n">df_</span><span class="p">):</span>
    <span class="n">firstDataRow</span> <span class="o">=</span> <span class="mi">2</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">df_</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
     
    <span class="c1"># Standardize column count</span>
    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
        <span class="c1"># Standardize rail moves column location</span>
        <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
        
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">res</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">firstDataRow</span><span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="c1">#print(df.head())</span>
    
    <span class="c1">#print(df.iloc[firstDataRow:, 2].values)</span>
    
    <span class="c1"># split rail column </span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">firstDataRow</span><span class="p">:,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">expand</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    
    <span class="c1">#print(_)</span>

    <span class="n">res</span><span class="p">[</span><span class="s2">&quot;RAIL-MOVES&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">res</span><span class="p">[</span><span class="s2">&quot;RAIL-RATIO&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
        
    <span class="c1">#res = pd.concat([df.iloc[firstDataRow:, 0:4], res.iloc[:, 2:]], axis=1)</span>

    <span class="c1"># split pier loaded column </span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">firstDataRow</span><span class="p">:,</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">expand</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> 

    <span class="n">res</span><span class="p">[</span><span class="s2">&quot;PIER-LOADED-EXPORT&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> 

    <span class="k">try</span><span class="p">:</span>
        <span class="n">res</span><span class="p">[</span><span class="s2">&quot;PIER-LOADED-IMPORT&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> 
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
        
    <span class="c1">#res = pd.concat([res, res.iloc[:, -2:]], axis=1)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># split pier empty column </span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">firstDataRow</span><span class="p">:,</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">expand</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> 

        <span class="n">res</span><span class="p">[</span><span class="s2">&quot;PIER-EMPTY-EXPORT&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">res</span><span class="p">[</span><span class="s2">&quot;PIER-EMPTY-IMPORT&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="n">res</span><span class="p">[</span><span class="s2">&quot;PIER-EMPTY-EXPORT&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">res</span><span class="p">[</span><span class="s2">&quot;PIER-EMPTY-IMPORT&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="c1">#res[&quot;PIER-TOTAL&quot;]= _[2] </span>

    <span class="c1">#res = pd.concat([df.iloc[firstDataRow:, 0], res.iloc[:, 2:]], axis=1)</span>

    <span class="c1"># split loaded teu column </span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">firstDataRow</span><span class="p">:,</span> <span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">expand</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> 

    <span class="n">res</span><span class="p">[</span><span class="s2">&quot;TEU-LOADED-EXPORT&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">res</span><span class="p">[</span><span class="s2">&quot;TEU-LOADED-IMPORT&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="c1">#res = pd.concat([df.iloc[firstDataRow:, 0], df.iloc[firstDataRow:, 4:6], res.iloc[:, 8:10], df.iloc[firstDataRow:, -1]], axis=1)</span>

    <span class="c1">#print(res)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># split empty teu column </span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">firstDataRow</span><span class="p">:,</span> <span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">expand</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> 

        <span class="n">res</span><span class="p">[</span><span class="s2">&quot;TEU-EMPTY-EXPORT&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">res</span><span class="p">[</span><span class="s2">&quot;TEU-EMPTY-IMPORT&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="n">res</span><span class="p">[</span><span class="s2">&quot;TEU-EMPTY-EXPORT&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">res</span><span class="p">[</span><span class="s2">&quot;TEU-EMPTY-IMPORT&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1">#res = pd.concat([df.iloc[firstDataRow:, 0], df.iloc[firstDataRow:, 4:6], res.iloc[:, 8:], df.iloc[firstDataRow:, -1]], axis=1)</span>

    <span class="n">res</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">res</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
                     <span class="n">res</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
                     <span class="n">res</span><span class="p">[</span><span class="s2">&quot;RAIL-MOVES&quot;</span><span class="p">],</span>
                     <span class="n">res</span><span class="p">[</span><span class="s2">&quot;RAIL-RATIO&quot;</span><span class="p">],</span>
                     <span class="n">res</span><span class="p">[</span><span class="s2">&quot;PIER-LOADED-EXPORT&quot;</span><span class="p">],</span>
                     <span class="n">res</span><span class="p">[</span><span class="s2">&quot;PIER-LOADED-IMPORT&quot;</span><span class="p">],</span>
                     <span class="n">res</span><span class="p">[</span><span class="s2">&quot;PIER-EMPTY-EXPORT&quot;</span><span class="p">],</span>
                     <span class="n">res</span><span class="p">[</span><span class="s2">&quot;PIER-EMPTY-IMPORT&quot;</span><span class="p">],</span>
                     <span class="n">res</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">5</span><span class="p">],</span>
                     <span class="n">res</span><span class="p">[</span><span class="s2">&quot;TEU-LOADED-EXPORT&quot;</span><span class="p">],</span>
                     <span class="n">res</span><span class="p">[</span><span class="s2">&quot;TEU-LOADED-IMPORT&quot;</span><span class="p">],</span>
                     <span class="n">res</span><span class="p">[</span><span class="s2">&quot;TEU-EMPTY-EXPORT&quot;</span><span class="p">],</span>
                     <span class="n">res</span><span class="p">[</span><span class="s2">&quot;TEU-EMPTY-IMPORT&quot;</span><span class="p">],</span>
                     <span class="n">res</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">8</span><span class="p">],</span>
                    <span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">res</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DATE&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;RAIL-DRAYS&#39;</span><span class="p">,</span> <span class="s1">&#39;RAIL-MOVES&#39;</span><span class="p">,</span> <span class="s1">&#39;RAIL-RATIO&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;PIER-LOADED-EXPORT&#39;</span><span class="p">,</span> <span class="s1">&#39;PIER-LOADED-IMPORT&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;PIER-EMPTY-EXPORT&#39;</span><span class="p">,</span> <span class="s1">&#39;PIER-EMPTY-IMPORT&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;PIER-TOTAL&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;TEU-LOADED-EXPORT&#39;</span><span class="p">,</span> <span class="s1">&#39;TEU-LOADED-IMPORT&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;TEU-EMPTY-EXPORT&#39;</span><span class="p">,</span> <span class="s1">&#39;TEU-EMPTY-IMPORT&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;TEU-TOTAL&#39;</span><span class="p">]</span>
    <span class="c1">#print(res)</span>
    
    <span class="c1"># fix remaining column labels</span>
    <span class="c1">#res.columns = [&#39;DATE&#39;, &#39;RAIL-DRAYS&#39;, &#39;RAIL-MOVES&#39;] + res.columns.to_list()[3:-1] + [&quot;TEU-TOTAL&quot;]</span>

    <span class="c1"># convert all columns to numeric</span>
    <span class="n">res</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>\
            <span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">v</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">))</span>

    
    <span class="n">res</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">:]</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">:]</span>\
            <span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">v</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">))</span>

    <span class="n">res</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%B, %Y&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">res</span>

<span class="c1">#df_ch = pd.concat([fixColumns(d) for d in dfs_ch[:2]])</span>

<span class="c1">#df_ch.head()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#doYoyChart(df_ch, metric=&#39;TEU-LOADED-EXPORT&#39;, location=&#39;Charleston&#39;)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#doYoyChart(df_ch, metric=&#39;TEU-LOADED-IMPORT&#39;, location=&#39;Charleston&#39;)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#doYoyChart(df_ch, metric=&#39;TEU-TOTAL&#39;, location=&#39;Charleston&#39;)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Port-of-Virginia">Port of Virginia<a class="anchor-link" href="#Port-of-Virginia">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># http://www.portofvirginia.com/who-we-are/port-stats/</span>

<span class="c1">#raise RuntimeError(&quot;Broken&quot;)</span>

<span class="c1">#result = !curl -sL &#39;http://www.portofvirginia.com/who-we-are/port-stats/&#39; | grep &#39;xlsx&#39;</span>

<span class="c1">#currentReport = [u for u in re.findall(&#39;href=&quot;([^&quot;]+)&quot;&#39;, &quot;&quot;.join(result)) if &quot;xls&quot; in u][0]</span>

<span class="n">baseUrl</span> <span class="o">=</span> <span class="s2">&quot;http://www.portofvirginia.com/who-we-are/port-stats/&quot;</span>

<span class="k">def</span> <span class="nf">fetchCurrentReport</span><span class="p">():</span> 
    <span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">executable_path</span><span class="o">=</span><span class="s1">&#39;/usr/local/bin/chromedriver&#39;</span><span class="p">,</span>
                              <span class="n">options</span><span class="o">=</span><span class="n">chrome_options</span><span class="p">)</span>

    <span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">baseUrl</span><span class="p">)</span>
    
    <span class="n">wait</span> <span class="o">=</span> <span class="n">WebDriverWait</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
    
    <span class="c1">#wait.until(ajaxComplete)</span>

    <span class="n">wait</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">CSS_SELECTOR</span><span class="p">,</span> <span class="s2">&quot;#container&quot;</span><span class="p">)))</span>
    
    <span class="n">reportLink</span> <span class="o">=</span> <span class="s2">&quot;#container &gt; div &gt; section &gt; article &gt; div &gt; ul &gt; li:nth-child(2) &gt; a&quot;</span>

    <span class="k">return</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_css_selector</span><span class="p">(</span><span class="n">reportLink</span><span class="p">)</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span>

<span class="n">currentReport</span> <span class="o">=</span> <span class="n">fetchCurrentReport</span><span class="p">()</span>

<span class="c1">#print(currentReport)</span>

<span class="n">oldUrl</span> <span class="o">=</span> <span class="s2">&quot;http://www.portofvirginia.com/excel/Port_of_Virginia_Statistics.xlsx&quot;</span>

<span class="n">url</span> <span class="o">=</span> <span class="n">currentReport</span> <span class="c1">#&quot;https://web.archive.org/web/20191218025738if_/http://www.portofvirginia.com/excel/Port_of_Virginia_Statistics.xlsx&quot;</span>
<span class="n">df_va</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_va</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="s1">&#39;Key&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df_va</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()[</span><span class="mi">2</span><span class="p">:]</span>

<span class="n">df_va</span> <span class="o">=</span> <span class="n">df_va</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">71</span><span class="p">]</span>
<span class="n">df_va</span> <span class="o">=</span> <span class="n">df_va</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">df_va</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_va</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ffill</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1">#df_va.head(20)</span>

<span class="n">df_va_melted</span> <span class="o">=</span> <span class="n">df_va</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="s1">&#39;Key&#39;</span><span class="p">])</span>
<span class="n">df_va_melted</span> <span class="o">=</span> <span class="n">df_va_melted</span><span class="p">[</span><span class="o">~</span><span class="n">df_va_melted</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
<span class="n">df_va_melted</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_va_melted</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">df_va_melted</span><span class="p">[</span><span class="s1">&#39;variable&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%b %Y&quot;</span><span class="p">)</span>

<span class="n">df_va_clean</span> <span class="o">=</span> <span class="n">df_va_melted</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Key&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_va_clean</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Virgina&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Export Empties&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_va_clean</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Virgina&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Import Loads&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_va_clean</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Virgina&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Export Loads&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_va_clean</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Virgina&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Total TEUs&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># https://www.oaklandseaport.com/performance/facts-figures/</span>

<span class="n">df_oakland</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;https://www.oaklandseaport.com/files/PDF/Oakland%20Monthly%20TEUs%201998-2021.xlsx&quot;</span><span class="p">,</span>
                           <span class="n">skiprows</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">df_oakland</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;[^A-z]+&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df_oakland</span><span class="p">]</span>

<span class="n">df_oakland</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_oakland</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="n">df_oakland</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y%B&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>

<span class="n">df_oakland</span> <span class="o">=</span> <span class="n">df_oakland</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="n">df_oakland</span> <span class="o">=</span> <span class="n">df_oakland</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Month&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">df_oakland</span> <span class="o">=</span> <span class="n">df_oakland</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;dt&#39;</span><span class="p">)</span>

<span class="c1">#df_oakland.tail()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;curl -s &#39;https://www.oaklandseaport.com/performance/facts-figures/&#39; | egrep &#39;class=</span><span class="se">\&quot;</span><span class="s2">(number|chart-subtitle)</span><span class="se">\&quot;</span><span class="s2">&#39;&quot;</span>

<span class="n">df_oak_latest_res</span> <span class="o">=</span> <span class="o">!</span><span class="nv">$command</span>

<span class="n">df_oak_latest_raw</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_oak_latest_res</span><span class="p">)</span>

<span class="n">extractMonthAndValue</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;title=&quot;([A-z]+)&quot;&gt;&lt;span class=&quot;number&quot;&gt;([0-9,.]+)&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">getLabel</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;Import-Full&#39;</span>
    <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;Export-Full&#39;</span>
    <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;Import-Empty&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;Export-Empty&#39;</span> 

<span class="n">df_oak_latest_stg</span> <span class="o">=</span> <span class="p">[(</span><span class="n">getLabel</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">extractMonthAndValue</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;class=&quot;chart-subtitle&quot;&#39;</span><span class="p">,</span> <span class="n">df_oak_latest_raw</span><span class="p">))</span> <span class="k">if</span> <span class="s2">&quot;number&quot;</span> <span class="ow">in</span> <span class="n">v</span><span class="p">]</span>

<span class="n">currentYear</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">year</span>

<span class="n">df_oak_latest</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="k">for</span> <span class="n">kind</span><span class="p">,</span> <span class="n">vals</span> <span class="ow">in</span> <span class="n">df_oak_latest_stg</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">continue</span>
        
    <span class="c1">#print(kind, vals)</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>
    <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">currentYear</span><span class="si">}</span><span class="s2">-&quot;</span> <span class="o">+</span> <span class="n">tmp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y-%b&quot;</span><span class="p">)</span>
    <span class="n">tmp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)))</span>
    <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">kind</span><span class="p">)</span>
    <span class="n">tmp</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">]</span>
    <span class="n">df_oak_latest</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_oak_latest</span><span class="p">,</span> <span class="n">tmp</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_oak_latest_tab</span> <span class="o">=</span> <span class="n">df_oak_latest</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>

<span class="n">df_oak_latest_tab</span><span class="p">[</span><span class="s1">&#39;Total-Full&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_oak_latest_tab</span><span class="p">[</span><span class="s1">&#39;Import-Full&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df_oak_latest_tab</span><span class="p">[</span><span class="s1">&#39;Export-Full&#39;</span><span class="p">]</span>
<span class="n">df_oak_latest_tab</span><span class="p">[</span><span class="s1">&#39;Total-Empty&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_oak_latest_tab</span><span class="p">[</span><span class="s1">&#39;Import-Empty&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df_oak_latest_tab</span><span class="p">[</span><span class="s1">&#39;Export-Empty&#39;</span><span class="p">]</span>
<span class="n">df_oak_latest_tab</span><span class="p">[</span><span class="s1">&#39;Grand-Total&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_oak_latest_tab</span><span class="p">[</span><span class="s1">&#39;Total-Full&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df_oak_latest_tab</span><span class="p">[</span><span class="s1">&#39;Total-Empty&#39;</span><span class="p">]</span>

<span class="c1">#df_oak_latest_tab.head()</span>

<span class="n">df_oak_combined</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_oakland</span><span class="p">,</span> <span class="n">df_oak_latest_tab</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Port-of-Oakland">Port of Oakland<a class="anchor-link" href="#Port-of-Oakland">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_oak_combined</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Total-Full&#39;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Oakland&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_oak_combined</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Total-Empty&#39;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Oakland&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_oak_combined</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Grand-Total&#39;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Oakland&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<hr>
&copy; <script>document.write(`${new Date().getFullYear()}`);</script> pymoment
</div>
</div>
</body>


<script>
// TODO - some, or all of this could be moved to pre-rendering sed/regex
// add bootstrap table styles to pandoc tables (notebooks)
$(document).ready( () => {

  $('tr').parent('thead').parent('table').addClass('table table-condensed');
  $('tr').parent('thead').parent('table').removeAttr('border');
  $('tr').parent('thead').parent('table').removeClass('dataframe');

  $('.output_area .output_html table thead tr').removeAttr('style');
  $('.output_area .output_html table thead tr th').attr("scope", "col");

  $('.output_area .output_html table tbody tr th').attr("scope", "row");


  // Change the input cell gutter text, make it a link
  $('.input .input_prompt').map((n, e) => {
    e.innerHTML = `<a href="#" >Show Code Cell [${n + 1}]</a>`;
  });

  // Attach an event listener to the above link for show/hide
  $('.input .input_prompt a').map((n, e) => {
    const showOrHide = e => {
      e.preventDefault();
      $(`#code-${n}`).find('.inner_cell').toggleClass('collapse');
      const v = $(`#code-${n}`).find('.input_prompt a');
      if (v.html().includes('Show')) {
        v.html(`Hide Code Cell [${n+1}]`);
      } else {
        v.html(`Show Code Cell [${n+1}]`);
      }
    }

    e.addEventListener("click", showOrHide, false);
  });

  // Annotate parent cells of input cells with id/classes
  $('.input .inner_cell').map((n, e) => {
    $('.input .inner_cell').parent('div').toArray()[n].id = `code-${n}`;
  });
  $('.input .inner_cell')
    .addClass("collapse")
    .after('<div class="inner_cell" style="font-size: 150%; padding-left: 5px;">...</div>');

});
</script>
    

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-L3L3NJKFJP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-L3L3NJKFJP');
</script>

</html>
