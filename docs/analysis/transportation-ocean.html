<p><small>Exported from <a href="http://github.com/kdunn926/us-macro/blob/24f3d6ee238536eb74492683e67d95d0a81df606/analysis/transportation-ocean.ipynb"><code>analysis/transportation-ocean.ipynb</code></a> committed by GitHub Action on Sat Dec 11 00:39:41 2021 <a href="http://github.com/kdunn926/us-macro/commit/24f3d6ee238536eb74492683e67d95d0a81df606">revision 1, 24f3d6e</a> <a href="https://stephenslab.github.io/ipynb-website/notes.html#Note-about-commit-ids"><span class="fa fa-question-circle"></span></a></small></p>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="ipynb_website:version" content="0.9.7" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="twitter:card" content="summary_large_image"></meta>
<meta property="og:title" content="US Macroeconomic Data Explorer | US Seaport Volumes" />
<meta property="og:type" content="article" />
<meta property="og:description" content="A look at shipping port traffic, according to TEU reports from each of the top 10 port authorities." />
<meta property="og:image" content="https://kdunn926.github.io/us-macro/analysis/transportation-ocean.png" />
<meta property="og:url" content="https://kdunn926.github.io/us-macro/analysis/transportation-ocean.html" />

<!-- begin stylesheets -->

<link rel="stylesheet"
    href="../css/jt.css">
<link rel="stylesheet"
    href="../css/toc2.css">
<link rel="stylesheet"
    href="../site_libs/jqueryui-1.11.4/jquery-ui.css">
<link rel="stylesheet"
    href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
<link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
<link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/styles/default.min.css">
    
<link rel="stylesheet" type="text/css" href="../css/readable.css">
<!-- end stylesheets -->

<!-- begin javascript -->

<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- Bootstrap 4 -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

<!-- Vega/Vegalite -->
<script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-lite@4"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/highlight.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    
<!-- end javascript -->


<script>hljs.initHighlightingOnLoad();</script>
<script type="text/javascript">
    if (window.hljs &&
        document.readyState &&
        document.readyState === "complete") {
       window.setTimeout(() => {
          hljs.initHighlighting();
       }, 0);
    }
</script>
    

<script src="../js/doc_toc.js"></script>
<script src="../js/docs.js"></script>


<script>
    MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": {
            preferredFont: "TeX",
            availableFonts: ["TeX"],
            styles: {
                scale: 110,
                ".MathJax_Display": {
                    "font-size": "110%%",
                }
            }
        }
    });
</script>
    

<script>
function filterDataFrame(id) {
    var input = document.getElementById("search_" + id);
    var filter = input.value.toUpperCase();
    var table = document.getElementById("dataframe_" + id);
    var tr = table.getElementsByTagName("tr");
    // Loop through all table rows, and hide those who don't match the search query
    for (var i = 1; i < tr.length; i++) {
        for (var j = 0; j < tr[i].cells.length; ++j) {
            var matched = false;
            if (tr[i].cells[j].innerHTML.toUpperCase().indexOf(filter) != -1) {
                tr[i].style.display = "";
                matched = true
                break;
            }
            if (!matched)
                tr[i].style.display = "none";
        }
    }
}

function sortDataFrame(id, n, dtype) {
    var table = document.getElementById("dataframe_" + id);
    var tb = table.tBodies[0]; // use `<tbody>` to ignore `<thead>` and `<tfoot>` rows
    var tr = Array.prototype.slice.call(tb.rows, 0); // put rows into array
    if (dtype === 'numeric') {
        var fn = (a, b) =>
            parseFloat(a.cells[n].textContent) <= parseFloat(b.cells[n].textContent) ? -1 : 1;
    } else {
        var fn = function(a, b) {
            var c = a.cells[n].textContent.trim().localeCompare(b.cells[n].textContent.trim());
            return c > 0 ? 1 : (c < 0 ? -1 : 0) }
    }
    var isSorted = function(array, fn) {
        if (array.length < 2)
            return 1;
        var direction = fn(array[0], array[1]);
        for (var i = 1; i < array.length - 1; ++i) {
            var d = fn(array[i], array[i+1]);
            if (d == 0)
                continue;
            else if (direction == 0)
                direction = d;
            else if (direction != d)
                return 0;
            }
        return direction;
    }
    var sorted = isSorted(tr, fn);
    if (sorted == 1 || sorted == -1) {
        // if sorted already, reverse it
        for(var i = tr.length - 1; i >= 0; --i)
            tb.appendChild(tr[i]); // append each row in order
    } else {
        tr = tr.sort(fn);
        for(var i = 0; i < tr.length; ++i)
            tb.appendChild(tr[i]); // append each row in order
    }
}
</script>




<script>
    // manage active state of menu based on current page
    $(document).ready(function () {
      // active menu anchor
      href = window.location.pathname
      href = href.substr(href.lastIndexOf('/') + 1)
      if (href === "")
        href = "index.html";
      var menuAnchor = $('a[href*="' + href + '"]');
      // mark it active
      menuAnchor.parent().addClass('active');
      // if it's got a parent navbar menu mark it active as well
      menuAnchor.closest('li.dropdown').addClass('active');
    });
</script>
    

<div class="container-fluid main-container">

<!-- tabsets -->
<script src="../site_libs/navigation-1.1/tabsets.js"></script>
<script>
    $(document).ready(function () {
      window.buildTabsets("TOC");
    });
</script>



<title>US Macroeconomic Data Explorer | US Seaport Volumes</title>

<style type = "text/css">
    body {
      
    }
</style>
</head>

<body>
<div tabindex="-1" id="notebook" class="border-box-sizing">
<div class="container" id="notebook-container">

<!-- code folding -->


<nav class="navbar navbar-expand-lg sticky-top navbar-light bg-light">
    <a class="navbar-brand" href="../index.html">US Macroeconomic Data Explorer</a>
    <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#navbar" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="navbar-nav mr-auto">
        
<li class="nav-item">
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
</li>
        
<li class="nav-item dropdown">
  <a class="nav-link dropdown-toggle btn" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="background-color: steelblue; color: white;">
    Explore other charts
  </a>
  <div class="dropdown-menu" aria-labelledby="navbarDropdown">
  

    <a class="dropdown-item" href="../analysis/autos.html">Autos</a>
        
    <a class="dropdown-item" href="../analysis/construction.html">Construction</a>
        
    <a class="dropdown-item" href="../analysis/creditcards.html">Creditcards</a>
        
    <a class="dropdown-item" href="../analysis/dairy.html">Dairy</a>
        
    <a class="dropdown-item" href="../analysis/electricity.html">Electricity</a>
        
    <a class="dropdown-item" href="../analysis/international-trade.html">International Trade</a>
        
    <a class="dropdown-item" href="../analysis/labor.html">Labor</a>
        
    <a class="dropdown-item" href="../analysis/manufacturing.html">Manufacturing</a>
        
    <a class="dropdown-item" href="../analysis/oil-gas-inventories.html">Oil Gas Inventories</a>
        
    <a class="dropdown-item" href="../analysis/residential-realestate-zillow.html">Residential Realestate Zillow</a>
        
    <a class="dropdown-item" href="../analysis/residential-realestate.html">Residential Realestate</a>
        
    <a class="dropdown-item" href="../analysis/retailsales.html">Retailsales</a>
        
    <a class="dropdown-item" href="../analysis/sentiment.html">Sentiment</a>
        
    <a class="dropdown-item" href="../analysis/services.html">Services</a>
        
    <a class="dropdown-item" href="../analysis/sp500-returns-and-performance.html">Sp500 Returns And Performance</a>
        
    <a class="dropdown-item" href="../analysis/transportation-air-waterway.html">Transportation Air Waterway</a>
        
    <a class="dropdown-item" href="../analysis/transportation-cass.html">Transportation Cass</a>
        
    <a class="dropdown-item" href="../analysis/transportation-ocean.html">Transportation Ocean</a>
        
    <a class="dropdown-item" href="../analysis/transportation-rail.html">Transportation Rail</a>
        
    <a class="dropdown-item" href="../analysis/us-treasury-auctions.html">Us Treasury Auctions</a>
        
    <a class="dropdown-item" href="../analysis/us-treasury-rates.html">Us Treasury Rates</a>
        
  </div>
</li>
      </ul>
        
<ul class="navbar-nav">
<li class="nav-item">
   <a class="nav-link" href="http://github.com/kdunn926/us-macro"> source </a>
</li>
</ul>
        
    </div><!--/.nav-collapse -->
</nav><!--/.navbar -->
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="US-Seaport-Volumes">US Seaport Volumes<a class="anchor-link" href="#US-Seaport-Volumes">&#182;</a></h1><hr>
<h4 id="For-the-top-10-ports-(80%25-of-all-TEUs)">For the top 10 ports (80% of all TEUs)<a class="anchor-link" href="#For-the-top-10-ports-(80%25-of-all-TEUs)">&#182;</a></h4><p>Note: TEU means "Twenty-foot [container] Equivalent Unit"</p>
<p>A look at shipping port traffic, according to TEU reports from each of the top 10 port authorities.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">json</span> <span class="kn">import</span> <span class="n">loads</span><span class="p">,</span> <span class="n">JSONDecodeError</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">environ</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>
<span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">HTML</span>

<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">from</span> <span class="nn">joblib</span> <span class="kn">import</span> <span class="n">Memory</span>

<span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span><span class="p">,</span> <span class="n">Request</span>
<span class="kn">from</span> <span class="nn">urllib.error</span> <span class="kn">import</span> <span class="n">HTTPError</span><span class="p">,</span> <span class="n">URLError</span>

<span class="kn">from</span> <span class="nn">tabula</span> <span class="kn">import</span> <span class="n">read_pdf</span>

<span class="kn">from</span> <span class="nn">googleapi.google</span> <span class="kn">import</span> <span class="n">search</span> <span class="k">as</span> <span class="n">googleSearch</span>

<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.support.ui</span> <span class="kn">import</span> <span class="n">WebDriverWait</span>
<span class="kn">from</span> <span class="nn">selenium.common.exceptions</span> <span class="kn">import</span> <span class="n">WebDriverException</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.chrome.options</span> <span class="kn">import</span> <span class="n">Options</span>
<span class="kn">import</span> <span class="nn">selenium.webdriver.support.expected_conditions</span> <span class="k">as</span> <span class="nn">EC</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.by</span> <span class="kn">import</span> <span class="n">By</span>

<span class="k">def</span> <span class="nf">ajaxComplete</span><span class="p">(</span><span class="n">driver</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span> <span class="o">==</span> <span class="n">driver</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s2">&quot;return jQuery.active&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">WebDriverException</span><span class="p">:</span>
        <span class="k">pass</span>
    
<span class="n">chrome_options</span> <span class="o">=</span> <span class="n">Options</span><span class="p">()</span>
<span class="n">chrome_options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--disable-extensions&quot;</span><span class="p">)</span>
<span class="n">chrome_options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--disable-gpu&quot;</span><span class="p">)</span>
<span class="n">chrome_options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--headless&quot;</span><span class="p">)</span>
<span class="c1">#chrome_options.add_argument(&quot;download.default_directory=/tmp&quot;)</span>
<span class="n">chrome_options</span><span class="o">.</span><span class="n">add_experimental_option</span><span class="p">(</span><span class="s2">&quot;prefs&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="s2">&quot;download.default_directory&quot;</span> <span class="p">:</span> <span class="s2">&quot;/tmp&quot;</span> <span class="p">})</span>

<span class="k">if</span> <span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;GITHUB_WORKFLOW&quot;</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Requires manual updates&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">doChart</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Oakland&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Full-Total&#39;</span><span class="p">):</span>
    <span class="c1">#metric = &#39;Full-Total&#39;</span>

    <span class="k">return</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[[</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">&#39;dt:T&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)),</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s1">:Q&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Volume [TEUs]&#39;</span><span class="p">)),</span>
        <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="n">alt</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">&quot;dt:T&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%b %Y&quot;</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s2">:Q&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;,.02f&quot;</span><span class="p">)]</span>
    <span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Port of </span><span class="si">{</span><span class="n">location</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s1"> Container Volume&#39;</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">750</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">400</span>
    <span class="p">)</span>

<span class="k">def</span> <span class="nf">doYoyChart</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Oakland&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Full-Total&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>

    <span class="n">brush</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;interval&#39;</span><span class="p">,</span> <span class="n">encodings</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span>
    
    <span class="n">base</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[[</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">&#39;dt:T&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)),</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s1">:Q&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Volume [TEUs]&#39;</span><span class="p">)),</span>
        <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="n">alt</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="s2">&quot;dt:T&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%b %Y&quot;</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">Tooltip</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;nolarge:Q&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;,.02f&quot;</span><span class="p">)]</span>
    <span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">750</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">400</span>
    <span class="p">)</span>

    <span class="n">upper</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">transform_window</span><span class="p">(</span>
        <span class="n">window</span><span class="o">=</span><span class="p">[</span><span class="n">alt</span><span class="o">.</span><span class="n">WindowFieldDef</span><span class="p">(</span><span class="s2">&quot;lag&quot;</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span> <span class="s1">&#39;as&#39;</span><span class="p">:</span> <span class="s1">&#39;previous&#39;</span> <span class="p">})],</span>
        <span class="n">sort</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;dt&quot;</span><span class="p">}],</span>
    <span class="p">)</span><span class="o">.</span><span class="n">transform_calculate</span><span class="p">(</span>
        <span class="n">yoy</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;((datum[&#39;</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s2">&#39;] - datum.previous) / datum.previous) * 100&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">&#39;dt:T&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="n">brush</span><span class="p">),</span> <span class="n">impute</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">ImputeParams</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">)),</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;yoy:Q&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Year-over-Year Volume Growth [%]&#39;</span><span class="p">),</span> <span class="n">impute</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">ImputeParams</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">keyvals</span><span class="o">=</span><span class="p">[</span><span class="mi">400</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])),</span>
        <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;datum[&#39;yoy&#39;] &lt; 0&quot;</span><span class="p">,</span>
            <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;lightsalmon&#39;</span><span class="p">),</span>
            <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;royalblue&#39;</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Port of </span><span class="si">{</span><span class="n">location</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s1"> Container Volume&#39;</span><span class="p">,</span>
    <span class="p">)</span>
    
    <span class="n">lower</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">100</span>
    <span class="p">)</span><span class="o">.</span><span class="n">add_selection</span><span class="p">(</span><span class="n">brush</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">upper</span> <span class="o">&amp;</span> <span class="n">lower</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">background</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
    

<span class="n">uaString</span> <span class="o">=</span> <span class="s1">&#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.1916.47 Safari/537.36&#39;</span>

<span class="n">memory</span> <span class="o">=</span> <span class="n">Memory</span><span class="p">(</span><span class="s1">&#39;data/&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;&lt;h4&gt;&lt;i&gt;(data current as of </span><span class="si">{}</span><span class="s2">)&lt;/i&gt;&lt;/h4&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%B </span><span class="si">%d</span><span class="s2">, %Y&quot;</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[3]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result"><h4><i>(data current as of November 03, 2021)</i></h4></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Port-of-Los-Angeles">Port of Los Angeles<a class="anchor-link" href="#Port-of-Los-Angeles">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Port of Los Angeles</span>
<span class="c1"># https://www.portoflosangeles.org/business/statistics/container-statistics</span>

<span class="c1"># 1995</span>
<span class="c1"># https://www.portoflosangeles.org/business/statistics/container-statistics/historical-teu-statistics-2019</span>

<span class="nd">@memory</span><span class="o">.</span><span class="n">cache</span>
<span class="k">def</span> <span class="nf">fetchLaData</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;skiprows&#39;</span><span class="p">:</span> <span class="mi">1</span> <span class="p">}):</span>
 
    <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span> <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="n">uaString</span> <span class="p">})</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>

    <span class="n">tmp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">()),</span> <span class="o">**</span><span class="n">args</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">cols</span>
    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1">#print(tmp.head())</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        
    <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">year</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%B-%Y&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">tmp</span>

<span class="k">def</span> <span class="nf">fetchLaDataNoCache</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;skiprows&#39;</span><span class="p">:</span> <span class="mi">1</span> <span class="p">}):</span>
 
    <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span> <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="n">uaString</span> <span class="p">})</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>

    <span class="n">tmp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">()),</span> <span class="o">**</span><span class="n">args</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">cols</span>
    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1">#print(tmp.head())</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        
    <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">year</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%B-%Y&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">tmp</span>

<span class="n">colsPre96</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Loaded Imports&#39;</span><span class="p">,</span> <span class="s1">&#39;Empty Imports&#39;</span><span class="p">,</span> <span class="s1">&#39;Total Imports&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Loaded Export&#39;</span><span class="p">,</span> <span class="s1">&#39;Empty Exports&#39;</span><span class="p">,</span> <span class="s1">&#39;Total TEUs&#39;</span><span class="p">,</span> <span class="s1">&#39;Prior Year Change&#39;</span><span class="p">]</span>

<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Loaded Imports&#39;</span><span class="p">,</span> <span class="s1">&#39;Empty Imports&#39;</span><span class="p">,</span> <span class="s1">&#39;Total Imports&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Loaded Export&#39;</span><span class="p">,</span> <span class="s1">&#39;Empty Exports&#39;</span><span class="p">,</span> <span class="s1">&#39;Total Exports&#39;</span><span class="p">,</span> <span class="s1">&#39;Total TEUs&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Prior Year Change&#39;</span><span class="p">]</span>

<span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;skiprows&#39;</span><span class="p">:</span> <span class="mi">1</span>
<span class="p">}</span>

<span class="n">urlFor</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="s2">&quot;https://www.portoflosangeles.org/business/statistics/container-statistics/historical-teu-statistics-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="n">dfs_la</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1995</span><span class="p">,</span> <span class="mi">2022</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">urlFor</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="c1">#print(url)</span>
    <span class="k">if</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mi">1996</span><span class="p">:</span>
        <span class="n">dfs_la</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fetchLaData</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">colsPre96</span><span class="p">,</span> <span class="n">args</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">y</span> <span class="o">==</span> <span class="mi">2021</span><span class="p">:</span>
        <span class="n">dfs_la</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fetchLaDataNoCache</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="p">{}))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dfs_la</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fetchLaData</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="p">{}))</span>

<span class="n">df_la</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dfs_la</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span> <span class="c1">#.tail()</span>

<span class="n">df_la</span><span class="p">[</span><span class="n">cols</span><span class="p">[:</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df_la</span><span class="p">[</span><span class="n">cols</span><span class="p">[:</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">)</span>

<span class="n">extractValue</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;\.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df_la</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="s1">&#39;Prior Year Change&#39;</span><span class="p">]:</span>
        <span class="k">continue</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">df_la</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_la</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="n">df_la</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_la</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">extractValue</span><span class="p">)</span>

<span class="c1">#df_la.head()</span>

<span class="c1">#df_la_smoothed = df_la.set_index(&#39;dt&#39;).resample(&#39;2M&#39;).mean().reset_index()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_la</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Los Angeles&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Loaded Imports&#39;</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;transportation-ocean.png&#39;</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



   
        
            
<div class="output_html rendered_html output_subarea ">
<div id="altair-viz-a26efb6bfd68465284b25ccc2bec0965"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-a26efb6bfd68465284b25ccc2bec0965") {
      outputDiv = document.getElementById("altair-viz-a26efb6bfd68465284b25ccc2bec0965");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector001"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Los Angeles Loaded Imports Container Volume", "transform": [{"window": [{"op": "lag", "field": "Loaded Imports", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Loaded Imports'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt"}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Loaded Imports"}}, "height": 100, "selection": {"selector001": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-253c4ac48ca81da69e2b3efbfbaa1341"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-253c4ac48ca81da69e2b3efbfbaa1341": [{"dt": "1996-01-01T00:00:00", "Loaded Imports": 96275.55}, {"dt": "1996-02-01T00:00:00", "Loaded Imports": 87376.8}, {"dt": "1996-03-01T00:00:00", "Loaded Imports": 82048.45}, {"dt": "1996-04-01T00:00:00", "Loaded Imports": 95875.55}, {"dt": "1996-05-01T00:00:00", "Loaded Imports": 103847.85}, {"dt": "1996-06-01T00:00:00", "Loaded Imports": 107809.45}, {"dt": "1996-07-01T00:00:00", "Loaded Imports": 118129.65}, {"dt": "1996-08-01T00:00:00", "Loaded Imports": 123216.85}, {"dt": "1996-09-01T00:00:00", "Loaded Imports": 123341.35}, {"dt": "1996-10-01T00:00:00", "Loaded Imports": 130603.75}, {"dt": "1996-11-01T00:00:00", "Loaded Imports": 116594.15}, {"dt": "1996-12-01T00:00:00", "Loaded Imports": 108355.15}, {"dt": "1997-01-01T00:00:00", "Loaded Imports": 115349.0}, {"dt": "1997-02-01T00:00:00", "Loaded Imports": 100956.55}, {"dt": "1997-03-01T00:00:00", "Loaded Imports": 102389.0}, {"dt": "1997-04-01T00:00:00", "Loaded Imports": 117035.2}, {"dt": "1997-05-01T00:00:00", "Loaded Imports": 123100.3}, {"dt": "1997-06-01T00:00:00", "Loaded Imports": 127693.25}, {"dt": "1997-07-01T00:00:00", "Loaded Imports": 130480.85}, {"dt": "1997-08-01T00:00:00", "Loaded Imports": 132618.55}, {"dt": "1997-09-01T00:00:00", "Loaded Imports": 132919.35}, {"dt": "1997-10-01T00:00:00", "Loaded Imports": 133849.15}, {"dt": "1997-11-01T00:00:00", "Loaded Imports": 123957.55}, {"dt": "1997-12-01T00:00:00", "Loaded Imports": 122273.15}, {"dt": "1998-01-01T00:00:00", "Loaded Imports": 116863.55}, {"dt": "1998-02-01T00:00:00", "Loaded Imports": 109819.0}, {"dt": "1998-03-01T00:00:00", "Loaded Imports": 142929.1}, {"dt": "1998-04-01T00:00:00", "Loaded Imports": 141028.2}, {"dt": "1998-05-01T00:00:00", "Loaded Imports": 155896.05}, {"dt": "1998-06-01T00:00:00", "Loaded Imports": 148826.0}, {"dt": "1998-07-01T00:00:00", "Loaded Imports": 147328.7}, {"dt": "1998-08-01T00:00:00", "Loaded Imports": 161600.95}, {"dt": "1998-09-01T00:00:00", "Loaded Imports": 147914.45}, {"dt": "1998-10-01T00:00:00", "Loaded Imports": 161150.95}, {"dt": "1998-11-01T00:00:00", "Loaded Imports": 150339.05}, {"dt": "1998-12-01T00:00:00", "Loaded Imports": 131718.3}, {"dt": "1999-01-01T00:00:00", "Loaded Imports": 132118.15}, {"dt": "1999-02-01T00:00:00", "Loaded Imports": 134281.3}, {"dt": "1999-03-01T00:00:00", "Loaded Imports": 133886.8}, {"dt": "1999-04-01T00:00:00", "Loaded Imports": 146258.45}, {"dt": "1999-05-01T00:00:00", "Loaded Imports": 175535.2}, {"dt": "1999-06-01T00:00:00", "Loaded Imports": 161750.75}, {"dt": "1999-07-01T00:00:00", "Loaded Imports": 176444.6}, {"dt": "1999-08-01T00:00:00", "Loaded Imports": 180684.75}, {"dt": "1999-09-01T00:00:00", "Loaded Imports": 180795.8}, {"dt": "1999-10-01T00:00:00", "Loaded Imports": 198681.1}, {"dt": "1999-11-01T00:00:00", "Loaded Imports": 174939.0}, {"dt": "1999-12-01T00:00:00", "Loaded Imports": 170476.75}, {"dt": "2000-01-01T00:00:00", "Loaded Imports": 185913.65}, {"dt": "2000-02-01T00:00:00", "Loaded Imports": 167829.75}, {"dt": "2000-03-01T00:00:00", "Loaded Imports": 180682.35}, {"dt": "2000-04-01T00:00:00", "Loaded Imports": 211262.3}, {"dt": "2000-05-01T00:00:00", "Loaded Imports": 204191.85}, {"dt": "2000-06-01T00:00:00", "Loaded Imports": 211118.5}, {"dt": "2000-07-01T00:00:00", "Loaded Imports": 232730.4}, {"dt": "2000-08-01T00:00:00", "Loaded Imports": 235529.25}, {"dt": "2000-09-01T00:00:00", "Loaded Imports": 220572.95}, {"dt": "2000-10-01T00:00:00", "Loaded Imports": 250875.35}, {"dt": "2000-11-01T00:00:00", "Loaded Imports": 199387.15}, {"dt": "2000-12-01T00:00:00", "Loaded Imports": 192452.8}, {"dt": "2001-01-01T00:00:00", "Loaded Imports": 201491.75}, {"dt": "2001-02-01T00:00:00", "Loaded Imports": 154024.25}, {"dt": "2001-03-01T00:00:00", "Loaded Imports": 206780.1}, {"dt": "2001-04-01T00:00:00", "Loaded Imports": 210732.05}, {"dt": "2001-05-01T00:00:00", "Loaded Imports": 203241.95}, {"dt": "2001-06-01T00:00:00", "Loaded Imports": 232201.85}, {"dt": "2001-07-01T00:00:00", "Loaded Imports": 238957.6}, {"dt": "2001-08-01T00:00:00", "Loaded Imports": 252137.2}, {"dt": "2001-09-01T00:00:00", "Loaded Imports": 267579.75}, {"dt": "2001-10-01T00:00:00", "Loaded Imports": 265721.7}, {"dt": "2001-11-01T00:00:00", "Loaded Imports": 234132.15}, {"dt": "2001-12-01T00:00:00", "Loaded Imports": 216656.7}, {"dt": "2002-01-01T00:00:00", "Loaded Imports": 210394.25}, {"dt": "2002-02-01T00:00:00", "Loaded Imports": 234405.15}, {"dt": "2002-03-01T00:00:00", "Loaded Imports": 218697.5}, {"dt": "2002-04-01T00:00:00", "Loaded Imports": 258026.4}, {"dt": "2002-05-01T00:00:00", "Loaded Imports": 274449.3}, {"dt": "2002-06-01T00:00:00", "Loaded Imports": 291966.3}, {"dt": "2002-07-01T00:00:00", "Loaded Imports": 260811.15}, {"dt": "2002-08-01T00:00:00", "Loaded Imports": 327471.85}, {"dt": "2002-09-01T00:00:00", "Loaded Imports": 320577.65}, {"dt": "2002-10-01T00:00:00", "Loaded Imports": 252909.65}, {"dt": "2002-11-01T00:00:00", "Loaded Imports": 291571.45}, {"dt": "2002-12-01T00:00:00", "Loaded Imports": 291130.5}, {"dt": "2003-01-01T00:00:00", "Loaded Imports": 264680.65}, {"dt": "2003-02-01T00:00:00", "Loaded Imports": 270731.25}, {"dt": "2003-03-01T00:00:00", "Loaded Imports": 293532.75}, {"dt": "2003-04-01T00:00:00", "Loaded Imports": 319620.55}, {"dt": "2003-05-01T00:00:00", "Loaded Imports": 340164.7}, {"dt": "2003-06-01T00:00:00", "Loaded Imports": 301151.35}, {"dt": "2003-07-01T00:00:00", "Loaded Imports": 326753.45}, {"dt": "2003-08-01T00:00:00", "Loaded Imports": 354433.85}, {"dt": "2003-09-01T00:00:00", "Loaded Imports": 342068.0}, {"dt": "2003-10-01T00:00:00", "Loaded Imports": 365198.85}, {"dt": "2003-11-01T00:00:00", "Loaded Imports": 334215.45}, {"dt": "2003-12-01T00:00:00", "Loaded Imports": 301922.4}, {"dt": "2004-01-01T00:00:00", "Loaded Imports": 340907.8}, {"dt": "2004-02-01T00:00:00", "Loaded Imports": 242928.3}, {"dt": "2004-03-01T00:00:00", "Loaded Imports": 334547.75}, {"dt": "2004-04-01T00:00:00", "Loaded Imports": 339942.9}, {"dt": "2004-05-01T00:00:00", "Loaded Imports": 361413.3}, {"dt": "2004-06-01T00:00:00", "Loaded Imports": 340625.2}, {"dt": "2004-07-01T00:00:00", "Loaded Imports": 361584.3}, {"dt": "2004-08-01T00:00:00", "Loaded Imports": 339428.1}, {"dt": "2004-09-01T00:00:00", "Loaded Imports": 318722.15}, {"dt": "2004-10-01T00:00:00", "Loaded Imports": 347354.6}, {"dt": "2004-11-01T00:00:00", "Loaded Imports": 335855.4}, {"dt": "2004-12-01T00:00:00", "Loaded Imports": 277110.1}, {"dt": "2005-01-01T00:00:00", "Loaded Imports": 298435.35}, {"dt": "2005-02-01T00:00:00", "Loaded Imports": 289415.4}, {"dt": "2005-03-01T00:00:00", "Loaded Imports": 255389.9}, {"dt": "2005-04-01T00:00:00", "Loaded Imports": 329094.2}, {"dt": "2005-05-01T00:00:00", "Loaded Imports": 313026.85}, {"dt": "2005-06-01T00:00:00", "Loaded Imports": 334823.5}, {"dt": "2005-07-01T00:00:00", "Loaded Imports": 352416.8}, {"dt": "2005-08-01T00:00:00", "Loaded Imports": 343029.25}, {"dt": "2005-09-01T00:00:00", "Loaded Imports": 350754.85}, {"dt": "2005-10-01T00:00:00", "Loaded Imports": 368524.2}, {"dt": "2005-11-01T00:00:00", "Loaded Imports": 325089.9}, {"dt": "2005-12-01T00:00:00", "Loaded Imports": 321326.15}, {"dt": "2006-01-01T00:00:00", "Loaded Imports": 321696.7}, {"dt": "2006-02-01T00:00:00", "Loaded Imports": 247693.0}, {"dt": "2006-03-01T00:00:00", "Loaded Imports": 340793.55}, {"dt": "2006-04-01T00:00:00", "Loaded Imports": 365187.9}, {"dt": "2006-05-01T00:00:00", "Loaded Imports": 362494.6}, {"dt": "2006-06-01T00:00:00", "Loaded Imports": 380852.5}, {"dt": "2006-07-01T00:00:00", "Loaded Imports": 404664.55}, {"dt": "2006-08-01T00:00:00", "Loaded Imports": 405303.05}, {"dt": "2006-09-01T00:00:00", "Loaded Imports": 425473.75}, {"dt": "2006-10-01T00:00:00", "Loaded Imports": 412554.4}, {"dt": "2006-11-01T00:00:00", "Loaded Imports": 382404.65}, {"dt": "2006-12-01T00:00:00", "Loaded Imports": 359066.6}, {"dt": "2007-01-01T00:00:00", "Loaded Imports": 360191.45}, {"dt": "2007-02-01T00:00:00", "Loaded Imports": 353009.95}, {"dt": "2007-03-01T00:00:00", "Loaded Imports": 318279.3}, {"dt": "2007-04-01T00:00:00", "Loaded Imports": 368682.95}, {"dt": "2007-05-01T00:00:00", "Loaded Imports": 361683.05}, {"dt": "2007-06-01T00:00:00", "Loaded Imports": 387314.3}, {"dt": "2007-07-01T00:00:00", "Loaded Imports": 382247.05}, {"dt": "2007-08-01T00:00:00", "Loaded Imports": 374225.9}, {"dt": "2007-09-01T00:00:00", "Loaded Imports": 403658.8}, {"dt": "2007-10-01T00:00:00", "Loaded Imports": 385529.75}, {"dt": "2007-11-01T00:00:00", "Loaded Imports": 375271.45}, {"dt": "2007-12-01T00:00:00", "Loaded Imports": 340075.65}, {"dt": "2008-01-01T00:00:00", "Loaded Imports": 343529.2}, {"dt": "2008-02-01T00:00:00", "Loaded Imports": 318444.95}, {"dt": "2008-03-01T00:00:00", "Loaded Imports": 295955.6}, {"dt": "2008-04-01T00:00:00", "Loaded Imports": 328403.4}, {"dt": "2008-05-01T00:00:00", "Loaded Imports": 371026.95}, {"dt": "2008-06-01T00:00:00", "Loaded Imports": 339102.25}, {"dt": "2008-07-01T00:00:00", "Loaded Imports": 367496.5}, {"dt": "2008-08-01T00:00:00", "Loaded Imports": 401137.35}, {"dt": "2008-09-01T00:00:00", "Loaded Imports": 367159.25}, {"dt": "2008-10-01T00:00:00", "Loaded Imports": 370986.9}, {"dt": "2008-11-01T00:00:00", "Loaded Imports": 338905.3}, {"dt": "2008-12-01T00:00:00", "Loaded Imports": 296442.7}, {"dt": "2009-01-01T00:00:00", "Loaded Imports": 317493.1}, {"dt": "2009-02-01T00:00:00", "Loaded Imports": 206034.5}, {"dt": "2009-03-01T00:00:00", "Loaded Imports": 277569.8}, {"dt": "2009-04-01T00:00:00", "Loaded Imports": 279194.15}, {"dt": "2009-05-01T00:00:00", "Loaded Imports": 304109.9}, {"dt": "2009-06-01T00:00:00", "Loaded Imports": 281175.05}, {"dt": "2009-07-01T00:00:00", "Loaded Imports": 305225.75}, {"dt": "2009-08-01T00:00:00", "Loaded Imports": 323629.2}, {"dt": "2009-09-01T00:00:00", "Loaded Imports": 309078.3}, {"dt": "2009-10-01T00:00:00", "Loaded Imports": 338734.75}, {"dt": "2009-11-01T00:00:00", "Loaded Imports": 298777.4}, {"dt": "2009-12-01T00:00:00", "Loaded Imports": 283364.4}, {"dt": "2010-01-01T00:00:00", "Loaded Imports": 296304.95}, {"dt": "2010-02-01T00:00:00", "Loaded Imports": 267361.15}, {"dt": "2010-03-01T00:00:00", "Loaded Imports": 269634.1}, {"dt": "2010-04-01T00:00:00", "Loaded Imports": 302224.6}, {"dt": "2010-05-01T00:00:00", "Loaded Imports": 342171.1}, {"dt": "2010-06-01T00:00:00", "Loaded Imports": 371888.6}, {"dt": "2010-07-01T00:00:00", "Loaded Imports": 369388.9}, {"dt": "2010-08-01T00:00:00", "Loaded Imports": 399150.65}, {"dt": "2010-09-01T00:00:00", "Loaded Imports": 373249.35}, {"dt": "2010-10-01T00:00:00", "Loaded Imports": 349545.4}, {"dt": "2010-11-01T00:00:00", "Loaded Imports": 333710.15}, {"dt": "2010-12-01T00:00:00", "Loaded Imports": 299304.45}, {"dt": "2011-01-01T00:00:00", "Loaded Imports": 338606.65}, {"dt": "2011-02-01T00:00:00", "Loaded Imports": 275886.5}, {"dt": "2011-03-01T00:00:00", "Loaded Imports": 297023.1}, {"dt": "2011-04-01T00:00:00", "Loaded Imports": 312359.9}, {"dt": "2011-05-01T00:00:00", "Loaded Imports": 360969.25}, {"dt": "2011-06-01T00:00:00", "Loaded Imports": 333894.3}, {"dt": "2011-07-01T00:00:00", "Loaded Imports": 357667.7}, {"dt": "2011-08-01T00:00:00", "Loaded Imports": 376189.55}, {"dt": "2011-09-01T00:00:00", "Loaded Imports": 372655.2}, {"dt": "2011-10-01T00:00:00", "Loaded Imports": 368842.95}, {"dt": "2011-11-01T00:00:00", "Loaded Imports": 354313.1}, {"dt": "2011-12-01T00:00:00", "Loaded Imports": 318355.65}, {"dt": "2012-01-01T00:00:00", "Loaded Imports": 356394.7}, {"dt": "2012-02-01T00:00:00", "Loaded Imports": 254359.6}, {"dt": "2012-03-01T00:00:00", "Loaded Imports": 324758.0}, {"dt": "2012-04-01T00:00:00", "Loaded Imports": 364555.15}, {"dt": "2012-05-01T00:00:00", "Loaded Imports": 370721.75}, {"dt": "2012-06-01T00:00:00", "Loaded Imports": 353930.55}, {"dt": "2012-07-01T00:00:00", "Loaded Imports": 371859.15}, {"dt": "2012-08-01T00:00:00", "Loaded Imports": 360762.1}, {"dt": "2012-09-01T00:00:00", "Loaded Imports": 385250.3}, {"dt": "2012-10-01T00:00:00", "Loaded Imports": 364881.9}, {"dt": "2012-11-01T00:00:00", "Loaded Imports": 288273.5}, {"dt": "2012-12-01T00:00:00", "Loaded Imports": 296874.45}, {"dt": "2013-01-01T00:00:00", "Loaded Imports": 337428.3}, {"dt": "2013-02-01T00:00:00", "Loaded Imports": 318547.0}, {"dt": "2013-03-01T00:00:00", "Loaded Imports": 231396.7}, {"dt": "2013-04-01T00:00:00", "Loaded Imports": 326780.95}, {"dt": "2013-05-01T00:00:00", "Loaded Imports": 326114.6}, {"dt": "2013-06-01T00:00:00", "Loaded Imports": 328324.9}, {"dt": "2013-07-01T00:00:00", "Loaded Imports": 370745.55}, {"dt": "2013-08-01T00:00:00", "Loaded Imports": 355682.75}, {"dt": "2013-09-01T00:00:00", "Loaded Imports": 370785.7}, {"dt": "2013-10-01T00:00:00", "Loaded Imports": 346137.55}, {"dt": "2013-11-01T00:00:00", "Loaded Imports": 342247.2}, {"dt": "2013-12-01T00:00:00", "Loaded Imports": 322500.6}, {"dt": "2014-01-01T00:00:00", "Loaded Imports": 360036.6}, {"dt": "2014-02-01T00:00:00", "Loaded Imports": 284812.35}, {"dt": "2014-03-01T00:00:00", "Loaded Imports": 327497.05}, {"dt": "2014-04-01T00:00:00", "Loaded Imports": 364126.05}, {"dt": "2014-05-01T00:00:00", "Loaded Imports": 351403.6}, {"dt": "2014-06-01T00:00:00", "Loaded Imports": 382666.15}, {"dt": "2014-07-01T00:00:00", "Loaded Imports": 363393.5}, {"dt": "2014-08-01T00:00:00", "Loaded Imports": 383551.35}, {"dt": "2014-09-01T00:00:00", "Loaded Imports": 411506.95}, {"dt": "2014-10-01T00:00:00", "Loaded Imports": 370938.2}, {"dt": "2014-11-01T00:00:00", "Loaded Imports": 333152.95}, {"dt": "2014-12-01T00:00:00", "Loaded Imports": 336674.95}, {"dt": "2015-01-01T00:00:00", "Loaded Imports": 259206.45}, {"dt": "2015-02-01T00:00:00", "Loaded Imports": 254225.3}, {"dt": "2015-03-01T00:00:00", "Loaded Imports": 430898.05}, {"dt": "2015-04-01T00:00:00", "Loaded Imports": 328140.25}, {"dt": "2015-05-01T00:00:00", "Loaded Imports": 348427.0}, {"dt": "2015-06-01T00:00:00", "Loaded Imports": 368708.5}, {"dt": "2015-07-01T00:00:00", "Loaded Imports": 350627.85}, {"dt": "2015-08-01T00:00:00", "Loaded Imports": 407804.4}, {"dt": "2015-09-01T00:00:00", "Loaded Imports": 372991.5}, {"dt": "2015-10-01T00:00:00", "Loaded Imports": 358601.5}, {"dt": "2015-11-01T00:00:00", "Loaded Imports": 358423.45}, {"dt": "2015-12-01T00:00:00", "Loaded Imports": 321407.7}, {"dt": "2016-01-01T00:00:00", "Loaded Imports": 367208.8}, {"dt": "2016-02-01T00:00:00", "Loaded Imports": 372744.3}, {"dt": "2016-03-01T00:00:00", "Loaded Imports": 287231.25}, {"dt": "2016-04-01T00:00:00", "Loaded Imports": 343574.1}, {"dt": "2016-05-01T00:00:00", "Loaded Imports": 400765.95}, {"dt": "2016-06-01T00:00:00", "Loaded Imports": 355622.9}, {"dt": "2016-07-01T00:00:00", "Loaded Imports": 368696.85}, {"dt": "2016-08-01T00:00:00", "Loaded Imports": 411366.85}, {"dt": "2016-09-01T00:00:00", "Loaded Imports": 388958.5}, {"dt": "2016-10-01T00:00:00", "Loaded Imports": 417311.05}, {"dt": "2016-11-01T00:00:00", "Loaded Imports": 437050.2}, {"dt": "2016-12-01T00:00:00", "Loaded Imports": 394217.15}, {"dt": "2017-01-01T00:00:00", "Loaded Imports": 415422.7}, {"dt": "2017-02-01T00:00:00", "Loaded Imports": 298974.95}, {"dt": "2017-03-01T00:00:00", "Loaded Imports": 373548.95}, {"dt": "2017-04-01T00:00:00", "Loaded Imports": 372040.9}, {"dt": "2017-05-01T00:00:00", "Loaded Imports": 413021.3}, {"dt": "2017-06-01T00:00:00", "Loaded Imports": 372272.1}, {"dt": "2017-07-01T00:00:00", "Loaded Imports": 417090.75}, {"dt": "2017-08-01T00:00:00", "Loaded Imports": 432479.15}, {"dt": "2017-09-01T00:00:00", "Loaded Imports": 388670.05}, {"dt": "2017-10-01T00:00:00", "Loaded Imports": 383385.0}, {"dt": "2017-11-01T00:00:00", "Loaded Imports": 463690.9}, {"dt": "2017-12-01T00:00:00", "Loaded Imports": 385492.05}, {"dt": "2018-01-01T00:00:00", "Loaded Imports": 422831.95}, {"dt": "2018-02-01T00:00:00", "Loaded Imports": 383089.55}, {"dt": "2018-03-01T00:00:00", "Loaded Imports": 264460.05}, {"dt": "2018-04-01T00:00:00", "Loaded Imports": 361108.3}, {"dt": "2018-05-01T00:00:00", "Loaded Imports": 405586.8}, {"dt": "2018-06-01T00:00:00", "Loaded Imports": 382964.0}, {"dt": "2018-07-01T00:00:00", "Loaded Imports": 438164.55}, {"dt": "2018-08-01T00:00:00", "Loaded Imports": 420573.25}, {"dt": "2018-09-01T00:00:00", "Loaded Imports": 414281.5}, {"dt": "2018-10-01T00:00:00", "Loaded Imports": 485823.55}, {"dt": "2018-11-01T00:00:00", "Loaded Imports": 422792.65}, {"dt": "2018-12-01T00:00:00", "Loaded Imports": 468905.85}, {"dt": "2019-01-01T00:00:00", "Loaded Imports": 429922.75}, {"dt": "2019-02-01T00:00:00", "Loaded Imports": 348315.75}, {"dt": "2019-03-01T00:00:00", "Loaded Imports": 297186.95}, {"dt": "2019-04-01T00:00:00", "Loaded Imports": 360744.65}, {"dt": "2019-05-01T00:00:00", "Loaded Imports": 427789.0}, {"dt": "2019-06-01T00:00:00", "Loaded Imports": 396306.5}, {"dt": "2019-07-01T00:00:00", "Loaded Imports": 476438.2}, {"dt": "2019-08-01T00:00:00", "Loaded Imports": 437613.25}, {"dt": "2019-09-01T00:00:00", "Loaded Imports": 402319.85}, {"dt": "2019-10-01T00:00:00", "Loaded Imports": 392768.6}, {"dt": "2019-11-01T00:00:00", "Loaded Imports": 371349.7}, {"dt": "2019-12-01T00:00:00", "Loaded Imports": 373511.0}, {"dt": "2020-01-01T00:00:00", "Loaded Imports": 414730.85}, {"dt": "2020-02-01T00:00:00", "Loaded Imports": 270025.05}, {"dt": "2020-03-01T00:00:00", "Loaded Imports": 220254.55}, {"dt": "2020-04-01T00:00:00", "Loaded Imports": 370111.0}, {"dt": "2020-05-01T00:00:00", "Loaded Imports": 306323.0}, {"dt": "2020-06-01T00:00:00", "Loaded Imports": 369188.9}, {"dt": "2020-07-01T00:00:00", "Loaded Imports": 456028.7}, {"dt": "2020-08-01T00:00:00", "Loaded Imports": 516285.95}, {"dt": "2020-09-01T00:00:00", "Loaded Imports": 471794.5}, {"dt": "2020-10-01T00:00:00", "Loaded Imports": 506613.2}, {"dt": "2020-11-01T00:00:00", "Loaded Imports": 464819.7}, {"dt": "2020-12-01T00:00:00", "Loaded Imports": 460865.0}, {"dt": "2021-01-01T00:00:00", "Loaded Imports": 437609.2}, {"dt": "2021-02-01T00:00:00", "Loaded Imports": 412884.25}, {"dt": "2021-03-01T00:00:00", "Loaded Imports": 490115.0}, {"dt": "2021-04-01T00:00:00", "Loaded Imports": 490126.85}, {"dt": "2021-05-01T00:00:00", "Loaded Imports": 535714.2}, {"dt": "2021-06-01T00:00:00", "Loaded Imports": 467763.25}, {"dt": "2021-07-01T00:00:00", "Loaded Imports": 469360.85}, {"dt": "2021-08-01T00:00:00", "Loaded Imports": 485672.15}, {"dt": "2021-09-01T00:00:00", "Loaded Imports": 468059.15}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_la</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Los Angeles&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Loaded Export&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[6]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-b75b906a1d91490ab0df863958914e5d"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-b75b906a1d91490ab0df863958914e5d") {
      outputDiv = document.getElementById("altair-viz-b75b906a1d91490ab0df863958914e5d");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector002"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Los Angeles Loaded Export Container Volume", "transform": [{"window": [{"op": "lag", "field": "Loaded Export", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Loaded Export'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt"}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Loaded Export"}}, "height": 100, "selection": {"selector002": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-0230d60fb97e0b8a96aa5fefef00a400"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-0230d60fb97e0b8a96aa5fefef00a400": [{"dt": "1996-01-01T00:00:00", "Loaded Export": 70385.7}, {"dt": "1996-02-01T00:00:00", "Loaded Export": 63690.35}, {"dt": "1996-03-01T00:00:00", "Loaded Export": 71969.1}, {"dt": "1996-04-01T00:00:00", "Loaded Export": 67039.65}, {"dt": "1996-05-01T00:00:00", "Loaded Export": 60772.15}, {"dt": "1996-06-01T00:00:00", "Loaded Export": 67356.15}, {"dt": "1996-07-01T00:00:00", "Loaded Export": 67884.1}, {"dt": "1996-08-01T00:00:00", "Loaded Export": 72171.55}, {"dt": "1996-09-01T00:00:00", "Loaded Export": 66293.5}, {"dt": "1996-10-01T00:00:00", "Loaded Export": 77459.8}, {"dt": "1996-11-01T00:00:00", "Loaded Export": 74874.0}, {"dt": "1996-12-01T00:00:00", "Loaded Export": 76539.65}, {"dt": "1997-01-01T00:00:00", "Loaded Export": 72537.0}, {"dt": "1997-02-01T00:00:00", "Loaded Export": 71375.5}, {"dt": "1997-03-01T00:00:00", "Loaded Export": 83445.75}, {"dt": "1997-04-01T00:00:00", "Loaded Export": 77211.2}, {"dt": "1997-05-01T00:00:00", "Loaded Export": 76327.25}, {"dt": "1997-06-01T00:00:00", "Loaded Export": 73399.35}, {"dt": "1997-07-01T00:00:00", "Loaded Export": 71622.55}, {"dt": "1997-08-01T00:00:00", "Loaded Export": 70892.1}, {"dt": "1997-09-01T00:00:00", "Loaded Export": 65614.75}, {"dt": "1997-10-01T00:00:00", "Loaded Export": 74447.3}, {"dt": "1997-11-01T00:00:00", "Loaded Export": 66021.4}, {"dt": "1997-12-01T00:00:00", "Loaded Export": 68031.7}, {"dt": "1998-01-01T00:00:00", "Loaded Export": 61184.65}, {"dt": "1998-02-01T00:00:00", "Loaded Export": 66589.0}, {"dt": "1998-03-01T00:00:00", "Loaded Export": 76610.2}, {"dt": "1998-04-01T00:00:00", "Loaded Export": 71112.0}, {"dt": "1998-05-01T00:00:00", "Loaded Export": 68261.0}, {"dt": "1998-06-01T00:00:00", "Loaded Export": 64001.05}, {"dt": "1998-07-01T00:00:00", "Loaded Export": 61964.65}, {"dt": "1998-08-01T00:00:00", "Loaded Export": 67823.4}, {"dt": "1998-09-01T00:00:00", "Loaded Export": 60648.2}, {"dt": "1998-10-01T00:00:00", "Loaded Export": 65691.6}, {"dt": "1998-11-01T00:00:00", "Loaded Export": 68248.25}, {"dt": "1998-12-01T00:00:00", "Loaded Export": 62534.05}, {"dt": "1999-01-01T00:00:00", "Loaded Export": 57550.2}, {"dt": "1999-02-01T00:00:00", "Loaded Export": 61073.55}, {"dt": "1999-03-01T00:00:00", "Loaded Export": 68857.1}, {"dt": "1999-04-01T00:00:00", "Loaded Export": 63470.25}, {"dt": "1999-05-01T00:00:00", "Loaded Export": 70211.0}, {"dt": "1999-06-01T00:00:00", "Loaded Export": 67376.65}, {"dt": "1999-07-01T00:00:00", "Loaded Export": 66948.15}, {"dt": "1999-08-01T00:00:00", "Loaded Export": 68901.1}, {"dt": "1999-09-01T00:00:00", "Loaded Export": 66206.75}, {"dt": "1999-10-01T00:00:00", "Loaded Export": 75968.2}, {"dt": "1999-11-01T00:00:00", "Loaded Export": 77652.75}, {"dt": "1999-12-01T00:00:00", "Loaded Export": 73364.85}, {"dt": "2000-01-01T00:00:00", "Loaded Export": 73881.05}, {"dt": "2000-02-01T00:00:00", "Loaded Export": 76561.15}, {"dt": "2000-03-01T00:00:00", "Loaded Export": 82893.05}, {"dt": "2000-04-01T00:00:00", "Loaded Export": 85232.4}, {"dt": "2000-05-01T00:00:00", "Loaded Export": 81592.0}, {"dt": "2000-06-01T00:00:00", "Loaded Export": 79134.6}, {"dt": "2000-07-01T00:00:00", "Loaded Export": 80864.1}, {"dt": "2000-08-01T00:00:00", "Loaded Export": 87338.5}, {"dt": "2000-09-01T00:00:00", "Loaded Export": 78539.95}, {"dt": "2000-10-01T00:00:00", "Loaded Export": 93795.3}, {"dt": "2000-11-01T00:00:00", "Loaded Export": 82848.85}, {"dt": "2000-12-01T00:00:00", "Loaded Export": 81969.95}, {"dt": "2001-01-01T00:00:00", "Loaded Export": 82384.4}, {"dt": "2001-02-01T00:00:00", "Loaded Export": 80339.6}, {"dt": "2001-03-01T00:00:00", "Loaded Export": 88237.8}, {"dt": "2001-04-01T00:00:00", "Loaded Export": 88057.15}, {"dt": "2001-05-01T00:00:00", "Loaded Export": 87323.5}, {"dt": "2001-06-01T00:00:00", "Loaded Export": 88133.45}, {"dt": "2001-07-01T00:00:00", "Loaded Export": 86878.9}, {"dt": "2001-08-01T00:00:00", "Loaded Export": 87938.95}, {"dt": "2001-09-01T00:00:00", "Loaded Export": 81806.15}, {"dt": "2001-10-01T00:00:00", "Loaded Export": 90827.65}, {"dt": "2001-11-01T00:00:00", "Loaded Export": 89680.8}, {"dt": "2001-12-01T00:00:00", "Loaded Export": 86186.35}, {"dt": "2002-01-01T00:00:00", "Loaded Export": 83122.55}, {"dt": "2002-02-01T00:00:00", "Loaded Export": 92400.75}, {"dt": "2002-03-01T00:00:00", "Loaded Export": 92662.25}, {"dt": "2002-04-01T00:00:00", "Loaded Export": 91114.35}, {"dt": "2002-05-01T00:00:00", "Loaded Export": 96684.7}, {"dt": "2002-06-01T00:00:00", "Loaded Export": 95285.1}, {"dt": "2002-07-01T00:00:00", "Loaded Export": 83739.65}, {"dt": "2002-08-01T00:00:00", "Loaded Export": 91421.45}, {"dt": "2002-09-01T00:00:00", "Loaded Export": 89503.25}, {"dt": "2002-10-01T00:00:00", "Loaded Export": 70208.4}, {"dt": "2002-11-01T00:00:00", "Loaded Export": 95772.3}, {"dt": "2002-12-01T00:00:00", "Loaded Export": 111941.95}, {"dt": "2003-01-01T00:00:00", "Loaded Export": 105485.1}, {"dt": "2003-02-01T00:00:00", "Loaded Export": 100162.5}, {"dt": "2003-03-01T00:00:00", "Loaded Export": 107152.0}, {"dt": "2003-04-01T00:00:00", "Loaded Export": 97540.75}, {"dt": "2003-05-01T00:00:00", "Loaded Export": 102253.5}, {"dt": "2003-06-01T00:00:00", "Loaded Export": 89532.25}, {"dt": "2003-07-01T00:00:00", "Loaded Export": 97374.5}, {"dt": "2003-08-01T00:00:00", "Loaded Export": 88080.75}, {"dt": "2003-09-01T00:00:00", "Loaded Export": 83858.0}, {"dt": "2003-10-01T00:00:00", "Loaded Export": 93824.25}, {"dt": "2003-11-01T00:00:00", "Loaded Export": 98896.0}, {"dt": "2003-12-01T00:00:00", "Loaded Export": 99185.0}, {"dt": "2004-01-01T00:00:00", "Loaded Export": 97093.25}, {"dt": "2004-02-01T00:00:00", "Loaded Export": 95388.25}, {"dt": "2004-03-01T00:00:00", "Loaded Export": 115026.0}, {"dt": "2004-04-01T00:00:00", "Loaded Export": 102541.0}, {"dt": "2004-05-01T00:00:00", "Loaded Export": 100912.5}, {"dt": "2004-06-01T00:00:00", "Loaded Export": 89709.75}, {"dt": "2004-07-01T00:00:00", "Loaded Export": 95940.75}, {"dt": "2004-08-01T00:00:00", "Loaded Export": 86693.25}, {"dt": "2004-09-01T00:00:00", "Loaded Export": 76129.0}, {"dt": "2004-10-01T00:00:00", "Loaded Export": 91494.5}, {"dt": "2004-11-01T00:00:00", "Loaded Export": 90283.25}, {"dt": "2004-12-01T00:00:00", "Loaded Export": 88668.5}, {"dt": "2005-01-01T00:00:00", "Loaded Export": 83252.25}, {"dt": "2005-02-01T00:00:00", "Loaded Export": 87297.75}, {"dt": "2005-03-01T00:00:00", "Loaded Export": 107452.5}, {"dt": "2005-04-01T00:00:00", "Loaded Export": 107048.5}, {"dt": "2005-05-01T00:00:00", "Loaded Export": 105220.25}, {"dt": "2005-06-01T00:00:00", "Loaded Export": 96659.25}, {"dt": "2005-07-01T00:00:00", "Loaded Export": 97547.5}, {"dt": "2005-08-01T00:00:00", "Loaded Export": 95061.25}, {"dt": "2005-09-01T00:00:00", "Loaded Export": 92992.5}, {"dt": "2005-10-01T00:00:00", "Loaded Export": 98189.0}, {"dt": "2005-11-01T00:00:00", "Loaded Export": 98268.25}, {"dt": "2005-12-01T00:00:00", "Loaded Export": 102241.5}, {"dt": "2006-01-01T00:00:00", "Loaded Export": 100408.25}, {"dt": "2006-02-01T00:00:00", "Loaded Export": 96481.25}, {"dt": "2006-03-01T00:00:00", "Loaded Export": 128240.5}, {"dt": "2006-04-01T00:00:00", "Loaded Export": 113398.75}, {"dt": "2006-05-01T00:00:00", "Loaded Export": 118907.25}, {"dt": "2006-06-01T00:00:00", "Loaded Export": 115184.65}, {"dt": "2006-07-01T00:00:00", "Loaded Export": 124134.25}, {"dt": "2006-08-01T00:00:00", "Loaded Export": 119220.25}, {"dt": "2006-09-01T00:00:00", "Loaded Export": 124195.75}, {"dt": "2006-10-01T00:00:00", "Loaded Export": 131335.25}, {"dt": "2006-11-01T00:00:00", "Loaded Export": 122646.0}, {"dt": "2006-12-01T00:00:00", "Loaded Export": 129467.75}, {"dt": "2007-01-01T00:00:00", "Loaded Export": 124433.25}, {"dt": "2007-02-01T00:00:00", "Loaded Export": 118952.75}, {"dt": "2007-03-01T00:00:00", "Loaded Export": 127945.75}, {"dt": "2007-04-01T00:00:00", "Loaded Export": 123079.0}, {"dt": "2007-05-01T00:00:00", "Loaded Export": 134349.5}, {"dt": "2007-06-01T00:00:00", "Loaded Export": 135963.5}, {"dt": "2007-07-01T00:00:00", "Loaded Export": 129591.75}, {"dt": "2007-08-01T00:00:00", "Loaded Export": 137352.0}, {"dt": "2007-09-01T00:00:00", "Loaded Export": 135716.7}, {"dt": "2007-10-01T00:00:00", "Loaded Export": 146906.75}, {"dt": "2007-11-01T00:00:00", "Loaded Export": 145227.75}, {"dt": "2007-12-01T00:00:00", "Loaded Export": 148124.0}, {"dt": "2008-01-01T00:00:00", "Loaded Export": 147949.75}, {"dt": "2008-02-01T00:00:00", "Loaded Export": 154127.15}, {"dt": "2008-03-01T00:00:00", "Loaded Export": 154980.3}, {"dt": "2008-04-01T00:00:00", "Loaded Export": 147056.25}, {"dt": "2008-05-01T00:00:00", "Loaded Export": 164061.75}, {"dt": "2008-06-01T00:00:00", "Loaded Export": 150852.15}, {"dt": "2008-07-01T00:00:00", "Loaded Export": 173650.5}, {"dt": "2008-08-01T00:00:00", "Loaded Export": 175262.5}, {"dt": "2008-09-01T00:00:00", "Loaded Export": 143470.75}, {"dt": "2008-10-01T00:00:00", "Loaded Export": 134784.5}, {"dt": "2008-11-01T00:00:00", "Loaded Export": 126602.25}, {"dt": "2008-12-01T00:00:00", "Loaded Export": 109704.5}, {"dt": "2009-01-01T00:00:00", "Loaded Export": 104503.25}, {"dt": "2009-02-01T00:00:00", "Loaded Export": 111595.25}, {"dt": "2009-03-01T00:00:00", "Loaded Export": 139774.5}, {"dt": "2009-04-01T00:00:00", "Loaded Export": 140829.0}, {"dt": "2009-05-01T00:00:00", "Loaded Export": 152471.75}, {"dt": "2009-06-01T00:00:00", "Loaded Export": 137214.4}, {"dt": "2009-07-01T00:00:00", "Loaded Export": 138268.75}, {"dt": "2009-08-01T00:00:00", "Loaded Export": 150341.5}, {"dt": "2009-09-01T00:00:00", "Loaded Export": 140271.0}, {"dt": "2009-10-01T00:00:00", "Loaded Export": 150656.75}, {"dt": "2009-11-01T00:00:00", "Loaded Export": 149147.9}, {"dt": "2009-12-01T00:00:00", "Loaded Export": 153836.5}, {"dt": "2010-01-01T00:00:00", "Loaded Export": 141243.5}, {"dt": "2010-02-01T00:00:00", "Loaded Export": 147925.6}, {"dt": "2010-03-01T00:00:00", "Loaded Export": 161816.75}, {"dt": "2010-04-01T00:00:00", "Loaded Export": 158338.0}, {"dt": "2010-05-01T00:00:00", "Loaded Export": 160621.25}, {"dt": "2010-06-01T00:00:00", "Loaded Export": 154558.0}, {"dt": "2010-07-01T00:00:00", "Loaded Export": 146368.75}, {"dt": "2010-08-01T00:00:00", "Loaded Export": 147608.75}, {"dt": "2010-09-01T00:00:00", "Loaded Export": 139800.25}, {"dt": "2010-10-01T00:00:00", "Loaded Export": 151048.75}, {"dt": "2010-11-01T00:00:00", "Loaded Export": 170319.25}, {"dt": "2010-12-01T00:00:00", "Loaded Export": 161625.0}, {"dt": "2011-01-01T00:00:00", "Loaded Export": 159050.75}, {"dt": "2011-02-01T00:00:00", "Loaded Export": 150357.0}, {"dt": "2011-03-01T00:00:00", "Loaded Export": 192849.25}, {"dt": "2011-04-01T00:00:00", "Loaded Export": 167448.25}, {"dt": "2011-05-01T00:00:00", "Loaded Export": 184274.5}, {"dt": "2011-06-01T00:00:00", "Loaded Export": 163137.25}, {"dt": "2011-07-01T00:00:00", "Loaded Export": 165135.25}, {"dt": "2011-08-01T00:00:00", "Loaded Export": 184231.5}, {"dt": "2011-09-01T00:00:00", "Loaded Export": 176954.25}, {"dt": "2011-10-01T00:00:00", "Loaded Export": 193547.75}, {"dt": "2011-11-01T00:00:00", "Loaded Export": 195877.75}, {"dt": "2011-12-01T00:00:00", "Loaded Export": 176530.75}, {"dt": "2012-01-01T00:00:00", "Loaded Export": 168427.0}, {"dt": "2012-02-01T00:00:00", "Loaded Export": 164725.25}, {"dt": "2012-03-01T00:00:00", "Loaded Export": 188155.5}, {"dt": "2012-04-01T00:00:00", "Loaded Export": 186838.25}, {"dt": "2012-05-01T00:00:00", "Loaded Export": 185107.5}, {"dt": "2012-06-01T00:00:00", "Loaded Export": 174418.25}, {"dt": "2012-07-01T00:00:00", "Loaded Export": 165581.25}, {"dt": "2012-08-01T00:00:00", "Loaded Export": 164819.0}, {"dt": "2012-09-01T00:00:00", "Loaded Export": 172432.75}, {"dt": "2012-10-01T00:00:00", "Loaded Export": 179810.5}, {"dt": "2012-11-01T00:00:00", "Loaded Export": 145344.0}, {"dt": "2012-12-01T00:00:00", "Loaded Export": 147417.0}, {"dt": "2013-01-01T00:00:00", "Loaded Export": 159257.5}, {"dt": "2013-02-01T00:00:00", "Loaded Export": 156690.75}, {"dt": "2013-03-01T00:00:00", "Loaded Export": 154428.25}, {"dt": "2013-04-01T00:00:00", "Loaded Export": 160129.5}, {"dt": "2013-05-01T00:00:00", "Loaded Export": 154904.5}, {"dt": "2013-06-01T00:00:00", "Loaded Export": 148203.5}, {"dt": "2013-07-01T00:00:00", "Loaded Export": 157585.5}, {"dt": "2013-08-01T00:00:00", "Loaded Export": 158484.5}, {"dt": "2013-09-01T00:00:00", "Loaded Export": 150380.0}, {"dt": "2013-10-01T00:00:00", "Loaded Export": 169568.25}, {"dt": "2013-11-01T00:00:00", "Loaded Export": 179175.75}, {"dt": "2013-12-01T00:00:00", "Loaded Export": 172261.0}, {"dt": "2014-01-01T00:00:00", "Loaded Export": 161938.5}, {"dt": "2014-02-01T00:00:00", "Loaded Export": 146925.75}, {"dt": "2014-03-01T00:00:00", "Loaded Export": 187826.0}, {"dt": "2014-04-01T00:00:00", "Loaded Export": 172945.25}, {"dt": "2014-05-01T00:00:00", "Loaded Export": 158473.0}, {"dt": "2014-06-01T00:00:00", "Loaded Export": 160823.0}, {"dt": "2014-07-01T00:00:00", "Loaded Export": 163294.5}, {"dt": "2014-08-01T00:00:00", "Loaded Export": 168248.0}, {"dt": "2014-09-01T00:00:00", "Loaded Export": 150678.5}, {"dt": "2014-10-01T00:00:00", "Loaded Export": 158181.5}, {"dt": "2014-11-01T00:00:00", "Loaded Export": 150568.0}, {"dt": "2014-12-01T00:00:00", "Loaded Export": 152112.0}, {"dt": "2015-01-01T00:00:00", "Loaded Export": 124365.25}, {"dt": "2015-02-01T00:00:00", "Loaded Export": 131806.5}, {"dt": "2015-03-01T00:00:00", "Loaded Export": 145536.25}, {"dt": "2015-04-01T00:00:00", "Loaded Export": 145655.75}, {"dt": "2015-05-01T00:00:00", "Loaded Export": 152917.0}, {"dt": "2015-06-01T00:00:00", "Loaded Export": 143549.25}, {"dt": "2015-07-01T00:00:00", "Loaded Export": 136402.0}, {"dt": "2015-08-01T00:00:00", "Loaded Export": 143936.0}, {"dt": "2015-09-01T00:00:00", "Loaded Export": 124286.0}, {"dt": "2015-10-01T00:00:00", "Loaded Export": 134963.75}, {"dt": "2015-11-01T00:00:00", "Loaded Export": 142020.25}, {"dt": "2015-12-01T00:00:00", "Loaded Export": 131239.0}, {"dt": "2016-01-01T00:00:00", "Loaded Export": 126240.5}, {"dt": "2016-02-01T00:00:00", "Loaded Export": 146488.75}, {"dt": "2016-03-01T00:00:00", "Loaded Export": 159362.5}, {"dt": "2016-04-01T00:00:00", "Loaded Export": 144103.75}, {"dt": "2016-05-01T00:00:00", "Loaded Export": 162487.0}, {"dt": "2016-06-01T00:00:00", "Loaded Export": 140561.5}, {"dt": "2016-07-01T00:00:00", "Loaded Export": 132490.0}, {"dt": "2016-08-01T00:00:00", "Loaded Export": 153005.0}, {"dt": "2016-09-01T00:00:00", "Loaded Export": 145096.25}, {"dt": "2016-10-01T00:00:00", "Loaded Export": 166406.25}, {"dt": "2016-11-01T00:00:00", "Loaded Export": 177359.75}, {"dt": "2016-12-01T00:00:00", "Loaded Export": 164900.5}, {"dt": "2017-01-01T00:00:00", "Loaded Export": 162420.0}, {"dt": "2017-02-01T00:00:00", "Loaded Export": 155357.65}, {"dt": "2017-03-01T00:00:00", "Loaded Export": 191771.75}, {"dt": "2017-04-01T00:00:00", "Loaded Export": 157661.5}, {"dt": "2017-05-01T00:00:00", "Loaded Export": 169639.0}, {"dt": "2017-06-01T00:00:00", "Loaded Export": 145527.5}, {"dt": "2017-07-01T00:00:00", "Loaded Export": 154925.75}, {"dt": "2017-08-01T00:00:00", "Loaded Export": 159197.0}, {"dt": "2017-09-01T00:00:00", "Loaded Export": 128445.5}, {"dt": "2017-10-01T00:00:00", "Loaded Export": 144209.75}, {"dt": "2017-11-01T00:00:00", "Loaded Export": 177913.0}, {"dt": "2017-12-01T00:00:00", "Loaded Export": 152865.5}, {"dt": "2018-01-01T00:00:00", "Loaded Export": 150035.25}, {"dt": "2018-02-01T00:00:00", "Loaded Export": 157591.25}, {"dt": "2018-03-01T00:00:00", "Loaded Export": 163706.65}, {"dt": "2018-04-01T00:00:00", "Loaded Export": 164703.65}, {"dt": "2018-05-01T00:00:00", "Loaded Export": 168680.75}, {"dt": "2018-06-01T00:00:00", "Loaded Export": 147563.25}, {"dt": "2018-07-01T00:00:00", "Loaded Export": 167991.75}, {"dt": "2018-08-01T00:00:00", "Loaded Export": 162465.5}, {"dt": "2018-09-01T00:00:00", "Loaded Export": 146999.5}, {"dt": "2018-10-01T00:00:00", "Loaded Export": 173823.9}, {"dt": "2018-11-01T00:00:00", "Loaded Export": 152527.0}, {"dt": "2018-12-01T00:00:00", "Loaded Export": 147965.4}, {"dt": "2019-01-01T00:00:00", "Loaded Export": 144993.0}, {"dt": "2019-02-01T00:00:00", "Loaded Export": 142554.5}, {"dt": "2019-03-01T00:00:00", "Loaded Export": 158923.75}, {"dt": "2019-04-01T00:00:00", "Loaded Export": 155532.75}, {"dt": "2019-05-01T00:00:00", "Loaded Export": 167357.25}, {"dt": "2019-06-01T00:00:00", "Loaded Export": 139318.0}, {"dt": "2019-07-01T00:00:00", "Loaded Export": 161340.25}, {"dt": "2019-08-01T00:00:00", "Loaded Export": 146284.0}, {"dt": "2019-09-01T00:00:00", "Loaded Export": 130768.5}, {"dt": "2019-10-01T00:00:00", "Loaded Export": 140331.5}, {"dt": "2019-11-01T00:00:00", "Loaded Export": 138544.5}, {"dt": "2019-12-01T00:00:00", "Loaded Export": 130228.5}, {"dt": "2020-01-01T00:00:00", "Loaded Export": 148206.0}, {"dt": "2020-02-01T00:00:00", "Loaded Export": 134468.5}, {"dt": "2020-03-01T00:00:00", "Loaded Export": 121146.0}, {"dt": "2020-04-01T00:00:00", "Loaded Export": 130321.25}, {"dt": "2020-05-01T00:00:00", "Loaded Export": 104382.0}, {"dt": "2020-06-01T00:00:00", "Loaded Export": 109585.75}, {"dt": "2020-07-01T00:00:00", "Loaded Export": 126353.7}, {"dt": "2020-08-01T00:00:00", "Loaded Export": 131428.75}, {"dt": "2020-09-01T00:00:00", "Loaded Export": 130396.75}, {"dt": "2020-10-01T00:00:00", "Loaded Export": 143935.75}, {"dt": "2020-11-01T00:00:00", "Loaded Export": 130916.5}, {"dt": "2020-12-01T00:00:00", "Loaded Export": 120265.0}, {"dt": "2021-01-01T00:00:00", "Loaded Export": 119326.75}, {"dt": "2021-02-01T00:00:00", "Loaded Export": 101208.15}, {"dt": "2021-03-01T00:00:00", "Loaded Export": 122899.0}, {"dt": "2021-04-01T00:00:00", "Loaded Export": 114448.5}, {"dt": "2021-05-01T00:00:00", "Loaded Export": 109886.0}, {"dt": "2021-06-01T00:00:00", "Loaded Export": 96066.75}, {"dt": "2021-07-01T00:00:00", "Loaded Export": 91439.5}, {"dt": "2021-08-01T00:00:00", "Loaded Export": 101292.0}, {"dt": "2021-09-01T00:00:00", "Loaded Export": 75713.5}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_la</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Los Angeles&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Total Imports&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[7]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-1de1a62fd91f4d02a3ebaadf91142c94"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-1de1a62fd91f4d02a3ebaadf91142c94") {
      outputDiv = document.getElementById("altair-viz-1de1a62fd91f4d02a3ebaadf91142c94");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector003"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Los Angeles Total Imports Container Volume", "transform": [{"window": [{"op": "lag", "field": "Total Imports", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Total Imports'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt"}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Total Imports"}}, "height": 100, "selection": {"selector003": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-d3052e41ec94c667081b94452d613dc6"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-d3052e41ec94c667081b94452d613dc6": [{"dt": "1996-01-01T00:00:00", "Total Imports": 111493.55}, {"dt": "1996-02-01T00:00:00", "Total Imports": 99784.05}, {"dt": "1996-03-01T00:00:00", "Total Imports": 96905.95}, {"dt": "1996-04-01T00:00:00", "Total Imports": 111203.2}, {"dt": "1996-05-01T00:00:00", "Total Imports": 115512.75}, {"dt": "1996-06-01T00:00:00", "Total Imports": 119421.5}, {"dt": "1996-07-01T00:00:00", "Total Imports": 129983.05}, {"dt": "1996-08-01T00:00:00", "Total Imports": 134295.55}, {"dt": "1996-09-01T00:00:00", "Total Imports": 134656.3}, {"dt": "1996-10-01T00:00:00", "Total Imports": 144429.25}, {"dt": "1996-11-01T00:00:00", "Total Imports": 128520.2}, {"dt": "1996-12-01T00:00:00", "Total Imports": 122427.15}, {"dt": "1997-01-01T00:00:00", "Total Imports": 127064.7}, {"dt": "1997-02-01T00:00:00", "Total Imports": 112732.15}, {"dt": "1997-03-01T00:00:00", "Total Imports": 113062.25}, {"dt": "1997-04-01T00:00:00", "Total Imports": 129796.1}, {"dt": "1997-05-01T00:00:00", "Total Imports": 136711.2}, {"dt": "1997-06-01T00:00:00", "Total Imports": 140218.3}, {"dt": "1997-07-01T00:00:00", "Total Imports": 143755.25}, {"dt": "1997-08-01T00:00:00", "Total Imports": 143388.85}, {"dt": "1997-09-01T00:00:00", "Total Imports": 143699.25}, {"dt": "1997-10-01T00:00:00", "Total Imports": 144424.9}, {"dt": "1997-11-01T00:00:00", "Total Imports": 131876.1}, {"dt": "1997-12-01T00:00:00", "Total Imports": 134314.7}, {"dt": "1998-01-01T00:00:00", "Total Imports": 125929.65}, {"dt": "1998-02-01T00:00:00", "Total Imports": 122976.0}, {"dt": "1998-03-01T00:00:00", "Total Imports": 154946.9}, {"dt": "1998-04-01T00:00:00", "Total Imports": 154521.95}, {"dt": "1998-05-01T00:00:00", "Total Imports": 167203.5}, {"dt": "1998-06-01T00:00:00", "Total Imports": 159637.2}, {"dt": "1998-07-01T00:00:00", "Total Imports": 158947.85}, {"dt": "1998-08-01T00:00:00", "Total Imports": 171151.55}, {"dt": "1998-09-01T00:00:00", "Total Imports": 157266.25}, {"dt": "1998-10-01T00:00:00", "Total Imports": 169363.8}, {"dt": "1998-11-01T00:00:00", "Total Imports": 158254.3}, {"dt": "1998-12-01T00:00:00", "Total Imports": 140164.35}, {"dt": "1999-01-01T00:00:00", "Total Imports": 142115.35}, {"dt": "1999-02-01T00:00:00", "Total Imports": 142079.95}, {"dt": "1999-03-01T00:00:00", "Total Imports": 141925.4}, {"dt": "1999-04-01T00:00:00", "Total Imports": 153558.2}, {"dt": "1999-05-01T00:00:00", "Total Imports": 182974.5}, {"dt": "1999-06-01T00:00:00", "Total Imports": 169681.45}, {"dt": "1999-07-01T00:00:00", "Total Imports": 185016.1}, {"dt": "1999-08-01T00:00:00", "Total Imports": 188280.5}, {"dt": "1999-09-01T00:00:00", "Total Imports": 187080.7}, {"dt": "1999-10-01T00:00:00", "Total Imports": 208162.15}, {"dt": "1999-11-01T00:00:00", "Total Imports": 184661.5}, {"dt": "1999-12-01T00:00:00", "Total Imports": 178492.65}, {"dt": "2000-01-01T00:00:00", "Total Imports": 194179.1}, {"dt": "2000-02-01T00:00:00", "Total Imports": 175889.25}, {"dt": "2000-03-01T00:00:00", "Total Imports": 188437.95}, {"dt": "2000-04-01T00:00:00", "Total Imports": 220156.2}, {"dt": "2000-05-01T00:00:00", "Total Imports": 217748.7}, {"dt": "2000-06-01T00:00:00", "Total Imports": 220070.55}, {"dt": "2000-07-01T00:00:00", "Total Imports": 243695.0}, {"dt": "2000-08-01T00:00:00", "Total Imports": 250550.5}, {"dt": "2000-09-01T00:00:00", "Total Imports": 227847.65}, {"dt": "2000-10-01T00:00:00", "Total Imports": 260468.6}, {"dt": "2000-11-01T00:00:00", "Total Imports": 210208.15}, {"dt": "2000-12-01T00:00:00", "Total Imports": 203020.25}, {"dt": "2001-01-01T00:00:00", "Total Imports": 212322.6}, {"dt": "2001-02-01T00:00:00", "Total Imports": 163331.4}, {"dt": "2001-03-01T00:00:00", "Total Imports": 217283.55}, {"dt": "2001-04-01T00:00:00", "Total Imports": 221464.7}, {"dt": "2001-05-01T00:00:00", "Total Imports": 213859.9}, {"dt": "2001-06-01T00:00:00", "Total Imports": 243053.0}, {"dt": "2001-07-01T00:00:00", "Total Imports": 250343.55}, {"dt": "2001-08-01T00:00:00", "Total Imports": 261704.6}, {"dt": "2001-09-01T00:00:00", "Total Imports": 275558.4}, {"dt": "2001-10-01T00:00:00", "Total Imports": 274953.1}, {"dt": "2001-11-01T00:00:00", "Total Imports": 241729.2}, {"dt": "2001-12-01T00:00:00", "Total Imports": 225885.5}, {"dt": "2002-01-01T00:00:00", "Total Imports": 220809.25}, {"dt": "2002-02-01T00:00:00", "Total Imports": 244166.75}, {"dt": "2002-03-01T00:00:00", "Total Imports": 229953.7}, {"dt": "2002-04-01T00:00:00", "Total Imports": 276372.75}, {"dt": "2002-05-01T00:00:00", "Total Imports": 284384.5}, {"dt": "2002-06-01T00:00:00", "Total Imports": 301446.95}, {"dt": "2002-07-01T00:00:00", "Total Imports": 271932.1}, {"dt": "2002-08-01T00:00:00", "Total Imports": 339689.25}, {"dt": "2002-09-01T00:00:00", "Total Imports": 330966.45}, {"dt": "2002-10-01T00:00:00", "Total Imports": 265217.35}, {"dt": "2002-11-01T00:00:00", "Total Imports": 301332.1}, {"dt": "2002-12-01T00:00:00", "Total Imports": 306098.55}, {"dt": "2003-01-01T00:00:00", "Total Imports": 276481.55}, {"dt": "2003-02-01T00:00:00", "Total Imports": 274739.5}, {"dt": "2003-03-01T00:00:00", "Total Imports": 298495.0}, {"dt": "2003-04-01T00:00:00", "Total Imports": 326708.05}, {"dt": "2003-05-01T00:00:00", "Total Imports": 348275.05}, {"dt": "2003-06-01T00:00:00", "Total Imports": 305891.85}, {"dt": "2003-07-01T00:00:00", "Total Imports": 331740.3}, {"dt": "2003-08-01T00:00:00", "Total Imports": 360045.1}, {"dt": "2003-09-01T00:00:00", "Total Imports": 350475.6}, {"dt": "2003-10-01T00:00:00", "Total Imports": 372111.05}, {"dt": "2003-11-01T00:00:00", "Total Imports": 338378.2}, {"dt": "2003-12-01T00:00:00", "Total Imports": 306983.45}, {"dt": "2004-01-01T00:00:00", "Total Imports": 345411.55}, {"dt": "2004-02-01T00:00:00", "Total Imports": 247709.3}, {"dt": "2004-03-01T00:00:00", "Total Imports": 340748.0}, {"dt": "2004-04-01T00:00:00", "Total Imports": 345338.15}, {"dt": "2004-05-01T00:00:00", "Total Imports": 367128.0}, {"dt": "2004-06-01T00:00:00", "Total Imports": 347055.75}, {"dt": "2004-07-01T00:00:00", "Total Imports": 365900.3}, {"dt": "2004-08-01T00:00:00", "Total Imports": 344108.6}, {"dt": "2004-09-01T00:00:00", "Total Imports": 324345.7}, {"dt": "2004-10-01T00:00:00", "Total Imports": 352717.85}, {"dt": "2004-11-01T00:00:00", "Total Imports": 340050.4}, {"dt": "2004-12-01T00:00:00", "Total Imports": 283267.2}, {"dt": "2005-01-01T00:00:00", "Total Imports": 305102.2}, {"dt": "2005-02-01T00:00:00", "Total Imports": 294022.45}, {"dt": "2005-03-01T00:00:00", "Total Imports": 262173.05}, {"dt": "2005-04-01T00:00:00", "Total Imports": 336086.9}, {"dt": "2005-05-01T00:00:00", "Total Imports": 319472.4}, {"dt": "2005-06-01T00:00:00", "Total Imports": 340581.95}, {"dt": "2005-07-01T00:00:00", "Total Imports": 356715.95}, {"dt": "2005-08-01T00:00:00", "Total Imports": 349654.5}, {"dt": "2005-09-01T00:00:00", "Total Imports": 356912.4}, {"dt": "2005-10-01T00:00:00", "Total Imports": 375050.85}, {"dt": "2005-11-01T00:00:00", "Total Imports": 332036.55}, {"dt": "2005-12-01T00:00:00", "Total Imports": 328244.1}, {"dt": "2006-01-01T00:00:00", "Total Imports": 327009.1}, {"dt": "2006-02-01T00:00:00", "Total Imports": 251811.85}, {"dt": "2006-03-01T00:00:00", "Total Imports": 345401.05}, {"dt": "2006-04-01T00:00:00", "Total Imports": 370170.6}, {"dt": "2006-05-01T00:00:00", "Total Imports": 368863.55}, {"dt": "2006-06-01T00:00:00", "Total Imports": 387956.85}, {"dt": "2006-07-01T00:00:00", "Total Imports": 413357.25}, {"dt": "2006-08-01T00:00:00", "Total Imports": 414004.3}, {"dt": "2006-09-01T00:00:00", "Total Imports": 431282.9}, {"dt": "2006-10-01T00:00:00", "Total Imports": 421693.7}, {"dt": "2006-11-01T00:00:00", "Total Imports": 390208.5}, {"dt": "2006-12-01T00:00:00", "Total Imports": 365590.75}, {"dt": "2007-01-01T00:00:00", "Total Imports": 367095.65}, {"dt": "2007-02-01T00:00:00", "Total Imports": 358600.75}, {"dt": "2007-03-01T00:00:00", "Total Imports": 323472.1}, {"dt": "2007-04-01T00:00:00", "Total Imports": 375511.5}, {"dt": "2007-05-01T00:00:00", "Total Imports": 368874.3}, {"dt": "2007-06-01T00:00:00", "Total Imports": 393187.1}, {"dt": "2007-07-01T00:00:00", "Total Imports": 387573.25}, {"dt": "2007-08-01T00:00:00", "Total Imports": 379027.1}, {"dt": "2007-09-01T00:00:00", "Total Imports": 407914.75}, {"dt": "2007-10-01T00:00:00", "Total Imports": 393947.95}, {"dt": "2007-11-01T00:00:00", "Total Imports": 383240.75}, {"dt": "2007-12-01T00:00:00", "Total Imports": 346140.45}, {"dt": "2008-01-01T00:00:00", "Total Imports": 347141.95}, {"dt": "2008-02-01T00:00:00", "Total Imports": 322978.55}, {"dt": "2008-03-01T00:00:00", "Total Imports": 301288.3}, {"dt": "2008-04-01T00:00:00", "Total Imports": 331840.65}, {"dt": "2008-05-01T00:00:00", "Total Imports": 376786.95}, {"dt": "2008-06-01T00:00:00", "Total Imports": 346791.55}, {"dt": "2008-07-01T00:00:00", "Total Imports": 376945.85}, {"dt": "2008-08-01T00:00:00", "Total Imports": 408236.3}, {"dt": "2008-09-01T00:00:00", "Total Imports": 373351.25}, {"dt": "2008-10-01T00:00:00", "Total Imports": 377272.95}, {"dt": "2008-11-01T00:00:00", "Total Imports": 345764.85}, {"dt": "2008-12-01T00:00:00", "Total Imports": 302760.2}, {"dt": "2009-01-01T00:00:00", "Total Imports": 320379.1}, {"dt": "2009-02-01T00:00:00", "Total Imports": 208178.5}, {"dt": "2009-03-01T00:00:00", "Total Imports": 281693.15}, {"dt": "2009-04-01T00:00:00", "Total Imports": 281674.25}, {"dt": "2009-05-01T00:00:00", "Total Imports": 306164.75}, {"dt": "2009-06-01T00:00:00", "Total Imports": 283982.8}, {"dt": "2009-07-01T00:00:00", "Total Imports": 307907.75}, {"dt": "2009-08-01T00:00:00", "Total Imports": 326905.75}, {"dt": "2009-09-01T00:00:00", "Total Imports": 313286.95}, {"dt": "2009-10-01T00:00:00", "Total Imports": 342412.6}, {"dt": "2009-11-01T00:00:00", "Total Imports": 303494.75}, {"dt": "2009-12-01T00:00:00", "Total Imports": 289010.85}, {"dt": "2010-01-01T00:00:00", "Total Imports": 302692.9}, {"dt": "2010-02-01T00:00:00", "Total Imports": 274939.8}, {"dt": "2010-03-01T00:00:00", "Total Imports": 281748.8}, {"dt": "2010-04-01T00:00:00", "Total Imports": 311343.05}, {"dt": "2010-05-01T00:00:00", "Total Imports": 351737.35}, {"dt": "2010-06-01T00:00:00", "Total Imports": 378967.05}, {"dt": "2010-07-01T00:00:00", "Total Imports": 375800.9}, {"dt": "2010-08-01T00:00:00", "Total Imports": 406691.4}, {"dt": "2010-09-01T00:00:00", "Total Imports": 379784.45}, {"dt": "2010-10-01T00:00:00", "Total Imports": 358240.65}, {"dt": "2010-11-01T00:00:00", "Total Imports": 344324.45}, {"dt": "2010-12-01T00:00:00", "Total Imports": 312860.7}, {"dt": "2011-01-01T00:00:00", "Total Imports": 355119.25}, {"dt": "2011-02-01T00:00:00", "Total Imports": 289163.05}, {"dt": "2011-03-01T00:00:00", "Total Imports": 312802.85}, {"dt": "2011-04-01T00:00:00", "Total Imports": 326846.35}, {"dt": "2011-05-01T00:00:00", "Total Imports": 375127.8}, {"dt": "2011-06-01T00:00:00", "Total Imports": 349423.3}, {"dt": "2011-07-01T00:00:00", "Total Imports": 375299.55}, {"dt": "2011-08-01T00:00:00", "Total Imports": 390877.5}, {"dt": "2011-09-01T00:00:00", "Total Imports": 383434.9}, {"dt": "2011-10-01T00:00:00", "Total Imports": 380437.85}, {"dt": "2011-11-01T00:00:00", "Total Imports": 368338.45}, {"dt": "2011-12-01T00:00:00", "Total Imports": 333164.25}, {"dt": "2012-01-01T00:00:00", "Total Imports": 365824.1}, {"dt": "2012-02-01T00:00:00", "Total Imports": 263458.8}, {"dt": "2012-03-01T00:00:00", "Total Imports": 338742.0}, {"dt": "2012-04-01T00:00:00", "Total Imports": 374035.7}, {"dt": "2012-05-01T00:00:00", "Total Imports": 379574.5}, {"dt": "2012-06-01T00:00:00", "Total Imports": 363603.45}, {"dt": "2012-07-01T00:00:00", "Total Imports": 380920.5}, {"dt": "2012-08-01T00:00:00", "Total Imports": 371591.0}, {"dt": "2012-09-01T00:00:00", "Total Imports": 393946.1}, {"dt": "2012-10-01T00:00:00", "Total Imports": 374385.3}, {"dt": "2012-11-01T00:00:00", "Total Imports": 298760.2}, {"dt": "2012-12-01T00:00:00", "Total Imports": 304971.7}, {"dt": "2013-01-01T00:00:00", "Total Imports": 349141.55}, {"dt": "2013-02-01T00:00:00", "Total Imports": 325505.25}, {"dt": "2013-03-01T00:00:00", "Total Imports": 242547.5}, {"dt": "2013-04-01T00:00:00", "Total Imports": 335032.95}, {"dt": "2013-05-01T00:00:00", "Total Imports": 338131.35}, {"dt": "2013-06-01T00:00:00", "Total Imports": 338636.5}, {"dt": "2013-07-01T00:00:00", "Total Imports": 382783.0}, {"dt": "2013-08-01T00:00:00", "Total Imports": 368697.75}, {"dt": "2013-09-01T00:00:00", "Total Imports": 382673.75}, {"dt": "2013-10-01T00:00:00", "Total Imports": 362452.1}, {"dt": "2013-11-01T00:00:00", "Total Imports": 351992.25}, {"dt": "2013-12-01T00:00:00", "Total Imports": 333121.35}, {"dt": "2014-01-01T00:00:00", "Total Imports": 371733.35}, {"dt": "2014-02-01T00:00:00", "Total Imports": 296537.1}, {"dt": "2014-03-01T00:00:00", "Total Imports": 342885.85}, {"dt": "2014-04-01T00:00:00", "Total Imports": 378044.05}, {"dt": "2014-05-01T00:00:00", "Total Imports": 368010.15}, {"dt": "2014-06-01T00:00:00", "Total Imports": 396092.8}, {"dt": "2014-07-01T00:00:00", "Total Imports": 380192.25}, {"dt": "2014-08-01T00:00:00", "Total Imports": 403003.2}, {"dt": "2014-09-01T00:00:00", "Total Imports": 424221.2}, {"dt": "2014-10-01T00:00:00", "Total Imports": 381558.65}, {"dt": "2014-11-01T00:00:00", "Total Imports": 343236.6}, {"dt": "2014-12-01T00:00:00", "Total Imports": 344398.95}, {"dt": "2015-01-01T00:00:00", "Total Imports": 267943.7}, {"dt": "2015-02-01T00:00:00", "Total Imports": 259956.05}, {"dt": "2015-03-01T00:00:00", "Total Imports": 439209.35}, {"dt": "2015-04-01T00:00:00", "Total Imports": 339593.75}, {"dt": "2015-05-01T00:00:00", "Total Imports": 359685.3}, {"dt": "2015-06-01T00:00:00", "Total Imports": 377780.6}, {"dt": "2015-07-01T00:00:00", "Total Imports": 362001.95}, {"dt": "2015-08-01T00:00:00", "Total Imports": 417318.8}, {"dt": "2015-09-01T00:00:00", "Total Imports": 383963.4}, {"dt": "2015-10-01T00:00:00", "Total Imports": 372415.65}, {"dt": "2015-11-01T00:00:00", "Total Imports": 368714.55}, {"dt": "2015-12-01T00:00:00", "Total Imports": 331046.9}, {"dt": "2016-01-01T00:00:00", "Total Imports": 375215.7}, {"dt": "2016-02-01T00:00:00", "Total Imports": 383368.25}, {"dt": "2016-03-01T00:00:00", "Total Imports": 296849.7}, {"dt": "2016-04-01T00:00:00", "Total Imports": 354203.55}, {"dt": "2016-05-01T00:00:00", "Total Imports": 411709.05}, {"dt": "2016-06-01T00:00:00", "Total Imports": 365177.15}, {"dt": "2016-07-01T00:00:00", "Total Imports": 379453.6}, {"dt": "2016-08-01T00:00:00", "Total Imports": 423190.25}, {"dt": "2016-09-01T00:00:00", "Total Imports": 399978.25}, {"dt": "2016-10-01T00:00:00", "Total Imports": 428196.85}, {"dt": "2016-11-01T00:00:00", "Total Imports": 448311.35}, {"dt": "2016-12-01T00:00:00", "Total Imports": 404880.65}, {"dt": "2017-01-01T00:00:00", "Total Imports": 428397.3}, {"dt": "2017-02-01T00:00:00", "Total Imports": 308581.75}, {"dt": "2017-03-01T00:00:00", "Total Imports": 385636.95}, {"dt": "2017-04-01T00:00:00", "Total Imports": 381516.65}, {"dt": "2017-05-01T00:00:00", "Total Imports": 424501.95}, {"dt": "2017-06-01T00:00:00", "Total Imports": 382783.6}, {"dt": "2017-07-01T00:00:00", "Total Imports": 427677.95}, {"dt": "2017-08-01T00:00:00", "Total Imports": 443038.8}, {"dt": "2017-09-01T00:00:00", "Total Imports": 398366.25}, {"dt": "2017-10-01T00:00:00", "Total Imports": 397958.7}, {"dt": "2017-11-01T00:00:00", "Total Imports": 475788.25}, {"dt": "2017-12-01T00:00:00", "Total Imports": 397301.05}, {"dt": "2018-01-01T00:00:00", "Total Imports": 432128.75}, {"dt": "2018-02-01T00:00:00", "Total Imports": 392682.95}, {"dt": "2018-03-01T00:00:00", "Total Imports": 273842.25}, {"dt": "2018-04-01T00:00:00", "Total Imports": 372526.3}, {"dt": "2018-05-01T00:00:00", "Total Imports": 417372.6}, {"dt": "2018-06-01T00:00:00", "Total Imports": 393365.15}, {"dt": "2018-07-01T00:00:00", "Total Imports": 454681.6}, {"dt": "2018-08-01T00:00:00", "Total Imports": 440676.4}, {"dt": "2018-09-01T00:00:00", "Total Imports": 431310.4}, {"dt": "2018-10-01T00:00:00", "Total Imports": 504387.85}, {"dt": "2018-11-01T00:00:00", "Total Imports": 439966.15}, {"dt": "2018-12-01T00:00:00", "Total Imports": 482353.25}, {"dt": "2019-01-01T00:00:00", "Total Imports": 445730.5}, {"dt": "2019-02-01T00:00:00", "Total Imports": 364550.55}, {"dt": "2019-03-01T00:00:00", "Total Imports": 311053.9}, {"dt": "2019-04-01T00:00:00", "Total Imports": 378343.5}, {"dt": "2019-05-01T00:00:00", "Total Imports": 440313.4}, {"dt": "2019-06-01T00:00:00", "Total Imports": 405824.0}, {"dt": "2019-07-01T00:00:00", "Total Imports": 487604.9}, {"dt": "2019-08-01T00:00:00", "Total Imports": 449085.8}, {"dt": "2019-09-01T00:00:00", "Total Imports": 414680.75}, {"dt": "2019-10-01T00:00:00", "Total Imports": 402425.5}, {"dt": "2019-11-01T00:00:00", "Total Imports": 380437.65}, {"dt": "2019-12-01T00:00:00", "Total Imports": 383794.25}, {"dt": "2020-01-01T00:00:00", "Total Imports": 425761.5}, {"dt": "2020-02-01T00:00:00", "Total Imports": 278735.05}, {"dt": "2020-03-01T00:00:00", "Total Imports": 231607.3}, {"dt": "2020-04-01T00:00:00", "Total Imports": 374186.0}, {"dt": "2020-05-01T00:00:00", "Total Imports": 306366.0}, {"dt": "2020-06-01T00:00:00", "Total Imports": 369256.9}, {"dt": "2020-07-01T00:00:00", "Total Imports": 457196.7}, {"dt": "2020-08-01T00:00:00", "Total Imports": 517024.75}, {"dt": "2020-09-01T00:00:00", "Total Imports": 476681.55}, {"dt": "2020-10-01T00:00:00", "Total Imports": 510812.8}, {"dt": "2020-11-01T00:00:00", "Total Imports": 466067.4}, {"dt": "2020-12-01T00:00:00", "Total Imports": 462655.3}, {"dt": "2021-01-01T00:00:00", "Total Imports": 437863.2}, {"dt": "2021-02-01T00:00:00", "Total Imports": 414154.5}, {"dt": "2021-03-01T00:00:00", "Total Imports": 493465.25}, {"dt": "2021-04-01T00:00:00", "Total Imports": 494681.6}, {"dt": "2021-05-01T00:00:00", "Total Imports": 540803.1}, {"dt": "2021-06-01T00:00:00", "Total Imports": 469553.6}, {"dt": "2021-07-01T00:00:00", "Total Imports": 469481.55}, {"dt": "2021-08-01T00:00:00", "Total Imports": 488873.85}, {"dt": "2021-09-01T00:00:00", "Total Imports": 469570.1}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_la</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Los Angeles&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Total TEUs&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[8]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-331ce44dbabd47729b36e170932a563c"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-331ce44dbabd47729b36e170932a563c") {
      outputDiv = document.getElementById("altair-viz-331ce44dbabd47729b36e170932a563c");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector004"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Los Angeles Total TEUs Container Volume", "transform": [{"window": [{"op": "lag", "field": "Total TEUs", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Total TEUs'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt"}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Total TEUs"}}, "height": 100, "selection": {"selector004": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-6c613759f7fd113105e1c687623acc7e"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-6c613759f7fd113105e1c687623acc7e": [{"dt": "1996-01-01T00:00:00", "Total TEUs": 204484.0}, {"dt": "1996-02-01T00:00:00", "Total TEUs": 186318.7}, {"dt": "1996-03-01T00:00:00", "Total TEUs": 195023.9}, {"dt": "1996-04-01T00:00:00", "Total TEUs": 205654.65}, {"dt": "1996-05-01T00:00:00", "Total TEUs": 210130.2}, {"dt": "1996-06-01T00:00:00", "Total TEUs": 219137.15}, {"dt": "1996-07-01T00:00:00", "Total TEUs": 231425.75}, {"dt": "1996-08-01T00:00:00", "Total TEUs": 250365.55}, {"dt": "1996-09-01T00:00:00", "Total TEUs": 242119.35}, {"dt": "1996-10-01T00:00:00", "Total TEUs": 269682.25}, {"dt": "1996-11-01T00:00:00", "Total TEUs": 239413.5}, {"dt": "1996-12-01T00:00:00", "Total TEUs": 229270.9}, {"dt": "1997-01-01T00:00:00", "Total TEUs": 236040.15}, {"dt": "1997-02-01T00:00:00", "Total TEUs": 217293.05}, {"dt": "1997-03-01T00:00:00", "Total TEUs": 230162.1}, {"dt": "1997-04-01T00:00:00", "Total TEUs": 241520.55}, {"dt": "1997-05-01T00:00:00", "Total TEUs": 251203.15}, {"dt": "1997-06-01T00:00:00", "Total TEUs": 246277.2}, {"dt": "1997-07-01T00:00:00", "Total TEUs": 252564.4}, {"dt": "1997-08-01T00:00:00", "Total TEUs": 259792.6}, {"dt": "1997-09-01T00:00:00", "Total TEUs": 256566.7}, {"dt": "1997-10-01T00:00:00", "Total TEUs": 268372.25}, {"dt": "1997-11-01T00:00:00", "Total TEUs": 245221.55}, {"dt": "1997-12-01T00:00:00", "Total TEUs": 254700.5}, {"dt": "1998-01-01T00:00:00", "Total TEUs": 238457.55}, {"dt": "1998-02-01T00:00:00", "Total TEUs": 235664.05}, {"dt": "1998-03-01T00:00:00", "Total TEUs": 274964.85}, {"dt": "1998-04-01T00:00:00", "Total TEUs": 273994.35}, {"dt": "1998-05-01T00:00:00", "Total TEUs": 300580.6}, {"dt": "1998-06-01T00:00:00", "Total TEUs": 284648.6}, {"dt": "1998-07-01T00:00:00", "Total TEUs": 279476.45}, {"dt": "1998-08-01T00:00:00", "Total TEUs": 313130.35}, {"dt": "1998-09-01T00:00:00", "Total TEUs": 289979.2}, {"dt": "1998-10-01T00:00:00", "Total TEUs": 311275.65}, {"dt": "1998-11-01T00:00:00", "Total TEUs": 299045.7}, {"dt": "1998-12-01T00:00:00", "Total TEUs": 277001.35}, {"dt": "1999-01-01T00:00:00", "Total TEUs": 269137.8}, {"dt": "1999-02-01T00:00:00", "Total TEUs": 263778.4}, {"dt": "1999-03-01T00:00:00", "Total TEUs": 275689.25}, {"dt": "1999-04-01T00:00:00", "Total TEUs": 282746.1}, {"dt": "1999-05-01T00:00:00", "Total TEUs": 335960.7}, {"dt": "1999-06-01T00:00:00", "Total TEUs": 317167.1}, {"dt": "1999-07-01T00:00:00", "Total TEUs": 330245.0}, {"dt": "1999-08-01T00:00:00", "Total TEUs": 348059.95}, {"dt": "1999-09-01T00:00:00", "Total TEUs": 336935.7}, {"dt": "1999-10-01T00:00:00", "Total TEUs": 387165.45}, {"dt": "1999-11-01T00:00:00", "Total TEUs": 347816.25}, {"dt": "1999-12-01T00:00:00", "Total TEUs": 334148.8}, {"dt": "2000-01-01T00:00:00", "Total TEUs": 358234.5}, {"dt": "2000-02-01T00:00:00", "Total TEUs": 336925.2}, {"dt": "2000-03-01T00:00:00", "Total TEUs": 357267.3}, {"dt": "2000-04-01T00:00:00", "Total TEUs": 407031.7}, {"dt": "2000-05-01T00:00:00", "Total TEUs": 408034.8}, {"dt": "2000-06-01T00:00:00", "Total TEUs": 402557.4}, {"dt": "2000-07-01T00:00:00", "Total TEUs": 440731.1}, {"dt": "2000-08-01T00:00:00", "Total TEUs": 464044.8}, {"dt": "2000-09-01T00:00:00", "Total TEUs": 422099.6}, {"dt": "2000-10-01T00:00:00", "Total TEUs": 481502.1}, {"dt": "2000-11-01T00:00:00", "Total TEUs": 414028.6}, {"dt": "2000-12-01T00:00:00", "Total TEUs": 386971.5}, {"dt": "2001-01-01T00:00:00", "Total TEUs": 396993.4}, {"dt": "2001-02-01T00:00:00", "Total TEUs": 330430.8}, {"dt": "2001-03-01T00:00:00", "Total TEUs": 401635.5}, {"dt": "2001-04-01T00:00:00", "Total TEUs": 417429.8}, {"dt": "2001-05-01T00:00:00", "Total TEUs": 400011.15}, {"dt": "2001-06-01T00:00:00", "Total TEUs": 435245.35}, {"dt": "2001-07-01T00:00:00", "Total TEUs": 451855.65}, {"dt": "2001-08-01T00:00:00", "Total TEUs": 477059.0}, {"dt": "2001-09-01T00:00:00", "Total TEUs": 484654.25}, {"dt": "2001-10-01T00:00:00", "Total TEUs": 505020.1}, {"dt": "2001-11-01T00:00:00", "Total TEUs": 455504.75}, {"dt": "2001-12-01T00:00:00", "Total TEUs": 427680.15}, {"dt": "2002-01-01T00:00:00", "Total TEUs": 408236.45}, {"dt": "2002-02-01T00:00:00", "Total TEUs": 435007.7}, {"dt": "2002-03-01T00:00:00", "Total TEUs": 436565.7}, {"dt": "2002-04-01T00:00:00", "Total TEUs": 484299.25}, {"dt": "2002-05-01T00:00:00", "Total TEUs": 531214.2}, {"dt": "2002-06-01T00:00:00", "Total TEUs": 536461.5}, {"dt": "2002-07-01T00:00:00", "Total TEUs": 495690.45}, {"dt": "2002-08-01T00:00:00", "Total TEUs": 605493.8}, {"dt": "2002-09-01T00:00:00", "Total TEUs": 589242.15}, {"dt": "2002-10-01T00:00:00", "Total TEUs": 470970.6}, {"dt": "2002-11-01T00:00:00", "Total TEUs": 545979.5}, {"dt": "2002-12-01T00:00:00", "Total TEUs": 566701.85}, {"dt": "2003-01-01T00:00:00", "Total TEUs": 518538.4}, {"dt": "2003-02-01T00:00:00", "Total TEUs": 541138.8}, {"dt": "2003-03-01T00:00:00", "Total TEUs": 563571.25}, {"dt": "2003-04-01T00:00:00", "Total TEUs": 589034.8}, {"dt": "2003-05-01T00:00:00", "Total TEUs": 651906.25}, {"dt": "2003-06-01T00:00:00", "Total TEUs": 563786.2}, {"dt": "2003-07-01T00:00:00", "Total TEUs": 615714.3}, {"dt": "2003-08-01T00:00:00", "Total TEUs": 650969.4}, {"dt": "2003-09-01T00:00:00", "Total TEUs": 622729.2}, {"dt": "2003-10-01T00:00:00", "Total TEUs": 671106.85}, {"dt": "2003-11-01T00:00:00", "Total TEUs": 627787.05}, {"dt": "2003-12-01T00:00:00", "Total TEUs": 562657.6}, {"dt": "2004-01-01T00:00:00", "Total TEUs": 616086.95}, {"dt": "2004-02-01T00:00:00", "Total TEUs": 482373.7}, {"dt": "2004-03-01T00:00:00", "Total TEUs": 611616.35}, {"dt": "2004-04-01T00:00:00", "Total TEUs": 616897.05}, {"dt": "2004-05-01T00:00:00", "Total TEUs": 660839.15}, {"dt": "2004-06-01T00:00:00", "Total TEUs": 612080.8}, {"dt": "2004-07-01T00:00:00", "Total TEUs": 676399.45}, {"dt": "2004-08-01T00:00:00", "Total TEUs": 627388.8}, {"dt": "2004-09-01T00:00:00", "Total TEUs": 592780.8}, {"dt": "2004-10-01T00:00:00", "Total TEUs": 642935.9}, {"dt": "2004-11-01T00:00:00", "Total TEUs": 630392.85}, {"dt": "2004-12-01T00:00:00", "Total TEUs": 551648.3}, {"dt": "2005-01-01T00:00:00", "Total TEUs": 590178.4}, {"dt": "2005-02-01T00:00:00", "Total TEUs": 554465.05}, {"dt": "2005-03-01T00:00:00", "Total TEUs": 525019.4}, {"dt": "2005-04-01T00:00:00", "Total TEUs": 636972.75}, {"dt": "2005-05-01T00:00:00", "Total TEUs": 610623.9}, {"dt": "2005-06-01T00:00:00", "Total TEUs": 634048.45}, {"dt": "2005-07-01T00:00:00", "Total TEUs": 648379.65}, {"dt": "2005-08-01T00:00:00", "Total TEUs": 651554.45}, {"dt": "2005-09-01T00:00:00", "Total TEUs": 663495.25}, {"dt": "2005-10-01T00:00:00", "Total TEUs": 707740.1}, {"dt": "2005-11-01T00:00:00", "Total TEUs": 640857.95}, {"dt": "2005-12-01T00:00:00", "Total TEUs": 621289.1}, {"dt": "2006-01-01T00:00:00", "Total TEUs": 620275.35}, {"dt": "2006-02-01T00:00:00", "Total TEUs": 480814.95}, {"dt": "2006-03-01T00:00:00", "Total TEUs": 670949.8}, {"dt": "2006-04-01T00:00:00", "Total TEUs": 673393.6}, {"dt": "2006-05-01T00:00:00", "Total TEUs": 695953.3}, {"dt": "2006-06-01T00:00:00", "Total TEUs": 726871.5}, {"dt": "2006-07-01T00:00:00", "Total TEUs": 761326.35}, {"dt": "2006-08-01T00:00:00", "Total TEUs": 790726.55}, {"dt": "2006-09-01T00:00:00", "Total TEUs": 791604.65}, {"dt": "2006-10-01T00:00:00", "Total TEUs": 800063.85}, {"dt": "2006-11-01T00:00:00", "Total TEUs": 745613.1}, {"dt": "2006-12-01T00:00:00", "Total TEUs": 712260.0}, {"dt": "2007-01-01T00:00:00", "Total TEUs": 691602.0}, {"dt": "2007-02-01T00:00:00", "Total TEUs": 649243.0}, {"dt": "2007-03-01T00:00:00", "Total TEUs": 629939.15}, {"dt": "2007-04-01T00:00:00", "Total TEUs": 679657.25}, {"dt": "2007-05-01T00:00:00", "Total TEUs": 681544.55}, {"dt": "2007-06-01T00:00:00", "Total TEUs": 716170.75}, {"dt": "2007-07-01T00:00:00", "Total TEUs": 716319.4}, {"dt": "2007-08-01T00:00:00", "Total TEUs": 714710.2}, {"dt": "2007-09-01T00:00:00", "Total TEUs": 742563.5}, {"dt": "2007-10-01T00:00:00", "Total TEUs": 735546.25}, {"dt": "2007-11-01T00:00:00", "Total TEUs": 736340.15}, {"dt": "2007-12-01T00:00:00", "Total TEUs": 661402.3}, {"dt": "2008-01-01T00:00:00", "Total TEUs": 652236.2}, {"dt": "2008-02-01T00:00:00", "Total TEUs": 613725.7}, {"dt": "2008-03-01T00:00:00", "Total TEUs": 583923.0}, {"dt": "2008-04-01T00:00:00", "Total TEUs": 605466.35}, {"dt": "2008-05-01T00:00:00", "Total TEUs": 686847.8}, {"dt": "2008-06-01T00:00:00", "Total TEUs": 632280.1}, {"dt": "2008-07-01T00:00:00", "Total TEUs": 698159.3}, {"dt": "2008-08-01T00:00:00", "Total TEUs": 757068.85}, {"dt": "2008-09-01T00:00:00", "Total TEUs": 692889.9}, {"dt": "2008-10-01T00:00:00", "Total TEUs": 706308.25}, {"dt": "2008-11-01T00:00:00", "Total TEUs": 660046.5}, {"dt": "2008-12-01T00:00:00", "Total TEUs": 561033.25}, {"dt": "2009-01-01T00:00:00", "Total TEUs": 587004.2}, {"dt": "2009-02-01T00:00:00", "Total TEUs": 413910.3}, {"dt": "2009-03-01T00:00:00", "Total TEUs": 526487.05}, {"dt": "2009-04-01T00:00:00", "Total TEUs": 532124.15}, {"dt": "2009-05-01T00:00:00", "Total TEUs": 574827.8}, {"dt": "2009-06-01T00:00:00", "Total TEUs": 551679.7}, {"dt": "2009-07-01T00:00:00", "Total TEUs": 576203.25}, {"dt": "2009-08-01T00:00:00", "Total TEUs": 612581.5}, {"dt": "2009-09-01T00:00:00", "Total TEUs": 583557.0}, {"dt": "2009-10-01T00:00:00", "Total TEUs": 647423.7}, {"dt": "2009-11-01T00:00:00", "Total TEUs": 580206.15}, {"dt": "2009-12-01T00:00:00", "Total TEUs": 562989.75}, {"dt": "2010-01-01T00:00:00", "Total TEUs": 572969.15}, {"dt": "2010-02-01T00:00:00", "Total TEUs": 525458.6}, {"dt": "2010-03-01T00:00:00", "Total TEUs": 550249.8}, {"dt": "2010-04-01T00:00:00", "Total TEUs": 595283.7}, {"dt": "2010-05-01T00:00:00", "Total TEUs": 689420.7}, {"dt": "2010-06-01T00:00:00", "Total TEUs": 730317.85}, {"dt": "2010-07-01T00:00:00", "Total TEUs": 730745.6}, {"dt": "2010-08-01T00:00:00", "Total TEUs": 763837.2}, {"dt": "2010-09-01T00:00:00", "Total TEUs": 711613.0}, {"dt": "2010-10-01T00:00:00", "Total TEUs": 682384.5}, {"dt": "2010-11-01T00:00:00", "Total TEUs": 666970.5}, {"dt": "2010-12-01T00:00:00", "Total TEUs": 612651.7}, {"dt": "2011-01-01T00:00:00", "Total TEUs": 660517.8}, {"dt": "2011-02-01T00:00:00", "Total TEUs": 554912.8}, {"dt": "2011-03-01T00:00:00", "Total TEUs": 600796.0}, {"dt": "2011-04-01T00:00:00", "Total TEUs": 617272.5}, {"dt": "2011-05-01T00:00:00", "Total TEUs": 692933.7}, {"dt": "2011-06-01T00:00:00", "Total TEUs": 640794.6}, {"dt": "2011-07-01T00:00:00", "Total TEUs": 688325.55}, {"dt": "2011-08-01T00:00:00", "Total TEUs": 723170.55}, {"dt": "2011-09-01T00:00:00", "Total TEUs": 705623.85}, {"dt": "2011-10-01T00:00:00", "Total TEUs": 712586.2}, {"dt": "2011-11-01T00:00:00", "Total TEUs": 694108.7}, {"dt": "2011-12-01T00:00:00", "Total TEUs": 649468.7}, {"dt": "2012-01-01T00:00:00", "Total TEUs": 698715.1}, {"dt": "2012-02-01T00:00:00", "Total TEUs": 525653.45}, {"dt": "2012-03-01T00:00:00", "Total TEUs": 650452.25}, {"dt": "2012-04-01T00:00:00", "Total TEUs": 707182.2}, {"dt": "2012-05-01T00:00:00", "Total TEUs": 731352.9}, {"dt": "2012-06-01T00:00:00", "Total TEUs": 696847.95}, {"dt": "2012-07-01T00:00:00", "Total TEUs": 726375.25}, {"dt": "2012-08-01T00:00:00", "Total TEUs": 706669.8}, {"dt": "2012-09-01T00:00:00", "Total TEUs": 744923.15}, {"dt": "2012-10-01T00:00:00", "Total TEUs": 718406.35}, {"dt": "2012-11-01T00:00:00", "Total TEUs": 582981.7}, {"dt": "2012-12-01T00:00:00", "Total TEUs": 588154.2}, {"dt": "2013-01-01T00:00:00", "Total TEUs": 669000.3}, {"dt": "2013-02-01T00:00:00", "Total TEUs": 614958.75}, {"dt": "2013-03-01T00:00:00", "Total TEUs": 503168.0}, {"dt": "2013-04-01T00:00:00", "Total TEUs": 640330.2}, {"dt": "2013-05-01T00:00:00", "Total TEUs": 636851.6}, {"dt": "2013-06-01T00:00:00", "Total TEUs": 646650.5}, {"dt": "2013-07-01T00:00:00", "Total TEUs": 715640.25}, {"dt": "2013-08-01T00:00:00", "Total TEUs": 709675.75}, {"dt": "2013-09-01T00:00:00", "Total TEUs": 710892.25}, {"dt": "2013-10-01T00:00:00", "Total TEUs": 684207.1}, {"dt": "2013-11-01T00:00:00", "Total TEUs": 683849.0}, {"dt": "2013-12-01T00:00:00", "Total TEUs": 653358.35}, {"dt": "2014-01-01T00:00:00", "Total TEUs": 685549.85}, {"dt": "2014-02-01T00:00:00", "Total TEUs": 559786.35}, {"dt": "2014-03-01T00:00:00", "Total TEUs": 675274.1}, {"dt": "2014-04-01T00:00:00", "Total TEUs": 706036.8}, {"dt": "2014-05-01T00:00:00", "Total TEUs": 689141.65}, {"dt": "2014-06-01T00:00:00", "Total TEUs": 736438.8}, {"dt": "2014-07-01T00:00:00", "Total TEUs": 717407.0}, {"dt": "2014-08-01T00:00:00", "Total TEUs": 757702.45}, {"dt": "2014-09-01T00:00:00", "Total TEUs": 775132.7}, {"dt": "2014-10-01T00:00:00", "Total TEUs": 715682.9}, {"dt": "2014-11-01T00:00:00", "Total TEUs": 663345.6}, {"dt": "2014-12-01T00:00:00", "Total TEUs": 658567.45}, {"dt": "2015-01-01T00:00:00", "Total TEUs": 529427.2}, {"dt": "2015-02-01T00:00:00", "Total TEUs": 502663.3}, {"dt": "2015-03-01T00:00:00", "Total TEUs": 791863.6}, {"dt": "2015-04-01T00:00:00", "Total TEUs": 662973.25}, {"dt": "2015-05-01T00:00:00", "Total TEUs": 694791.05}, {"dt": "2015-06-01T00:00:00", "Total TEUs": 721802.6}, {"dt": "2015-07-01T00:00:00", "Total TEUs": 699127.95}, {"dt": "2015-08-01T00:00:00", "Total TEUs": 786667.8}, {"dt": "2015-09-01T00:00:00", "Total TEUs": 730306.9}, {"dt": "2015-10-01T00:00:00", "Total TEUs": 704588.9}, {"dt": "2015-11-01T00:00:00", "Total TEUs": 709968.7}, {"dt": "2015-12-01T00:00:00", "Total TEUs": 626276.65}, {"dt": "2016-01-01T00:00:00", "Total TEUs": 704398.45}, {"dt": "2016-02-01T00:00:00", "Total TEUs": 713721.0}, {"dt": "2016-03-01T00:00:00", "Total TEUs": 612863.2}, {"dt": "2016-04-01T00:00:00", "Total TEUs": 656177.05}, {"dt": "2016-05-01T00:00:00", "Total TEUs": 770409.3}, {"dt": "2016-06-01T00:00:00", "Total TEUs": 676006.9}, {"dt": "2016-07-01T00:00:00", "Total TEUs": 687891.8}, {"dt": "2016-08-01T00:00:00", "Total TEUs": 798932.75}, {"dt": "2016-09-01T00:00:00", "Total TEUs": 747707.4}, {"dt": "2016-10-01T00:00:00", "Total TEUs": 814574.5}, {"dt": "2016-11-01T00:00:00", "Total TEUs": 877564.2}, {"dt": "2016-12-01T00:00:00", "Total TEUs": 796536.25}, {"dt": "2017-01-01T00:00:00", "Total TEUs": 826639.55}, {"dt": "2017-02-01T00:00:00", "Total TEUs": 625381.15}, {"dt": "2017-03-01T00:00:00", "Total TEUs": 788523.7}, {"dt": "2017-04-01T00:00:00", "Total TEUs": 714755.05}, {"dt": "2017-05-01T00:00:00", "Total TEUs": 796216.7}, {"dt": "2017-06-01T00:00:00", "Total TEUs": 731032.35}, {"dt": "2017-07-01T00:00:00", "Total TEUs": 796804.0}, {"dt": "2017-08-01T00:00:00", "Total TEUs": 847857.05}, {"dt": "2017-09-01T00:00:00", "Total TEUs": 763784.5}, {"dt": "2017-10-01T00:00:00", "Total TEUs": 748762.2}, {"dt": "2017-11-01T00:00:00", "Total TEUs": 924225.75}, {"dt": "2017-12-01T00:00:00", "Total TEUs": 779210.95}, {"dt": "2018-01-01T00:00:00", "Total TEUs": 808728.5}, {"dt": "2018-02-01T00:00:00", "Total TEUs": 725059.45}, {"dt": "2018-03-01T00:00:00", "Total TEUs": 577865.9}, {"dt": "2018-04-01T00:00:00", "Total TEUs": 705535.95}, {"dt": "2018-05-01T00:00:00", "Total TEUs": 768804.35}, {"dt": "2018-06-01T00:00:00", "Total TEUs": 723141.15}, {"dt": "2018-07-01T00:00:00", "Total TEUs": 833567.85}, {"dt": "2018-08-01T00:00:00", "Total TEUs": 826638.4}, {"dt": "2018-09-01T00:00:00", "Total TEUs": 801264.15}, {"dt": "2018-10-01T00:00:00", "Total TEUs": 952553.75}, {"dt": "2018-11-01T00:00:00", "Total TEUs": 832330.9}, {"dt": "2018-12-01T00:00:00", "Total TEUs": 903258.15}, {"dt": "2019-01-01T00:00:00", "Total TEUs": 852449.5}, {"dt": "2019-02-01T00:00:00", "Total TEUs": 705306.55}, {"dt": "2019-03-01T00:00:00", "Total TEUs": 650977.15}, {"dt": "2019-04-01T00:00:00", "Total TEUs": 736465.95}, {"dt": "2019-05-01T00:00:00", "Total TEUs": 828662.15}, {"dt": "2019-06-01T00:00:00", "Total TEUs": 764777.25}, {"dt": "2019-07-01T00:00:00", "Total TEUs": 912154.15}, {"dt": "2019-08-01T00:00:00", "Total TEUs": 861080.8}, {"dt": "2019-09-01T00:00:00", "Total TEUs": 779902.75}, {"dt": "2019-10-01T00:00:00", "Total TEUs": 770188.5}, {"dt": "2019-11-01T00:00:00", "Total TEUs": 728917.9}, {"dt": "2019-12-01T00:00:00", "Total TEUs": 746749.75}, {"dt": "2020-01-01T00:00:00", "Total TEUs": 806143.75}, {"dt": "2020-02-01T00:00:00", "Total TEUs": 544037.3}, {"dt": "2020-03-01T00:00:00", "Total TEUs": 449568.3}, {"dt": "2020-04-01T00:00:00", "Total TEUs": 688999.0}, {"dt": "2020-05-01T00:00:00", "Total TEUs": 581664.75}, {"dt": "2020-06-01T00:00:00", "Total TEUs": 691475.4}, {"dt": "2020-07-01T00:00:00", "Total TEUs": 856389.15}, {"dt": "2020-08-01T00:00:00", "Total TEUs": 961832.75}, {"dt": "2020-09-01T00:00:00", "Total TEUs": 883624.8}, {"dt": "2020-10-01T00:00:00", "Total TEUs": 980728.55}, {"dt": "2020-11-01T00:00:00", "Total TEUs": 889748.15}, {"dt": "2020-12-01T00:00:00", "Total TEUs": 879186.05}, {"dt": "2021-01-01T00:00:00", "Total TEUs": 835516.2}, {"dt": "2021-02-01T00:00:00", "Total TEUs": 799315.4}, {"dt": "2021-03-01T00:00:00", "Total TEUs": 957599.25}, {"dt": "2021-04-01T00:00:00", "Total TEUs": 946966.35}, {"dt": "2021-05-01T00:00:00", "Total TEUs": 1012047.85}, {"dt": "2021-06-01T00:00:00", "Total TEUs": 876430.35}, {"dt": "2021-07-01T00:00:00", "Total TEUs": 890799.8}, {"dt": "2021-08-01T00:00:00", "Total TEUs": 954377.35}, {"dt": "2021-09-01T00:00:00", "Total TEUs": 903864.6}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Port-of-Long-Beach">Port of Long Beach<a class="anchor-link" href="#Port-of-Long-Beach">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># http://www.polb.com/economics/stats/teus_archive.asp</span>

<span class="n">uaString</span> <span class="o">=</span> <span class="s1">&#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.122 Safari/537.36&#39;</span>

<span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="s2">&quot;https://thehelm.polb.com/stellar_custom_table/table100/&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span> <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="n">uaString</span> <span class="p">})</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>

<span class="n">df_lb_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">()),</span> <span class="n">displayed_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">df_lb_raw</span> <span class="o">=</span> <span class="n">df_lb_raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>

<span class="n">df_lb_raw</span><span class="p">[</span><span class="n">df_lb_raw</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span> <span class="o">=</span> <span class="n">df_lb_raw</span><span class="p">[</span><span class="n">df_lb_raw</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">)</span>

<span class="n">df_lb_raw</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_lb_raw</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%b %Y&#39;</span><span class="p">))</span>

<span class="c1">#df_lb_raw.head(16)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_lb_raw</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Long Beach&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Total Loaded&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[10]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-fffad891fb3a41e9bf0c553b2f3a041c"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-fffad891fb3a41e9bf0c553b2f3a041c") {
      outputDiv = document.getElementById("altair-viz-fffad891fb3a41e9bf0c553b2f3a041c");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector005"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Long Beach Total Loaded Container Volume", "transform": [{"window": [{"op": "lag", "field": "Total Loaded", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Total Loaded'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt"}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Total Loaded"}}, "height": 100, "selection": {"selector005": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-990c0968e5cce11ea0e32ac3ad8d14a5"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-990c0968e5cce11ea0e32ac3ad8d14a5": [{"dt": "2021-09-01T00:00:00", "Total Loaded": 481016}, {"dt": "2021-08-01T00:00:00", "Total Loaded": 526911}, {"dt": "2021-07-01T00:00:00", "Total Loaded": 492890}, {"dt": "2021-06-01T00:00:00", "Total Loaded": 474048}, {"dt": "2021-05-01T00:00:00", "Total Loaded": 580081}, {"dt": "2021-04-01T00:00:00", "Total Loaded": 491220}, {"dt": "2021-03-01T00:00:00", "Total Loaded": 547882}, {"dt": "2021-02-01T00:00:00", "Total Loaded": 493172}, {"dt": "2021-01-01T00:00:00", "Total Loaded": 480509}, {"dt": "2020-12-01T00:00:00", "Total Loaded": 538446}, {"dt": "2020-11-01T00:00:00", "Total Loaded": 499960}, {"dt": "2020-10-01T00:00:00", "Total Loaded": 517086}, {"dt": "2020-09-01T00:00:00", "Total Loaded": 518173}, {"dt": "2020-08-01T00:00:00", "Total Loaded": 490969}, {"dt": "2020-07-01T00:00:00", "Total Loaded": 515408}, {"dt": "2020-06-01T00:00:00", "Total Loaded": 418252}, {"dt": "2020-05-01T00:00:00", "Total Loaded": 447145}, {"dt": "2020-04-01T00:00:00", "Total Loaded": 356042}, {"dt": "2020-03-01T00:00:00", "Total Loaded": 380012}, {"dt": "2020-02-01T00:00:00", "Total Loaded": 374151}, {"dt": "2020-01-01T00:00:00", "Total Loaded": 418585}, {"dt": "2019-12-01T00:00:00", "Total Loaded": 448626}, {"dt": "2019-11-01T00:00:00", "Total Loaded": 416992}, {"dt": "2019-10-01T00:00:00", "Total Loaded": 468697}, {"dt": "2019-09-01T00:00:00", "Total Loaded": 478134}, {"dt": "2019-08-01T00:00:00", "Total Loaded": 447755}, {"dt": "2019-07-01T00:00:00", "Total Loaded": 425004}, {"dt": "2019-06-01T00:00:00", "Total Loaded": 465450}, {"dt": "2019-05-01T00:00:00", "Total Loaded": 411145}, {"dt": "2019-04-01T00:00:00", "Total Loaded": 441687}, {"dt": "2019-03-01T00:00:00", "Total Loaded": 378475}, {"dt": "2019-02-01T00:00:00", "Total Loaded": 408152}, {"dt": "2019-01-01T00:00:00", "Total Loaded": 441126}, {"dt": "2018-12-01T00:00:00", "Total Loaded": 486427}, {"dt": "2018-11-01T00:00:00", "Total Loaded": 435651}, {"dt": "2018-10-01T00:00:00", "Total Loaded": 483921}, {"dt": "2018-09-01T00:00:00", "Total Loaded": 478862}, {"dt": "2018-08-01T00:00:00", "Total Loaded": 462575}, {"dt": "2018-07-01T00:00:00", "Total Loaded": 467483}, {"dt": "2018-06-01T00:00:00", "Total Loaded": 519263}, {"dt": "2018-05-01T00:00:00", "Total Loaded": 503468}, {"dt": "2018-04-01T00:00:00", "Total Loaded": 454175}, {"dt": "2018-03-01T00:00:00", "Total Loaded": 410243}, {"dt": "2018-02-01T00:00:00", "Total Loaded": 473163}, {"dt": "2018-01-01T00:00:00", "Total Loaded": 445159}, {"dt": "2017-12-01T00:00:00", "Total Loaded": 483170}, {"dt": "2017-11-01T00:00:00", "Total Loaded": 445574}, {"dt": "2017-10-01T00:00:00", "Total Loaded": 465163}, {"dt": "2017-09-01T00:00:00", "Total Loaded": 491634}, {"dt": "2017-08-01T00:00:00", "Total Loaded": 473005}, {"dt": "2017-07-01T00:00:00", "Total Loaded": 504918}, {"dt": "2017-06-01T00:00:00", "Total Loaded": 453632}, {"dt": "2017-05-01T00:00:00", "Total Loaded": 455380}, {"dt": "2017-04-01T00:00:00", "Total Loaded": 404467}, {"dt": "2017-03-01T00:00:00", "Total Loaded": 369969}, {"dt": "2017-02-01T00:00:00", "Total Loaded": 369570}, {"dt": "2017-01-01T00:00:00", "Total Loaded": 417224}, {"dt": "2016-12-01T00:00:00", "Total Loaded": 394532}, {"dt": "2016-11-01T00:00:00", "Total Loaded": 391507}, {"dt": "2016-10-01T00:00:00", "Total Loaded": 423481}, {"dt": "2016-09-01T00:00:00", "Total Loaded": 403328}, {"dt": "2016-08-01T00:00:00", "Total Loaded": 480872}, {"dt": "2016-07-01T00:00:00", "Total Loaded": 468420}, {"dt": "2016-06-01T00:00:00", "Total Loaded": 441625}, {"dt": "2016-05-01T00:00:00", "Total Loaded": 469233}, {"dt": "2016-04-01T00:00:00", "Total Loaded": 360121}, {"dt": "2016-03-01T00:00:00", "Total Loaded": 334845}, {"dt": "2016-02-01T00:00:00", "Total Loaded": 418880}, {"dt": "2016-01-01T00:00:00", "Total Loaded": 385230}, {"dt": "2015-12-01T00:00:00", "Total Loaded": 422120}, {"dt": "2015-11-01T00:00:00", "Total Loaded": 431371}, {"dt": "2015-10-01T00:00:00", "Total Loaded": 436303}, {"dt": "2015-09-01T00:00:00", "Total Loaded": 458548}, {"dt": "2015-08-01T00:00:00", "Total Loaded": 497027}, {"dt": "2015-07-01T00:00:00", "Total Loaded": 489787}, {"dt": "2015-06-01T00:00:00", "Total Loaded": 425412}, {"dt": "2015-05-01T00:00:00", "Total Loaded": 463172}, {"dt": "2015-04-01T00:00:00", "Total Loaded": 454922}, {"dt": "2015-03-01T00:00:00", "Total Loaded": 444857}, {"dt": "2015-02-01T00:00:00", "Total Loaded": 315173}, {"dt": "2015-01-01T00:00:00", "Total Loaded": 312129}, {"dt": "2014-12-01T00:00:00", "Total Loaded": 408012}, {"dt": "2014-11-01T00:00:00", "Total Loaded": 423944}, {"dt": "2014-10-01T00:00:00", "Total Loaded": 430927}, {"dt": "2014-09-01T00:00:00", "Total Loaded": 457755}, {"dt": "2014-08-01T00:00:00", "Total Loaded": 427707}, {"dt": "2014-07-01T00:00:00", "Total Loaded": 421741}, {"dt": "2014-06-01T00:00:00", "Total Loaded": 456088}, {"dt": "2014-05-01T00:00:00", "Total Loaded": 459141}, {"dt": "2014-04-01T00:00:00", "Total Loaded": 442210}, {"dt": "2014-03-01T00:00:00", "Total Loaded": 377315}, {"dt": "2014-02-01T00:00:00", "Total Loaded": 415243}, {"dt": "2014-01-01T00:00:00", "Total Loaded": 401826}, {"dt": "2013-12-01T00:00:00", "Total Loaded": 439584}, {"dt": "2013-11-01T00:00:00", "Total Loaded": 448588}, {"dt": "2013-10-01T00:00:00", "Total Loaded": 439728}, {"dt": "2013-09-01T00:00:00", "Total Loaded": 442657}, {"dt": "2013-08-01T00:00:00", "Total Loaded": 481935}, {"dt": "2013-07-01T00:00:00", "Total Loaded": 427216}, {"dt": "2013-06-01T00:00:00", "Total Loaded": 424248}, {"dt": "2013-05-01T00:00:00", "Total Loaded": 452571}, {"dt": "2013-04-01T00:00:00", "Total Loaded": 402201}, {"dt": "2013-03-01T00:00:00", "Total Loaded": 381125}, {"dt": "2013-02-01T00:00:00", "Total Loaded": 419770}, {"dt": "2013-01-01T00:00:00", "Total Loaded": 400632}, {"dt": "2012-12-01T00:00:00", "Total Loaded": 431140}, {"dt": "2012-11-01T00:00:00", "Total Loaded": 416846}, {"dt": "2012-10-01T00:00:00", "Total Loaded": 410201}, {"dt": "2012-09-01T00:00:00", "Total Loaded": 380004}, {"dt": "2012-08-01T00:00:00", "Total Loaded": 403202}, {"dt": "2012-07-01T00:00:00", "Total Loaded": 385807}, {"dt": "2012-06-01T00:00:00", "Total Loaded": 414175}, {"dt": "2012-05-01T00:00:00", "Total Loaded": 379020}, {"dt": "2012-04-01T00:00:00", "Total Loaded": 353415}, {"dt": "2012-03-01T00:00:00", "Total Loaded": 370979}, {"dt": "2012-02-01T00:00:00", "Total Loaded": 311481}, {"dt": "2012-01-01T00:00:00", "Total Loaded": 346208}, {"dt": "2011-12-01T00:00:00", "Total Loaded": 377838}, {"dt": "2011-11-01T00:00:00", "Total Loaded": 342760}, {"dt": "2011-10-01T00:00:00", "Total Loaded": 358573}, {"dt": "2011-09-01T00:00:00", "Total Loaded": 381428}, {"dt": "2011-08-01T00:00:00", "Total Loaded": 388475}, {"dt": "2011-07-01T00:00:00", "Total Loaded": 417282}, {"dt": "2011-06-01T00:00:00", "Total Loaded": 397701}, {"dt": "2011-05-01T00:00:00", "Total Loaded": 405261}, {"dt": "2011-04-01T00:00:00", "Total Loaded": 413790}, {"dt": "2011-03-01T00:00:00", "Total Loaded": 322972}, {"dt": "2011-02-01T00:00:00", "Total Loaded": 355589}, {"dt": "2011-01-01T00:00:00", "Total Loaded": 369991}, {"dt": "2010-12-01T00:00:00", "Total Loaded": 398029}, {"dt": "2010-11-01T00:00:00", "Total Loaded": 417108}, {"dt": "2010-10-01T00:00:00", "Total Loaded": 453749}, {"dt": "2010-09-01T00:00:00", "Total Loaded": 412926}, {"dt": "2010-08-01T00:00:00", "Total Loaded": 437279}, {"dt": "2010-07-01T00:00:00", "Total Loaded": 420055}, {"dt": "2010-06-01T00:00:00", "Total Loaded": 378165}, {"dt": "2010-05-01T00:00:00", "Total Loaded": 403164}, {"dt": "2010-04-01T00:00:00", "Total Loaded": 371400}, {"dt": "2010-03-01T00:00:00", "Total Loaded": 337147}, {"dt": "2010-02-01T00:00:00", "Total Loaded": 331128}, {"dt": "2010-01-01T00:00:00", "Total Loaded": 331108}, {"dt": "2009-12-01T00:00:00", "Total Loaded": 355670}, {"dt": "2009-11-01T00:00:00", "Total Loaded": 342630}, {"dt": "2009-10-01T00:00:00", "Total Loaded": 346258}, {"dt": "2009-09-01T00:00:00", "Total Loaded": 334261}, {"dt": "2009-08-01T00:00:00", "Total Loaded": 380543}, {"dt": "2009-07-01T00:00:00", "Total Loaded": 330139}, {"dt": "2009-06-01T00:00:00", "Total Loaded": 320465}, {"dt": "2009-05-01T00:00:00", "Total Loaded": 329655}, {"dt": "2009-04-01T00:00:00", "Total Loaded": 312027}, {"dt": "2009-03-01T00:00:00", "Total Loaded": 304124}, {"dt": "2009-02-01T00:00:00", "Total Loaded": 242080}, {"dt": "2009-01-01T00:00:00", "Total Loaded": 289098}, {"dt": "2008-12-01T00:00:00", "Total Loaded": 299040}, {"dt": "2008-11-01T00:00:00", "Total Loaded": 377690}, {"dt": "2008-10-01T00:00:00", "Total Loaded": 424977}, {"dt": "2008-09-01T00:00:00", "Total Loaded": 408767}, {"dt": "2008-08-01T00:00:00", "Total Loaded": 436641}, {"dt": "2008-07-01T00:00:00", "Total Loaded": 425714}, {"dt": "2008-06-01T00:00:00", "Total Loaded": 448519}, {"dt": "2008-05-01T00:00:00", "Total Loaded": 426179}, {"dt": "2008-04-01T00:00:00", "Total Loaded": 444130}, {"dt": "2008-03-01T00:00:00", "Total Loaded": 391007}, {"dt": "2008-02-01T00:00:00", "Total Loaded": 410506}, {"dt": "2008-01-01T00:00:00", "Total Loaded": 383244}, {"dt": "2007-12-01T00:00:00", "Total Loaded": 423422}, {"dt": "2007-11-01T00:00:00", "Total Loaded": 453916}, {"dt": "2007-10-01T00:00:00", "Total Loaded": 467970}, {"dt": "2007-09-01T00:00:00", "Total Loaded": 466349}, {"dt": "2007-08-01T00:00:00", "Total Loaded": 468056}, {"dt": "2007-07-01T00:00:00", "Total Loaded": 467491}, {"dt": "2007-06-01T00:00:00", "Total Loaded": 480378}, {"dt": "2007-05-01T00:00:00", "Total Loaded": 443727}, {"dt": "2007-04-01T00:00:00", "Total Loaded": 424329}, {"dt": "2007-03-01T00:00:00", "Total Loaded": 378527}, {"dt": "2007-02-01T00:00:00", "Total Loaded": 393015}, {"dt": "2007-01-01T00:00:00", "Total Loaded": 411654}, {"dt": "2006-12-01T00:00:00", "Total Loaded": 394564}, {"dt": "2006-11-01T00:00:00", "Total Loaded": 440544}, {"dt": "2006-10-01T00:00:00", "Total Loaded": 445006}, {"dt": "2006-09-01T00:00:00", "Total Loaded": 416321}, {"dt": "2006-08-01T00:00:00", "Total Loaded": 453085}, {"dt": "2006-07-01T00:00:00", "Total Loaded": 405978}, {"dt": "2006-06-01T00:00:00", "Total Loaded": 421565}, {"dt": "2006-05-01T00:00:00", "Total Loaded": 443472}, {"dt": "2006-04-01T00:00:00", "Total Loaded": 432799}, {"dt": "2006-03-01T00:00:00", "Total Loaded": 401168}, {"dt": "2006-02-01T00:00:00", "Total Loaded": 362426}, {"dt": "2006-01-01T00:00:00", "Total Loaded": 393595}, {"dt": "2005-12-01T00:00:00", "Total Loaded": 370542}, {"dt": "2005-11-01T00:00:00", "Total Loaded": 412212}, {"dt": "2005-10-01T00:00:00", "Total Loaded": 402625}, {"dt": "2005-09-01T00:00:00", "Total Loaded": 410469}, {"dt": "2005-08-01T00:00:00", "Total Loaded": 416874}, {"dt": "2005-07-01T00:00:00", "Total Loaded": 396435}, {"dt": "2005-06-01T00:00:00", "Total Loaded": 395633}, {"dt": "2005-05-01T00:00:00", "Total Loaded": 394065}, {"dt": "2005-04-01T00:00:00", "Total Loaded": 378529}, {"dt": "2005-03-01T00:00:00", "Total Loaded": 314612}, {"dt": "2005-02-01T00:00:00", "Total Loaded": 341112}, {"dt": "2005-01-01T00:00:00", "Total Loaded": 334365}, {"dt": "2004-12-01T00:00:00", "Total Loaded": 362872}, {"dt": "2004-11-01T00:00:00", "Total Loaded": 395153}, {"dt": "2004-10-01T00:00:00", "Total Loaded": 374414}, {"dt": "2004-09-01T00:00:00", "Total Loaded": 331782}, {"dt": "2004-08-01T00:00:00", "Total Loaded": 354253}, {"dt": "2004-07-01T00:00:00", "Total Loaded": 364258}, {"dt": "2004-06-01T00:00:00", "Total Loaded": 342970}, {"dt": "2004-05-01T00:00:00", "Total Loaded": 327412}, {"dt": "2004-04-01T00:00:00", "Total Loaded": 306871}, {"dt": "2004-03-01T00:00:00", "Total Loaded": 330323}, {"dt": "2004-02-01T00:00:00", "Total Loaded": 230958}, {"dt": "2004-01-01T00:00:00", "Total Loaded": 274627}, {"dt": "2003-12-01T00:00:00", "Total Loaded": 294035}, {"dt": "2003-11-01T00:00:00", "Total Loaded": 298828}, {"dt": "2003-10-01T00:00:00", "Total Loaded": 315479}, {"dt": "2003-09-01T00:00:00", "Total Loaded": 272241}, {"dt": "2003-08-01T00:00:00", "Total Loaded": 282248}, {"dt": "2003-07-01T00:00:00", "Total Loaded": 312090}, {"dt": "2003-06-01T00:00:00", "Total Loaded": 275336}, {"dt": "2003-05-01T00:00:00", "Total Loaded": 273171}, {"dt": "2003-04-01T00:00:00", "Total Loaded": 275771}, {"dt": "2003-03-01T00:00:00", "Total Loaded": 262597}, {"dt": "2003-02-01T00:00:00", "Total Loaded": 226508}, {"dt": "2003-01-01T00:00:00", "Total Loaded": 225812}, {"dt": "2002-12-01T00:00:00", "Total Loaded": 250505}, {"dt": "2002-11-01T00:00:00", "Total Loaded": 244409}, {"dt": "2002-10-01T00:00:00", "Total Loaded": 204384}, {"dt": "2002-09-01T00:00:00", "Total Loaded": 242798}, {"dt": "2002-08-01T00:00:00", "Total Loaded": 305678}, {"dt": "2002-07-01T00:00:00", "Total Loaded": 320118}, {"dt": "2002-06-01T00:00:00", "Total Loaded": 311926}, {"dt": "2002-05-01T00:00:00", "Total Loaded": 315444}, {"dt": "2002-04-01T00:00:00", "Total Loaded": 315913}, {"dt": "2002-03-01T00:00:00", "Total Loaded": 259719}, {"dt": "2002-02-01T00:00:00", "Total Loaded": 285609}, {"dt": "2002-01-01T00:00:00", "Total Loaded": 251472}, {"dt": "2001-12-01T00:00:00", "Total Loaded": 275244}, {"dt": "2001-11-01T00:00:00", "Total Loaded": 269740}, {"dt": "2001-10-01T00:00:00", "Total Loaded": 320440}, {"dt": "2001-09-01T00:00:00", "Total Loaded": 296928}, {"dt": "2001-08-01T00:00:00", "Total Loaded": 304793}, {"dt": "2001-07-01T00:00:00", "Total Loaded": 286135}, {"dt": "2001-06-01T00:00:00", "Total Loaded": 281383}, {"dt": "2001-05-01T00:00:00", "Total Loaded": 277228}, {"dt": "2001-04-01T00:00:00", "Total Loaded": 279199}, {"dt": "2001-03-01T00:00:00", "Total Loaded": 279954}, {"dt": "2001-02-01T00:00:00", "Total Loaded": 230668}, {"dt": "2001-01-01T00:00:00", "Total Loaded": 271811}, {"dt": "2000-12-01T00:00:00", "Total Loaded": 259982}, {"dt": "2000-11-01T00:00:00", "Total Loaded": 303821}, {"dt": "2000-10-01T00:00:00", "Total Loaded": 324052}, {"dt": "2000-09-01T00:00:00", "Total Loaded": 289755}, {"dt": "2000-08-01T00:00:00", "Total Loaded": 322981}, {"dt": "2000-07-01T00:00:00", "Total Loaded": 311739}, {"dt": "2000-06-01T00:00:00", "Total Loaded": 286309}, {"dt": "2000-05-01T00:00:00", "Total Loaded": 315786}, {"dt": "2000-04-01T00:00:00", "Total Loaded": 291738}, {"dt": "2000-03-01T00:00:00", "Total Loaded": 276360}, {"dt": "2000-02-01T00:00:00", "Total Loaded": 259255}, {"dt": "2000-01-01T00:00:00", "Total Loaded": 258763}, {"dt": "1999-12-01T00:00:00", "Total Loaded": 272269}, {"dt": "1999-11-01T00:00:00", "Total Loaded": 300645}, {"dt": "1999-10-01T00:00:00", "Total Loaded": 288591}, {"dt": "1999-09-01T00:00:00", "Total Loaded": 301388}, {"dt": "1999-08-01T00:00:00", "Total Loaded": 295290}, {"dt": "1999-07-01T00:00:00", "Total Loaded": 262741}, {"dt": "1999-06-01T00:00:00", "Total Loaded": 273372}, {"dt": "1999-05-01T00:00:00", "Total Loaded": 293193}, {"dt": "1999-04-01T00:00:00", "Total Loaded": 258615}, {"dt": "1999-03-01T00:00:00", "Total Loaded": 260612}, {"dt": "1999-02-01T00:00:00", "Total Loaded": 252482}, {"dt": "1999-01-01T00:00:00", "Total Loaded": 247073}, {"dt": "1998-12-01T00:00:00", "Total Loaded": 254059}, {"dt": "1998-11-01T00:00:00", "Total Loaded": 276952}, {"dt": "1998-10-01T00:00:00", "Total Loaded": 257890}, {"dt": "1998-09-01T00:00:00", "Total Loaded": 272729}, {"dt": "1998-08-01T00:00:00", "Total Loaded": 272829}, {"dt": "1998-07-01T00:00:00", "Total Loaded": 280088}, {"dt": "1998-06-01T00:00:00", "Total Loaded": 265634}, {"dt": "1998-05-01T00:00:00", "Total Loaded": 248021}, {"dt": "1998-04-01T00:00:00", "Total Loaded": 259518}, {"dt": "1998-03-01T00:00:00", "Total Loaded": 256230}, {"dt": "1998-02-01T00:00:00", "Total Loaded": 209420}, {"dt": "1998-01-01T00:00:00", "Total Loaded": 217178}, {"dt": "1997-12-01T00:00:00", "Total Loaded": 236978}, {"dt": "1997-11-01T00:00:00", "Total Loaded": 242922}, {"dt": "1997-10-01T00:00:00", "Total Loaded": 257096}, {"dt": "1997-09-01T00:00:00", "Total Loaded": 274675}, {"dt": "1997-08-01T00:00:00", "Total Loaded": 247733}, {"dt": "1997-07-01T00:00:00", "Total Loaded": 266208}, {"dt": "1997-06-01T00:00:00", "Total Loaded": 266025}, {"dt": "1997-05-01T00:00:00", "Total Loaded": 235064}, {"dt": "1997-04-01T00:00:00", "Total Loaded": 239003}, {"dt": "1997-03-01T00:00:00", "Total Loaded": 231596}, {"dt": "1997-02-01T00:00:00", "Total Loaded": 214390}, {"dt": "1997-01-01T00:00:00", "Total Loaded": 202421}, {"dt": "1996-12-01T00:00:00", "Total Loaded": 233644}, {"dt": "1996-11-01T00:00:00", "Total Loaded": 212309}, {"dt": "1996-10-01T00:00:00", "Total Loaded": 240472}, {"dt": "1996-09-01T00:00:00", "Total Loaded": 229528}, {"dt": "1996-08-01T00:00:00", "Total Loaded": 222519}, {"dt": "1996-07-01T00:00:00", "Total Loaded": 229985}, {"dt": "1996-06-01T00:00:00", "Total Loaded": 222308}, {"dt": "1996-05-01T00:00:00", "Total Loaded": 207244}, {"dt": "1996-04-01T00:00:00", "Total Loaded": 228365}, {"dt": "1996-03-01T00:00:00", "Total Loaded": 202720}, {"dt": "1996-02-01T00:00:00", "Total Loaded": 203582}, {"dt": "1996-01-01T00:00:00", "Total Loaded": 196789}, {"dt": "1995-12-01T00:00:00", "Total Loaded": 196939}, {"dt": "1995-11-01T00:00:00", "Total Loaded": 199099}, {"dt": "1995-10-01T00:00:00", "Total Loaded": 227605}, {"dt": "1995-09-01T00:00:00", "Total Loaded": 196010}, {"dt": "1995-08-01T00:00:00", "Total Loaded": 217298}, {"dt": "1995-07-01T00:00:00", "Total Loaded": 215181}, {"dt": "1995-06-01T00:00:00", "Total Loaded": 197236}, {"dt": "1995-05-01T00:00:00", "Total Loaded": 204914}, {"dt": "1995-04-01T00:00:00", "Total Loaded": 197397}, {"dt": "1995-03-01T00:00:00", "Total Loaded": 178089}, {"dt": "1995-02-01T00:00:00", "Total Loaded": 181000}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_lb_raw</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Long Beach&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Total&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[11]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-aeb46b4de996487890d93e1405aa309e"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-aeb46b4de996487890d93e1405aa309e") {
      outputDiv = document.getElementById("altair-viz-aeb46b4de996487890d93e1405aa309e");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector006"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Long Beach Total Container Volume", "transform": [{"window": [{"op": "lag", "field": "Total", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Total'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt"}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Total"}}, "height": 100, "selection": {"selector006": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-98089c0317957524af89d0eb2f1106b3"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-98089c0317957524af89d0eb2f1106b3": [{"dt": "2021-09-01T00:00:00", "Total": 748472}, {"dt": "2021-08-01T00:00:00", "Total": 807704}, {"dt": "2021-07-01T00:00:00", "Total": 784845}, {"dt": "2021-06-01T00:00:00", "Total": 724297}, {"dt": "2021-05-01T00:00:00", "Total": 907216}, {"dt": "2021-04-01T00:00:00", "Total": 746188}, {"dt": "2021-03-01T00:00:00", "Total": 840387}, {"dt": "2021-02-01T00:00:00", "Total": 771735}, {"dt": "2021-01-01T00:00:00", "Total": 764006}, {"dt": "2020-12-01T00:00:00", "Total": 815885}, {"dt": "2020-11-01T00:00:00", "Total": 783523}, {"dt": "2020-10-01T00:00:00", "Total": 806603}, {"dt": "2020-09-01T00:00:00", "Total": 795580}, {"dt": "2020-08-01T00:00:00", "Total": 725610}, {"dt": "2020-07-01T00:00:00", "Total": 753081}, {"dt": "2020-06-01T00:00:00", "Total": 602180}, {"dt": "2020-05-01T00:00:00", "Total": 628205}, {"dt": "2020-04-01T00:00:00", "Total": 519730}, {"dt": "2020-03-01T00:00:00", "Total": 517664}, {"dt": "2020-02-01T00:00:00", "Total": 538428}, {"dt": "2020-01-01T00:00:00", "Total": 626829}, {"dt": "2019-12-01T00:00:00", "Total": 665262}, {"dt": "2019-11-01T00:00:00", "Total": 599984}, {"dt": "2019-10-01T00:00:00", "Total": 688425}, {"dt": "2019-09-01T00:00:00", "Total": 706955}, {"dt": "2019-08-01T00:00:00", "Total": 663993}, {"dt": "2019-07-01T00:00:00", "Total": 621781}, {"dt": "2019-06-01T00:00:00", "Total": 677168}, {"dt": "2019-05-01T00:00:00", "Total": 573624}, {"dt": "2019-04-01T00:00:00", "Total": 628122}, {"dt": "2019-03-01T00:00:00", "Total": 552821}, {"dt": "2019-02-01T00:00:00", "Total": 596617}, {"dt": "2019-01-01T00:00:00", "Total": 657286}, {"dt": "2018-12-01T00:00:00", "Total": 741647}, {"dt": "2018-11-01T00:00:00", "Total": 621834}, {"dt": "2018-10-01T00:00:00", "Total": 705408}, {"dt": "2018-09-01T00:00:00", "Total": 701205}, {"dt": "2018-08-01T00:00:00", "Total": 679543}, {"dt": "2018-07-01T00:00:00", "Total": 688458}, {"dt": "2018-06-01T00:00:00", "Total": 752189}, {"dt": "2018-05-01T00:00:00", "Total": 687427}, {"dt": "2018-04-01T00:00:00", "Total": 618439}, {"dt": "2018-03-01T00:00:00", "Total": 575258}, {"dt": "2018-02-01T00:00:00", "Total": 661791}, {"dt": "2018-01-01T00:00:00", "Total": 657830}, {"dt": "2017-12-01T00:00:00", "Total": 696919}, {"dt": "2017-11-01T00:00:00", "Total": 612659}, {"dt": "2017-10-01T00:00:00", "Total": 669218}, {"dt": "2017-09-01T00:00:00", "Total": 701619}, {"dt": "2017-08-01T00:00:00", "Total": 692375}, {"dt": "2017-07-01T00:00:00", "Total": 720312}, {"dt": "2017-06-01T00:00:00", "Total": 658727}, {"dt": "2017-05-01T00:00:00", "Total": 648288}, {"dt": "2017-04-01T00:00:00", "Total": 558014}, {"dt": "2017-03-01T00:00:00", "Total": 505382}, {"dt": "2017-02-01T00:00:00", "Total": 498312}, {"dt": "2017-01-01T00:00:00", "Total": 582689}, {"dt": "2016-12-01T00:00:00", "Total": 548929}, {"dt": "2016-11-01T00:00:00", "Total": 534308}, {"dt": "2016-10-01T00:00:00", "Total": 581808}, {"dt": "2016-09-01T00:00:00", "Total": 546804}, {"dt": "2016-08-01T00:00:00", "Total": 641029}, {"dt": "2016-07-01T00:00:00", "Total": 637091}, {"dt": "2016-06-01T00:00:00", "Total": 603339}, {"dt": "2016-05-01T00:00:00", "Total": 640566}, {"dt": "2016-04-01T00:00:00", "Total": 478842}, {"dt": "2016-03-01T00:00:00", "Total": 464855}, {"dt": "2016-02-01T00:00:00", "Total": 561412}, {"dt": "2016-01-01T00:00:00", "Total": 536188}, {"dt": "2015-12-01T00:00:00", "Total": 596448}, {"dt": "2015-11-01T00:00:00", "Total": 619699}, {"dt": "2015-10-01T00:00:00", "Total": 619984}, {"dt": "2015-09-01T00:00:00", "Total": 655624}, {"dt": "2015-08-01T00:00:00", "Total": 703652}, {"dt": "2015-07-01T00:00:00", "Total": 690244}, {"dt": "2015-06-01T00:00:00", "Total": 583621}, {"dt": "2015-05-01T00:00:00", "Total": 635250}, {"dt": "2015-04-01T00:00:00", "Total": 614860}, {"dt": "2015-03-01T00:00:00", "Total": 630084}, {"dt": "2015-02-01T00:00:00", "Total": 413114}, {"dt": "2015-01-01T00:00:00", "Total": 429490}, {"dt": "2014-12-01T00:00:00", "Total": 567237}, {"dt": "2014-11-01T00:00:00", "Total": 581514}, {"dt": "2014-10-01T00:00:00", "Total": 583009}, {"dt": "2014-09-01T00:00:00", "Total": 629771}, {"dt": "2014-08-01T00:00:00", "Total": 573083}, {"dt": "2014-07-01T00:00:00", "Total": 583060}, {"dt": "2014-06-01T00:00:00", "Total": 610516}, {"dt": "2014-05-01T00:00:00", "Total": 599509}, {"dt": "2014-04-01T00:00:00", "Total": 569843}, {"dt": "2014-03-01T00:00:00", "Total": 477209}, {"dt": "2014-02-01T00:00:00", "Total": 517173}, {"dt": "2014-01-01T00:00:00", "Total": 528884}, {"dt": "2013-12-01T00:00:00", "Total": 582443}, {"dt": "2013-11-01T00:00:00", "Total": 569599}, {"dt": "2013-10-01T00:00:00", "Total": 576502}, {"dt": "2013-09-01T00:00:00", "Total": 587114}, {"dt": "2013-08-01T00:00:00", "Total": 630292}, {"dt": "2013-07-01T00:00:00", "Total": 562166}, {"dt": "2013-06-01T00:00:00", "Total": 565476}, {"dt": "2013-05-01T00:00:00", "Total": 583588}, {"dt": "2013-04-01T00:00:00", "Total": 519464}, {"dt": "2013-03-01T00:00:00", "Total": 486699}, {"dt": "2013-02-01T00:00:00", "Total": 530967}, {"dt": "2013-01-01T00:00:00", "Total": 536263}, {"dt": "2012-12-01T00:00:00", "Total": 560120}, {"dt": "2012-11-01T00:00:00", "Total": 555513}, {"dt": "2012-10-01T00:00:00", "Total": 530313}, {"dt": "2012-09-01T00:00:00", "Total": 512020}, {"dt": "2012-08-01T00:00:00", "Total": 543445}, {"dt": "2012-07-01T00:00:00", "Total": 522486}, {"dt": "2012-06-01T00:00:00", "Total": 555359}, {"dt": "2012-05-01T00:00:00", "Total": 497892}, {"dt": "2012-04-01T00:00:00", "Total": 461911}, {"dt": "2012-03-01T00:00:00", "Total": 461590}, {"dt": "2012-02-01T00:00:00", "Total": 388589}, {"dt": "2012-01-01T00:00:00", "Total": 456424}, {"dt": "2011-12-01T00:00:00", "Total": 509944}, {"dt": "2011-11-01T00:00:00", "Total": 459881}, {"dt": "2011-10-01T00:00:00", "Total": 487665}, {"dt": "2011-09-01T00:00:00", "Total": 527175}, {"dt": "2011-08-01T00:00:00", "Total": 535929}, {"dt": "2011-07-01T00:00:00", "Total": 572926}, {"dt": "2011-06-01T00:00:00", "Total": 554269}, {"dt": "2011-05-01T00:00:00", "Total": 536681}, {"dt": "2011-04-01T00:00:00", "Total": 531090}, {"dt": "2011-03-01T00:00:00", "Total": 412235}, {"dt": "2011-02-01T00:00:00", "Total": 458336}, {"dt": "2011-01-01T00:00:00", "Total": 474960}, {"dt": "2010-12-01T00:00:00", "Total": 523311}, {"dt": "2010-11-01T00:00:00", "Total": 558307}, {"dt": "2010-10-01T00:00:00", "Total": 613621}, {"dt": "2010-09-01T00:00:00", "Total": 574790}, {"dt": "2010-08-01T00:00:00", "Total": 611002}, {"dt": "2010-07-01T00:00:00", "Total": 587881}, {"dt": "2010-06-01T00:00:00", "Total": 520100}, {"dt": "2010-05-01T00:00:00", "Total": 524715}, {"dt": "2010-04-01T00:00:00", "Total": 485059}, {"dt": "2010-03-01T00:00:00", "Total": 422774}, {"dt": "2010-02-01T00:00:00", "Total": 413134}, {"dt": "2010-01-01T00:00:00", "Total": 428805}, {"dt": "2009-12-01T00:00:00", "Total": 467237}, {"dt": "2009-11-01T00:00:00", "Total": 448151}, {"dt": "2009-10-01T00:00:00", "Total": 452418}, {"dt": "2009-09-01T00:00:00", "Total": 440364}, {"dt": "2009-08-01T00:00:00", "Total": 493339}, {"dt": "2009-07-01T00:00:00", "Total": 433013}, {"dt": "2009-06-01T00:00:00", "Total": 413347}, {"dt": "2009-05-01T00:00:00", "Total": 419555}, {"dt": "2009-04-01T00:00:00", "Total": 408705}, {"dt": "2009-03-01T00:00:00", "Total": 374131}, {"dt": "2009-02-01T00:00:00", "Total": 318042}, {"dt": "2009-01-01T00:00:00", "Total": 399295}, {"dt": "2008-12-01T00:00:00", "Total": 429946}, {"dt": "2008-11-01T00:00:00", "Total": 557459}, {"dt": "2008-10-01T00:00:00", "Total": 595189}, {"dt": "2008-09-01T00:00:00", "Total": 554837}, {"dt": "2008-08-01T00:00:00", "Total": 572256}, {"dt": "2008-07-01T00:00:00", "Total": 563703}, {"dt": "2008-06-01T00:00:00", "Total": 579675}, {"dt": "2008-05-01T00:00:00", "Total": 529011}, {"dt": "2008-04-01T00:00:00", "Total": 556585}, {"dt": "2008-03-01T00:00:00", "Total": 498114}, {"dt": "2008-02-01T00:00:00", "Total": 529699}, {"dt": "2008-01-01T00:00:00", "Total": 521342}, {"dt": "2007-12-01T00:00:00", "Total": 575355}, {"dt": "2007-11-01T00:00:00", "Total": 611606}, {"dt": "2007-10-01T00:00:00", "Total": 644573}, {"dt": "2007-09-01T00:00:00", "Total": 654109}, {"dt": "2007-08-01T00:00:00", "Total": 657904}, {"dt": "2007-07-01T00:00:00", "Total": 647428}, {"dt": "2007-06-01T00:00:00", "Total": 662219}, {"dt": "2007-05-01T00:00:00", "Total": 606256}, {"dt": "2007-04-01T00:00:00", "Total": 579235}, {"dt": "2007-03-01T00:00:00", "Total": 541107}, {"dt": "2007-02-01T00:00:00", "Total": 541204}, {"dt": "2007-01-01T00:00:00", "Total": 591469}, {"dt": "2006-12-01T00:00:00", "Total": 575227}, {"dt": "2006-11-01T00:00:00", "Total": 654997}, {"dt": "2006-10-01T00:00:00", "Total": 650726}, {"dt": "2006-09-01T00:00:00", "Total": 614739}, {"dt": "2006-08-01T00:00:00", "Total": 675058}, {"dt": "2006-07-01T00:00:00", "Total": 582925}, {"dt": "2006-06-01T00:00:00", "Total": 617002}, {"dt": "2006-05-01T00:00:00", "Total": 644066}, {"dt": "2006-04-01T00:00:00", "Total": 619512}, {"dt": "2006-03-01T00:00:00", "Total": 561194}, {"dt": "2006-02-01T00:00:00", "Total": 515464}, {"dt": "2006-01-01T00:00:00", "Total": 579455}, {"dt": "2005-12-01T00:00:00", "Total": 545772}, {"dt": "2005-11-01T00:00:00", "Total": 610644}, {"dt": "2005-10-01T00:00:00", "Total": 600940}, {"dt": "2005-09-01T00:00:00", "Total": 610269}, {"dt": "2005-08-01T00:00:00", "Total": 615361}, {"dt": "2005-07-01T00:00:00", "Total": 573300}, {"dt": "2005-06-01T00:00:00", "Total": 576604}, {"dt": "2005-05-01T00:00:00", "Total": 564886}, {"dt": "2005-04-01T00:00:00", "Total": 538501}, {"dt": "2005-03-01T00:00:00", "Total": 466019}, {"dt": "2005-02-01T00:00:00", "Total": 497925}, {"dt": "2005-01-01T00:00:00", "Total": 509597}, {"dt": "2004-12-01T00:00:00", "Total": 551339}, {"dt": "2004-11-01T00:00:00", "Total": 582614}, {"dt": "2004-10-01T00:00:00", "Total": 557665}, {"dt": "2004-09-01T00:00:00", "Total": 494376}, {"dt": "2004-08-01T00:00:00", "Total": 520904}, {"dt": "2004-07-01T00:00:00", "Total": 529663}, {"dt": "2004-06-01T00:00:00", "Total": 494098}, {"dt": "2004-05-01T00:00:00", "Total": 468029}, {"dt": "2004-04-01T00:00:00", "Total": 441061}, {"dt": "2004-03-01T00:00:00", "Total": 448398}, {"dt": "2004-02-01T00:00:00", "Total": 314749}, {"dt": "2004-01-01T00:00:00", "Total": 376956}, {"dt": "2003-12-01T00:00:00", "Total": 406021}, {"dt": "2003-11-01T00:00:00", "Total": 424893}, {"dt": "2003-10-01T00:00:00", "Total": 436824}, {"dt": "2003-09-01T00:00:00", "Total": 379811}, {"dt": "2003-08-01T00:00:00", "Total": 390717}, {"dt": "2003-07-01T00:00:00", "Total": 430686}, {"dt": "2003-06-01T00:00:00", "Total": 386516}, {"dt": "2003-05-01T00:00:00", "Total": 388386}, {"dt": "2003-04-01T00:00:00", "Total": 400786}, {"dt": "2003-03-01T00:00:00", "Total": 356532}, {"dt": "2003-02-01T00:00:00", "Total": 322606}, {"dt": "2003-01-01T00:00:00", "Total": 334346}, {"dt": "2002-12-01T00:00:00", "Total": 361962}, {"dt": "2002-11-01T00:00:00", "Total": 335149}, {"dt": "2002-10-01T00:00:00", "Total": 301318}, {"dt": "2002-09-01T00:00:00", "Total": 340339}, {"dt": "2002-08-01T00:00:00", "Total": 427236}, {"dt": "2002-07-01T00:00:00", "Total": 451917}, {"dt": "2002-06-01T00:00:00", "Total": 418977}, {"dt": "2002-05-01T00:00:00", "Total": 428033}, {"dt": "2002-04-01T00:00:00", "Total": 410200}, {"dt": "2002-03-01T00:00:00", "Total": 343606}, {"dt": "2002-02-01T00:00:00", "Total": 362983}, {"dt": "2002-01-01T00:00:00", "Total": 344645}, {"dt": "2001-12-01T00:00:00", "Total": 359543}, {"dt": "2001-11-01T00:00:00", "Total": 372085}, {"dt": "2001-10-01T00:00:00", "Total": 434868}, {"dt": "2001-09-01T00:00:00", "Total": 388379}, {"dt": "2001-08-01T00:00:00", "Total": 405862}, {"dt": "2001-07-01T00:00:00", "Total": 379032}, {"dt": "2001-06-01T00:00:00", "Total": 362658}, {"dt": "2001-05-01T00:00:00", "Total": 367572}, {"dt": "2001-04-01T00:00:00", "Total": 366528}, {"dt": "2001-03-01T00:00:00", "Total": 360279}, {"dt": "2001-02-01T00:00:00", "Total": 311712}, {"dt": "2001-01-01T00:00:00", "Total": 354433}, {"dt": "2000-12-01T00:00:00", "Total": 351390}, {"dt": "2000-11-01T00:00:00", "Total": 410897}, {"dt": "2000-10-01T00:00:00", "Total": 432932}, {"dt": "2000-09-01T00:00:00", "Total": 387593}, {"dt": "2000-08-01T00:00:00", "Total": 434741}, {"dt": "2000-07-01T00:00:00", "Total": 409979}, {"dt": "2000-06-01T00:00:00", "Total": 374895}, {"dt": "2000-05-01T00:00:00", "Total": 406772}, {"dt": "2000-04-01T00:00:00", "Total": 366465}, {"dt": "2000-03-01T00:00:00", "Total": 350764}, {"dt": "2000-02-01T00:00:00", "Total": 335216}, {"dt": "2000-01-01T00:00:00", "Total": 339143}, {"dt": "1999-12-01T00:00:00", "Total": 365240}, {"dt": "1999-11-01T00:00:00", "Total": 397301}, {"dt": "1999-10-01T00:00:00", "Total": 396420}, {"dt": "1999-09-01T00:00:00", "Total": 402710}, {"dt": "1999-08-01T00:00:00", "Total": 399305}, {"dt": "1999-07-01T00:00:00", "Total": 347961}, {"dt": "1999-06-01T00:00:00", "Total": 373975}, {"dt": "1999-05-01T00:00:00", "Total": 394467}, {"dt": "1999-04-01T00:00:00", "Total": 339686}, {"dt": "1999-03-01T00:00:00", "Total": 347974}, {"dt": "1999-02-01T00:00:00", "Total": 324129}, {"dt": "1999-01-01T00:00:00", "Total": 319312}, {"dt": "1998-12-01T00:00:00", "Total": 336648}, {"dt": "1998-11-01T00:00:00", "Total": 368141}, {"dt": "1998-10-01T00:00:00", "Total": 347462}, {"dt": "1998-09-01T00:00:00", "Total": 372746}, {"dt": "1998-08-01T00:00:00", "Total": 372615}, {"dt": "1998-07-01T00:00:00", "Total": 378714}, {"dt": "1998-06-01T00:00:00", "Total": 355036}, {"dt": "1998-05-01T00:00:00", "Total": 331619}, {"dt": "1998-04-01T00:00:00", "Total": 336924}, {"dt": "1998-03-01T00:00:00", "Total": 333334}, {"dt": "1998-02-01T00:00:00", "Total": 276176}, {"dt": "1998-01-01T00:00:00", "Total": 288274}, {"dt": "1997-12-01T00:00:00", "Total": 300992}, {"dt": "1997-11-01T00:00:00", "Total": 310992}, {"dt": "1997-10-01T00:00:00", "Total": 314956}, {"dt": "1997-09-01T00:00:00", "Total": 332470}, {"dt": "1997-08-01T00:00:00", "Total": 297508}, {"dt": "1997-07-01T00:00:00", "Total": 315000}, {"dt": "1997-06-01T00:00:00", "Total": 309629}, {"dt": "1997-05-01T00:00:00", "Total": 278017}, {"dt": "1997-04-01T00:00:00", "Total": 276934}, {"dt": "1997-03-01T00:00:00", "Total": 273922}, {"dt": "1997-02-01T00:00:00", "Total": 250274}, {"dt": "1997-01-01T00:00:00", "Total": 243905}, {"dt": "1996-12-01T00:00:00", "Total": 271381}, {"dt": "1996-11-01T00:00:00", "Total": 252219}, {"dt": "1996-10-01T00:00:00", "Total": 284862}, {"dt": "1996-09-01T00:00:00", "Total": 277529}, {"dt": "1996-08-01T00:00:00", "Total": 268872}, {"dt": "1996-07-01T00:00:00", "Total": 266947}, {"dt": "1996-06-01T00:00:00", "Total": 262324}, {"dt": "1996-05-01T00:00:00", "Total": 240021}, {"dt": "1996-04-01T00:00:00", "Total": 258140}, {"dt": "1996-03-01T00:00:00", "Total": 230200}, {"dt": "1996-02-01T00:00:00", "Total": 226904}, {"dt": "1996-01-01T00:00:00", "Total": 227936}, {"dt": "1995-12-01T00:00:00", "Total": 233866}, {"dt": "1995-11-01T00:00:00", "Total": 243099}, {"dt": "1995-10-01T00:00:00", "Total": 271587}, {"dt": "1995-09-01T00:00:00", "Total": 242453}, {"dt": "1995-08-01T00:00:00", "Total": 264134}, {"dt": "1995-07-01T00:00:00", "Total": 256033}, {"dt": "1995-06-01T00:00:00", "Total": 227698}, {"dt": "1995-05-01T00:00:00", "Total": 240376}, {"dt": "1995-04-01T00:00:00", "Total": 226931}, {"dt": "1995-03-01T00:00:00", "Total": 206438}, {"dt": "1995-02-01T00:00:00", "Total": 216102}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_lb_raw</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Long Beach&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Total Empties&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[12]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-aa1ba63158f74cc98132379343229994"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-aa1ba63158f74cc98132379343229994") {
      outputDiv = document.getElementById("altair-viz-aa1ba63158f74cc98132379343229994");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector007"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Long Beach Total Empties Container Volume", "transform": [{"window": [{"op": "lag", "field": "Total Empties", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Total Empties'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt"}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Total Empties"}}, "height": 100, "selection": {"selector007": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-1c596a233d93f768d71e1f582b46de0a"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-1c596a233d93f768d71e1f582b46de0a": [{"dt": "2021-09-01T00:00:00", "Total Empties": 267456}, {"dt": "2021-08-01T00:00:00", "Total Empties": 280794}, {"dt": "2021-07-01T00:00:00", "Total Empties": 291955}, {"dt": "2021-06-01T00:00:00", "Total Empties": 250249}, {"dt": "2021-05-01T00:00:00", "Total Empties": 327135}, {"dt": "2021-04-01T00:00:00", "Total Empties": 254968}, {"dt": "2021-03-01T00:00:00", "Total Empties": 292505}, {"dt": "2021-02-01T00:00:00", "Total Empties": 278563}, {"dt": "2021-01-01T00:00:00", "Total Empties": 283497}, {"dt": "2020-12-01T00:00:00", "Total Empties": 277440}, {"dt": "2020-11-01T00:00:00", "Total Empties": 283563}, {"dt": "2020-10-01T00:00:00", "Total Empties": 289517}, {"dt": "2020-09-01T00:00:00", "Total Empties": 277406}, {"dt": "2020-08-01T00:00:00", "Total Empties": 234642}, {"dt": "2020-07-01T00:00:00", "Total Empties": 237672}, {"dt": "2020-06-01T00:00:00", "Total Empties": 183928}, {"dt": "2020-05-01T00:00:00", "Total Empties": 181060}, {"dt": "2020-04-01T00:00:00", "Total Empties": 163688}, {"dt": "2020-03-01T00:00:00", "Total Empties": 137652}, {"dt": "2020-02-01T00:00:00", "Total Empties": 164277}, {"dt": "2020-01-01T00:00:00", "Total Empties": 208244}, {"dt": "2019-12-01T00:00:00", "Total Empties": 216636}, {"dt": "2019-11-01T00:00:00", "Total Empties": 182992}, {"dt": "2019-10-01T00:00:00", "Total Empties": 219728}, {"dt": "2019-09-01T00:00:00", "Total Empties": 228821}, {"dt": "2019-08-01T00:00:00", "Total Empties": 216238}, {"dt": "2019-07-01T00:00:00", "Total Empties": 196777}, {"dt": "2019-06-01T00:00:00", "Total Empties": 211718}, {"dt": "2019-05-01T00:00:00", "Total Empties": 162479}, {"dt": "2019-04-01T00:00:00", "Total Empties": 186435}, {"dt": "2019-03-01T00:00:00", "Total Empties": 174346}, {"dt": "2019-02-01T00:00:00", "Total Empties": 188465}, {"dt": "2019-01-01T00:00:00", "Total Empties": 216160}, {"dt": "2018-12-01T00:00:00", "Total Empties": 255220}, {"dt": "2018-11-01T00:00:00", "Total Empties": 186183}, {"dt": "2018-10-01T00:00:00", "Total Empties": 221487}, {"dt": "2018-09-01T00:00:00", "Total Empties": 222343}, {"dt": "2018-08-01T00:00:00", "Total Empties": 216968}, {"dt": "2018-07-01T00:00:00", "Total Empties": 220975}, {"dt": "2018-06-01T00:00:00", "Total Empties": 232926}, {"dt": "2018-05-01T00:00:00", "Total Empties": 183959}, {"dt": "2018-04-01T00:00:00", "Total Empties": 164264}, {"dt": "2018-03-01T00:00:00", "Total Empties": 165015}, {"dt": "2018-02-01T00:00:00", "Total Empties": 188628}, {"dt": "2018-01-01T00:00:00", "Total Empties": 212671}, {"dt": "2017-12-01T00:00:00", "Total Empties": 213749}, {"dt": "2017-11-01T00:00:00", "Total Empties": 167085}, {"dt": "2017-10-01T00:00:00", "Total Empties": 204055}, {"dt": "2017-09-01T00:00:00", "Total Empties": 209985}, {"dt": "2017-08-01T00:00:00", "Total Empties": 219370}, {"dt": "2017-07-01T00:00:00", "Total Empties": 215394}, {"dt": "2017-06-01T00:00:00", "Total Empties": 205095}, {"dt": "2017-05-01T00:00:00", "Total Empties": 192908}, {"dt": "2017-04-01T00:00:00", "Total Empties": 153547}, {"dt": "2017-03-01T00:00:00", "Total Empties": 135413}, {"dt": "2017-02-01T00:00:00", "Total Empties": 128742}, {"dt": "2017-01-01T00:00:00", "Total Empties": 165465}, {"dt": "2016-12-01T00:00:00", "Total Empties": 154397}, {"dt": "2016-11-01T00:00:00", "Total Empties": 142801}, {"dt": "2016-10-01T00:00:00", "Total Empties": 158327}, {"dt": "2016-09-01T00:00:00", "Total Empties": 143476}, {"dt": "2016-08-01T00:00:00", "Total Empties": 160157}, {"dt": "2016-07-01T00:00:00", "Total Empties": 168671}, {"dt": "2016-06-01T00:00:00", "Total Empties": 161714}, {"dt": "2016-05-01T00:00:00", "Total Empties": 171333}, {"dt": "2016-04-01T00:00:00", "Total Empties": 118721}, {"dt": "2016-03-01T00:00:00", "Total Empties": 130010}, {"dt": "2016-02-01T00:00:00", "Total Empties": 142532}, {"dt": "2016-01-01T00:00:00", "Total Empties": 150958}, {"dt": "2015-12-01T00:00:00", "Total Empties": 174328}, {"dt": "2015-11-01T00:00:00", "Total Empties": 188328}, {"dt": "2015-10-01T00:00:00", "Total Empties": 183681}, {"dt": "2015-09-01T00:00:00", "Total Empties": 197076}, {"dt": "2015-08-01T00:00:00", "Total Empties": 206625}, {"dt": "2015-07-01T00:00:00", "Total Empties": 200457}, {"dt": "2015-06-01T00:00:00", "Total Empties": 158209}, {"dt": "2015-05-01T00:00:00", "Total Empties": 172078}, {"dt": "2015-04-01T00:00:00", "Total Empties": 159938}, {"dt": "2015-03-01T00:00:00", "Total Empties": 185227}, {"dt": "2015-02-01T00:00:00", "Total Empties": 97941}, {"dt": "2015-01-01T00:00:00", "Total Empties": 117361}, {"dt": "2014-12-01T00:00:00", "Total Empties": 159225}, {"dt": "2014-11-01T00:00:00", "Total Empties": 157570}, {"dt": "2014-10-01T00:00:00", "Total Empties": 152082}, {"dt": "2014-09-01T00:00:00", "Total Empties": 172016}, {"dt": "2014-08-01T00:00:00", "Total Empties": 145376}, {"dt": "2014-07-01T00:00:00", "Total Empties": 161319}, {"dt": "2014-06-01T00:00:00", "Total Empties": 154428}, {"dt": "2014-05-01T00:00:00", "Total Empties": 140368}, {"dt": "2014-04-01T00:00:00", "Total Empties": 127633}, {"dt": "2014-03-01T00:00:00", "Total Empties": 99894}, {"dt": "2014-02-01T00:00:00", "Total Empties": 101930}, {"dt": "2014-01-01T00:00:00", "Total Empties": 127058}, {"dt": "2013-12-01T00:00:00", "Total Empties": 142859}, {"dt": "2013-11-01T00:00:00", "Total Empties": 121011}, {"dt": "2013-10-01T00:00:00", "Total Empties": 136774}, {"dt": "2013-09-01T00:00:00", "Total Empties": 144457}, {"dt": "2013-08-01T00:00:00", "Total Empties": 148357}, {"dt": "2013-07-01T00:00:00", "Total Empties": 134950}, {"dt": "2013-06-01T00:00:00", "Total Empties": 141228}, {"dt": "2013-05-01T00:00:00", "Total Empties": 131017}, {"dt": "2013-04-01T00:00:00", "Total Empties": 117263}, {"dt": "2013-03-01T00:00:00", "Total Empties": 105574}, {"dt": "2013-02-01T00:00:00", "Total Empties": 111197}, {"dt": "2013-01-01T00:00:00", "Total Empties": 135631}, {"dt": "2012-12-01T00:00:00", "Total Empties": 128980}, {"dt": "2012-11-01T00:00:00", "Total Empties": 138667}, {"dt": "2012-10-01T00:00:00", "Total Empties": 120112}, {"dt": "2012-09-01T00:00:00", "Total Empties": 132016}, {"dt": "2012-08-01T00:00:00", "Total Empties": 140243}, {"dt": "2012-07-01T00:00:00", "Total Empties": 136679}, {"dt": "2012-06-01T00:00:00", "Total Empties": 141184}, {"dt": "2012-05-01T00:00:00", "Total Empties": 118872}, {"dt": "2012-04-01T00:00:00", "Total Empties": 108496}, {"dt": "2012-03-01T00:00:00", "Total Empties": 90611}, {"dt": "2012-02-01T00:00:00", "Total Empties": 77108}, {"dt": "2012-01-01T00:00:00", "Total Empties": 110216}, {"dt": "2011-12-01T00:00:00", "Total Empties": 132106}, {"dt": "2011-11-01T00:00:00", "Total Empties": 117121}, {"dt": "2011-10-01T00:00:00", "Total Empties": 129092}, {"dt": "2011-09-01T00:00:00", "Total Empties": 145747}, {"dt": "2011-08-01T00:00:00", "Total Empties": 147454}, {"dt": "2011-07-01T00:00:00", "Total Empties": 155644}, {"dt": "2011-06-01T00:00:00", "Total Empties": 156568}, {"dt": "2011-05-01T00:00:00", "Total Empties": 131420}, {"dt": "2011-04-01T00:00:00", "Total Empties": 117300}, {"dt": "2011-03-01T00:00:00", "Total Empties": 89263}, {"dt": "2011-02-01T00:00:00", "Total Empties": 102747}, {"dt": "2011-01-01T00:00:00", "Total Empties": 104969}, {"dt": "2010-12-01T00:00:00", "Total Empties": 125282}, {"dt": "2010-11-01T00:00:00", "Total Empties": 141199}, {"dt": "2010-10-01T00:00:00", "Total Empties": 159872}, {"dt": "2010-09-01T00:00:00", "Total Empties": 161864}, {"dt": "2010-08-01T00:00:00", "Total Empties": 173723}, {"dt": "2010-07-01T00:00:00", "Total Empties": 167826}, {"dt": "2010-06-01T00:00:00", "Total Empties": 141935}, {"dt": "2010-05-01T00:00:00", "Total Empties": 121551}, {"dt": "2010-04-01T00:00:00", "Total Empties": 113659}, {"dt": "2010-03-01T00:00:00", "Total Empties": 85627}, {"dt": "2010-02-01T00:00:00", "Total Empties": 82006}, {"dt": "2010-01-01T00:00:00", "Total Empties": 97697}, {"dt": "2009-12-01T00:00:00", "Total Empties": 111567}, {"dt": "2009-11-01T00:00:00", "Total Empties": 105521}, {"dt": "2009-10-01T00:00:00", "Total Empties": 106160}, {"dt": "2009-09-01T00:00:00", "Total Empties": 106103}, {"dt": "2009-08-01T00:00:00", "Total Empties": 112796}, {"dt": "2009-07-01T00:00:00", "Total Empties": 102874}, {"dt": "2009-06-01T00:00:00", "Total Empties": 92882}, {"dt": "2009-05-01T00:00:00", "Total Empties": 89900}, {"dt": "2009-04-01T00:00:00", "Total Empties": 96678}, {"dt": "2009-03-01T00:00:00", "Total Empties": 70007}, {"dt": "2009-02-01T00:00:00", "Total Empties": 75962}, {"dt": "2009-01-01T00:00:00", "Total Empties": 110197}, {"dt": "2008-12-01T00:00:00", "Total Empties": 130906}, {"dt": "2008-11-01T00:00:00", "Total Empties": 179769}, {"dt": "2008-10-01T00:00:00", "Total Empties": 170212}, {"dt": "2008-09-01T00:00:00", "Total Empties": 146070}, {"dt": "2008-08-01T00:00:00", "Total Empties": 135615}, {"dt": "2008-07-01T00:00:00", "Total Empties": 137989}, {"dt": "2008-06-01T00:00:00", "Total Empties": 131156}, {"dt": "2008-05-01T00:00:00", "Total Empties": 102832}, {"dt": "2008-04-01T00:00:00", "Total Empties": 112455}, {"dt": "2008-03-01T00:00:00", "Total Empties": 107107}, {"dt": "2008-02-01T00:00:00", "Total Empties": 119193}, {"dt": "2008-01-01T00:00:00", "Total Empties": 138098}, {"dt": "2007-12-01T00:00:00", "Total Empties": 151933}, {"dt": "2007-11-01T00:00:00", "Total Empties": 157690}, {"dt": "2007-10-01T00:00:00", "Total Empties": 176603}, {"dt": "2007-09-01T00:00:00", "Total Empties": 187760}, {"dt": "2007-08-01T00:00:00", "Total Empties": 189848}, {"dt": "2007-07-01T00:00:00", "Total Empties": 179937}, {"dt": "2007-06-01T00:00:00", "Total Empties": 181841}, {"dt": "2007-05-01T00:00:00", "Total Empties": 162529}, {"dt": "2007-04-01T00:00:00", "Total Empties": 154906}, {"dt": "2007-03-01T00:00:00", "Total Empties": 162580}, {"dt": "2007-02-01T00:00:00", "Total Empties": 148189}, {"dt": "2007-01-01T00:00:00", "Total Empties": 179815}, {"dt": "2006-12-01T00:00:00", "Total Empties": 180663}, {"dt": "2006-11-01T00:00:00", "Total Empties": 214453}, {"dt": "2006-10-01T00:00:00", "Total Empties": 205720}, {"dt": "2006-09-01T00:00:00", "Total Empties": 198418}, {"dt": "2006-08-01T00:00:00", "Total Empties": 221973}, {"dt": "2006-07-01T00:00:00", "Total Empties": 176947}, {"dt": "2006-06-01T00:00:00", "Total Empties": 195437}, {"dt": "2006-05-01T00:00:00", "Total Empties": 200594}, {"dt": "2006-04-01T00:00:00", "Total Empties": 186713}, {"dt": "2006-03-01T00:00:00", "Total Empties": 160026}, {"dt": "2006-02-01T00:00:00", "Total Empties": 153038}, {"dt": "2006-01-01T00:00:00", "Total Empties": 185860}, {"dt": "2005-12-01T00:00:00", "Total Empties": 175230}, {"dt": "2005-11-01T00:00:00", "Total Empties": 198432}, {"dt": "2005-10-01T00:00:00", "Total Empties": 198315}, {"dt": "2005-09-01T00:00:00", "Total Empties": 199800}, {"dt": "2005-08-01T00:00:00", "Total Empties": 198487}, {"dt": "2005-07-01T00:00:00", "Total Empties": 176865}, {"dt": "2005-06-01T00:00:00", "Total Empties": 180971}, {"dt": "2005-05-01T00:00:00", "Total Empties": 170821}, {"dt": "2005-04-01T00:00:00", "Total Empties": 159972}, {"dt": "2005-03-01T00:00:00", "Total Empties": 151407}, {"dt": "2005-02-01T00:00:00", "Total Empties": 156813}, {"dt": "2005-01-01T00:00:00", "Total Empties": 175232}, {"dt": "2004-12-01T00:00:00", "Total Empties": 188467}, {"dt": "2004-11-01T00:00:00", "Total Empties": 187461}, {"dt": "2004-10-01T00:00:00", "Total Empties": 183251}, {"dt": "2004-09-01T00:00:00", "Total Empties": 162594}, {"dt": "2004-08-01T00:00:00", "Total Empties": 166651}, {"dt": "2004-07-01T00:00:00", "Total Empties": 165405}, {"dt": "2004-06-01T00:00:00", "Total Empties": 151128}, {"dt": "2004-05-01T00:00:00", "Total Empties": 140617}, {"dt": "2004-04-01T00:00:00", "Total Empties": 134190}, {"dt": "2004-03-01T00:00:00", "Total Empties": 118075}, {"dt": "2004-02-01T00:00:00", "Total Empties": 83791}, {"dt": "2004-01-01T00:00:00", "Total Empties": 102329}, {"dt": "2003-12-01T00:00:00", "Total Empties": 111986}, {"dt": "2003-11-01T00:00:00", "Total Empties": 126065}, {"dt": "2003-10-01T00:00:00", "Total Empties": 121345}, {"dt": "2003-09-01T00:00:00", "Total Empties": 107570}, {"dt": "2003-08-01T00:00:00", "Total Empties": 108469}, {"dt": "2003-07-01T00:00:00", "Total Empties": 118596}, {"dt": "2003-06-01T00:00:00", "Total Empties": 111180}, {"dt": "2003-05-01T00:00:00", "Total Empties": 115215}, {"dt": "2003-04-01T00:00:00", "Total Empties": 125015}, {"dt": "2003-03-01T00:00:00", "Total Empties": 93935}, {"dt": "2003-02-01T00:00:00", "Total Empties": 96098}, {"dt": "2003-01-01T00:00:00", "Total Empties": 108534}, {"dt": "2002-12-01T00:00:00", "Total Empties": 111457}, {"dt": "2002-11-01T00:00:00", "Total Empties": 90740}, {"dt": "2002-10-01T00:00:00", "Total Empties": 96934}, {"dt": "2002-09-01T00:00:00", "Total Empties": 97541}, {"dt": "2002-08-01T00:00:00", "Total Empties": 121558}, {"dt": "2002-07-01T00:00:00", "Total Empties": 131799}, {"dt": "2002-06-01T00:00:00", "Total Empties": 107051}, {"dt": "2002-05-01T00:00:00", "Total Empties": 112589}, {"dt": "2002-04-01T00:00:00", "Total Empties": 94287}, {"dt": "2002-03-01T00:00:00", "Total Empties": 83887}, {"dt": "2002-02-01T00:00:00", "Total Empties": 77374}, {"dt": "2002-01-01T00:00:00", "Total Empties": 93173}, {"dt": "2001-12-01T00:00:00", "Total Empties": 84299}, {"dt": "2001-11-01T00:00:00", "Total Empties": 102345}, {"dt": "2001-10-01T00:00:00", "Total Empties": 114428}, {"dt": "2001-09-01T00:00:00", "Total Empties": 91451}, {"dt": "2001-08-01T00:00:00", "Total Empties": 101069}, {"dt": "2001-07-01T00:00:00", "Total Empties": 92897}, {"dt": "2001-06-01T00:00:00", "Total Empties": 81275}, {"dt": "2001-05-01T00:00:00", "Total Empties": 90344}, {"dt": "2001-04-01T00:00:00", "Total Empties": 87329}, {"dt": "2001-03-01T00:00:00", "Total Empties": 80325}, {"dt": "2001-02-01T00:00:00", "Total Empties": 81044}, {"dt": "2001-01-01T00:00:00", "Total Empties": 82622}, {"dt": "2000-12-01T00:00:00", "Total Empties": 91408}, {"dt": "2000-11-01T00:00:00", "Total Empties": 107076}, {"dt": "2000-10-01T00:00:00", "Total Empties": 108880}, {"dt": "2000-09-01T00:00:00", "Total Empties": 97838}, {"dt": "2000-08-01T00:00:00", "Total Empties": 111760}, {"dt": "2000-07-01T00:00:00", "Total Empties": 98240}, {"dt": "2000-06-01T00:00:00", "Total Empties": 88586}, {"dt": "2000-05-01T00:00:00", "Total Empties": 90986}, {"dt": "2000-04-01T00:00:00", "Total Empties": 74727}, {"dt": "2000-03-01T00:00:00", "Total Empties": 74404}, {"dt": "2000-02-01T00:00:00", "Total Empties": 75961}, {"dt": "2000-01-01T00:00:00", "Total Empties": 80380}, {"dt": "1999-12-01T00:00:00", "Total Empties": 92971}, {"dt": "1999-11-01T00:00:00", "Total Empties": 96656}, {"dt": "1999-10-01T00:00:00", "Total Empties": 107829}, {"dt": "1999-09-01T00:00:00", "Total Empties": 101322}, {"dt": "1999-08-01T00:00:00", "Total Empties": 104015}, {"dt": "1999-07-01T00:00:00", "Total Empties": 85220}, {"dt": "1999-06-01T00:00:00", "Total Empties": 100603}, {"dt": "1999-05-01T00:00:00", "Total Empties": 101274}, {"dt": "1999-04-01T00:00:00", "Total Empties": 81071}, {"dt": "1999-03-01T00:00:00", "Total Empties": 87362}, {"dt": "1999-02-01T00:00:00", "Total Empties": 71647}, {"dt": "1999-01-01T00:00:00", "Total Empties": 72239}, {"dt": "1998-12-01T00:00:00", "Total Empties": 82589}, {"dt": "1998-11-01T00:00:00", "Total Empties": 91189}, {"dt": "1998-10-01T00:00:00", "Total Empties": 89572}, {"dt": "1998-09-01T00:00:00", "Total Empties": 100017}, {"dt": "1998-08-01T00:00:00", "Total Empties": 99786}, {"dt": "1998-07-01T00:00:00", "Total Empties": 98626}, {"dt": "1998-06-01T00:00:00", "Total Empties": 89402}, {"dt": "1998-05-01T00:00:00", "Total Empties": 83598}, {"dt": "1998-04-01T00:00:00", "Total Empties": 77406}, {"dt": "1998-03-01T00:00:00", "Total Empties": 77104}, {"dt": "1998-02-01T00:00:00", "Total Empties": 66756}, {"dt": "1998-01-01T00:00:00", "Total Empties": 71096}, {"dt": "1997-12-01T00:00:00", "Total Empties": 64014}, {"dt": "1997-11-01T00:00:00", "Total Empties": 68070}, {"dt": "1997-10-01T00:00:00", "Total Empties": 57860}, {"dt": "1997-09-01T00:00:00", "Total Empties": 57795}, {"dt": "1997-08-01T00:00:00", "Total Empties": 49775}, {"dt": "1997-07-01T00:00:00", "Total Empties": 48792}, {"dt": "1997-06-01T00:00:00", "Total Empties": 43604}, {"dt": "1997-05-01T00:00:00", "Total Empties": 42953}, {"dt": "1997-04-01T00:00:00", "Total Empties": 37931}, {"dt": "1997-03-01T00:00:00", "Total Empties": 42326}, {"dt": "1997-02-01T00:00:00", "Total Empties": 35884}, {"dt": "1997-01-01T00:00:00", "Total Empties": 41484}, {"dt": "1996-12-01T00:00:00", "Total Empties": 37737}, {"dt": "1996-11-01T00:00:00", "Total Empties": 39910}, {"dt": "1996-10-01T00:00:00", "Total Empties": 44390}, {"dt": "1996-09-01T00:00:00", "Total Empties": 48001}, {"dt": "1996-08-01T00:00:00", "Total Empties": 46353}, {"dt": "1996-07-01T00:00:00", "Total Empties": 36962}, {"dt": "1996-06-01T00:00:00", "Total Empties": 40016}, {"dt": "1996-05-01T00:00:00", "Total Empties": 32777}, {"dt": "1996-04-01T00:00:00", "Total Empties": 29775}, {"dt": "1996-03-01T00:00:00", "Total Empties": 27480}, {"dt": "1996-02-01T00:00:00", "Total Empties": 23322}, {"dt": "1996-01-01T00:00:00", "Total Empties": 31147}, {"dt": "1995-12-01T00:00:00", "Total Empties": 36927}, {"dt": "1995-11-01T00:00:00", "Total Empties": 44000}, {"dt": "1995-10-01T00:00:00", "Total Empties": 43982}, {"dt": "1995-09-01T00:00:00", "Total Empties": 46443}, {"dt": "1995-08-01T00:00:00", "Total Empties": 46836}, {"dt": "1995-07-01T00:00:00", "Total Empties": 40852}, {"dt": "1995-06-01T00:00:00", "Total Empties": 30462}, {"dt": "1995-05-01T00:00:00", "Total Empties": 35462}, {"dt": "1995-04-01T00:00:00", "Total Empties": 29534}, {"dt": "1995-03-01T00:00:00", "Total Empties": 28349}, {"dt": "1995-02-01T00:00:00", "Total Empties": 35102}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_lb_raw</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Long Beach&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Loaded Inbound&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[13]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-421523a078884f229071e41e8c6d47e2"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-421523a078884f229071e41e8c6d47e2") {
      outputDiv = document.getElementById("altair-viz-421523a078884f229071e41e8c6d47e2");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector008"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Long Beach Loaded Inbound Container Volume", "transform": [{"window": [{"op": "lag", "field": "Loaded Inbound", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Loaded Inbound'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt"}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Loaded Inbound"}}, "height": 100, "selection": {"selector008": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-5314179a99d9d782fdbab418e15bae13"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-5314179a99d9d782fdbab418e15bae13": [{"dt": "2021-09-01T00:00:00", "Loaded Inbound": 370230}, {"dt": "2021-08-01T00:00:00", "Loaded Inbound": 407426}, {"dt": "2021-07-01T00:00:00", "Loaded Inbound": 382940}, {"dt": "2021-06-01T00:00:00", "Loaded Inbound": 357101}, {"dt": "2021-05-01T00:00:00", "Loaded Inbound": 444736}, {"dt": "2021-04-01T00:00:00", "Loaded Inbound": 367151}, {"dt": "2021-03-01T00:00:00", "Loaded Inbound": 408172}, {"dt": "2021-02-01T00:00:00", "Loaded Inbound": 373756}, {"dt": "2021-01-01T00:00:00", "Loaded Inbound": 364255}, {"dt": "2020-12-01T00:00:00", "Loaded Inbound": 406072}, {"dt": "2020-11-01T00:00:00", "Loaded Inbound": 382677}, {"dt": "2020-10-01T00:00:00", "Loaded Inbound": 402408}, {"dt": "2020-09-01T00:00:00", "Loaded Inbound": 405618}, {"dt": "2020-08-01T00:00:00", "Loaded Inbound": 364792}, {"dt": "2020-07-01T00:00:00", "Loaded Inbound": 376807}, {"dt": "2020-06-01T00:00:00", "Loaded Inbound": 300714}, {"dt": "2020-05-01T00:00:00", "Loaded Inbound": 312590}, {"dt": "2020-04-01T00:00:00", "Loaded Inbound": 253540}, {"dt": "2020-03-01T00:00:00", "Loaded Inbound": 234570}, {"dt": "2020-02-01T00:00:00", "Loaded Inbound": 248592}, {"dt": "2020-01-01T00:00:00", "Loaded Inbound": 309961}, {"dt": "2019-12-01T00:00:00", "Loaded Inbound": 323231}, {"dt": "2019-11-01T00:00:00", "Loaded Inbound": 293287}, {"dt": "2019-10-01T00:00:00", "Loaded Inbound": 337062}, {"dt": "2019-09-01T00:00:00", "Loaded Inbound": 354919}, {"dt": "2019-08-01T00:00:00", "Loaded Inbound": 322780}, {"dt": "2019-07-01T00:00:00", "Loaded Inbound": 313350}, {"dt": "2019-06-01T00:00:00", "Loaded Inbound": 331617}, {"dt": "2019-05-01T00:00:00", "Loaded Inbound": 290568}, {"dt": "2019-04-01T00:00:00", "Loaded Inbound": 317883}, {"dt": "2019-03-01T00:00:00", "Loaded Inbound": 247039}, {"dt": "2019-02-01T00:00:00", "Loaded Inbound": 302865}, {"dt": "2019-01-01T00:00:00", "Loaded Inbound": 323838}, {"dt": "2018-12-01T00:00:00", "Loaded Inbound": 373098}, {"dt": "2018-11-01T00:00:00", "Loaded Inbound": 319877}, {"dt": "2018-10-01T00:00:00", "Loaded Inbound": 364084}, {"dt": "2018-09-01T00:00:00", "Loaded Inbound": 357301}, {"dt": "2018-08-01T00:00:00", "Loaded Inbound": 343029}, {"dt": "2018-07-01T00:00:00", "Loaded Inbound": 347736}, {"dt": "2018-06-01T00:00:00", "Loaded Inbound": 384095}, {"dt": "2018-05-01T00:00:00", "Loaded Inbound": 361056}, {"dt": "2018-04-01T00:00:00", "Loaded Inbound": 312376}, {"dt": "2018-03-01T00:00:00", "Loaded Inbound": 267824}, {"dt": "2018-02-01T00:00:00", "Loaded Inbound": 342247}, {"dt": "2018-01-01T00:00:00", "Loaded Inbound": 324656}, {"dt": "2017-12-01T00:00:00", "Loaded Inbound": 345721}, {"dt": "2017-11-01T00:00:00", "Loaded Inbound": 319210}, {"dt": "2017-10-01T00:00:00", "Loaded Inbound": 339013}, {"dt": "2017-09-01T00:00:00", "Loaded Inbound": 366298}, {"dt": "2017-08-01T00:00:00", "Loaded Inbound": 355715}, {"dt": "2017-07-01T00:00:00", "Loaded Inbound": 378820}, {"dt": "2017-06-01T00:00:00", "Loaded Inbound": 335328}, {"dt": "2017-05-01T00:00:00", "Loaded Inbound": 336594}, {"dt": "2017-04-01T00:00:00", "Loaded Inbound": 288207}, {"dt": "2017-03-01T00:00:00", "Loaded Inbound": 249534}, {"dt": "2017-02-01T00:00:00", "Loaded Inbound": 249759}, {"dt": "2017-01-01T00:00:00", "Loaded Inbound": 298990}, {"dt": "2016-12-01T00:00:00", "Loaded Inbound": 271599}, {"dt": "2016-11-01T00:00:00", "Loaded Inbound": 270610}, {"dt": "2016-10-01T00:00:00", "Loaded Inbound": 296711}, {"dt": "2016-09-01T00:00:00", "Loaded Inbound": 282945}, {"dt": "2016-08-01T00:00:00", "Loaded Inbound": 321625}, {"dt": "2016-07-01T00:00:00", "Loaded Inbound": 325608}, {"dt": "2016-06-01T00:00:00", "Loaded Inbound": 313526}, {"dt": "2016-05-01T00:00:00", "Loaded Inbound": 330639}, {"dt": "2016-04-01T00:00:00", "Loaded Inbound": 247316}, {"dt": "2016-03-01T00:00:00", "Loaded Inbound": 207635}, {"dt": "2016-02-01T00:00:00", "Loaded Inbound": 295870}, {"dt": "2016-01-01T00:00:00", "Loaded Inbound": 278491}, {"dt": "2015-12-01T00:00:00", "Loaded Inbound": 296002}, {"dt": "2015-11-01T00:00:00", "Loaded Inbound": 306654}, {"dt": "2015-10-01T00:00:00", "Loaded Inbound": 307995}, {"dt": "2015-09-01T00:00:00", "Loaded Inbound": 332909}, {"dt": "2015-08-01T00:00:00", "Loaded Inbound": 358262}, {"dt": "2015-07-01T00:00:00", "Loaded Inbound": 345912}, {"dt": "2015-06-01T00:00:00", "Loaded Inbound": 297189}, {"dt": "2015-05-01T00:00:00", "Loaded Inbound": 327317}, {"dt": "2015-04-01T00:00:00", "Loaded Inbound": 317376}, {"dt": "2015-03-01T00:00:00", "Loaded Inbound": 317520}, {"dt": "2015-02-01T00:00:00", "Loaded Inbound": 204462}, {"dt": "2015-01-01T00:00:00", "Loaded Inbound": 213667}, {"dt": "2014-12-01T00:00:00", "Loaded Inbound": 276516}, {"dt": "2014-11-01T00:00:00", "Loaded Inbound": 293984}, {"dt": "2014-10-01T00:00:00", "Loaded Inbound": 310482}, {"dt": "2014-09-01T00:00:00", "Loaded Inbound": 339343}, {"dt": "2014-08-01T00:00:00", "Loaded Inbound": 300851}, {"dt": "2014-07-01T00:00:00", "Loaded Inbound": 297615}, {"dt": "2014-06-01T00:00:00", "Loaded Inbound": 316054}, {"dt": "2014-05-01T00:00:00", "Loaded Inbound": 312439}, {"dt": "2014-04-01T00:00:00", "Loaded Inbound": 295712}, {"dt": "2014-03-01T00:00:00", "Loaded Inbound": 223432}, {"dt": "2014-02-01T00:00:00", "Loaded Inbound": 271671}, {"dt": "2014-01-01T00:00:00", "Loaded Inbound": 279415}, {"dt": "2013-12-01T00:00:00", "Loaded Inbound": 291434}, {"dt": "2013-11-01T00:00:00", "Loaded Inbound": 296638}, {"dt": "2013-10-01T00:00:00", "Loaded Inbound": 298271}, {"dt": "2013-09-01T00:00:00", "Loaded Inbound": 307981}, {"dt": "2013-08-01T00:00:00", "Loaded Inbound": 327817}, {"dt": "2013-07-01T00:00:00", "Loaded Inbound": 294926}, {"dt": "2013-06-01T00:00:00", "Loaded Inbound": 290448}, {"dt": "2013-05-01T00:00:00", "Loaded Inbound": 305498}, {"dt": "2013-04-01T00:00:00", "Loaded Inbound": 264337}, {"dt": "2013-03-01T00:00:00", "Loaded Inbound": 224913}, {"dt": "2013-02-01T00:00:00", "Loaded Inbound": 279144}, {"dt": "2013-01-01T00:00:00", "Loaded Inbound": 273918}, {"dt": "2012-12-01T00:00:00", "Loaded Inbound": 295579}, {"dt": "2012-11-01T00:00:00", "Loaded Inbound": 278534}, {"dt": "2012-10-01T00:00:00", "Loaded Inbound": 276698}, {"dt": "2012-09-01T00:00:00", "Loaded Inbound": 265102}, {"dt": "2012-08-01T00:00:00", "Loaded Inbound": 274977}, {"dt": "2012-07-01T00:00:00", "Loaded Inbound": 261233}, {"dt": "2012-06-01T00:00:00", "Loaded Inbound": 280526}, {"dt": "2012-05-01T00:00:00", "Loaded Inbound": 249937}, {"dt": "2012-04-01T00:00:00", "Loaded Inbound": 232963}, {"dt": "2012-03-01T00:00:00", "Loaded Inbound": 226141}, {"dt": "2012-02-01T00:00:00", "Loaded Inbound": 191475}, {"dt": "2012-01-01T00:00:00", "Loaded Inbound": 229125}, {"dt": "2011-12-01T00:00:00", "Loaded Inbound": 248609}, {"dt": "2011-11-01T00:00:00", "Loaded Inbound": 231749}, {"dt": "2011-10-01T00:00:00", "Loaded Inbound": 240248}, {"dt": "2011-09-01T00:00:00", "Loaded Inbound": 263214}, {"dt": "2011-08-01T00:00:00", "Loaded Inbound": 267198}, {"dt": "2011-07-01T00:00:00", "Loaded Inbound": 290314}, {"dt": "2011-06-01T00:00:00", "Loaded Inbound": 271113}, {"dt": "2011-05-01T00:00:00", "Loaded Inbound": 275100}, {"dt": "2011-04-01T00:00:00", "Loaded Inbound": 270107}, {"dt": "2011-03-01T00:00:00", "Loaded Inbound": 191211}, {"dt": "2011-02-01T00:00:00", "Loaded Inbound": 233660}, {"dt": "2011-01-01T00:00:00", "Loaded Inbound": 242445}, {"dt": "2010-12-01T00:00:00", "Loaded Inbound": 256889}, {"dt": "2010-11-01T00:00:00", "Loaded Inbound": 274480}, {"dt": "2010-10-01T00:00:00", "Loaded Inbound": 303168}, {"dt": "2010-09-01T00:00:00", "Loaded Inbound": 288905}, {"dt": "2010-08-01T00:00:00", "Loaded Inbound": 311240}, {"dt": "2010-07-01T00:00:00", "Loaded Inbound": 293878}, {"dt": "2010-06-01T00:00:00", "Loaded Inbound": 262053}, {"dt": "2010-05-01T00:00:00", "Loaded Inbound": 264505}, {"dt": "2010-04-01T00:00:00", "Loaded Inbound": 241245}, {"dt": "2010-03-01T00:00:00", "Loaded Inbound": 206652}, {"dt": "2010-02-01T00:00:00", "Loaded Inbound": 207920}, {"dt": "2010-01-01T00:00:00", "Loaded Inbound": 217925}, {"dt": "2009-12-01T00:00:00", "Loaded Inbound": 232586}, {"dt": "2009-11-01T00:00:00", "Loaded Inbound": 228347}, {"dt": "2009-10-01T00:00:00", "Loaded Inbound": 227064}, {"dt": "2009-09-01T00:00:00", "Loaded Inbound": 224924}, {"dt": "2009-08-01T00:00:00", "Loaded Inbound": 249920}, {"dt": "2009-07-01T00:00:00", "Loaded Inbound": 221719}, {"dt": "2009-06-01T00:00:00", "Loaded Inbound": 206358}, {"dt": "2009-05-01T00:00:00", "Loaded Inbound": 208590}, {"dt": "2009-04-01T00:00:00", "Loaded Inbound": 199051}, {"dt": "2009-03-01T00:00:00", "Loaded Inbound": 186450}, {"dt": "2009-02-01T00:00:00", "Loaded Inbound": 149299}, {"dt": "2009-01-01T00:00:00", "Loaded Inbound": 200588}, {"dt": "2008-12-01T00:00:00", "Loaded Inbound": 205031}, {"dt": "2008-11-01T00:00:00", "Loaded Inbound": 267840}, {"dt": "2008-10-01T00:00:00", "Loaded Inbound": 292456}, {"dt": "2008-09-01T00:00:00", "Loaded Inbound": 279137}, {"dt": "2008-08-01T00:00:00", "Loaded Inbound": 283174}, {"dt": "2008-07-01T00:00:00", "Loaded Inbound": 272350}, {"dt": "2008-06-01T00:00:00", "Loaded Inbound": 288339}, {"dt": "2008-05-01T00:00:00", "Loaded Inbound": 267381}, {"dt": "2008-04-01T00:00:00", "Loaded Inbound": 280553}, {"dt": "2008-03-01T00:00:00", "Loaded Inbound": 228328}, {"dt": "2008-02-01T00:00:00", "Loaded Inbound": 263231}, {"dt": "2008-01-01T00:00:00", "Loaded Inbound": 261543}, {"dt": "2007-12-01T00:00:00", "Loaded Inbound": 280482}, {"dt": "2007-11-01T00:00:00", "Loaded Inbound": 310068}, {"dt": "2007-10-01T00:00:00", "Loaded Inbound": 323131}, {"dt": "2007-09-01T00:00:00", "Loaded Inbound": 331507}, {"dt": "2007-08-01T00:00:00", "Loaded Inbound": 326646}, {"dt": "2007-07-01T00:00:00", "Loaded Inbound": 332402}, {"dt": "2007-06-01T00:00:00", "Loaded Inbound": 339411}, {"dt": "2007-05-01T00:00:00", "Loaded Inbound": 316666}, {"dt": "2007-04-01T00:00:00", "Loaded Inbound": 303138}, {"dt": "2007-03-01T00:00:00", "Loaded Inbound": 252998}, {"dt": "2007-02-01T00:00:00", "Loaded Inbound": 284800}, {"dt": "2007-01-01T00:00:00", "Loaded Inbound": 303344}, {"dt": "2006-12-01T00:00:00", "Loaded Inbound": 282726}, {"dt": "2006-11-01T00:00:00", "Loaded Inbound": 332806}, {"dt": "2006-10-01T00:00:00", "Loaded Inbound": 335688}, {"dt": "2006-09-01T00:00:00", "Loaded Inbound": 317661}, {"dt": "2006-08-01T00:00:00", "Loaded Inbound": 347829}, {"dt": "2006-07-01T00:00:00", "Loaded Inbound": 305117}, {"dt": "2006-06-01T00:00:00", "Loaded Inbound": 319737}, {"dt": "2006-05-01T00:00:00", "Loaded Inbound": 328314}, {"dt": "2006-04-01T00:00:00", "Loaded Inbound": 321044}, {"dt": "2006-03-01T00:00:00", "Loaded Inbound": 282440}, {"dt": "2006-02-01T00:00:00", "Loaded Inbound": 252463}, {"dt": "2006-01-01T00:00:00", "Loaded Inbound": 293855}, {"dt": "2005-12-01T00:00:00", "Loaded Inbound": 266358}, {"dt": "2005-11-01T00:00:00", "Loaded Inbound": 305065}, {"dt": "2005-10-01T00:00:00", "Loaded Inbound": 299203}, {"dt": "2005-09-01T00:00:00", "Loaded Inbound": 313460}, {"dt": "2005-08-01T00:00:00", "Loaded Inbound": 306124}, {"dt": "2005-07-01T00:00:00", "Loaded Inbound": 289518}, {"dt": "2005-06-01T00:00:00", "Loaded Inbound": 294252}, {"dt": "2005-05-01T00:00:00", "Loaded Inbound": 288031}, {"dt": "2005-04-01T00:00:00", "Loaded Inbound": 270920}, {"dt": "2005-03-01T00:00:00", "Loaded Inbound": 210093}, {"dt": "2005-02-01T00:00:00", "Loaded Inbound": 250245}, {"dt": "2005-01-01T00:00:00", "Loaded Inbound": 252785}, {"dt": "2004-12-01T00:00:00", "Loaded Inbound": 269495}, {"dt": "2004-11-01T00:00:00", "Loaded Inbound": 295717}, {"dt": "2004-10-01T00:00:00", "Loaded Inbound": 288590}, {"dt": "2004-09-01T00:00:00", "Loaded Inbound": 255592}, {"dt": "2004-08-01T00:00:00", "Loaded Inbound": 274914}, {"dt": "2004-07-01T00:00:00", "Loaded Inbound": 281817}, {"dt": "2004-06-01T00:00:00", "Loaded Inbound": 260752}, {"dt": "2004-05-01T00:00:00", "Loaded Inbound": 242910}, {"dt": "2004-04-01T00:00:00", "Loaded Inbound": 227046}, {"dt": "2004-03-01T00:00:00", "Loaded Inbound": 235500}, {"dt": "2004-02-01T00:00:00", "Loaded Inbound": 153995}, {"dt": "2004-01-01T00:00:00", "Loaded Inbound": 201652}, {"dt": "2003-12-01T00:00:00", "Loaded Inbound": 210094}, {"dt": "2003-11-01T00:00:00", "Loaded Inbound": 216379}, {"dt": "2003-10-01T00:00:00", "Loaded Inbound": 230527}, {"dt": "2003-09-01T00:00:00", "Loaded Inbound": 206315}, {"dt": "2003-08-01T00:00:00", "Loaded Inbound": 206910}, {"dt": "2003-07-01T00:00:00", "Loaded Inbound": 231118}, {"dt": "2003-06-01T00:00:00", "Loaded Inbound": 204344}, {"dt": "2003-05-01T00:00:00", "Loaded Inbound": 196565}, {"dt": "2003-04-01T00:00:00", "Loaded Inbound": 200476}, {"dt": "2003-03-01T00:00:00", "Loaded Inbound": 179800}, {"dt": "2003-02-01T00:00:00", "Loaded Inbound": 158863}, {"dt": "2003-01-01T00:00:00", "Loaded Inbound": 168186}, {"dt": "2002-12-01T00:00:00", "Loaded Inbound": 186243}, {"dt": "2002-11-01T00:00:00", "Loaded Inbound": 179463}, {"dt": "2002-10-01T00:00:00", "Loaded Inbound": 163776}, {"dt": "2002-09-01T00:00:00", "Loaded Inbound": 188874}, {"dt": "2002-08-01T00:00:00", "Loaded Inbound": 234592}, {"dt": "2002-07-01T00:00:00", "Loaded Inbound": 249618}, {"dt": "2002-06-01T00:00:00", "Loaded Inbound": 236112}, {"dt": "2002-05-01T00:00:00", "Loaded Inbound": 231382}, {"dt": "2002-04-01T00:00:00", "Loaded Inbound": 227953}, {"dt": "2002-03-01T00:00:00", "Loaded Inbound": 171874}, {"dt": "2002-02-01T00:00:00", "Loaded Inbound": 202276}, {"dt": "2002-01-01T00:00:00", "Loaded Inbound": 180528}, {"dt": "2001-12-01T00:00:00", "Loaded Inbound": 191584}, {"dt": "2001-11-01T00:00:00", "Loaded Inbound": 193861}, {"dt": "2001-10-01T00:00:00", "Loaded Inbound": 238185}, {"dt": "2001-09-01T00:00:00", "Loaded Inbound": 220204}, {"dt": "2001-08-01T00:00:00", "Loaded Inbound": 221492}, {"dt": "2001-07-01T00:00:00", "Loaded Inbound": 208179}, {"dt": "2001-06-01T00:00:00", "Loaded Inbound": 202988}, {"dt": "2001-05-01T00:00:00", "Loaded Inbound": 196120}, {"dt": "2001-04-01T00:00:00", "Loaded Inbound": 202575}, {"dt": "2001-03-01T00:00:00", "Loaded Inbound": 195605}, {"dt": "2001-02-01T00:00:00", "Loaded Inbound": 155148}, {"dt": "2001-01-01T00:00:00", "Loaded Inbound": 194738}, {"dt": "2000-12-01T00:00:00", "Loaded Inbound": 180631}, {"dt": "2000-11-01T00:00:00", "Loaded Inbound": 213065}, {"dt": "2000-10-01T00:00:00", "Loaded Inbound": 235511}, {"dt": "2000-09-01T00:00:00", "Loaded Inbound": 208880}, {"dt": "2000-08-01T00:00:00", "Loaded Inbound": 236969}, {"dt": "2000-07-01T00:00:00", "Loaded Inbound": 224865}, {"dt": "2000-06-01T00:00:00", "Loaded Inbound": 203004}, {"dt": "2000-05-01T00:00:00", "Loaded Inbound": 218016}, {"dt": "2000-04-01T00:00:00", "Loaded Inbound": 200724}, {"dt": "2000-03-01T00:00:00", "Loaded Inbound": 178489}, {"dt": "2000-02-01T00:00:00", "Loaded Inbound": 177362}, {"dt": "2000-01-01T00:00:00", "Loaded Inbound": 178672}, {"dt": "1999-12-01T00:00:00", "Loaded Inbound": 185572}, {"dt": "1999-11-01T00:00:00", "Loaded Inbound": 209444}, {"dt": "1999-10-01T00:00:00", "Loaded Inbound": 204242}, {"dt": "1999-09-01T00:00:00", "Loaded Inbound": 219080}, {"dt": "1999-08-01T00:00:00", "Loaded Inbound": 214709}, {"dt": "1999-07-01T00:00:00", "Loaded Inbound": 188586}, {"dt": "1999-06-01T00:00:00", "Loaded Inbound": 194410}, {"dt": "1999-05-01T00:00:00", "Loaded Inbound": 205640}, {"dt": "1999-04-01T00:00:00", "Loaded Inbound": 181575}, {"dt": "1999-03-01T00:00:00", "Loaded Inbound": 171913}, {"dt": "1999-02-01T00:00:00", "Loaded Inbound": 172482}, {"dt": "1999-01-01T00:00:00", "Loaded Inbound": 169397}, {"dt": "1998-12-01T00:00:00", "Loaded Inbound": 166532}, {"dt": "1998-11-01T00:00:00", "Loaded Inbound": 192661}, {"dt": "1998-10-01T00:00:00", "Loaded Inbound": 180719}, {"dt": "1998-09-01T00:00:00", "Loaded Inbound": 198945}, {"dt": "1998-08-01T00:00:00", "Loaded Inbound": 195413}, {"dt": "1998-07-01T00:00:00", "Loaded Inbound": 199138}, {"dt": "1998-06-01T00:00:00", "Loaded Inbound": 183019}, {"dt": "1998-05-01T00:00:00", "Loaded Inbound": 163640}, {"dt": "1998-04-01T00:00:00", "Loaded Inbound": 172247}, {"dt": "1998-03-01T00:00:00", "Loaded Inbound": 167712}, {"dt": "1998-02-01T00:00:00", "Loaded Inbound": 132117}, {"dt": "1998-01-01T00:00:00", "Loaded Inbound": 144758}, {"dt": "1997-12-01T00:00:00", "Loaded Inbound": 145840}, {"dt": "1997-11-01T00:00:00", "Loaded Inbound": 146354}, {"dt": "1997-10-01T00:00:00", "Loaded Inbound": 169995}, {"dt": "1997-09-01T00:00:00", "Loaded Inbound": 183914}, {"dt": "1997-08-01T00:00:00", "Loaded Inbound": 160215}, {"dt": "1997-07-01T00:00:00", "Loaded Inbound": 169964}, {"dt": "1997-06-01T00:00:00", "Loaded Inbound": 165763}, {"dt": "1997-05-01T00:00:00", "Loaded Inbound": 143330}, {"dt": "1997-04-01T00:00:00", "Loaded Inbound": 146110}, {"dt": "1997-03-01T00:00:00", "Loaded Inbound": 125040}, {"dt": "1997-02-01T00:00:00", "Loaded Inbound": 126804}, {"dt": "1997-01-01T00:00:00", "Loaded Inbound": 123456}, {"dt": "1996-12-01T00:00:00", "Loaded Inbound": 133087}, {"dt": "1996-11-01T00:00:00", "Loaded Inbound": 125971}, {"dt": "1996-10-01T00:00:00", "Loaded Inbound": 150796}, {"dt": "1996-09-01T00:00:00", "Loaded Inbound": 147405}, {"dt": "1996-08-01T00:00:00", "Loaded Inbound": 139554}, {"dt": "1996-07-01T00:00:00", "Loaded Inbound": 146839}, {"dt": "1996-06-01T00:00:00", "Loaded Inbound": 132419}, {"dt": "1996-05-01T00:00:00", "Loaded Inbound": 120002}, {"dt": "1996-04-01T00:00:00", "Loaded Inbound": 127583}, {"dt": "1996-03-01T00:00:00", "Loaded Inbound": 101338}, {"dt": "1996-02-01T00:00:00", "Loaded Inbound": 113349}, {"dt": "1996-01-01T00:00:00", "Loaded Inbound": 109235}, {"dt": "1995-12-01T00:00:00", "Loaded Inbound": 104146}, {"dt": "1995-11-01T00:00:00", "Loaded Inbound": 109200}, {"dt": "1995-10-01T00:00:00", "Loaded Inbound": 134836}, {"dt": "1995-09-01T00:00:00", "Loaded Inbound": 114541}, {"dt": "1995-08-01T00:00:00", "Loaded Inbound": 127944}, {"dt": "1995-07-01T00:00:00", "Loaded Inbound": 127008}, {"dt": "1995-06-01T00:00:00", "Loaded Inbound": 113419}, {"dt": "1995-05-01T00:00:00", "Loaded Inbound": 113688}, {"dt": "1995-04-01T00:00:00", "Loaded Inbound": 110518}, {"dt": "1995-03-01T00:00:00", "Loaded Inbound": 94125}, {"dt": "1995-02-01T00:00:00", "Loaded Inbound": 99121}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Port-of-New-York-/-New-Jersey">Port of New York / New Jersey<a class="anchor-link" href="#Port-of-New-York-/-New-Jersey">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataUrl</span> <span class="o">=</span> <span class="s2">&quot;https://www.panynj.gov/content/port/en.model.json&quot;</span>

<span class="c1">#jqPath = &#39;\&#39;.&quot;:children&quot;.&quot;/port/en/our-port/facts-and-figures&quot;.&quot;:items&quot;.&quot;root&quot;.&quot;:items&quot;.&quot;responsivegrid&quot;.&quot;:items&quot;.&quot;accordionlist_435572874&quot;.&quot;:items&quot;\&#39;&#39;</span>
    
<span class="k">def</span> <span class="nf">doNynjFetch</span><span class="p">(</span><span class="n">retries</span> <span class="o">=</span> <span class="mi">5</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">retries</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">loads</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">dataUrl</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span> <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="n">uaString</span> <span class="p">})</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>

        <span class="n">dict_data</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

        <span class="n">r</span> <span class="o">=</span> <span class="n">dict_data</span><span class="p">[</span><span class="s2">&quot;:children&quot;</span><span class="p">]</span>\
                     <span class="p">[</span><span class="s2">&quot;/port/en/our-port/facts-and-figures&quot;</span><span class="p">]</span>\
                     <span class="p">[</span><span class="s2">&quot;:items&quot;</span><span class="p">]</span>\
                     <span class="p">[</span><span class="s2">&quot;root&quot;</span><span class="p">]</span>\
                     <span class="p">[</span><span class="s2">&quot;:items&quot;</span><span class="p">]</span>\
                     <span class="p">[</span><span class="s2">&quot;responsivegrid&quot;</span><span class="p">]</span>\
                     <span class="p">[</span><span class="s2">&quot;:items&quot;</span><span class="p">]</span>\
                     <span class="p">[</span><span class="s2">&quot;accordionlist_435572874&quot;</span><span class="p">]</span>\
                     <span class="p">[</span><span class="s2">&quot;:items&quot;</span><span class="p">]</span>
        
        <span class="k">return</span> <span class="n">r</span>
    <span class="k">except</span> <span class="n">JSONDecodeError</span><span class="p">:</span>
        <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">doNynjFetch</span><span class="p">(</span><span class="n">retries</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">nynj_dict_content</span> <span class="o">=</span> <span class="n">doNynjFetch</span><span class="p">()</span>
    
<span class="n">post2011Cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Import Loads&#39;</span><span class="p">,</span> <span class="s1">&#39;Import Empties&#39;</span><span class="p">,</span> <span class="s1">&#39;Export Loads&#39;</span><span class="p">,</span> <span class="s1">&#39;Export Empties&#39;</span><span class="p">,</span> <span class="s1">&#39;Total Loads&#39;</span><span class="p">,</span> <span class="s1">&#39;Total Empties&#39;</span><span class="p">,</span> <span class="s1">&#39;Total TEUs&#39;</span><span class="p">,</span> <span class="s1">&#39;Total Rail Lifts&#39;</span><span class="p">]</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Import TEUs&quot;</span><span class="p">,</span> <span class="s2">&quot;Export TEUs&quot;</span><span class="p">,</span> <span class="s2">&quot;Total TEUs&quot;</span><span class="p">,</span> <span class="s2">&quot;Total Rail Lifts&quot;</span><span class="p">]</span>

<span class="n">currentYear</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">year</span>

<span class="n">dfs_nynj</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">nynj_dict_content</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
    <span class="n">year</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;linkAriaLabel&quot;</span><span class="p">]</span>
    <span class="c1">#print(year)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s2">&quot;:items&quot;</span><span class="p">][</span><span class="s2">&quot;text&quot;</span><span class="p">][</span><span class="s2">&quot;text&quot;</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="c1"># text_copy</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s2">&quot;:items&quot;</span><span class="p">][</span><span class="s2">&quot;text_copy&quot;</span><span class="p">][</span><span class="s2">&quot;text&quot;</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">monthData</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tmp</span><span class="p">):</span>
        <span class="c1"># skip the YTD section</span>
        <span class="c1">#if n &lt; 2:</span>
        <span class="c1">#    continue</span>
        
        <span class="n">mtmp</span> <span class="o">=</span> <span class="n">monthData</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">mtmp</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Period&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">post2011Cols</span>
            
            <span class="c1"># cleanup types before doing math</span>
            <span class="n">mtmp</span><span class="p">[</span><span class="n">post2011Cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">mtmp</span><span class="p">[</span><span class="n">post2011Cols</span><span class="p">]</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;[^0-9.]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)))</span>
            <span class="n">mtmp</span><span class="p">[</span><span class="n">post2011Cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">mtmp</span><span class="p">[</span><span class="n">post2011Cols</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">))</span>
            
            <span class="n">mtmp</span><span class="p">[</span><span class="s1">&#39;Import TEUs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mtmp</span><span class="p">[</span><span class="s1">&#39;Import Loads&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">mtmp</span><span class="p">[</span><span class="s1">&#39;Import Empties&#39;</span><span class="p">]</span>
            <span class="n">mtmp</span><span class="p">[</span><span class="s1">&#39;Export TEUs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mtmp</span><span class="p">[</span><span class="s1">&#39;Export Loads&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">mtmp</span><span class="p">[</span><span class="s1">&#39;Export Empties&#39;</span><span class="p">]</span>
            
            <span class="c1"># Monthy is shown Dec-&gt;Jan after 2014, Jan-&gt;Dec before 2014 (and for 2020)</span>
            <span class="n">index</span> <span class="o">=</span> <span class="mi">13</span><span class="o">-</span><span class="n">n</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2014</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">!=</span> <span class="n">currentYear</span> <span class="k">else</span> <span class="n">n</span>
            <span class="n">mtmp</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mtmp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">v</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%m-%Y&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">mtmp</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Period&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">cols</span>
            <span class="n">mtmp</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mtmp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%B %y&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">))</span>
        
            <span class="n">mtmp</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">mtmp</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;[^0-9.]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)))</span>
            <span class="n">mtmp</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">mtmp</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">))</span>
        
        <span class="n">dfs_nynj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mtmp</span><span class="p">)</span>

<span class="n">commonFields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Period&#39;</span><span class="p">,</span> <span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="s1">&#39;Import TEUs&#39;</span><span class="p">,</span> <span class="s1">&#39;Export TEUs&#39;</span><span class="p">,</span> <span class="s1">&#39;Total TEUs&#39;</span><span class="p">]</span>

<span class="n">df_nynj</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dfs_nynj</span><span class="p">)[</span><span class="n">commonFields</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span> <span class="c1">#.tail(30)</span>

<span class="n">df_nynj</span> <span class="o">=</span> <span class="n">df_nynj</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;dt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span> <span class="c1">#.head()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_nynj</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(),</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;New York/New Jersey&quot;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;Import TEUs&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[15]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-10ee69f0ba2e44fea42bce1a239abf4c"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-10ee69f0ba2e44fea42bce1a239abf4c") {
      outputDiv = document.getElementById("altair-viz-10ee69f0ba2e44fea42bce1a239abf4c");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector009"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of New York/New Jersey Import TEUs Container Volume", "transform": [{"window": [{"op": "lag", "field": "Import TEUs", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Import TEUs'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt"}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Import TEUs"}}, "height": 100, "selection": {"selector009": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-f3490c1c5963c39c3b45ba5cb14c42c4"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-f3490c1c5963c39c3b45ba5cb14c42c4": [{"dt": "2005-01-01T00:00:00", "Import TEUs": 191242.0}, {"dt": "2005-02-01T00:00:00", "Import TEUs": 179210.0}, {"dt": "2005-03-01T00:00:00", "Import TEUs": 194984.0}, {"dt": "2005-04-01T00:00:00", "Import TEUs": 184573.0}, {"dt": "2005-05-01T00:00:00", "Import TEUs": 211414.0}, {"dt": "2005-06-01T00:00:00", "Import TEUs": 202916.0}, {"dt": "2005-07-01T00:00:00", "Import TEUs": 211764.0}, {"dt": "2005-08-01T00:00:00", "Import TEUs": 199437.0}, {"dt": "2005-09-01T00:00:00", "Import TEUs": 205132.0}, {"dt": "2005-10-01T00:00:00", "Import TEUs": 216593.0}, {"dt": "2005-11-01T00:00:00", "Import TEUs": 213802.0}, {"dt": "2005-12-01T00:00:00", "Import TEUs": 197055.0}, {"dt": "2006-01-01T00:00:00", "Import TEUs": 196328.5}, {"dt": "2006-02-01T00:00:00", "Import TEUs": 177956.5}, {"dt": "2006-03-01T00:00:00", "Import TEUs": 203648.5}, {"dt": "2006-04-01T00:00:00", "Import TEUs": 219230.5}, {"dt": "2006-05-01T00:00:00", "Import TEUs": 215877.0}, {"dt": "2006-06-01T00:00:00", "Import TEUs": 226168.5}, {"dt": "2006-07-01T00:00:00", "Import TEUs": 222998.0}, {"dt": "2006-08-01T00:00:00", "Import TEUs": 226110.0}, {"dt": "2006-09-01T00:00:00", "Import TEUs": 217306.0}, {"dt": "2006-10-01T00:00:00", "Import TEUs": 228202.0}, {"dt": "2006-11-01T00:00:00", "Import TEUs": 212153.0}, {"dt": "2006-12-01T00:00:00", "Import TEUs": 208295.0}, {"dt": "2007-01-01T00:00:00", "Import TEUs": 190233.0}, {"dt": "2007-02-01T00:00:00", "Import TEUs": 192377.0}, {"dt": "2007-03-01T00:00:00", "Import TEUs": 233233.0}, {"dt": "2007-04-01T00:00:00", "Import TEUs": 190907.0}, {"dt": "2007-05-01T00:00:00", "Import TEUs": 218807.0}, {"dt": "2007-06-01T00:00:00", "Import TEUs": 235998.0}, {"dt": "2007-07-01T00:00:00", "Import TEUs": 230276.0}, {"dt": "2007-08-01T00:00:00", "Import TEUs": 245535.0}, {"dt": "2007-09-01T00:00:00", "Import TEUs": 235112.0}, {"dt": "2007-10-01T00:00:00", "Import TEUs": 224795.0}, {"dt": "2007-11-01T00:00:00", "Import TEUs": 213170.0}, {"dt": "2007-12-01T00:00:00", "Import TEUs": 209149.0}, {"dt": "2008-01-01T00:00:00", "Import TEUs": 199718.0}, {"dt": "2008-02-01T00:00:00", "Import TEUs": 194440.0}, {"dt": "2008-03-01T00:00:00", "Import TEUs": 203279.0}, {"dt": "2008-04-01T00:00:00", "Import TEUs": 202462.0}, {"dt": "2008-05-01T00:00:00", "Import TEUs": 210660.0}, {"dt": "2008-06-01T00:00:00", "Import TEUs": 221509.0}, {"dt": "2008-07-01T00:00:00", "Import TEUs": 229149.0}, {"dt": "2008-08-01T00:00:00", "Import TEUs": 227739.0}, {"dt": "2008-09-01T00:00:00", "Import TEUs": 238844.0}, {"dt": "2008-10-01T00:00:00", "Import TEUs": 230338.0}, {"dt": "2008-11-01T00:00:00", "Import TEUs": 204080.0}, {"dt": "2008-12-01T00:00:00", "Import TEUs": 186756.0}, {"dt": "2009-01-01T00:00:00", "Import TEUs": 176449.0}, {"dt": "2009-02-01T00:00:00", "Import TEUs": 169909.0}, {"dt": "2009-03-01T00:00:00", "Import TEUs": 167592.0}, {"dt": "2009-04-01T00:00:00", "Import TEUs": 170899.0}, {"dt": "2009-05-01T00:00:00", "Import TEUs": 182403.0}, {"dt": "2009-06-01T00:00:00", "Import TEUs": 186985.0}, {"dt": "2009-07-01T00:00:00", "Import TEUs": 207066.0}, {"dt": "2009-08-01T00:00:00", "Import TEUs": 209693.0}, {"dt": "2009-09-01T00:00:00", "Import TEUs": 203622.0}, {"dt": "2009-10-01T00:00:00", "Import TEUs": 206034.0}, {"dt": "2009-11-01T00:00:00", "Import TEUs": 191549.0}, {"dt": "2009-12-01T00:00:00", "Import TEUs": 172834.0}, {"dt": "2010-01-01T00:00:00", "Import TEUs": 185797.0}, {"dt": "2010-02-01T00:00:00", "Import TEUs": 173911.0}, {"dt": "2010-03-01T00:00:00", "Import TEUs": 204311.0}, {"dt": "2010-04-01T00:00:00", "Import TEUs": 197723.0}, {"dt": "2010-05-01T00:00:00", "Import TEUs": 222840.0}, {"dt": "2010-06-01T00:00:00", "Import TEUs": 222671.0}, {"dt": "2010-07-01T00:00:00", "Import TEUs": 251199.0}, {"dt": "2010-08-01T00:00:00", "Import TEUs": 244559.0}, {"dt": "2010-09-01T00:00:00", "Import TEUs": 225947.0}, {"dt": "2010-10-01T00:00:00", "Import TEUs": 232438.0}, {"dt": "2010-11-01T00:00:00", "Import TEUs": 214830.0}, {"dt": "2010-12-01T00:00:00", "Import TEUs": 202868.0}, {"dt": "2011-01-01T00:00:00", "Import TEUs": 219680.5}, {"dt": "2011-02-01T00:00:00", "Import TEUs": 209735.5}, {"dt": "2011-03-01T00:00:00", "Import TEUs": 211585.5}, {"dt": "2011-04-01T00:00:00", "Import TEUs": 220590.5}, {"dt": "2011-05-01T00:00:00", "Import TEUs": 234126.0}, {"dt": "2011-06-01T00:00:00", "Import TEUs": 225197.5}, {"dt": "2011-07-01T00:00:00", "Import TEUs": 239558.5}, {"dt": "2011-08-01T00:00:00", "Import TEUs": 246511.5}, {"dt": "2011-09-01T00:00:00", "Import TEUs": 245655.0}, {"dt": "2011-10-01T00:00:00", "Import TEUs": 226693.0}, {"dt": "2011-11-01T00:00:00", "Import TEUs": 230595.0}, {"dt": "2011-12-01T00:00:00", "Import TEUs": 214969.0}, {"dt": "2012-01-01T00:00:00", "Import TEUs": 233956.0}, {"dt": "2012-02-01T00:00:00", "Import TEUs": 228386.0}, {"dt": "2012-03-01T00:00:00", "Import TEUs": 217105.0}, {"dt": "2012-04-01T00:00:00", "Import TEUs": 230148.0}, {"dt": "2012-05-01T00:00:00", "Import TEUs": 246310.0}, {"dt": "2012-06-01T00:00:00", "Import TEUs": 244428.0}, {"dt": "2012-07-01T00:00:00", "Import TEUs": 261284.0}, {"dt": "2012-08-01T00:00:00", "Import TEUs": 261909.0}, {"dt": "2012-09-01T00:00:00", "Import TEUs": 242199.0}, {"dt": "2012-10-01T00:00:00", "Import TEUs": 202616.0}, {"dt": "2012-11-01T00:00:00", "Import TEUs": 229363.0}, {"dt": "2012-12-01T00:00:00", "Import TEUs": 220102.0}, {"dt": "2013-01-01T00:00:00", "Import TEUs": 220326.0}, {"dt": "2013-02-01T00:00:00", "Import TEUs": 206492.0}, {"dt": "2013-03-01T00:00:00", "Import TEUs": 218430.0}, {"dt": "2013-04-01T00:00:00", "Import TEUs": 219295.0}, {"dt": "2013-05-01T00:00:00", "Import TEUs": 247274.0}, {"dt": "2013-06-01T00:00:00", "Import TEUs": 231570.0}, {"dt": "2013-07-01T00:00:00", "Import TEUs": 253551.0}, {"dt": "2013-08-01T00:00:00", "Import TEUs": 266498.0}, {"dt": "2013-09-01T00:00:00", "Import TEUs": 237845.0}, {"dt": "2013-10-01T00:00:00", "Import TEUs": 258701.0}, {"dt": "2013-11-01T00:00:00", "Import TEUs": 213476.0}, {"dt": "2013-12-01T00:00:00", "Import TEUs": 230543.0}, {"dt": "2014-01-01T00:00:00", "Import TEUs": 234133.0}, {"dt": "2014-02-01T00:00:00", "Import TEUs": 208529.0}, {"dt": "2014-03-01T00:00:00", "Import TEUs": 235462.0}, {"dt": "2014-04-01T00:00:00", "Import TEUs": 231188.0}, {"dt": "2014-05-01T00:00:00", "Import TEUs": 250741.0}, {"dt": "2014-06-01T00:00:00", "Import TEUs": 243714.0}, {"dt": "2014-07-01T00:00:00", "Import TEUs": 269961.0}, {"dt": "2014-08-01T00:00:00", "Import TEUs": 271429.0}, {"dt": "2014-09-01T00:00:00", "Import TEUs": 253846.0}, {"dt": "2014-10-01T00:00:00", "Import TEUs": 275238.0}, {"dt": "2014-11-01T00:00:00", "Import TEUs": 242430.0}, {"dt": "2014-12-01T00:00:00", "Import TEUs": 252965.0}, {"dt": "2015-01-01T00:00:00", "Import TEUs": 237739.0}, {"dt": "2015-02-01T00:00:00", "Import TEUs": 241394.0}, {"dt": "2015-03-01T00:00:00", "Import TEUs": 288749.0}, {"dt": "2015-04-01T00:00:00", "Import TEUs": 252633.0}, {"dt": "2015-05-01T00:00:00", "Import TEUs": 284632.0}, {"dt": "2015-06-01T00:00:00", "Import TEUs": 281099.0}, {"dt": "2015-07-01T00:00:00", "Import TEUs": 298333.0}, {"dt": "2015-08-01T00:00:00", "Import TEUs": 287790.0}, {"dt": "2015-09-01T00:00:00", "Import TEUs": 288104.0}, {"dt": "2015-10-01T00:00:00", "Import TEUs": 271248.0}, {"dt": "2015-11-01T00:00:00", "Import TEUs": 250702.0}, {"dt": "2015-12-01T00:00:00", "Import TEUs": 255181.0}, {"dt": "2016-01-01T00:00:00", "Import TEUs": 249510.0}, {"dt": "2016-02-01T00:00:00", "Import TEUs": 261146.0}, {"dt": "2016-03-01T00:00:00", "Import TEUs": 255114.0}, {"dt": "2016-04-01T00:00:00", "Import TEUs": 247136.0}, {"dt": "2016-05-01T00:00:00", "Import TEUs": 270986.0}, {"dt": "2016-06-01T00:00:00", "Import TEUs": 273154.0}, {"dt": "2016-07-01T00:00:00", "Import TEUs": 276778.0}, {"dt": "2016-08-01T00:00:00", "Import TEUs": 306200.0}, {"dt": "2016-09-01T00:00:00", "Import TEUs": 256330.0}, {"dt": "2016-10-01T00:00:00", "Import TEUs": 291038.0}, {"dt": "2016-11-01T00:00:00", "Import TEUs": 274088.0}, {"dt": "2016-12-01T00:00:00", "Import TEUs": 267405.0}, {"dt": "2017-01-01T00:00:00", "Import TEUs": 262484.0}, {"dt": "2017-02-01T00:00:00", "Import TEUs": 264134.0}, {"dt": "2017-03-01T00:00:00", "Import TEUs": 251335.0}, {"dt": "2017-04-01T00:00:00", "Import TEUs": 281356.0}, {"dt": "2017-05-01T00:00:00", "Import TEUs": 285674.0}, {"dt": "2017-06-01T00:00:00", "Import TEUs": 296902.0}, {"dt": "2017-07-01T00:00:00", "Import TEUs": 293233.0}, {"dt": "2017-08-01T00:00:00", "Import TEUs": 322437.0}, {"dt": "2017-09-01T00:00:00", "Import TEUs": 289305.0}, {"dt": "2017-10-01T00:00:00", "Import TEUs": 307357.0}, {"dt": "2017-11-01T00:00:00", "Import TEUs": 287223.0}, {"dt": "2017-12-01T00:00:00", "Import TEUs": 275520.0}, {"dt": "2018-01-01T00:00:00", "Import TEUs": 310901.0}, {"dt": "2018-02-01T00:00:00", "Import TEUs": 275459.0}, {"dt": "2018-03-01T00:00:00", "Import TEUs": 290033.0}, {"dt": "2018-04-01T00:00:00", "Import TEUs": 273610.0}, {"dt": "2018-05-01T00:00:00", "Import TEUs": 303541.0}, {"dt": "2018-06-01T00:00:00", "Import TEUs": 312052.0}, {"dt": "2018-07-01T00:00:00", "Import TEUs": 323551.0}, {"dt": "2018-08-01T00:00:00", "Import TEUs": 335116.0}, {"dt": "2018-09-01T00:00:00", "Import TEUs": 305443.0}, {"dt": "2018-10-01T00:00:00", "Import TEUs": 340899.0}, {"dt": "2018-11-01T00:00:00", "Import TEUs": 303881.0}, {"dt": "2018-12-01T00:00:00", "Import TEUs": 318426.0}, {"dt": "2019-01-01T00:00:00", "Import TEUs": 328361.0}, {"dt": "2019-02-01T00:00:00", "Import TEUs": 296500.0}, {"dt": "2019-03-01T00:00:00", "Import TEUs": 284283.0}, {"dt": "2019-04-01T00:00:00", "Import TEUs": 299375.0}, {"dt": "2019-05-01T00:00:00", "Import TEUs": 341943.0}, {"dt": "2019-06-01T00:00:00", "Import TEUs": 303309.0}, {"dt": "2019-07-01T00:00:00", "Import TEUs": 338728.0}, {"dt": "2019-08-01T00:00:00", "Import TEUs": 344473.0}, {"dt": "2019-09-01T00:00:00", "Import TEUs": 317587.0}, {"dt": "2019-10-01T00:00:00", "Import TEUs": 340952.0}, {"dt": "2019-11-01T00:00:00", "Import TEUs": 302460.0}, {"dt": "2019-12-01T00:00:00", "Import TEUs": 290508.0}, {"dt": "2020-01-01T00:00:00", "Import TEUs": 350700.0}, {"dt": "2020-02-01T00:00:00", "Import TEUs": 335313.5}, {"dt": "2020-03-01T00:00:00", "Import TEUs": 301106.0}, {"dt": "2020-04-01T00:00:00", "Import TEUs": 276099.5}, {"dt": "2020-05-01T00:00:00", "Import TEUs": 267008.0}, {"dt": "2020-06-01T00:00:00", "Import TEUs": 276099.5}, {"dt": "2020-07-01T00:00:00", "Import TEUs": 301106.0}, {"dt": "2020-08-01T00:00:00", "Import TEUs": 335313.5}, {"dt": "2020-09-01T00:00:00", "Import TEUs": 350700.0}, {"dt": "2020-10-01T00:00:00", "Import TEUs": 405415.0}, {"dt": "2020-11-01T00:00:00", "Import TEUs": 386219.0}, {"dt": "2020-12-01T00:00:00", "Import TEUs": 361246.0}, {"dt": "2021-01-01T00:00:00", "Import TEUs": 381158.0}, {"dt": "2021-02-01T00:00:00", "Import TEUs": 401404.0}, {"dt": "2021-03-01T00:00:00", "Import TEUs": 396699.0}, {"dt": "2021-04-01T00:00:00", "Import TEUs": 388449.0}, {"dt": "2021-05-01T00:00:00", "Import TEUs": 398708.0}, {"dt": "2021-06-01T00:00:00", "Import TEUs": 361833.0}, {"dt": "2021-07-01T00:00:00", "Import TEUs": 395535.0}, {"dt": "2021-08-01T00:00:00", "Import TEUs": 336466.0}, {"dt": "2021-09-01T00:00:00", "Import TEUs": 373037.0}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_nynj</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(),</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;New York/New Jersey&quot;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;Export TEUs&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[16]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-6e2bac434ae943e38ccb7dcd6059d4b6"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-6e2bac434ae943e38ccb7dcd6059d4b6") {
      outputDiv = document.getElementById("altair-viz-6e2bac434ae943e38ccb7dcd6059d4b6");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector010"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of New York/New Jersey Export TEUs Container Volume", "transform": [{"window": [{"op": "lag", "field": "Export TEUs", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Export TEUs'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt"}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Export TEUs"}}, "height": 100, "selection": {"selector010": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-01ab7802e6ca99b32e916844e91f29c3"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-01ab7802e6ca99b32e916844e91f29c3": [{"dt": "2005-01-01T00:00:00", "Export TEUs": 77692.0}, {"dt": "2005-02-01T00:00:00", "Export TEUs": 74099.0}, {"dt": "2005-03-01T00:00:00", "Export TEUs": 84574.0}, {"dt": "2005-04-01T00:00:00", "Export TEUs": 86723.0}, {"dt": "2005-05-01T00:00:00", "Export TEUs": 86475.0}, {"dt": "2005-06-01T00:00:00", "Export TEUs": 80582.0}, {"dt": "2005-07-01T00:00:00", "Export TEUs": 81790.0}, {"dt": "2005-08-01T00:00:00", "Export TEUs": 78994.0}, {"dt": "2005-09-01T00:00:00", "Export TEUs": 77699.0}, {"dt": "2005-10-01T00:00:00", "Export TEUs": 83920.0}, {"dt": "2005-11-01T00:00:00", "Export TEUs": 86622.0}, {"dt": "2005-12-01T00:00:00", "Export TEUs": 78713.0}, {"dt": "2006-01-01T00:00:00", "Export TEUs": 86985.5}, {"dt": "2006-02-01T00:00:00", "Export TEUs": 83982.0}, {"dt": "2006-03-01T00:00:00", "Export TEUs": 102531.0}, {"dt": "2006-04-01T00:00:00", "Export TEUs": 93565.5}, {"dt": "2006-05-01T00:00:00", "Export TEUs": 98012.5}, {"dt": "2006-06-01T00:00:00", "Export TEUs": 101994.5}, {"dt": "2006-07-01T00:00:00", "Export TEUs": 92502.0}, {"dt": "2006-08-01T00:00:00", "Export TEUs": 99962.5}, {"dt": "2006-09-01T00:00:00", "Export TEUs": 99752.5}, {"dt": "2006-10-01T00:00:00", "Export TEUs": 104896.0}, {"dt": "2006-11-01T00:00:00", "Export TEUs": 105095.0}, {"dt": "2006-12-01T00:00:00", "Export TEUs": 106049.0}, {"dt": "2007-01-01T00:00:00", "Export TEUs": 105311.0}, {"dt": "2007-02-01T00:00:00", "Export TEUs": 99725.0}, {"dt": "2007-03-01T00:00:00", "Export TEUs": 129066.0}, {"dt": "2007-04-01T00:00:00", "Export TEUs": 112554.0}, {"dt": "2007-05-01T00:00:00", "Export TEUs": 127051.0}, {"dt": "2007-06-01T00:00:00", "Export TEUs": 130257.0}, {"dt": "2007-07-01T00:00:00", "Export TEUs": 115576.0}, {"dt": "2007-08-01T00:00:00", "Export TEUs": 128799.0}, {"dt": "2007-09-01T00:00:00", "Export TEUs": 129445.0}, {"dt": "2007-10-01T00:00:00", "Export TEUs": 132851.0}, {"dt": "2007-11-01T00:00:00", "Export TEUs": 131951.0}, {"dt": "2007-12-01T00:00:00", "Export TEUs": 135317.0}, {"dt": "2008-01-01T00:00:00", "Export TEUs": 123021.0}, {"dt": "2008-02-01T00:00:00", "Export TEUs": 130287.0}, {"dt": "2008-03-01T00:00:00", "Export TEUs": 145569.0}, {"dt": "2008-04-01T00:00:00", "Export TEUs": 140235.0}, {"dt": "2008-05-01T00:00:00", "Export TEUs": 145170.0}, {"dt": "2008-06-01T00:00:00", "Export TEUs": 152286.0}, {"dt": "2008-07-01T00:00:00", "Export TEUs": 143869.0}, {"dt": "2008-08-01T00:00:00", "Export TEUs": 140949.0}, {"dt": "2008-09-01T00:00:00", "Export TEUs": 144034.0}, {"dt": "2008-10-01T00:00:00", "Export TEUs": 131009.0}, {"dt": "2008-11-01T00:00:00", "Export TEUs": 118296.0}, {"dt": "2008-12-01T00:00:00", "Export TEUs": 101515.0}, {"dt": "2009-01-01T00:00:00", "Export TEUs": 96314.0}, {"dt": "2009-02-01T00:00:00", "Export TEUs": 113233.0}, {"dt": "2009-03-01T00:00:00", "Export TEUs": 113236.0}, {"dt": "2009-04-01T00:00:00", "Export TEUs": 110700.0}, {"dt": "2009-05-01T00:00:00", "Export TEUs": 122652.0}, {"dt": "2009-06-01T00:00:00", "Export TEUs": 117427.0}, {"dt": "2009-07-01T00:00:00", "Export TEUs": 114782.0}, {"dt": "2009-08-01T00:00:00", "Export TEUs": 121629.0}, {"dt": "2009-09-01T00:00:00", "Export TEUs": 117160.0}, {"dt": "2009-10-01T00:00:00", "Export TEUs": 127107.0}, {"dt": "2009-11-01T00:00:00", "Export TEUs": 124007.0}, {"dt": "2009-12-01T00:00:00", "Export TEUs": 114825.0}, {"dt": "2010-01-01T00:00:00", "Export TEUs": 116759.0}, {"dt": "2010-02-01T00:00:00", "Export TEUs": 108455.0}, {"dt": "2010-03-01T00:00:00", "Export TEUs": 127992.0}, {"dt": "2010-04-01T00:00:00", "Export TEUs": 132954.0}, {"dt": "2010-05-01T00:00:00", "Export TEUs": 134803.0}, {"dt": "2010-06-01T00:00:00", "Export TEUs": 126520.0}, {"dt": "2010-07-01T00:00:00", "Export TEUs": 128654.0}, {"dt": "2010-08-01T00:00:00", "Export TEUs": 128426.0}, {"dt": "2010-09-01T00:00:00", "Export TEUs": 117289.0}, {"dt": "2010-10-01T00:00:00", "Export TEUs": 139182.0}, {"dt": "2010-11-01T00:00:00", "Export TEUs": 134055.0}, {"dt": "2010-12-01T00:00:00", "Export TEUs": 123239.0}, {"dt": "2011-01-01T00:00:00", "Export TEUs": 171856.0}, {"dt": "2011-02-01T00:00:00", "Export TEUs": 161319.5}, {"dt": "2011-03-01T00:00:00", "Export TEUs": 194786.0}, {"dt": "2011-04-01T00:00:00", "Export TEUs": 178882.5}, {"dt": "2011-05-01T00:00:00", "Export TEUs": 192025.0}, {"dt": "2011-06-01T00:00:00", "Export TEUs": 177798.5}, {"dt": "2011-07-01T00:00:00", "Export TEUs": 184784.0}, {"dt": "2011-08-01T00:00:00", "Export TEUs": 178332.0}, {"dt": "2011-09-01T00:00:00", "Export TEUs": 194658.0}, {"dt": "2011-10-01T00:00:00", "Export TEUs": 189801.5}, {"dt": "2011-11-01T00:00:00", "Export TEUs": 176566.0}, {"dt": "2011-12-01T00:00:00", "Export TEUs": 178516.0}, {"dt": "2012-01-01T00:00:00", "Export TEUs": 214725.0}, {"dt": "2012-02-01T00:00:00", "Export TEUs": 201518.0}, {"dt": "2012-03-01T00:00:00", "Export TEUs": 225242.0}, {"dt": "2012-04-01T00:00:00", "Export TEUs": 213628.0}, {"dt": "2012-05-01T00:00:00", "Export TEUs": 234567.0}, {"dt": "2012-06-01T00:00:00", "Export TEUs": 230778.0}, {"dt": "2012-07-01T00:00:00", "Export TEUs": 253494.0}, {"dt": "2012-08-01T00:00:00", "Export TEUs": 251180.0}, {"dt": "2012-09-01T00:00:00", "Export TEUs": 248690.0}, {"dt": "2012-10-01T00:00:00", "Export TEUs": 211464.0}, {"dt": "2012-11-01T00:00:00", "Export TEUs": 192910.0}, {"dt": "2012-12-01T00:00:00", "Export TEUs": 233912.0}, {"dt": "2013-01-01T00:00:00", "Export TEUs": 208041.0}, {"dt": "2013-02-01T00:00:00", "Export TEUs": 196783.0}, {"dt": "2013-03-01T00:00:00", "Export TEUs": 220356.0}, {"dt": "2013-04-01T00:00:00", "Export TEUs": 217284.0}, {"dt": "2013-05-01T00:00:00", "Export TEUs": 229110.0}, {"dt": "2013-06-01T00:00:00", "Export TEUs": 206200.0}, {"dt": "2013-07-01T00:00:00", "Export TEUs": 231291.0}, {"dt": "2013-08-01T00:00:00", "Export TEUs": 261030.0}, {"dt": "2013-09-01T00:00:00", "Export TEUs": 234736.0}, {"dt": "2013-10-01T00:00:00", "Export TEUs": 247156.0}, {"dt": "2013-11-01T00:00:00", "Export TEUs": 208652.0}, {"dt": "2013-12-01T00:00:00", "Export TEUs": 202707.0}, {"dt": "2014-01-01T00:00:00", "Export TEUs": 194785.0}, {"dt": "2014-02-01T00:00:00", "Export TEUs": 179380.0}, {"dt": "2014-03-01T00:00:00", "Export TEUs": 248877.0}, {"dt": "2014-04-01T00:00:00", "Export TEUs": 229669.0}, {"dt": "2014-05-01T00:00:00", "Export TEUs": 244293.0}, {"dt": "2014-06-01T00:00:00", "Export TEUs": 226783.0}, {"dt": "2014-07-01T00:00:00", "Export TEUs": 246283.0}, {"dt": "2014-08-01T00:00:00", "Export TEUs": 257152.0}, {"dt": "2014-09-01T00:00:00", "Export TEUs": 244687.0}, {"dt": "2014-10-01T00:00:00", "Export TEUs": 256064.0}, {"dt": "2014-11-01T00:00:00", "Export TEUs": 242369.0}, {"dt": "2014-12-01T00:00:00", "Export TEUs": 232325.0}, {"dt": "2015-01-01T00:00:00", "Export TEUs": 225263.0}, {"dt": "2015-02-01T00:00:00", "Export TEUs": 203891.0}, {"dt": "2015-03-01T00:00:00", "Export TEUs": 270515.0}, {"dt": "2015-04-01T00:00:00", "Export TEUs": 252041.0}, {"dt": "2015-05-01T00:00:00", "Export TEUs": 274359.0}, {"dt": "2015-06-01T00:00:00", "Export TEUs": 281474.0}, {"dt": "2015-07-01T00:00:00", "Export TEUs": 290585.0}, {"dt": "2015-08-01T00:00:00", "Export TEUs": 286757.0}, {"dt": "2015-09-01T00:00:00", "Export TEUs": 281852.0}, {"dt": "2015-10-01T00:00:00", "Export TEUs": 273429.0}, {"dt": "2015-11-01T00:00:00", "Export TEUs": 249906.0}, {"dt": "2015-12-01T00:00:00", "Export TEUs": 244044.0}, {"dt": "2016-01-01T00:00:00", "Export TEUs": 228395.0}, {"dt": "2016-02-01T00:00:00", "Export TEUs": 239513.0}, {"dt": "2016-03-01T00:00:00", "Export TEUs": 262675.0}, {"dt": "2016-04-01T00:00:00", "Export TEUs": 242175.0}, {"dt": "2016-05-01T00:00:00", "Export TEUs": 254062.0}, {"dt": "2016-06-01T00:00:00", "Export TEUs": 257421.0}, {"dt": "2016-07-01T00:00:00", "Export TEUs": 255659.0}, {"dt": "2016-08-01T00:00:00", "Export TEUs": 279127.0}, {"dt": "2016-09-01T00:00:00", "Export TEUs": 241374.0}, {"dt": "2016-10-01T00:00:00", "Export TEUs": 248054.0}, {"dt": "2016-11-01T00:00:00", "Export TEUs": 253886.0}, {"dt": "2016-12-01T00:00:00", "Export TEUs": 260727.0}, {"dt": "2017-01-01T00:00:00", "Export TEUs": 255184.0}, {"dt": "2017-02-01T00:00:00", "Export TEUs": 242932.0}, {"dt": "2017-03-01T00:00:00", "Export TEUs": 256935.0}, {"dt": "2017-04-01T00:00:00", "Export TEUs": 265657.0}, {"dt": "2017-05-01T00:00:00", "Export TEUs": 279378.0}, {"dt": "2017-06-01T00:00:00", "Export TEUs": 287704.0}, {"dt": "2017-07-01T00:00:00", "Export TEUs": 283714.0}, {"dt": "2017-08-01T00:00:00", "Export TEUs": 308967.0}, {"dt": "2017-09-01T00:00:00", "Export TEUs": 284153.0}, {"dt": "2017-10-01T00:00:00", "Export TEUs": 281491.0}, {"dt": "2017-11-01T00:00:00", "Export TEUs": 279296.0}, {"dt": "2017-12-01T00:00:00", "Export TEUs": 268446.0}, {"dt": "2018-01-01T00:00:00", "Export TEUs": 274963.0}, {"dt": "2018-02-01T00:00:00", "Export TEUs": 246462.0}, {"dt": "2018-03-01T00:00:00", "Export TEUs": 282543.0}, {"dt": "2018-04-01T00:00:00", "Export TEUs": 277507.0}, {"dt": "2018-05-01T00:00:00", "Export TEUs": 290084.0}, {"dt": "2018-06-01T00:00:00", "Export TEUs": 313314.0}, {"dt": "2018-07-01T00:00:00", "Export TEUs": 299008.0}, {"dt": "2018-08-01T00:00:00", "Export TEUs": 316636.0}, {"dt": "2018-09-01T00:00:00", "Export TEUs": 297591.0}, {"dt": "2018-10-01T00:00:00", "Export TEUs": 317809.0}, {"dt": "2018-11-01T00:00:00", "Export TEUs": 279999.0}, {"dt": "2018-12-01T00:00:00", "Export TEUs": 290964.0}, {"dt": "2019-01-01T00:00:00", "Export TEUs": 294170.0}, {"dt": "2019-02-01T00:00:00", "Export TEUs": 288716.0}, {"dt": "2019-03-01T00:00:00", "Export TEUs": 300815.0}, {"dt": "2019-04-01T00:00:00", "Export TEUs": 305888.0}, {"dt": "2019-05-01T00:00:00", "Export TEUs": 301763.0}, {"dt": "2019-06-01T00:00:00", "Export TEUs": 307718.0}, {"dt": "2019-07-01T00:00:00", "Export TEUs": 324266.0}, {"dt": "2019-08-01T00:00:00", "Export TEUs": 335112.0}, {"dt": "2019-09-01T00:00:00", "Export TEUs": 307374.0}, {"dt": "2019-10-01T00:00:00", "Export TEUs": 325429.0}, {"dt": "2019-11-01T00:00:00", "Export TEUs": 297166.0}, {"dt": "2019-12-01T00:00:00", "Export TEUs": 294235.0}, {"dt": "2020-01-01T00:00:00", "Export TEUs": 318296.5}, {"dt": "2020-02-01T00:00:00", "Export TEUs": 298431.0}, {"dt": "2020-03-01T00:00:00", "Export TEUs": 283040.5}, {"dt": "2020-04-01T00:00:00", "Export TEUs": 259518.0}, {"dt": "2020-05-01T00:00:00", "Export TEUs": 270404.0}, {"dt": "2020-06-01T00:00:00", "Export TEUs": 259518.0}, {"dt": "2020-07-01T00:00:00", "Export TEUs": 283040.5}, {"dt": "2020-08-01T00:00:00", "Export TEUs": 298431.0}, {"dt": "2020-09-01T00:00:00", "Export TEUs": 318296.5}, {"dt": "2020-10-01T00:00:00", "Export TEUs": 350022.0}, {"dt": "2020-11-01T00:00:00", "Export TEUs": 352666.0}, {"dt": "2020-12-01T00:00:00", "Export TEUs": 347829.0}, {"dt": "2021-01-01T00:00:00", "Export TEUs": 343260.0}, {"dt": "2021-02-01T00:00:00", "Export TEUs": 379378.0}, {"dt": "2021-03-01T00:00:00", "Export TEUs": 362111.0}, {"dt": "2021-04-01T00:00:00", "Export TEUs": 360951.0}, {"dt": "2021-05-01T00:00:00", "Export TEUs": 397715.0}, {"dt": "2021-06-01T00:00:00", "Export TEUs": 350966.0}, {"dt": "2021-07-01T00:00:00", "Export TEUs": 394241.0}, {"dt": "2021-08-01T00:00:00", "Export TEUs": 288654.0}, {"dt": "2021-09-01T00:00:00", "Export TEUs": 348247.0}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[37]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_nynj</span><span class="p">[</span><span class="mi">12</span><span class="p">:]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(),</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;New York/New Jersey&quot;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;Total TEUs&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[37]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-59e62252df0640fab1a858291eab940d"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-59e62252df0640fab1a858291eab940d") {
      outputDiv = document.getElementById("altair-viz-59e62252df0640fab1a858291eab940d");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector023"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of New York/New Jersey Total TEUs Container Volume", "transform": [{"window": [{"op": "lag", "field": "Total TEUs", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Total TEUs'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt"}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Total TEUs"}}, "height": 100, "selection": {"selector023": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-a1d58d0bae67548d39d33427e0e8c1fe"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-a1d58d0bae67548d39d33427e0e8c1fe": [{"dt": "2006-01-01T00:00:00", "Total TEUs": 283314.0}, {"dt": "2006-02-01T00:00:00", "Total TEUs": 261938.5}, {"dt": "2006-03-01T00:00:00", "Total TEUs": 306179.5}, {"dt": "2006-04-01T00:00:00", "Total TEUs": 312796.0}, {"dt": "2006-05-01T00:00:00", "Total TEUs": 313889.5}, {"dt": "2006-06-01T00:00:00", "Total TEUs": 328163.0}, {"dt": "2006-07-01T00:00:00", "Total TEUs": 315500.0}, {"dt": "2006-08-01T00:00:00", "Total TEUs": 326072.5}, {"dt": "2006-09-01T00:00:00", "Total TEUs": 317058.5}, {"dt": "2006-10-01T00:00:00", "Total TEUs": 333098.0}, {"dt": "2006-11-01T00:00:00", "Total TEUs": 317248.0}, {"dt": "2006-12-01T00:00:00", "Total TEUs": 314344.5}, {"dt": "2007-01-01T00:00:00", "Total TEUs": 295544.0}, {"dt": "2007-02-01T00:00:00", "Total TEUs": 292102.0}, {"dt": "2007-03-01T00:00:00", "Total TEUs": 362299.0}, {"dt": "2007-04-01T00:00:00", "Total TEUs": 303461.0}, {"dt": "2007-05-01T00:00:00", "Total TEUs": 345858.0}, {"dt": "2007-06-01T00:00:00", "Total TEUs": 366255.0}, {"dt": "2007-07-01T00:00:00", "Total TEUs": 345852.0}, {"dt": "2007-08-01T00:00:00", "Total TEUs": 374334.0}, {"dt": "2007-09-01T00:00:00", "Total TEUs": 364557.0}, {"dt": "2007-10-01T00:00:00", "Total TEUs": 357646.0}, {"dt": "2007-11-01T00:00:00", "Total TEUs": 345121.0}, {"dt": "2007-12-01T00:00:00", "Total TEUs": 344466.0}, {"dt": "2008-01-01T00:00:00", "Total TEUs": 322739.0}, {"dt": "2008-02-01T00:00:00", "Total TEUs": 324727.0}, {"dt": "2008-03-01T00:00:00", "Total TEUs": 348848.0}, {"dt": "2008-04-01T00:00:00", "Total TEUs": 342697.0}, {"dt": "2008-05-01T00:00:00", "Total TEUs": 355830.0}, {"dt": "2008-06-01T00:00:00", "Total TEUs": 373795.0}, {"dt": "2008-07-01T00:00:00", "Total TEUs": 373018.0}, {"dt": "2008-08-01T00:00:00", "Total TEUs": 368688.0}, {"dt": "2008-09-01T00:00:00", "Total TEUs": 382878.0}, {"dt": "2008-10-01T00:00:00", "Total TEUs": 361347.0}, {"dt": "2008-11-01T00:00:00", "Total TEUs": 322376.0}, {"dt": "2008-12-01T00:00:00", "Total TEUs": 288271.0}, {"dt": "2009-01-01T00:00:00", "Total TEUs": 272763.0}, {"dt": "2009-02-01T00:00:00", "Total TEUs": 283142.0}, {"dt": "2009-03-01T00:00:00", "Total TEUs": 280828.0}, {"dt": "2009-04-01T00:00:00", "Total TEUs": 281599.0}, {"dt": "2009-05-01T00:00:00", "Total TEUs": 305055.0}, {"dt": "2009-06-01T00:00:00", "Total TEUs": 304412.0}, {"dt": "2009-07-01T00:00:00", "Total TEUs": 321848.0}, {"dt": "2009-08-01T00:00:00", "Total TEUs": 331322.0}, {"dt": "2009-09-01T00:00:00", "Total TEUs": 320782.0}, {"dt": "2009-10-01T00:00:00", "Total TEUs": 333141.0}, {"dt": "2009-11-01T00:00:00", "Total TEUs": 315556.0}, {"dt": "2009-12-01T00:00:00", "Total TEUs": 287659.0}, {"dt": "2010-01-01T00:00:00", "Total TEUs": 302556.0}, {"dt": "2010-02-01T00:00:00", "Total TEUs": 282366.0}, {"dt": "2010-03-01T00:00:00", "Total TEUs": 332303.0}, {"dt": "2010-04-01T00:00:00", "Total TEUs": 330677.0}, {"dt": "2010-05-01T00:00:00", "Total TEUs": 357643.0}, {"dt": "2010-06-01T00:00:00", "Total TEUs": 349191.0}, {"dt": "2010-07-01T00:00:00", "Total TEUs": 379853.0}, {"dt": "2010-08-01T00:00:00", "Total TEUs": 372985.0}, {"dt": "2010-09-01T00:00:00", "Total TEUs": 343235.5}, {"dt": "2010-10-01T00:00:00", "Total TEUs": 371619.5}, {"dt": "2010-11-01T00:00:00", "Total TEUs": 348885.0}, {"dt": "2010-12-01T00:00:00", "Total TEUs": 326107.0}, {"dt": "2011-01-01T00:00:00", "Total TEUs": 391537.0}, {"dt": "2011-02-01T00:00:00", "Total TEUs": 371055.0}, {"dt": "2011-03-01T00:00:00", "Total TEUs": 406371.0}, {"dt": "2011-04-01T00:00:00", "Total TEUs": 399472.5}, {"dt": "2011-05-01T00:00:00", "Total TEUs": 426150.5}, {"dt": "2011-06-01T00:00:00", "Total TEUs": 402996.0}, {"dt": "2011-07-01T00:00:00", "Total TEUs": 424342.5}, {"dt": "2011-08-01T00:00:00", "Total TEUs": 424843.5}, {"dt": "2011-09-01T00:00:00", "Total TEUs": 440313.0}, {"dt": "2011-10-01T00:00:00", "Total TEUs": 416493.5}, {"dt": "2011-11-01T00:00:00", "Total TEUs": 407161.0}, {"dt": "2011-12-01T00:00:00", "Total TEUs": 393485.0}, {"dt": "2012-01-01T00:00:00", "Total TEUs": 448681.0}, {"dt": "2012-02-01T00:00:00", "Total TEUs": 429904.0}, {"dt": "2012-03-01T00:00:00", "Total TEUs": 442347.0}, {"dt": "2012-04-01T00:00:00", "Total TEUs": 443776.0}, {"dt": "2012-05-01T00:00:00", "Total TEUs": 480876.0}, {"dt": "2012-06-01T00:00:00", "Total TEUs": 475206.0}, {"dt": "2012-07-01T00:00:00", "Total TEUs": 514777.0}, {"dt": "2012-08-01T00:00:00", "Total TEUs": 513088.0}, {"dt": "2012-09-01T00:00:00", "Total TEUs": 490888.0}, {"dt": "2012-10-01T00:00:00", "Total TEUs": 414080.0}, {"dt": "2012-11-01T00:00:00", "Total TEUs": 422273.0}, {"dt": "2012-12-01T00:00:00", "Total TEUs": 454013.0}, {"dt": "2013-01-01T00:00:00", "Total TEUs": 428367.0}, {"dt": "2013-02-01T00:00:00", "Total TEUs": 403275.0}, {"dt": "2013-03-01T00:00:00", "Total TEUs": 438786.0}, {"dt": "2013-04-01T00:00:00", "Total TEUs": 436579.0}, {"dt": "2013-05-01T00:00:00", "Total TEUs": 476384.0}, {"dt": "2013-06-01T00:00:00", "Total TEUs": 437770.0}, {"dt": "2013-07-01T00:00:00", "Total TEUs": 484842.0}, {"dt": "2013-08-01T00:00:00", "Total TEUs": 527528.0}, {"dt": "2013-09-01T00:00:00", "Total TEUs": 472581.0}, {"dt": "2013-10-01T00:00:00", "Total TEUs": 505857.0}, {"dt": "2013-11-01T00:00:00", "Total TEUs": 422128.0}, {"dt": "2013-12-01T00:00:00", "Total TEUs": 433250.0}, {"dt": "2014-01-01T00:00:00", "Total TEUs": 428918.0}, {"dt": "2014-02-01T00:00:00", "Total TEUs": 387909.0}, {"dt": "2014-03-01T00:00:00", "Total TEUs": 484339.0}, {"dt": "2014-04-01T00:00:00", "Total TEUs": 460857.0}, {"dt": "2014-05-01T00:00:00", "Total TEUs": 495034.0}, {"dt": "2014-06-01T00:00:00", "Total TEUs": 470497.0}, {"dt": "2014-07-01T00:00:00", "Total TEUs": 516244.0}, {"dt": "2014-08-01T00:00:00", "Total TEUs": 528581.0}, {"dt": "2014-09-01T00:00:00", "Total TEUs": 498533.0}, {"dt": "2014-10-01T00:00:00", "Total TEUs": 531302.0}, {"dt": "2014-11-01T00:00:00", "Total TEUs": 484799.0}, {"dt": "2014-12-01T00:00:00", "Total TEUs": 485290.0}, {"dt": "2015-01-01T00:00:00", "Total TEUs": 463002.0}, {"dt": "2015-02-01T00:00:00", "Total TEUs": 445285.0}, {"dt": "2015-03-01T00:00:00", "Total TEUs": 559264.0}, {"dt": "2015-04-01T00:00:00", "Total TEUs": 504674.0}, {"dt": "2015-05-01T00:00:00", "Total TEUs": 558991.0}, {"dt": "2015-06-01T00:00:00", "Total TEUs": 562573.0}, {"dt": "2015-07-01T00:00:00", "Total TEUs": 588918.0}, {"dt": "2015-08-01T00:00:00", "Total TEUs": 574547.0}, {"dt": "2015-09-01T00:00:00", "Total TEUs": 569956.0}, {"dt": "2015-10-01T00:00:00", "Total TEUs": 544677.0}, {"dt": "2015-11-01T00:00:00", "Total TEUs": 500608.0}, {"dt": "2015-12-01T00:00:00", "Total TEUs": 499225.0}, {"dt": "2016-01-01T00:00:00", "Total TEUs": 477905.0}, {"dt": "2016-02-01T00:00:00", "Total TEUs": 500659.0}, {"dt": "2016-03-01T00:00:00", "Total TEUs": 517789.0}, {"dt": "2016-04-01T00:00:00", "Total TEUs": 489311.0}, {"dt": "2016-05-01T00:00:00", "Total TEUs": 525048.0}, {"dt": "2016-06-01T00:00:00", "Total TEUs": 530575.0}, {"dt": "2016-07-01T00:00:00", "Total TEUs": 532437.0}, {"dt": "2016-08-01T00:00:00", "Total TEUs": 585327.0}, {"dt": "2016-09-01T00:00:00", "Total TEUs": 497704.0}, {"dt": "2016-10-01T00:00:00", "Total TEUs": 539092.0}, {"dt": "2016-11-01T00:00:00", "Total TEUs": 527974.0}, {"dt": "2016-12-01T00:00:00", "Total TEUs": 528132.0}, {"dt": "2017-01-01T00:00:00", "Total TEUs": 517668.0}, {"dt": "2017-02-01T00:00:00", "Total TEUs": 507066.0}, {"dt": "2017-03-01T00:00:00", "Total TEUs": 508270.0}, {"dt": "2017-04-01T00:00:00", "Total TEUs": 547013.0}, {"dt": "2017-05-01T00:00:00", "Total TEUs": 565052.0}, {"dt": "2017-06-01T00:00:00", "Total TEUs": 584606.0}, {"dt": "2017-07-01T00:00:00", "Total TEUs": 576947.0}, {"dt": "2017-08-01T00:00:00", "Total TEUs": 631404.0}, {"dt": "2017-09-01T00:00:00", "Total TEUs": 573458.0}, {"dt": "2017-10-01T00:00:00", "Total TEUs": 588848.0}, {"dt": "2017-11-01T00:00:00", "Total TEUs": 566519.0}, {"dt": "2017-12-01T00:00:00", "Total TEUs": 543966.0}, {"dt": "2018-01-01T00:00:00", "Total TEUs": 585864.0}, {"dt": "2018-02-01T00:00:00", "Total TEUs": 521921.0}, {"dt": "2018-03-01T00:00:00", "Total TEUs": 572576.0}, {"dt": "2018-04-01T00:00:00", "Total TEUs": 551117.0}, {"dt": "2018-05-01T00:00:00", "Total TEUs": 593625.0}, {"dt": "2018-06-01T00:00:00", "Total TEUs": 625366.0}, {"dt": "2018-07-01T00:00:00", "Total TEUs": 622559.0}, {"dt": "2018-08-01T00:00:00", "Total TEUs": 651752.0}, {"dt": "2018-09-01T00:00:00", "Total TEUs": 603034.0}, {"dt": "2018-10-01T00:00:00", "Total TEUs": 658708.0}, {"dt": "2018-11-01T00:00:00", "Total TEUs": 583880.0}, {"dt": "2018-12-01T00:00:00", "Total TEUs": 609390.0}, {"dt": "2019-01-01T00:00:00", "Total TEUs": 622531.0}, {"dt": "2019-02-01T00:00:00", "Total TEUs": 585216.0}, {"dt": "2019-03-01T00:00:00", "Total TEUs": 585098.0}, {"dt": "2019-04-01T00:00:00", "Total TEUs": 605263.0}, {"dt": "2019-05-01T00:00:00", "Total TEUs": 643706.0}, {"dt": "2019-06-01T00:00:00", "Total TEUs": 611027.0}, {"dt": "2019-07-01T00:00:00", "Total TEUs": 662994.0}, {"dt": "2019-08-01T00:00:00", "Total TEUs": 679585.0}, {"dt": "2019-09-01T00:00:00", "Total TEUs": 624961.0}, {"dt": "2019-10-01T00:00:00", "Total TEUs": 666381.0}, {"dt": "2019-11-01T00:00:00", "Total TEUs": 599626.0}, {"dt": "2019-12-01T00:00:00", "Total TEUs": 584743.0}, {"dt": "2020-01-01T00:00:00", "Total TEUs": 668996.5}, {"dt": "2020-02-01T00:00:00", "Total TEUs": 633744.5}, {"dt": "2020-03-01T00:00:00", "Total TEUs": 584146.5}, {"dt": "2020-04-01T00:00:00", "Total TEUs": 535617.5}, {"dt": "2020-05-01T00:00:00", "Total TEUs": 537412.0}, {"dt": "2020-06-01T00:00:00", "Total TEUs": 535617.5}, {"dt": "2020-07-01T00:00:00", "Total TEUs": 584146.5}, {"dt": "2020-08-01T00:00:00", "Total TEUs": 633744.5}, {"dt": "2020-09-01T00:00:00", "Total TEUs": 668996.5}, {"dt": "2020-10-01T00:00:00", "Total TEUs": 755437.0}, {"dt": "2020-11-01T00:00:00", "Total TEUs": 738885.0}, {"dt": "2020-12-01T00:00:00", "Total TEUs": 709075.0}, {"dt": "2021-01-01T00:00:00", "Total TEUs": 724418.0}, {"dt": "2021-02-01T00:00:00", "Total TEUs": 780782.0}, {"dt": "2021-03-01T00:00:00", "Total TEUs": 758810.0}, {"dt": "2021-04-01T00:00:00", "Total TEUs": 749400.0}, {"dt": "2021-05-01T00:00:00", "Total TEUs": 796693.0}, {"dt": "2021-06-01T00:00:00", "Total TEUs": 712799.0}, {"dt": "2021-07-01T00:00:00", "Total TEUs": 789776.0}, {"dt": "2021-08-01T00:00:00", "Total TEUs": 625120.0}, {"dt": "2021-09-01T00:00:00", "Total TEUs": 721284.0}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Georgia-Ports">Georgia Ports<a class="anchor-link" href="#Georgia-Ports">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[38]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@memory</span><span class="o">.</span><span class="n">cache</span>
<span class="k">def</span> <span class="nf">doGaFetch</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">retries</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">retries</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span> <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="n">uaString</span> <span class="p">})</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>

        <span class="n">tabs</span> <span class="o">=</span> <span class="n">read_pdf</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">()),</span> <span class="n">pages</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>

        <span class="c1"># noop to test for the table</span>
        <span class="n">tabs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="k">return</span> <span class="n">tabs</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">doGaFetch</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">retries</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    
<span class="n">reportPage</span> <span class="o">=</span> <span class="s1">&#39;https://gaports.com/sales/by-the-numbers/&#39;</span>
<span class="n">currentReport</span> <span class="o">=</span> <span class="o">!</span>curl -s -L <span class="nv">$reportPage</span> <span class="p">|</span> egrep -i <span class="s1">&#39;Monthly.*TEU.*pdf&#39;</span> <span class="p">|</span> perl -pe <span class="s1">&#39;s/.*href=\&quot;([^&quot;]+)\&quot;.*/\1/&#39;</span>

<span class="c1">#print(currentReport[0])</span>

<span class="n">current</span> <span class="o">=</span> <span class="s2">&quot;https://gaports.com/wp-content/uploads/2021/04/Monthly-TEU-Throughput-March-2021.pdf&quot;</span>

<span class="n">tabs</span> <span class="o">=</span> <span class="n">doGaFetch</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[39]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Jan&#39;</span><span class="p">,</span> <span class="s1">&#39;Feb&#39;</span><span class="p">,</span> <span class="s1">&#39;Mar&#39;</span><span class="p">,</span> <span class="s1">&#39;Apr&#39;</span><span class="p">,</span> <span class="s1">&#39;May&#39;</span><span class="p">,</span> <span class="s1">&#39;Jun&#39;</span><span class="p">,</span> <span class="s1">&#39;Jul&#39;</span><span class="p">,</span> <span class="s1">&#39;Aug&#39;</span><span class="p">,</span> <span class="s1">&#39;Sep&#39;</span><span class="p">,</span> <span class="s1">&#39;Oct&#39;</span><span class="p">,</span> <span class="s1">&#39;Nov&#39;</span><span class="p">,</span> <span class="s1">&#39;Dec&#39;</span><span class="p">,</span> <span class="s1">&#39;Total&#39;</span><span class="p">]</span>

<span class="n">flatten</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">l</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">parseGpTable</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">17</span><span class="p">):</span>
    <span class="n">gp_raw</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="n">end</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="mi">17</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1">#print(gp_raw.iloc[0, :].values)</span>
    
    <span class="n">firstRowVals</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="n">gp_raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
    <span class="c1">#print(firstRowVals)</span>
    
    <span class="c1"># Use all the month values in order then append the total value as the last element</span>
    <span class="n">firstRow</span> <span class="o">=</span> <span class="p">[</span><span class="n">firstRowVals</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">firstRowVals</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))]</span> <span class="o">+</span> <span class="p">[</span><span class="n">gp_raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="c1">#print(firstRow)</span>

    <span class="n">records</span> <span class="o">=</span> <span class="n">gp_raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">flatten</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="n">s</span><span class="o">.</span><span class="n">values</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#print(records.head(1))</span>
    
    <span class="n">df_ga_melted</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">([</span><span class="n">firstRow</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">records</span><span class="o">.</span><span class="n">values</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
    
    <span class="c1">#print(df_ga_melted[df_ga_melted[&#39;Year&#39;] == &#39;2020&#39;].head(15))</span>
    
    <span class="n">df_ga_melted</span> <span class="o">=</span> <span class="n">df_ga_melted</span><span class="p">[</span><span class="n">df_ga_melted</span><span class="p">[</span><span class="s1">&#39;variable&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;Total&#39;</span><span class="p">]</span>
    <span class="n">df_ga_melted</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_ga_melted</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">df_ga_melted</span><span class="p">[</span><span class="s1">&#39;variable&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y-%b&#39;</span><span class="p">)</span>
    <span class="n">df_ga_melted</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_ga_melted</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">))</span>

    <span class="n">df_ga_tst</span> <span class="o">=</span> <span class="n">df_ga_melted</span><span class="p">[[</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;dt&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;dt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;1M&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;TEU Total&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df_ga_tst</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="n">df_ga_tst</span> <span class="o">=</span> <span class="n">parseGpTable</span><span class="p">(</span><span class="n">tabs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[40]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cols2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Key&#39;</span><span class="p">,</span> <span class="s1">&#39;Jan&#39;</span><span class="p">,</span> <span class="s1">&#39;Feb&#39;</span><span class="p">,</span> <span class="s1">&#39;Mar&#39;</span><span class="p">,</span> <span class="s1">&#39;Apr&#39;</span><span class="p">,</span> <span class="s1">&#39;May&#39;</span><span class="p">,</span> <span class="s1">&#39;Jun&#39;</span><span class="p">,</span> <span class="s1">&#39;Jul&#39;</span><span class="p">,</span> <span class="s1">&#39;Aug&#39;</span><span class="p">,</span> <span class="s1">&#39;Sep&#39;</span><span class="p">,</span> <span class="s1">&#39;Oct&#39;</span><span class="p">,</span> <span class="s1">&#39;Nov&#39;</span><span class="p">,</span> <span class="s1">&#39;Dec&#39;</span><span class="p">,</span> <span class="s1">&#39;Total&#39;</span><span class="p">]</span>

<span class="c1">#gp_raw = tabs[0].iloc[3:21].copy()</span>

<span class="n">gp_detail_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">tabs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">18</span><span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()]</span> <span class="o">+</span> <span class="n">tabs</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">gp_detail_raw</span> <span class="o">=</span> <span class="n">gp_detail_raw</span><span class="p">[</span><span class="o">~</span><span class="n">gp_detail_raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>

<span class="c1">#print(gp_detail_raw)</span>

<span class="c1"># Exclude rows with erroneous data</span>
<span class="n">gp_detail_raw</span> <span class="o">=</span> <span class="n">gp_detail_raw</span><span class="p">[</span><span class="o">~</span><span class="n">gp_detail_raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;%&quot;</span><span class="p">)]</span>
<span class="n">gp_detail_raw</span> <span class="o">=</span> <span class="n">gp_detail_raw</span><span class="p">[</span><span class="n">gp_detail_raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(I|E|T|\d)&quot;</span><span class="p">)]</span>

<span class="c1">#print(gp_detail_raw.head(25))</span>

<span class="n">hypenate</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;rt &quot;</span><span class="p">,</span> <span class="s2">&quot;rt-&quot;</span><span class="p">)</span>\
                           <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Total Full&quot;</span><span class="p">,</span> <span class="s2">&quot;Total-Full&quot;</span><span class="p">)</span>\
                           <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Total Empty&quot;</span><span class="p">,</span> <span class="s2">&quot;Total-Empty&quot;</span><span class="p">)</span>\
                           <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Total All&quot;</span><span class="p">,</span> <span class="s2">&quot;Total-All&quot;</span><span class="p">)</span>

<span class="n">gp_detail_raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">gp_detail_raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">hypenate</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd"># Special case for the current year</span>
<span class="sd">firstRowVals2 = flatten(map(lambda v: hypenate(v).split(), gp_detail_raw.iloc[0, :-1].values))</span>
<span class="sd">firstRow2 = [firstRowVals2[n] if n &lt; len(firstRowVals2) else &#39;&#39; for n in range(len(cols2[:-1]))] + [gp_detail_raw.iloc[0, -1]]</span>

<span class="sd"># General case for the historical years</span>
<span class="sd">remainingRows = gp_detail_raw.iloc[1:].apply(lambda s: flatten(map(lambda v: hypenate(v).split(), s.to_list())), axis=1)</span>

<span class="sd">gp_detail = pd.DataFrame.from_records([firstRow2] + [r for r in remainingRows.values], columns=cols2)</span>

<span class="sd">#print(gp_detail.head())</span>

<span class="sd"># Find all the records that don&#39;t have the year in them</span>
<span class="sd">rowsToShift = gp_detail[~gp_detail[&#39;Year&#39;].str.match(&quot;^\d&quot;)].index.values</span>

<span class="sd">#####</span>
<span class="sd"># Note, this is the likely line to toggle between commented&lt;-&gt;uncommented if seeing issues</span>
<span class="sd">#####</span>
<span class="sd"># Shift records not containing the year to the right by one to line things up</span>
<span class="sd">gp_detail.iloc[rowsToShift] = gp_detail.iloc[rowsToShift].apply(lambda v: pd.Series([None] + v.to_list()[:-1]), axis=1)</span>

<span class="sd">gp_detail.iloc[rowsToShift, 0] = pd.to_numeric(&#39;&#39;, errors=&#39;coerce&#39;)</span>
<span class="sd">&quot;&quot;&quot;</span><span class="p">;</span>

<span class="n">gp_detail</span> <span class="o">=</span> <span class="n">gp_detail_raw</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">gp_detail</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">cols2</span>

<span class="c1"># Fill the years for the rest of the rows</span>
<span class="n">gp_detail</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gp_detail</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ffill</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="c1">#print(gp_detail.head(20))</span>

<span class="n">df_ga_detail_melted</span> <span class="o">=</span> <span class="n">gp_detail</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Key&quot;</span><span class="p">,</span> <span class="s2">&quot;Year&quot;</span><span class="p">])</span>

<span class="n">df_ga_detail_melted</span> <span class="o">=</span> <span class="n">df_ga_detail_melted</span><span class="p">[</span><span class="n">df_ga_detail_melted</span><span class="p">[</span><span class="s2">&quot;variable&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;Total&quot;</span><span class="p">]</span>

<span class="n">df_ga_detail_melted</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_ga_detail_melted</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span>\
                                           <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">df_ga_detail_melted</span><span class="p">[</span><span class="s1">&#39;variable&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y-%b&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>

<span class="n">df_ga_detail_melted</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_ga_detail_melted</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>\
                                    <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>\
                                    <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">))</span>

<span class="c1">#print(df_ga_detail_melted.fillna(&#39;nan&#39;).dropna().tail())</span>

<span class="n">df_ga_ts</span> <span class="o">=</span> <span class="n">df_ga_detail_melted</span><span class="p">[[</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="s1">&#39;Key&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Key&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df_ga_ts</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="s1">&#39;Export Empty&#39;</span><span class="p">,</span> <span class="s1">&#39;Export Full&#39;</span><span class="p">,</span> <span class="s1">&#39;Export Total&#39;</span><span class="p">,</span>\
                    <span class="s1">&#39;Import Empty&#39;</span><span class="p">,</span> <span class="s1">&#39;Import Full&#39;</span><span class="p">,</span> <span class="s1">&#39;Import Total&#39;</span><span class="p">,</span> <span class="s1">&#39;Total All&#39;</span><span class="p">,</span> <span class="s1">&#39;Total Empty&#39;</span><span class="p">,</span> <span class="s1">&#39;Total Full&#39;</span><span class="p">]</span>

<span class="n">df_ga_ts</span> <span class="o">=</span> <span class="n">df_ga_ts</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[41]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_ga_ts</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Georgia&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Total All&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[41]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-1620b1cee36040a999d0896afd8e4c0e"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-1620b1cee36040a999d0896afd8e4c0e") {
      outputDiv = document.getElementById("altair-viz-1620b1cee36040a999d0896afd8e4c0e");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector024"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Georgia Total All Container Volume", "transform": [{"window": [{"op": "lag", "field": "Total All", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Total All'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt"}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Total All"}}, "height": 100, "selection": {"selector024": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-2b7d3b758ade45ad5d99d846129dca09"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-2b7d3b758ade45ad5d99d846129dca09": [{"dt": "2003-01-01T00:00:00", "Total All": 130333.0}, {"dt": "2003-02-01T00:00:00", "Total All": 116677.0}, {"dt": "2003-03-01T00:00:00", "Total All": 125978.0}, {"dt": "2003-04-01T00:00:00", "Total All": 129040.0}, {"dt": "2003-05-01T00:00:00", "Total All": 122255.0}, {"dt": "2003-06-01T00:00:00", "Total All": 123615.0}, {"dt": "2003-07-01T00:00:00", "Total All": 127441.0}, {"dt": "2003-08-01T00:00:00", "Total All": 133322.0}, {"dt": "2003-09-01T00:00:00", "Total All": 130142.0}, {"dt": "2003-10-01T00:00:00", "Total All": 143206.0}, {"dt": "2003-11-01T00:00:00", "Total All": 116884.0}, {"dt": "2003-12-01T00:00:00", "Total All": 122927.0}, {"dt": "2004-01-01T00:00:00", "Total All": 125018.0}, {"dt": "2004-02-01T00:00:00", "Total All": 133271.0}, {"dt": "2004-03-01T00:00:00", "Total All": 136255.0}, {"dt": "2004-04-01T00:00:00", "Total All": 136410.0}, {"dt": "2004-05-01T00:00:00", "Total All": 137277.0}, {"dt": "2004-06-01T00:00:00", "Total All": 130527.0}, {"dt": "2004-07-01T00:00:00", "Total All": 136204.0}, {"dt": "2004-08-01T00:00:00", "Total All": 154361.0}, {"dt": "2004-09-01T00:00:00", "Total All": 130983.0}, {"dt": "2004-10-01T00:00:00", "Total All": 161131.0}, {"dt": "2004-11-01T00:00:00", "Total All": 142064.0}, {"dt": "2004-12-01T00:00:00", "Total All": 139623.0}, {"dt": "2005-01-01T00:00:00", "Total All": 150841.0}, {"dt": "2005-02-01T00:00:00", "Total All": 144958.0}, {"dt": "2005-03-01T00:00:00", "Total All": 148992.0}, {"dt": "2005-04-01T00:00:00", "Total All": 153911.0}, {"dt": "2005-05-01T00:00:00", "Total All": 148791.0}, {"dt": "2005-06-01T00:00:00", "Total All": 149232.0}, {"dt": "2005-07-01T00:00:00", "Total All": 162095.0}, {"dt": "2005-08-01T00:00:00", "Total All": 166856.0}, {"dt": "2005-09-01T00:00:00", "Total All": 169756.0}, {"dt": "2005-10-01T00:00:00", "Total All": 191112.0}, {"dt": "2005-11-01T00:00:00", "Total All": 161789.0}, {"dt": "2005-12-01T00:00:00", "Total All": 153174.0}, {"dt": "2006-01-01T00:00:00", "Total All": 177539.0}, {"dt": "2006-02-01T00:00:00", "Total All": 160792.0}, {"dt": "2006-03-01T00:00:00", "Total All": 172193.0}, {"dt": "2006-04-01T00:00:00", "Total All": 173389.0}, {"dt": "2006-05-01T00:00:00", "Total All": 177743.0}, {"dt": "2006-06-01T00:00:00", "Total All": 175411.0}, {"dt": "2006-07-01T00:00:00", "Total All": 182432.0}, {"dt": "2006-08-01T00:00:00", "Total All": 181419.0}, {"dt": "2006-09-01T00:00:00", "Total All": 193611.0}, {"dt": "2006-10-01T00:00:00", "Total All": 207624.0}, {"dt": "2006-11-01T00:00:00", "Total All": 180292.0}, {"dt": "2006-12-01T00:00:00", "Total All": 177752.0}, {"dt": "2007-01-01T00:00:00", "Total All": 177388.0}, {"dt": "2007-02-01T00:00:00", "Total All": 189036.0}, {"dt": "2007-03-01T00:00:00", "Total All": 207989.0}, {"dt": "2007-04-01T00:00:00", "Total All": 204733.0}, {"dt": "2007-05-01T00:00:00", "Total All": 220806.0}, {"dt": "2007-06-01T00:00:00", "Total All": 215200.0}, {"dt": "2007-07-01T00:00:00", "Total All": 231691.0}, {"dt": "2007-08-01T00:00:00", "Total All": 236009.0}, {"dt": "2007-09-01T00:00:00", "Total All": 250551.0}, {"dt": "2007-10-01T00:00:00", "Total All": 249501.0}, {"dt": "2007-11-01T00:00:00", "Total All": 218391.0}, {"dt": "2007-12-01T00:00:00", "Total All": 203016.0}, {"dt": "2008-01-01T00:00:00", "Total All": 223717.0}, {"dt": "2008-02-01T00:00:00", "Total All": 214386.0}, {"dt": "2008-03-01T00:00:00", "Total All": 218209.0}, {"dt": "2008-04-01T00:00:00", "Total All": 218469.0}, {"dt": "2008-05-01T00:00:00", "Total All": 213979.0}, {"dt": "2008-06-01T00:00:00", "Total All": 209674.0}, {"dt": "2008-07-01T00:00:00", "Total All": 220797.0}, {"dt": "2008-08-01T00:00:00", "Total All": 228543.0}, {"dt": "2008-09-01T00:00:00", "Total All": 240140.0}, {"dt": "2008-10-01T00:00:00", "Total All": 230253.0}, {"dt": "2008-11-01T00:00:00", "Total All": 213763.0}, {"dt": "2008-12-01T00:00:00", "Total All": 184197.0}, {"dt": "2009-01-01T00:00:00", "Total All": 188109.0}, {"dt": "2009-02-01T00:00:00", "Total All": 167970.0}, {"dt": "2009-03-01T00:00:00", "Total All": 171987.0}, {"dt": "2009-04-01T00:00:00", "Total All": 193839.0}, {"dt": "2009-05-01T00:00:00", "Total All": 185917.0}, {"dt": "2009-06-01T00:00:00", "Total All": 179451.0}, {"dt": "2009-07-01T00:00:00", "Total All": 208087.0}, {"dt": "2009-08-01T00:00:00", "Total All": 207259.0}, {"dt": "2009-09-01T00:00:00", "Total All": 202911.0}, {"dt": "2009-10-01T00:00:00", "Total All": 234084.0}, {"dt": "2009-11-01T00:00:00", "Total All": 199314.0}, {"dt": "2009-12-01T00:00:00", "Total All": 217585.0}, {"dt": "2010-01-01T00:00:00", "Total All": 225837.0}, {"dt": "2010-02-01T00:00:00", "Total All": 202568.0}, {"dt": "2010-03-01T00:00:00", "Total All": 227860.0}, {"dt": "2010-04-01T00:00:00", "Total All": 239742.0}, {"dt": "2010-05-01T00:00:00", "Total All": 231762.0}, {"dt": "2010-06-01T00:00:00", "Total All": 240734.0}, {"dt": "2010-07-01T00:00:00", "Total All": 251128.0}, {"dt": "2010-08-01T00:00:00", "Total All": 248471.0}, {"dt": "2010-09-01T00:00:00", "Total All": 242994.0}, {"dt": "2010-10-01T00:00:00", "Total All": 273277.0}, {"dt": "2010-11-01T00:00:00", "Total All": 222281.0}, {"dt": "2010-12-01T00:00:00", "Total All": 218522.0}, {"dt": "2011-01-01T00:00:00", "Total All": 236981.0}, {"dt": "2011-02-01T00:00:00", "Total All": 235643.0}, {"dt": "2011-03-01T00:00:00", "Total All": 238013.0}, {"dt": "2011-04-01T00:00:00", "Total All": 260063.0}, {"dt": "2011-05-01T00:00:00", "Total All": 254330.0}, {"dt": "2011-06-01T00:00:00", "Total All": 245544.0}, {"dt": "2011-07-01T00:00:00", "Total All": 262723.0}, {"dt": "2011-08-01T00:00:00", "Total All": 237792.0}, {"dt": "2011-09-01T00:00:00", "Total All": 269856.0}, {"dt": "2011-10-01T00:00:00", "Total All": 255116.0}, {"dt": "2011-11-01T00:00:00", "Total All": 234150.0}, {"dt": "2011-12-01T00:00:00", "Total All": 214472.0}, {"dt": "2012-01-01T00:00:00", "Total All": 247102.0}, {"dt": "2012-02-01T00:00:00", "Total All": 237076.0}, {"dt": "2012-03-01T00:00:00", "Total All": 259795.0}, {"dt": "2012-04-01T00:00:00", "Total All": 248911.0}, {"dt": "2012-05-01T00:00:00", "Total All": 256530.0}, {"dt": "2012-06-01T00:00:00", "Total All": 258950.0}, {"dt": "2012-07-01T00:00:00", "Total All": 252130.0}, {"dt": "2012-08-01T00:00:00", "Total All": 270610.0}, {"dt": "2012-09-01T00:00:00", "Total All": 257159.0}, {"dt": "2012-10-01T00:00:00", "Total All": 230640.0}, {"dt": "2012-11-01T00:00:00", "Total All": 228184.0}, {"dt": "2012-12-01T00:00:00", "Total All": 219128.0}, {"dt": "2013-01-01T00:00:00", "Total All": 230372.0}, {"dt": "2013-02-01T00:00:00", "Total All": 242425.0}, {"dt": "2013-03-01T00:00:00", "Total All": 232545.0}, {"dt": "2013-04-01T00:00:00", "Total All": 258951.0}, {"dt": "2013-05-01T00:00:00", "Total All": 261520.0}, {"dt": "2013-06-01T00:00:00", "Total All": 265787.0}, {"dt": "2013-07-01T00:00:00", "Total All": 246652.0}, {"dt": "2013-08-01T00:00:00", "Total All": 280813.0}, {"dt": "2013-09-01T00:00:00", "Total All": 261821.0}, {"dt": "2013-10-01T00:00:00", "Total All": 274327.0}, {"dt": "2013-11-01T00:00:00", "Total All": 243215.0}, {"dt": "2013-12-01T00:00:00", "Total All": 235300.0}, {"dt": "2014-01-01T00:00:00", "Total All": 259091.0}, {"dt": "2014-02-01T00:00:00", "Total All": 248750.0}, {"dt": "2014-03-01T00:00:00", "Total All": 260559.0}, {"dt": "2014-04-01T00:00:00", "Total All": 266935.0}, {"dt": "2014-05-01T00:00:00", "Total All": 290436.0}, {"dt": "2014-06-01T00:00:00", "Total All": 268119.0}, {"dt": "2014-07-01T00:00:00", "Total All": 293889.0}, {"dt": "2014-08-01T00:00:00", "Total All": 301822.0}, {"dt": "2014-09-01T00:00:00", "Total All": 295698.0}, {"dt": "2014-10-01T00:00:00", "Total All": 311760.0}, {"dt": "2014-11-01T00:00:00", "Total All": 271357.0}, {"dt": "2014-12-01T00:00:00", "Total All": 277634.0}, {"dt": "2015-01-01T00:00:00", "Total All": 293654.0}, {"dt": "2015-02-01T00:00:00", "Total All": 284037.0}, {"dt": "2015-03-01T00:00:00", "Total All": 333056.0}, {"dt": "2015-04-01T00:00:00", "Total All": 335907.0}, {"dt": "2015-05-01T00:00:00", "Total All": 338207.0}, {"dt": "2015-06-01T00:00:00", "Total All": 330420.0}, {"dt": "2015-07-01T00:00:00", "Total All": 324242.0}, {"dt": "2015-08-01T00:00:00", "Total All": 315175.0}, {"dt": "2015-09-01T00:00:00", "Total All": 317417.0}, {"dt": "2015-10-01T00:00:00", "Total All": 321094.0}, {"dt": "2015-11-01T00:00:00", "Total All": 284146.0}, {"dt": "2015-12-01T00:00:00", "Total All": 260074.0}, {"dt": "2016-01-01T00:00:00", "Total All": 285301.0}, {"dt": "2016-02-01T00:00:00", "Total All": 307035.0}, {"dt": "2016-03-01T00:00:00", "Total All": 295149.0}, {"dt": "2016-04-01T00:00:00", "Total All": 298040.0}, {"dt": "2016-05-01T00:00:00", "Total All": 313485.0}, {"dt": "2016-06-01T00:00:00", "Total All": 288364.0}, {"dt": "2016-07-01T00:00:00", "Total All": 314714.0}, {"dt": "2016-08-01T00:00:00", "Total All": 330846.0}, {"dt": "2016-09-01T00:00:00", "Total All": 308348.0}, {"dt": "2016-10-01T00:00:00", "Total All": 310393.0}, {"dt": "2016-11-01T00:00:00", "Total All": 300671.0}, {"dt": "2016-12-01T00:00:00", "Total All": 292173.0}, {"dt": "2017-01-01T00:00:00", "Total All": 331468.0}, {"dt": "2017-02-01T00:00:00", "Total All": 330539.0}, {"dt": "2017-03-01T00:00:00", "Total All": 311770.0}, {"dt": "2017-04-01T00:00:00", "Total All": 333006.0}, {"dt": "2017-05-01T00:00:00", "Total All": 350104.0}, {"dt": "2017-06-01T00:00:00", "Total All": 337711.0}, {"dt": "2017-07-01T00:00:00", "Total All": 336099.0}, {"dt": "2017-08-01T00:00:00", "Total All": 348297.0}, {"dt": "2017-09-01T00:00:00", "Total All": 325141.0}, {"dt": "2017-10-01T00:00:00", "Total All": 409814.0}, {"dt": "2017-11-01T00:00:00", "Total All": 309147.0}, {"dt": "2017-12-01T00:00:00", "Total All": 323117.0}, {"dt": "2018-01-01T00:00:00", "Total All": 338793.0}, {"dt": "2018-02-01T00:00:00", "Total All": 341094.0}, {"dt": "2018-03-01T00:00:00", "Total All": 355208.0}, {"dt": "2018-04-01T00:00:00", "Total All": 356717.0}, {"dt": "2018-05-01T00:00:00", "Total All": 361029.0}, {"dt": "2018-06-01T00:00:00", "Total All": 370726.0}, {"dt": "2018-07-01T00:00:00", "Total All": 378767.0}, {"dt": "2018-08-01T00:00:00", "Total All": 375844.0}, {"dt": "2018-09-01T00:00:00", "Total All": 364150.0}, {"dt": "2018-10-01T00:00:00", "Total All": 413778.0}, {"dt": "2018-11-01T00:00:00", "Total All": 344506.0}, {"dt": "2018-12-01T00:00:00", "Total All": 351366.0}, {"dt": "2019-01-01T00:00:00", "Total All": 430079.0}, {"dt": "2019-02-01T00:00:00", "Total All": 312042.0}, {"dt": "2019-03-01T00:00:00", "Total All": 410326.0}, {"dt": "2019-04-01T00:00:00", "Total All": 364481.0}, {"dt": "2019-05-01T00:00:00", "Total All": 373394.0}, {"dt": "2019-06-01T00:00:00", "Total All": 361906.0}, {"dt": "2019-07-01T00:00:00", "Total All": 387022.0}, {"dt": "2019-08-01T00:00:00", "Total All": 437747.0}, {"dt": "2019-09-01T00:00:00", "Total All": 369999.0}, {"dt": "2019-10-01T00:00:00", "Total All": 428381.0}, {"dt": "2019-11-01T00:00:00", "Total All": 362964.0}, {"dt": "2019-12-01T00:00:00", "Total All": 360834.0}, {"dt": "2020-01-01T00:00:00", "Total All": 377671.0}, {"dt": "2020-02-01T00:00:00", "Total All": 364405.0}, {"dt": "2020-03-01T00:00:00", "Total All": 335789.0}, {"dt": "2020-04-01T00:00:00", "Total All": 337890.0}, {"dt": "2020-05-01T00:00:00", "Total All": 337359.0}, {"dt": "2020-06-01T00:00:00", "Total All": 338287.0}, {"dt": "2020-07-01T00:00:00", "Total All": 360697.0}, {"dt": "2020-08-01T00:00:00", "Total All": 441596.0}, {"dt": "2020-09-01T00:00:00", "Total All": 412138.0}, {"dt": "2020-10-01T00:00:00", "Total All": 464095.0}, {"dt": "2020-11-01T00:00:00", "Total All": 464804.0}, {"dt": "2020-12-01T00:00:00", "Total All": 447525.0}, {"dt": "2021-01-01T00:00:00", "Total All": 459608.0}, {"dt": "2021-02-01T00:00:00", "Total All": 390804.0}, {"dt": "2021-03-01T00:00:00", "Total All": 498065.0}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_ga_ts</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Georgia&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Import Empty&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[23]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-9b69564a78744be9847badd7fe3ba208"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-9b69564a78744be9847badd7fe3ba208") {
      outputDiv = document.getElementById("altair-viz-9b69564a78744be9847badd7fe3ba208");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector013"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Georgia Import Empty Container Volume", "transform": [{"window": [{"op": "lag", "field": "Import Empty", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Import Empty'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt"}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Import Empty"}}, "height": 100, "selection": {"selector013": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-825308865a1ec34001baffbc34c42e35"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-825308865a1ec34001baffbc34c42e35": [{"dt": "2003-01-01T00:00:00", "Import Empty": 4678.0}, {"dt": "2003-02-01T00:00:00", "Import Empty": 6347.0}, {"dt": "2003-03-01T00:00:00", "Import Empty": 9422.0}, {"dt": "2003-04-01T00:00:00", "Import Empty": 6211.0}, {"dt": "2003-05-01T00:00:00", "Import Empty": 6069.0}, {"dt": "2003-06-01T00:00:00", "Import Empty": 7212.0}, {"dt": "2003-07-01T00:00:00", "Import Empty": 6531.0}, {"dt": "2003-08-01T00:00:00", "Import Empty": 6285.0}, {"dt": "2003-09-01T00:00:00", "Import Empty": 3221.0}, {"dt": "2003-10-01T00:00:00", "Import Empty": 4553.0}, {"dt": "2003-11-01T00:00:00", "Import Empty": 4008.0}, {"dt": "2003-12-01T00:00:00", "Import Empty": 6844.0}, {"dt": "2004-01-01T00:00:00", "Import Empty": 8153.0}, {"dt": "2004-02-01T00:00:00", "Import Empty": 7062.0}, {"dt": "2004-03-01T00:00:00", "Import Empty": 8118.0}, {"dt": "2004-04-01T00:00:00", "Import Empty": 5561.0}, {"dt": "2004-05-01T00:00:00", "Import Empty": 6325.0}, {"dt": "2004-06-01T00:00:00", "Import Empty": 5751.0}, {"dt": "2004-07-01T00:00:00", "Import Empty": 6388.0}, {"dt": "2004-08-01T00:00:00", "Import Empty": 9472.0}, {"dt": "2004-09-01T00:00:00", "Import Empty": 5332.0}, {"dt": "2004-10-01T00:00:00", "Import Empty": 6830.0}, {"dt": "2004-11-01T00:00:00", "Import Empty": 7533.0}, {"dt": "2004-12-01T00:00:00", "Import Empty": 8049.0}, {"dt": "2005-01-01T00:00:00", "Import Empty": 7571.0}, {"dt": "2005-02-01T00:00:00", "Import Empty": 6666.0}, {"dt": "2005-03-01T00:00:00", "Import Empty": 7447.0}, {"dt": "2005-04-01T00:00:00", "Import Empty": 5886.0}, {"dt": "2005-05-01T00:00:00", "Import Empty": 6648.0}, {"dt": "2005-06-01T00:00:00", "Import Empty": 7328.0}, {"dt": "2005-07-01T00:00:00", "Import Empty": 7420.0}, {"dt": "2005-08-01T00:00:00", "Import Empty": 7311.0}, {"dt": "2005-09-01T00:00:00", "Import Empty": 4079.0}, {"dt": "2005-10-01T00:00:00", "Import Empty": 6073.0}, {"dt": "2005-11-01T00:00:00", "Import Empty": 5411.0}, {"dt": "2005-12-01T00:00:00", "Import Empty": 6670.0}, {"dt": "2006-01-01T00:00:00", "Import Empty": 8313.0}, {"dt": "2006-02-01T00:00:00", "Import Empty": 7140.0}, {"dt": "2006-03-01T00:00:00", "Import Empty": 13391.0}, {"dt": "2006-04-01T00:00:00", "Import Empty": 11925.0}, {"dt": "2006-05-01T00:00:00", "Import Empty": 8284.0}, {"dt": "2006-06-01T00:00:00", "Import Empty": 9465.0}, {"dt": "2006-07-01T00:00:00", "Import Empty": 8130.0}, {"dt": "2006-08-01T00:00:00", "Import Empty": 6102.0}, {"dt": "2006-09-01T00:00:00", "Import Empty": 6073.0}, {"dt": "2006-10-01T00:00:00", "Import Empty": 5786.0}, {"dt": "2006-11-01T00:00:00", "Import Empty": 6516.0}, {"dt": "2006-12-01T00:00:00", "Import Empty": 6803.0}, {"dt": "2007-01-01T00:00:00", "Import Empty": 8911.0}, {"dt": "2007-02-01T00:00:00", "Import Empty": 7107.0}, {"dt": "2007-03-01T00:00:00", "Import Empty": 12400.0}, {"dt": "2007-04-01T00:00:00", "Import Empty": 10770.0}, {"dt": "2007-05-01T00:00:00", "Import Empty": 11318.0}, {"dt": "2007-06-01T00:00:00", "Import Empty": 13864.0}, {"dt": "2007-07-01T00:00:00", "Import Empty": 10815.0}, {"dt": "2007-08-01T00:00:00", "Import Empty": 9925.0}, {"dt": "2007-09-01T00:00:00", "Import Empty": 12593.0}, {"dt": "2007-10-01T00:00:00", "Import Empty": 10428.0}, {"dt": "2007-11-01T00:00:00", "Import Empty": 7700.0}, {"dt": "2007-12-01T00:00:00", "Import Empty": 10207.0}, {"dt": "2008-01-01T00:00:00", "Import Empty": 14466.0}, {"dt": "2008-02-01T00:00:00", "Import Empty": 10308.0}, {"dt": "2008-03-01T00:00:00", "Import Empty": 17090.0}, {"dt": "2008-04-01T00:00:00", "Import Empty": 11304.0}, {"dt": "2008-05-01T00:00:00", "Import Empty": 13977.0}, {"dt": "2008-06-01T00:00:00", "Import Empty": 14299.0}, {"dt": "2008-07-01T00:00:00", "Import Empty": 15017.0}, {"dt": "2008-08-01T00:00:00", "Import Empty": 13697.0}, {"dt": "2008-09-01T00:00:00", "Import Empty": 12144.0}, {"dt": "2008-10-01T00:00:00", "Import Empty": 9660.0}, {"dt": "2008-11-01T00:00:00", "Import Empty": 10315.0}, {"dt": "2008-12-01T00:00:00", "Import Empty": 10669.0}, {"dt": "2009-01-01T00:00:00", "Import Empty": 10212.0}, {"dt": "2009-02-01T00:00:00", "Import Empty": 9758.0}, {"dt": "2009-03-01T00:00:00", "Import Empty": 16627.0}, {"dt": "2009-04-01T00:00:00", "Import Empty": 21721.0}, {"dt": "2009-05-01T00:00:00", "Import Empty": 18635.0}, {"dt": "2009-06-01T00:00:00", "Import Empty": 17579.0}, {"dt": "2009-07-01T00:00:00", "Import Empty": 23741.0}, {"dt": "2009-08-01T00:00:00", "Import Empty": 19649.0}, {"dt": "2009-09-01T00:00:00", "Import Empty": 22777.0}, {"dt": "2009-10-01T00:00:00", "Import Empty": 18652.0}, {"dt": "2009-11-01T00:00:00", "Import Empty": 20100.0}, {"dt": "2009-12-01T00:00:00", "Import Empty": 26938.0}, {"dt": "2010-01-01T00:00:00", "Import Empty": 29093.0}, {"dt": "2010-02-01T00:00:00", "Import Empty": 21712.0}, {"dt": "2010-03-01T00:00:00", "Import Empty": 30758.0}, {"dt": "2010-04-01T00:00:00", "Import Empty": 25391.0}, {"dt": "2010-05-01T00:00:00", "Import Empty": 23092.0}, {"dt": "2010-06-01T00:00:00", "Import Empty": 24496.0}, {"dt": "2010-07-01T00:00:00", "Import Empty": 22393.0}, {"dt": "2010-08-01T00:00:00", "Import Empty": 22478.0}, {"dt": "2010-09-01T00:00:00", "Import Empty": 20960.0}, {"dt": "2010-10-01T00:00:00", "Import Empty": 23072.0}, {"dt": "2010-11-01T00:00:00", "Import Empty": 19497.0}, {"dt": "2010-12-01T00:00:00", "Import Empty": 22312.0}, {"dt": "2011-01-01T00:00:00", "Import Empty": 23122.0}, {"dt": "2011-02-01T00:00:00", "Import Empty": 25707.0}, {"dt": "2011-03-01T00:00:00", "Import Empty": 30671.0}, {"dt": "2011-04-01T00:00:00", "Import Empty": 31739.0}, {"dt": "2011-05-01T00:00:00", "Import Empty": 30472.0}, {"dt": "2011-06-01T00:00:00", "Import Empty": 27524.0}, {"dt": "2011-07-01T00:00:00", "Import Empty": 26883.0}, {"dt": "2011-08-01T00:00:00", "Import Empty": 20856.0}, {"dt": "2011-09-01T00:00:00", "Import Empty": 25959.0}, {"dt": "2011-10-01T00:00:00", "Import Empty": 21087.0}, {"dt": "2011-11-01T00:00:00", "Import Empty": 23866.0}, {"dt": "2011-12-01T00:00:00", "Import Empty": 17319.0}, {"dt": "2012-01-01T00:00:00", "Import Empty": 26226.0}, {"dt": "2012-02-01T00:00:00", "Import Empty": 28342.0}, {"dt": "2012-03-01T00:00:00", "Import Empty": 30976.0}, {"dt": "2012-04-01T00:00:00", "Import Empty": 29123.0}, {"dt": "2012-05-01T00:00:00", "Import Empty": 23758.0}, {"dt": "2012-06-01T00:00:00", "Import Empty": 25762.0}, {"dt": "2012-07-01T00:00:00", "Import Empty": 25842.0}, {"dt": "2012-08-01T00:00:00", "Import Empty": 27361.0}, {"dt": "2012-09-01T00:00:00", "Import Empty": 22890.0}, {"dt": "2012-10-01T00:00:00", "Import Empty": 16536.0}, {"dt": "2012-11-01T00:00:00", "Import Empty": 19975.0}, {"dt": "2012-12-01T00:00:00", "Import Empty": 19031.0}, {"dt": "2013-01-01T00:00:00", "Import Empty": 23849.0}, {"dt": "2013-02-01T00:00:00", "Import Empty": 29163.0}, {"dt": "2013-03-01T00:00:00", "Import Empty": 24997.0}, {"dt": "2013-04-01T00:00:00", "Import Empty": 31775.0}, {"dt": "2013-05-01T00:00:00", "Import Empty": 27527.0}, {"dt": "2013-06-01T00:00:00", "Import Empty": 27429.0}, {"dt": "2013-07-01T00:00:00", "Import Empty": 21314.0}, {"dt": "2013-08-01T00:00:00", "Import Empty": 22717.0}, {"dt": "2013-09-01T00:00:00", "Import Empty": 25118.0}, {"dt": "2013-10-01T00:00:00", "Import Empty": 12403.0}, {"dt": "2013-11-01T00:00:00", "Import Empty": 16586.0}, {"dt": "2013-12-01T00:00:00", "Import Empty": 21279.0}, {"dt": "2014-01-01T00:00:00", "Import Empty": 26136.0}, {"dt": "2014-02-01T00:00:00", "Import Empty": 22427.0}, {"dt": "2014-03-01T00:00:00", "Import Empty": 23127.0}, {"dt": "2014-04-01T00:00:00", "Import Empty": 24629.0}, {"dt": "2014-05-01T00:00:00", "Import Empty": 29872.0}, {"dt": "2014-06-01T00:00:00", "Import Empty": 24900.0}, {"dt": "2014-07-01T00:00:00", "Import Empty": 21910.0}, {"dt": "2014-08-01T00:00:00", "Import Empty": 18664.0}, {"dt": "2014-09-01T00:00:00", "Import Empty": 16445.0}, {"dt": "2014-10-01T00:00:00", "Import Empty": 18923.0}, {"dt": "2014-11-01T00:00:00", "Import Empty": 16585.0}, {"dt": "2014-12-01T00:00:00", "Import Empty": 13622.0}, {"dt": "2015-01-01T00:00:00", "Import Empty": 19776.0}, {"dt": "2015-02-01T00:00:00", "Import Empty": 22798.0}, {"dt": "2015-03-01T00:00:00", "Import Empty": 19861.0}, {"dt": "2015-04-01T00:00:00", "Import Empty": 25402.0}, {"dt": "2015-05-01T00:00:00", "Import Empty": 19095.0}, {"dt": "2015-06-01T00:00:00", "Import Empty": 14678.0}, {"dt": "2015-07-01T00:00:00", "Import Empty": 14115.0}, {"dt": "2015-08-01T00:00:00", "Import Empty": 10522.0}, {"dt": "2015-09-01T00:00:00", "Import Empty": 12063.0}, {"dt": "2015-10-01T00:00:00", "Import Empty": 13051.0}, {"dt": "2015-11-01T00:00:00", "Import Empty": 11721.0}, {"dt": "2015-12-01T00:00:00", "Import Empty": 12901.0}, {"dt": "2016-01-01T00:00:00", "Import Empty": 15084.0}, {"dt": "2016-02-01T00:00:00", "Import Empty": 14741.0}, {"dt": "2016-03-01T00:00:00", "Import Empty": 11831.0}, {"dt": "2016-04-01T00:00:00", "Import Empty": 15178.0}, {"dt": "2016-05-01T00:00:00", "Import Empty": 10708.0}, {"dt": "2016-06-01T00:00:00", "Import Empty": 10968.0}, {"dt": "2016-07-01T00:00:00", "Import Empty": 11881.0}, {"dt": "2016-08-01T00:00:00", "Import Empty": 12720.0}, {"dt": "2016-09-01T00:00:00", "Import Empty": 14585.0}, {"dt": "2016-10-01T00:00:00", "Import Empty": 8175.0}, {"dt": "2016-11-01T00:00:00", "Import Empty": 11067.0}, {"dt": "2016-12-01T00:00:00", "Import Empty": 10335.0}, {"dt": "2017-01-01T00:00:00", "Import Empty": 14027.0}, {"dt": "2017-02-01T00:00:00", "Import Empty": 15120.0}, {"dt": "2017-03-01T00:00:00", "Import Empty": 15595.0}, {"dt": "2017-04-01T00:00:00", "Import Empty": 13834.0}, {"dt": "2017-05-01T00:00:00", "Import Empty": 13054.0}, {"dt": "2017-06-01T00:00:00", "Import Empty": 8335.0}, {"dt": "2017-07-01T00:00:00", "Import Empty": 9766.0}, {"dt": "2017-08-01T00:00:00", "Import Empty": 8450.0}, {"dt": "2017-09-01T00:00:00", "Import Empty": 9116.0}, {"dt": "2017-10-01T00:00:00", "Import Empty": 10750.0}, {"dt": "2017-11-01T00:00:00", "Import Empty": 6270.0}, {"dt": "2017-12-01T00:00:00", "Import Empty": 6576.0}, {"dt": "2018-01-01T00:00:00", "Import Empty": 8491.0}, {"dt": "2018-02-01T00:00:00", "Import Empty": 15235.0}, {"dt": "2018-03-01T00:00:00", "Import Empty": 13089.0}, {"dt": "2018-04-01T00:00:00", "Import Empty": 15800.0}, {"dt": "2018-05-01T00:00:00", "Import Empty": 10051.0}, {"dt": "2018-06-01T00:00:00", "Import Empty": 9741.0}, {"dt": "2018-07-01T00:00:00", "Import Empty": 6806.0}, {"dt": "2018-08-01T00:00:00", "Import Empty": 5121.0}, {"dt": "2018-09-01T00:00:00", "Import Empty": 5967.0}, {"dt": "2018-10-01T00:00:00", "Import Empty": 3730.0}, {"dt": "2018-11-01T00:00:00", "Import Empty": 3873.0}, {"dt": "2018-12-01T00:00:00", "Import Empty": 2637.0}, {"dt": "2019-01-01T00:00:00", "Import Empty": 2216.0}, {"dt": "2019-02-01T00:00:00", "Import Empty": 4465.0}, {"dt": "2019-03-01T00:00:00", "Import Empty": 9785.0}, {"dt": "2019-04-01T00:00:00", "Import Empty": 7386.0}, {"dt": "2019-05-01T00:00:00", "Import Empty": 2773.0}, {"dt": "2019-06-01T00:00:00", "Import Empty": 4756.0}, {"dt": "2019-07-01T00:00:00", "Import Empty": 5401.0}, {"dt": "2019-08-01T00:00:00", "Import Empty": 6095.0}, {"dt": "2019-09-01T00:00:00", "Import Empty": 8879.0}, {"dt": "2019-10-01T00:00:00", "Import Empty": 7678.0}, {"dt": "2019-11-01T00:00:00", "Import Empty": 7383.0}, {"dt": "2019-12-01T00:00:00", "Import Empty": 9385.0}, {"dt": "2020-01-01T00:00:00", "Import Empty": 6950.0}, {"dt": "2020-02-01T00:00:00", "Import Empty": 11042.0}, {"dt": "2020-03-01T00:00:00", "Import Empty": 15296.0}, {"dt": "2020-04-01T00:00:00", "Import Empty": 7874.0}, {"dt": "2020-05-01T00:00:00", "Import Empty": 7695.0}, {"dt": "2020-06-01T00:00:00", "Import Empty": 7143.0}, {"dt": "2020-07-01T00:00:00", "Import Empty": 7509.0}, {"dt": "2020-08-01T00:00:00", "Import Empty": 5779.0}, {"dt": "2020-09-01T00:00:00", "Import Empty": 4400.0}, {"dt": "2020-10-01T00:00:00", "Import Empty": 5854.0}, {"dt": "2020-11-01T00:00:00", "Import Empty": 5158.0}, {"dt": "2020-12-01T00:00:00", "Import Empty": 5283.0}, {"dt": "2021-01-01T00:00:00", "Import Empty": 3498.0}, {"dt": "2021-02-01T00:00:00", "Import Empty": 3672.0}, {"dt": "2021-03-01T00:00:00", "Import Empty": 6127.0}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_ga_ts</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Georgia&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Import Full&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[24]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-f08262e47dd74cb69247023d88140c02"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-f08262e47dd74cb69247023d88140c02") {
      outputDiv = document.getElementById("altair-viz-f08262e47dd74cb69247023d88140c02");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector014"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Georgia Import Full Container Volume", "transform": [{"window": [{"op": "lag", "field": "Import Full", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Import Full'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt"}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Import Full"}}, "height": 100, "selection": {"selector014": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-799715d52faad276b065f32700fbd756"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-799715d52faad276b065f32700fbd756": [{"dt": "2003-01-01T00:00:00", "Import Full": 58082.0}, {"dt": "2003-02-01T00:00:00", "Import Full": 48500.0}, {"dt": "2003-03-01T00:00:00", "Import Full": 45723.0}, {"dt": "2003-04-01T00:00:00", "Import Full": 53662.0}, {"dt": "2003-05-01T00:00:00", "Import Full": 46723.0}, {"dt": "2003-06-01T00:00:00", "Import Full": 45070.0}, {"dt": "2003-07-01T00:00:00", "Import Full": 49782.0}, {"dt": "2003-08-01T00:00:00", "Import Full": 55437.0}, {"dt": "2003-09-01T00:00:00", "Import Full": 57672.0}, {"dt": "2003-10-01T00:00:00", "Import Full": 61121.0}, {"dt": "2003-11-01T00:00:00", "Import Full": 43857.0}, {"dt": "2003-12-01T00:00:00", "Import Full": 49819.0}, {"dt": "2004-01-01T00:00:00", "Import Full": 50750.0}, {"dt": "2004-02-01T00:00:00", "Import Full": 53589.0}, {"dt": "2004-03-01T00:00:00", "Import Full": 53812.0}, {"dt": "2004-04-01T00:00:00", "Import Full": 53575.0}, {"dt": "2004-05-01T00:00:00", "Import Full": 52339.0}, {"dt": "2004-06-01T00:00:00", "Import Full": 51115.0}, {"dt": "2004-07-01T00:00:00", "Import Full": 56529.0}, {"dt": "2004-08-01T00:00:00", "Import Full": 61498.0}, {"dt": "2004-09-01T00:00:00", "Import Full": 58757.0}, {"dt": "2004-10-01T00:00:00", "Import Full": 72876.0}, {"dt": "2004-11-01T00:00:00", "Import Full": 55999.0}, {"dt": "2004-12-01T00:00:00", "Import Full": 58374.0}, {"dt": "2005-01-01T00:00:00", "Import Full": 63885.0}, {"dt": "2005-02-01T00:00:00", "Import Full": 63287.0}, {"dt": "2005-03-01T00:00:00", "Import Full": 60027.0}, {"dt": "2005-04-01T00:00:00", "Import Full": 65795.0}, {"dt": "2005-05-01T00:00:00", "Import Full": 62850.0}, {"dt": "2005-06-01T00:00:00", "Import Full": 61908.0}, {"dt": "2005-07-01T00:00:00", "Import Full": 68108.0}, {"dt": "2005-08-01T00:00:00", "Import Full": 72639.0}, {"dt": "2005-09-01T00:00:00", "Import Full": 77105.0}, {"dt": "2005-10-01T00:00:00", "Import Full": 84996.0}, {"dt": "2005-11-01T00:00:00", "Import Full": 65488.0}, {"dt": "2005-12-01T00:00:00", "Import Full": 62178.0}, {"dt": "2006-01-01T00:00:00", "Import Full": 74750.0}, {"dt": "2006-02-01T00:00:00", "Import Full": 66085.0}, {"dt": "2006-03-01T00:00:00", "Import Full": 59711.0}, {"dt": "2006-04-01T00:00:00", "Import Full": 69304.0}, {"dt": "2006-05-01T00:00:00", "Import Full": 68357.0}, {"dt": "2006-06-01T00:00:00", "Import Full": 67133.0}, {"dt": "2006-07-01T00:00:00", "Import Full": 74545.0}, {"dt": "2006-08-01T00:00:00", "Import Full": 73623.0}, {"dt": "2006-09-01T00:00:00", "Import Full": 82071.0}, {"dt": "2006-10-01T00:00:00", "Import Full": 89533.0}, {"dt": "2006-11-01T00:00:00", "Import Full": 72117.0}, {"dt": "2006-12-01T00:00:00", "Import Full": 69004.0}, {"dt": "2007-01-01T00:00:00", "Import Full": 72681.0}, {"dt": "2007-02-01T00:00:00", "Import Full": 80214.0}, {"dt": "2007-03-01T00:00:00", "Import Full": 80744.0}, {"dt": "2007-04-01T00:00:00", "Import Full": 81643.0}, {"dt": "2007-05-01T00:00:00", "Import Full": 87599.0}, {"dt": "2007-06-01T00:00:00", "Import Full": 86213.0}, {"dt": "2007-07-01T00:00:00", "Import Full": 97495.0}, {"dt": "2007-08-01T00:00:00", "Import Full": 97841.0}, {"dt": "2007-09-01T00:00:00", "Import Full": 104953.0}, {"dt": "2007-10-01T00:00:00", "Import Full": 110353.0}, {"dt": "2007-11-01T00:00:00", "Import Full": 90415.0}, {"dt": "2007-12-01T00:00:00", "Import Full": 83875.0}, {"dt": "2008-01-01T00:00:00", "Import Full": 93160.0}, {"dt": "2008-02-01T00:00:00", "Import Full": 89539.0}, {"dt": "2008-03-01T00:00:00", "Import Full": 85021.0}, {"dt": "2008-04-01T00:00:00", "Import Full": 91314.0}, {"dt": "2008-05-01T00:00:00", "Import Full": 87036.0}, {"dt": "2008-06-01T00:00:00", "Import Full": 83731.0}, {"dt": "2008-07-01T00:00:00", "Import Full": 91047.0}, {"dt": "2008-08-01T00:00:00", "Import Full": 94552.0}, {"dt": "2008-09-01T00:00:00", "Import Full": 105628.0}, {"dt": "2008-10-01T00:00:00", "Import Full": 94743.0}, {"dt": "2008-11-01T00:00:00", "Import Full": 84954.0}, {"dt": "2008-12-01T00:00:00", "Import Full": 72535.0}, {"dt": "2009-01-01T00:00:00", "Import Full": 77898.0}, {"dt": "2009-02-01T00:00:00", "Import Full": 68418.0}, {"dt": "2009-03-01T00:00:00", "Import Full": 60609.0}, {"dt": "2009-04-01T00:00:00", "Import Full": 73703.0}, {"dt": "2009-05-01T00:00:00", "Import Full": 67298.0}, {"dt": "2009-06-01T00:00:00", "Import Full": 64375.0}, {"dt": "2009-07-01T00:00:00", "Import Full": 73550.0}, {"dt": "2009-08-01T00:00:00", "Import Full": 76887.0}, {"dt": "2009-09-01T00:00:00", "Import Full": 77538.0}, {"dt": "2009-10-01T00:00:00", "Import Full": 92233.0}, {"dt": "2009-11-01T00:00:00", "Import Full": 73267.0}, {"dt": "2009-12-01T00:00:00", "Import Full": 77779.0}, {"dt": "2010-01-01T00:00:00", "Import Full": 80634.0}, {"dt": "2010-02-01T00:00:00", "Import Full": 72736.0}, {"dt": "2010-03-01T00:00:00", "Import Full": 81475.0}, {"dt": "2010-04-01T00:00:00", "Import Full": 87595.0}, {"dt": "2010-05-01T00:00:00", "Import Full": 87386.0}, {"dt": "2010-06-01T00:00:00", "Import Full": 88874.0}, {"dt": "2010-07-01T00:00:00", "Import Full": 95145.0}, {"dt": "2010-08-01T00:00:00", "Import Full": 96991.0}, {"dt": "2010-09-01T00:00:00", "Import Full": 95186.0}, {"dt": "2010-10-01T00:00:00", "Import Full": 106122.0}, {"dt": "2010-11-01T00:00:00", "Import Full": 81173.0}, {"dt": "2010-12-01T00:00:00", "Import Full": 77941.0}, {"dt": "2011-01-01T00:00:00", "Import Full": 88576.0}, {"dt": "2011-02-01T00:00:00", "Import Full": 86372.0}, {"dt": "2011-03-01T00:00:00", "Import Full": 77850.0}, {"dt": "2011-04-01T00:00:00", "Import Full": 91188.0}, {"dt": "2011-05-01T00:00:00", "Import Full": 90547.0}, {"dt": "2011-06-01T00:00:00", "Import Full": 87803.0}, {"dt": "2011-07-01T00:00:00", "Import Full": 95264.0}, {"dt": "2011-08-01T00:00:00", "Import Full": 90054.0}, {"dt": "2011-09-01T00:00:00", "Import Full": 100544.0}, {"dt": "2011-10-01T00:00:00", "Import Full": 96302.0}, {"dt": "2011-11-01T00:00:00", "Import Full": 82402.0}, {"dt": "2011-12-01T00:00:00", "Import Full": 78297.0}, {"dt": "2012-01-01T00:00:00", "Import Full": 91847.0}, {"dt": "2012-02-01T00:00:00", "Import Full": 86235.0}, {"dt": "2012-03-01T00:00:00", "Import Full": 87557.0}, {"dt": "2012-04-01T00:00:00", "Import Full": 91139.0}, {"dt": "2012-05-01T00:00:00", "Import Full": 93116.0}, {"dt": "2012-06-01T00:00:00", "Import Full": 93855.0}, {"dt": "2012-07-01T00:00:00", "Import Full": 94172.0}, {"dt": "2012-08-01T00:00:00", "Import Full": 100003.0}, {"dt": "2012-09-01T00:00:00", "Import Full": 97051.0}, {"dt": "2012-10-01T00:00:00", "Import Full": 86785.0}, {"dt": "2012-11-01T00:00:00", "Import Full": 84849.0}, {"dt": "2012-12-01T00:00:00", "Import Full": 81682.0}, {"dt": "2013-01-01T00:00:00", "Import Full": 88273.0}, {"dt": "2013-02-01T00:00:00", "Import Full": 85645.0}, {"dt": "2013-03-01T00:00:00", "Import Full": 80121.0}, {"dt": "2013-04-01T00:00:00", "Import Full": 92187.0}, {"dt": "2013-05-01T00:00:00", "Import Full": 96409.0}, {"dt": "2013-06-01T00:00:00", "Import Full": 97609.0}, {"dt": "2013-07-01T00:00:00", "Import Full": 94971.0}, {"dt": "2013-08-01T00:00:00", "Import Full": 111356.0}, {"dt": "2013-09-01T00:00:00", "Import Full": 102049.0}, {"dt": "2013-10-01T00:00:00", "Import Full": 110838.0}, {"dt": "2013-11-01T00:00:00", "Import Full": 97596.0}, {"dt": "2013-12-01T00:00:00", "Import Full": 88747.0}, {"dt": "2014-01-01T00:00:00", "Import Full": 100882.0}, {"dt": "2014-02-01T00:00:00", "Import Full": 97801.0}, {"dt": "2014-03-01T00:00:00", "Import Full": 99312.0}, {"dt": "2014-04-01T00:00:00", "Import Full": 100163.0}, {"dt": "2014-05-01T00:00:00", "Import Full": 112241.0}, {"dt": "2014-06-01T00:00:00", "Import Full": 101667.0}, {"dt": "2014-07-01T00:00:00", "Import Full": 122227.0}, {"dt": "2014-08-01T00:00:00", "Import Full": 127548.0}, {"dt": "2014-09-01T00:00:00", "Import Full": 123216.0}, {"dt": "2014-10-01T00:00:00", "Import Full": 131987.0}, {"dt": "2014-11-01T00:00:00", "Import Full": 112248.0}, {"dt": "2014-12-01T00:00:00", "Import Full": 118140.0}, {"dt": "2015-01-01T00:00:00", "Import Full": 128127.0}, {"dt": "2015-02-01T00:00:00", "Import Full": 114529.0}, {"dt": "2015-03-01T00:00:00", "Import Full": 151671.0}, {"dt": "2015-04-01T00:00:00", "Import Full": 135476.0}, {"dt": "2015-05-01T00:00:00", "Import Full": 148513.0}, {"dt": "2015-06-01T00:00:00", "Import Full": 141155.0}, {"dt": "2015-07-01T00:00:00", "Import Full": 142314.0}, {"dt": "2015-08-01T00:00:00", "Import Full": 142144.0}, {"dt": "2015-09-01T00:00:00", "Import Full": 139774.0}, {"dt": "2015-10-01T00:00:00", "Import Full": 142715.0}, {"dt": "2015-11-01T00:00:00", "Import Full": 124773.0}, {"dt": "2015-12-01T00:00:00", "Import Full": 111401.0}, {"dt": "2016-01-01T00:00:00", "Import Full": 129554.0}, {"dt": "2016-02-01T00:00:00", "Import Full": 140624.0}, {"dt": "2016-03-01T00:00:00", "Import Full": 128378.0}, {"dt": "2016-04-01T00:00:00", "Import Full": 130208.0}, {"dt": "2016-05-01T00:00:00", "Import Full": 141051.0}, {"dt": "2016-06-01T00:00:00", "Import Full": 132299.0}, {"dt": "2016-07-01T00:00:00", "Import Full": 145779.0}, {"dt": "2016-08-01T00:00:00", "Import Full": 152341.0}, {"dt": "2016-09-01T00:00:00", "Import Full": 146552.0}, {"dt": "2016-10-01T00:00:00", "Import Full": 150930.0}, {"dt": "2016-11-01T00:00:00", "Import Full": 139732.0}, {"dt": "2016-12-01T00:00:00", "Import Full": 133423.0}, {"dt": "2017-01-01T00:00:00", "Import Full": 154363.0}, {"dt": "2017-02-01T00:00:00", "Import Full": 148374.0}, {"dt": "2017-03-01T00:00:00", "Import Full": 137392.0}, {"dt": "2017-04-01T00:00:00", "Import Full": 149258.0}, {"dt": "2017-05-01T00:00:00", "Import Full": 160086.0}, {"dt": "2017-06-01T00:00:00", "Import Full": 154738.0}, {"dt": "2017-07-01T00:00:00", "Import Full": 159570.0}, {"dt": "2017-08-01T00:00:00", "Import Full": 164496.0}, {"dt": "2017-09-01T00:00:00", "Import Full": 166885.0}, {"dt": "2017-10-01T00:00:00", "Import Full": 188369.0}, {"dt": "2017-11-01T00:00:00", "Import Full": 144181.0}, {"dt": "2017-12-01T00:00:00", "Import Full": 148121.0}, {"dt": "2018-01-01T00:00:00", "Import Full": 169758.0}, {"dt": "2018-02-01T00:00:00", "Import Full": 158890.0}, {"dt": "2018-03-01T00:00:00", "Import Full": 159699.0}, {"dt": "2018-04-01T00:00:00", "Import Full": 161691.0}, {"dt": "2018-05-01T00:00:00", "Import Full": 165828.0}, {"dt": "2018-06-01T00:00:00", "Import Full": 175617.0}, {"dt": "2018-07-01T00:00:00", "Import Full": 181875.0}, {"dt": "2018-08-01T00:00:00", "Import Full": 182883.0}, {"dt": "2018-09-01T00:00:00", "Import Full": 173691.0}, {"dt": "2018-10-01T00:00:00", "Import Full": 205836.0}, {"dt": "2018-11-01T00:00:00", "Import Full": 169159.0}, {"dt": "2018-12-01T00:00:00", "Import Full": 176441.0}, {"dt": "2019-01-01T00:00:00", "Import Full": 209583.0}, {"dt": "2019-02-01T00:00:00", "Import Full": 149685.0}, {"dt": "2019-03-01T00:00:00", "Import Full": 186369.0}, {"dt": "2019-04-01T00:00:00", "Import Full": 175661.0}, {"dt": "2019-05-01T00:00:00", "Import Full": 185265.0}, {"dt": "2019-06-01T00:00:00", "Import Full": 168799.0}, {"dt": "2019-07-01T00:00:00", "Import Full": 197341.0}, {"dt": "2019-08-01T00:00:00", "Import Full": 217017.0}, {"dt": "2019-09-01T00:00:00", "Import Full": 183466.0}, {"dt": "2019-10-01T00:00:00", "Import Full": 199483.0}, {"dt": "2019-11-01T00:00:00", "Import Full": 173863.0}, {"dt": "2019-12-01T00:00:00", "Import Full": 172124.0}, {"dt": "2020-01-01T00:00:00", "Import Full": 188762.0}, {"dt": "2020-02-01T00:00:00", "Import Full": 170007.0}, {"dt": "2020-03-01T00:00:00", "Import Full": 147034.0}, {"dt": "2020-04-01T00:00:00", "Import Full": 166679.0}, {"dt": "2020-05-01T00:00:00", "Import Full": 154730.0}, {"dt": "2020-06-01T00:00:00", "Import Full": 161363.0}, {"dt": "2020-07-01T00:00:00", "Import Full": 185548.0}, {"dt": "2020-08-01T00:00:00", "Import Full": 227537.0}, {"dt": "2020-09-01T00:00:00", "Import Full": 212517.0}, {"dt": "2020-10-01T00:00:00", "Import Full": 233215.0}, {"dt": "2020-11-01T00:00:00", "Import Full": 234583.0}, {"dt": "2020-12-01T00:00:00", "Import Full": 224656.0}, {"dt": "2021-01-01T00:00:00", "Import Full": 232645.0}, {"dt": "2021-02-01T00:00:00", "Import Full": 189677.0}, {"dt": "2021-03-01T00:00:00", "Import Full": 249395.0}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_ga_ts</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Georgia&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Export Total&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[25]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-0a236fafe881471b8001f0ec30dbeb8b"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-0a236fafe881471b8001f0ec30dbeb8b") {
      outputDiv = document.getElementById("altair-viz-0a236fafe881471b8001f0ec30dbeb8b");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector015"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Georgia Export Total Container Volume", "transform": [{"window": [{"op": "lag", "field": "Export Total", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Export Total'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt"}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Export Total"}}, "height": 100, "selection": {"selector015": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-bae986f6b21ff9daaae664d4e919cb48"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-bae986f6b21ff9daaae664d4e919cb48": [{"dt": "2003-01-01T00:00:00", "Export Total": 67572.0}, {"dt": "2003-02-01T00:00:00", "Export Total": 61830.0}, {"dt": "2003-03-01T00:00:00", "Export Total": 70833.0}, {"dt": "2003-04-01T00:00:00", "Export Total": 69167.0}, {"dt": "2003-05-01T00:00:00", "Export Total": 69463.0}, {"dt": "2003-06-01T00:00:00", "Export Total": 71334.0}, {"dt": "2003-07-01T00:00:00", "Export Total": 71128.0}, {"dt": "2003-08-01T00:00:00", "Export Total": 71600.0}, {"dt": "2003-09-01T00:00:00", "Export Total": 69249.0}, {"dt": "2003-10-01T00:00:00", "Export Total": 77532.0}, {"dt": "2003-11-01T00:00:00", "Export Total": 69019.0}, {"dt": "2003-12-01T00:00:00", "Export Total": 66264.0}, {"dt": "2004-01-01T00:00:00", "Export Total": 66115.0}, {"dt": "2004-02-01T00:00:00", "Export Total": 72620.0}, {"dt": "2004-03-01T00:00:00", "Export Total": 74326.0}, {"dt": "2004-04-01T00:00:00", "Export Total": 77274.0}, {"dt": "2004-05-01T00:00:00", "Export Total": 78613.0}, {"dt": "2004-06-01T00:00:00", "Export Total": 73661.0}, {"dt": "2004-07-01T00:00:00", "Export Total": 73287.0}, {"dt": "2004-08-01T00:00:00", "Export Total": 83392.0}, {"dt": "2004-09-01T00:00:00", "Export Total": 66894.0}, {"dt": "2004-10-01T00:00:00", "Export Total": 81426.0}, {"dt": "2004-11-01T00:00:00", "Export Total": 78532.0}, {"dt": "2004-12-01T00:00:00", "Export Total": 73200.0}, {"dt": "2005-01-01T00:00:00", "Export Total": 79386.0}, {"dt": "2005-02-01T00:00:00", "Export Total": 75005.0}, {"dt": "2005-03-01T00:00:00", "Export Total": 81519.0}, {"dt": "2005-04-01T00:00:00", "Export Total": 82231.0}, {"dt": "2005-05-01T00:00:00", "Export Total": 79293.0}, {"dt": "2005-06-01T00:00:00", "Export Total": 79997.0}, {"dt": "2005-07-01T00:00:00", "Export Total": 86567.0}, {"dt": "2005-08-01T00:00:00", "Export Total": 86906.0}, {"dt": "2005-09-01T00:00:00", "Export Total": 88572.0}, {"dt": "2005-10-01T00:00:00", "Export Total": 100043.0}, {"dt": "2005-11-01T00:00:00", "Export Total": 90890.0}, {"dt": "2005-12-01T00:00:00", "Export Total": 84326.0}, {"dt": "2006-01-01T00:00:00", "Export Total": 94476.0}, {"dt": "2006-02-01T00:00:00", "Export Total": 87567.0}, {"dt": "2006-03-01T00:00:00", "Export Total": 99091.0}, {"dt": "2006-04-01T00:00:00", "Export Total": 92160.0}, {"dt": "2006-05-01T00:00:00", "Export Total": 101102.0}, {"dt": "2006-06-01T00:00:00", "Export Total": 98813.0}, {"dt": "2006-07-01T00:00:00", "Export Total": 99758.0}, {"dt": "2006-08-01T00:00:00", "Export Total": 101694.0}, {"dt": "2006-09-01T00:00:00", "Export Total": 105468.0}, {"dt": "2006-10-01T00:00:00", "Export Total": 112306.0}, {"dt": "2006-11-01T00:00:00", "Export Total": 101659.0}, {"dt": "2006-12-01T00:00:00", "Export Total": 101945.0}, {"dt": "2007-01-01T00:00:00", "Export Total": 95796.0}, {"dt": "2007-02-01T00:00:00", "Export Total": 101715.0}, {"dt": "2007-03-01T00:00:00", "Export Total": 114844.0}, {"dt": "2007-04-01T00:00:00", "Export Total": 112320.0}, {"dt": "2007-05-01T00:00:00", "Export Total": 121889.0}, {"dt": "2007-06-01T00:00:00", "Export Total": 115123.0}, {"dt": "2007-07-01T00:00:00", "Export Total": 123382.0}, {"dt": "2007-08-01T00:00:00", "Export Total": 128243.0}, {"dt": "2007-09-01T00:00:00", "Export Total": 133004.0}, {"dt": "2007-10-01T00:00:00", "Export Total": 128720.0}, {"dt": "2007-11-01T00:00:00", "Export Total": 120276.0}, {"dt": "2007-12-01T00:00:00", "Export Total": 108935.0}, {"dt": "2008-01-01T00:00:00", "Export Total": 116091.0}, {"dt": "2008-02-01T00:00:00", "Export Total": 114539.0}, {"dt": "2008-03-01T00:00:00", "Export Total": 116098.0}, {"dt": "2008-04-01T00:00:00", "Export Total": 115851.0}, {"dt": "2008-05-01T00:00:00", "Export Total": 112966.0}, {"dt": "2008-06-01T00:00:00", "Export Total": 111643.0}, {"dt": "2008-07-01T00:00:00", "Export Total": 114733.0}, {"dt": "2008-08-01T00:00:00", "Export Total": 120294.0}, {"dt": "2008-09-01T00:00:00", "Export Total": 122368.0}, {"dt": "2008-10-01T00:00:00", "Export Total": 125850.0}, {"dt": "2008-11-01T00:00:00", "Export Total": 118494.0}, {"dt": "2008-12-01T00:00:00", "Export Total": 100993.0}, {"dt": "2009-01-01T00:00:00", "Export Total": 99999.0}, {"dt": "2009-02-01T00:00:00", "Export Total": 89794.0}, {"dt": "2009-03-01T00:00:00", "Export Total": 94751.0}, {"dt": "2009-04-01T00:00:00", "Export Total": 98415.0}, {"dt": "2009-05-01T00:00:00", "Export Total": 99985.0}, {"dt": "2009-06-01T00:00:00", "Export Total": 97497.0}, {"dt": "2009-07-01T00:00:00", "Export Total": 110796.0}, {"dt": "2009-08-01T00:00:00", "Export Total": 110724.0}, {"dt": "2009-09-01T00:00:00", "Export Total": 102596.0}, {"dt": "2009-10-01T00:00:00", "Export Total": 123199.0}, {"dt": "2009-11-01T00:00:00", "Export Total": 105947.0}, {"dt": "2009-12-01T00:00:00", "Export Total": 112868.0}, {"dt": "2010-01-01T00:00:00", "Export Total": 116111.0}, {"dt": "2010-02-01T00:00:00", "Export Total": 108121.0}, {"dt": "2010-03-01T00:00:00", "Export Total": 115628.0}, {"dt": "2010-04-01T00:00:00", "Export Total": 126756.0}, {"dt": "2010-05-01T00:00:00", "Export Total": 121284.0}, {"dt": "2010-06-01T00:00:00", "Export Total": 127365.0}, {"dt": "2010-07-01T00:00:00", "Export Total": 133591.0}, {"dt": "2010-08-01T00:00:00", "Export Total": 129002.0}, {"dt": "2010-09-01T00:00:00", "Export Total": 126849.0}, {"dt": "2010-10-01T00:00:00", "Export Total": 144083.0}, {"dt": "2010-11-01T00:00:00", "Export Total": 121611.0}, {"dt": "2010-12-01T00:00:00", "Export Total": 118270.0}, {"dt": "2011-01-01T00:00:00", "Export Total": 125283.0}, {"dt": "2011-02-01T00:00:00", "Export Total": 123564.0}, {"dt": "2011-03-01T00:00:00", "Export Total": 129492.0}, {"dt": "2011-04-01T00:00:00", "Export Total": 137136.0}, {"dt": "2011-05-01T00:00:00", "Export Total": 133312.0}, {"dt": "2011-06-01T00:00:00", "Export Total": 130217.0}, {"dt": "2011-07-01T00:00:00", "Export Total": 140576.0}, {"dt": "2011-08-01T00:00:00", "Export Total": 126882.0}, {"dt": "2011-09-01T00:00:00", "Export Total": 143354.0}, {"dt": "2011-10-01T00:00:00", "Export Total": 137727.0}, {"dt": "2011-11-01T00:00:00", "Export Total": 127883.0}, {"dt": "2011-12-01T00:00:00", "Export Total": 118855.0}, {"dt": "2012-01-01T00:00:00", "Export Total": 129030.0}, {"dt": "2012-02-01T00:00:00", "Export Total": 122499.0}, {"dt": "2012-03-01T00:00:00", "Export Total": 141262.0}, {"dt": "2012-04-01T00:00:00", "Export Total": 128649.0}, {"dt": "2012-05-01T00:00:00", "Export Total": 139655.0}, {"dt": "2012-06-01T00:00:00", "Export Total": 139333.0}, {"dt": "2012-07-01T00:00:00", "Export Total": 132116.0}, {"dt": "2012-08-01T00:00:00", "Export Total": 143246.0}, {"dt": "2012-09-01T00:00:00", "Export Total": 137219.0}, {"dt": "2012-10-01T00:00:00", "Export Total": 127319.0}, {"dt": "2012-11-01T00:00:00", "Export Total": 123360.0}, {"dt": "2012-12-01T00:00:00", "Export Total": 118415.0}, {"dt": "2013-01-01T00:00:00", "Export Total": 118250.0}, {"dt": "2013-02-01T00:00:00", "Export Total": 127617.0}, {"dt": "2013-03-01T00:00:00", "Export Total": 127428.0}, {"dt": "2013-04-01T00:00:00", "Export Total": 134988.0}, {"dt": "2013-05-01T00:00:00", "Export Total": 137584.0}, {"dt": "2013-06-01T00:00:00", "Export Total": 140749.0}, {"dt": "2013-07-01T00:00:00", "Export Total": 130368.0}, {"dt": "2013-08-01T00:00:00", "Export Total": 146740.0}, {"dt": "2013-09-01T00:00:00", "Export Total": 134654.0}, {"dt": "2013-10-01T00:00:00", "Export Total": 151087.0}, {"dt": "2013-11-01T00:00:00", "Export Total": 129033.0}, {"dt": "2013-12-01T00:00:00", "Export Total": 125275.0}, {"dt": "2014-01-01T00:00:00", "Export Total": 132073.0}, {"dt": "2014-02-01T00:00:00", "Export Total": 128522.0}, {"dt": "2014-03-01T00:00:00", "Export Total": 138121.0}, {"dt": "2014-04-01T00:00:00", "Export Total": 142143.0}, {"dt": "2014-05-01T00:00:00", "Export Total": 148323.0}, {"dt": "2014-06-01T00:00:00", "Export Total": 141552.0}, {"dt": "2014-07-01T00:00:00", "Export Total": 149752.0}, {"dt": "2014-08-01T00:00:00", "Export Total": 155610.0}, {"dt": "2014-09-01T00:00:00", "Export Total": 156037.0}, {"dt": "2014-10-01T00:00:00", "Export Total": 160850.0}, {"dt": "2014-11-01T00:00:00", "Export Total": 142525.0}, {"dt": "2014-12-01T00:00:00", "Export Total": 145873.0}, {"dt": "2015-01-01T00:00:00", "Export Total": 145752.0}, {"dt": "2015-02-01T00:00:00", "Export Total": 146710.0}, {"dt": "2015-03-01T00:00:00", "Export Total": 161524.0}, {"dt": "2015-04-01T00:00:00", "Export Total": 175030.0}, {"dt": "2015-05-01T00:00:00", "Export Total": 170599.0}, {"dt": "2015-06-01T00:00:00", "Export Total": 174587.0}, {"dt": "2015-07-01T00:00:00", "Export Total": 167813.0}, {"dt": "2015-08-01T00:00:00", "Export Total": 162509.0}, {"dt": "2015-09-01T00:00:00", "Export Total": 165581.0}, {"dt": "2015-10-01T00:00:00", "Export Total": 165329.0}, {"dt": "2015-11-01T00:00:00", "Export Total": 147652.0}, {"dt": "2015-12-01T00:00:00", "Export Total": 135772.0}, {"dt": "2016-01-01T00:00:00", "Export Total": 140664.0}, {"dt": "2016-02-01T00:00:00", "Export Total": 151671.0}, {"dt": "2016-03-01T00:00:00", "Export Total": 154940.0}, {"dt": "2016-04-01T00:00:00", "Export Total": 152655.0}, {"dt": "2016-05-01T00:00:00", "Export Total": 161726.0}, {"dt": "2016-06-01T00:00:00", "Export Total": 145097.0}, {"dt": "2016-07-01T00:00:00", "Export Total": 157054.0}, {"dt": "2016-08-01T00:00:00", "Export Total": 165785.0}, {"dt": "2016-09-01T00:00:00", "Export Total": 147212.0}, {"dt": "2016-10-01T00:00:00", "Export Total": 151288.0}, {"dt": "2016-11-01T00:00:00", "Export Total": 149873.0}, {"dt": "2016-12-01T00:00:00", "Export Total": 148415.0}, {"dt": "2017-01-01T00:00:00", "Export Total": 163078.0}, {"dt": "2017-02-01T00:00:00", "Export Total": 167046.0}, {"dt": "2017-03-01T00:00:00", "Export Total": 158784.0}, {"dt": "2017-04-01T00:00:00", "Export Total": 169914.0}, {"dt": "2017-05-01T00:00:00", "Export Total": 176965.0}, {"dt": "2017-06-01T00:00:00", "Export Total": 174639.0}, {"dt": "2017-07-01T00:00:00", "Export Total": 166763.0}, {"dt": "2017-08-01T00:00:00", "Export Total": 175351.0}, {"dt": "2017-09-01T00:00:00", "Export Total": 149140.0}, {"dt": "2017-10-01T00:00:00", "Export Total": 210695.0}, {"dt": "2017-11-01T00:00:00", "Export Total": 158696.0}, {"dt": "2017-12-01T00:00:00", "Export Total": 168420.0}, {"dt": "2018-01-01T00:00:00", "Export Total": 160544.0}, {"dt": "2018-02-01T00:00:00", "Export Total": 166969.0}, {"dt": "2018-03-01T00:00:00", "Export Total": 182421.0}, {"dt": "2018-04-01T00:00:00", "Export Total": 179226.0}, {"dt": "2018-05-01T00:00:00", "Export Total": 185149.0}, {"dt": "2018-06-01T00:00:00", "Export Total": 185368.0}, {"dt": "2018-07-01T00:00:00", "Export Total": 190087.0}, {"dt": "2018-08-01T00:00:00", "Export Total": 187840.0}, {"dt": "2018-09-01T00:00:00", "Export Total": 184491.0}, {"dt": "2018-10-01T00:00:00", "Export Total": 204212.0}, {"dt": "2018-11-01T00:00:00", "Export Total": 171474.0}, {"dt": "2018-12-01T00:00:00", "Export Total": 172289.0}, {"dt": "2019-01-01T00:00:00", "Export Total": 218279.0}, {"dt": "2019-02-01T00:00:00", "Export Total": 157893.0}, {"dt": "2019-03-01T00:00:00", "Export Total": 214172.0}, {"dt": "2019-04-01T00:00:00", "Export Total": 181434.0}, {"dt": "2019-05-01T00:00:00", "Export Total": 185356.0}, {"dt": "2019-06-01T00:00:00", "Export Total": 188351.0}, {"dt": "2019-07-01T00:00:00", "Export Total": 184280.0}, {"dt": "2019-08-01T00:00:00", "Export Total": 214634.0}, {"dt": "2019-09-01T00:00:00", "Export Total": 177655.0}, {"dt": "2019-10-01T00:00:00", "Export Total": 221221.0}, {"dt": "2019-11-01T00:00:00", "Export Total": 181718.0}, {"dt": "2019-12-01T00:00:00", "Export Total": 179326.0}, {"dt": "2020-01-01T00:00:00", "Export Total": 181960.0}, {"dt": "2020-02-01T00:00:00", "Export Total": 183356.0}, {"dt": "2020-03-01T00:00:00", "Export Total": 173459.0}, {"dt": "2020-04-01T00:00:00", "Export Total": 163337.0}, {"dt": "2020-05-01T00:00:00", "Export Total": 174935.0}, {"dt": "2020-06-01T00:00:00", "Export Total": 169781.0}, {"dt": "2020-07-01T00:00:00", "Export Total": 167640.0}, {"dt": "2020-08-01T00:00:00", "Export Total": 208280.0}, {"dt": "2020-09-01T00:00:00", "Export Total": 195221.0}, {"dt": "2020-10-01T00:00:00", "Export Total": 225026.0}, {"dt": "2020-11-01T00:00:00", "Export Total": 225063.0}, {"dt": "2020-12-01T00:00:00", "Export Total": 217586.0}, {"dt": "2021-01-01T00:00:00", "Export Total": 223464.0}, {"dt": "2021-02-01T00:00:00", "Export Total": 197455.0}, {"dt": "2021-03-01T00:00:00", "Export Total": 242543.0}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_ga_ts</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Georgia&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Export Empty&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[26]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-28aaa5d878c74d6aa7b9808e961e318e"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-28aaa5d878c74d6aa7b9808e961e318e") {
      outputDiv = document.getElementById("altair-viz-28aaa5d878c74d6aa7b9808e961e318e");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector016"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Georgia Export Empty Container Volume", "transform": [{"window": [{"op": "lag", "field": "Export Empty", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Export Empty'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt"}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Export Empty"}}, "height": 100, "selection": {"selector016": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-83eae90716b7028d02fe507e268b4d12"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-83eae90716b7028d02fe507e268b4d12": [{"dt": "2003-01-01T00:00:00", "Export Empty": 20689.0}, {"dt": "2003-02-01T00:00:00", "Export Empty": 16955.0}, {"dt": "2003-03-01T00:00:00", "Export Empty": 19190.0}, {"dt": "2003-04-01T00:00:00", "Export Empty": 21026.0}, {"dt": "2003-05-01T00:00:00", "Export Empty": 23455.0}, {"dt": "2003-06-01T00:00:00", "Export Empty": 23283.0}, {"dt": "2003-07-01T00:00:00", "Export Empty": 21637.0}, {"dt": "2003-08-01T00:00:00", "Export Empty": 26996.0}, {"dt": "2003-09-01T00:00:00", "Export Empty": 25930.0}, {"dt": "2003-10-01T00:00:00", "Export Empty": 29903.0}, {"dt": "2003-11-01T00:00:00", "Export Empty": 22206.0}, {"dt": "2003-12-01T00:00:00", "Export Empty": 13515.0}, {"dt": "2004-01-01T00:00:00", "Export Empty": 14219.0}, {"dt": "2004-02-01T00:00:00", "Export Empty": 16475.0}, {"dt": "2004-03-01T00:00:00", "Export Empty": 16205.0}, {"dt": "2004-04-01T00:00:00", "Export Empty": 17277.0}, {"dt": "2004-05-01T00:00:00", "Export Empty": 19431.0}, {"dt": "2004-06-01T00:00:00", "Export Empty": 22398.0}, {"dt": "2004-07-01T00:00:00", "Export Empty": 22087.0}, {"dt": "2004-08-01T00:00:00", "Export Empty": 27548.0}, {"dt": "2004-09-01T00:00:00", "Export Empty": 21751.0}, {"dt": "2004-10-01T00:00:00", "Export Empty": 25548.0}, {"dt": "2004-11-01T00:00:00", "Export Empty": 27565.0}, {"dt": "2004-12-01T00:00:00", "Export Empty": 19331.0}, {"dt": "2005-01-01T00:00:00", "Export Empty": 21150.0}, {"dt": "2005-02-01T00:00:00", "Export Empty": 18838.0}, {"dt": "2005-03-01T00:00:00", "Export Empty": 21594.0}, {"dt": "2005-04-01T00:00:00", "Export Empty": 21054.0}, {"dt": "2005-05-01T00:00:00", "Export Empty": 19047.0}, {"dt": "2005-06-01T00:00:00", "Export Empty": 21861.0}, {"dt": "2005-07-01T00:00:00", "Export Empty": 24002.0}, {"dt": "2005-08-01T00:00:00", "Export Empty": 27275.0}, {"dt": "2005-09-01T00:00:00", "Export Empty": 31446.0}, {"dt": "2005-10-01T00:00:00", "Export Empty": 38104.0}, {"dt": "2005-11-01T00:00:00", "Export Empty": 37335.0}, {"dt": "2005-12-01T00:00:00", "Export Empty": 26486.0}, {"dt": "2006-01-01T00:00:00", "Export Empty": 30848.0}, {"dt": "2006-02-01T00:00:00", "Export Empty": 28310.0}, {"dt": "2006-03-01T00:00:00", "Export Empty": 27243.0}, {"dt": "2006-04-01T00:00:00", "Export Empty": 26267.0}, {"dt": "2006-05-01T00:00:00", "Export Empty": 35420.0}, {"dt": "2006-06-01T00:00:00", "Export Empty": 32449.0}, {"dt": "2006-07-01T00:00:00", "Export Empty": 32724.0}, {"dt": "2006-08-01T00:00:00", "Export Empty": 39746.0}, {"dt": "2006-09-01T00:00:00", "Export Empty": 40869.0}, {"dt": "2006-10-01T00:00:00", "Export Empty": 46810.0}, {"dt": "2006-11-01T00:00:00", "Export Empty": 40410.0}, {"dt": "2006-12-01T00:00:00", "Export Empty": 32497.0}, {"dt": "2007-01-01T00:00:00", "Export Empty": 30385.0}, {"dt": "2007-02-01T00:00:00", "Export Empty": 28980.0}, {"dt": "2007-03-01T00:00:00", "Export Empty": 34729.0}, {"dt": "2007-04-01T00:00:00", "Export Empty": 29539.0}, {"dt": "2007-05-01T00:00:00", "Export Empty": 33549.0}, {"dt": "2007-06-01T00:00:00", "Export Empty": 28575.0}, {"dt": "2007-07-01T00:00:00", "Export Empty": 34539.0}, {"dt": "2007-08-01T00:00:00", "Export Empty": 39525.0}, {"dt": "2007-09-01T00:00:00", "Export Empty": 43103.0}, {"dt": "2007-10-01T00:00:00", "Export Empty": 39680.0}, {"dt": "2007-11-01T00:00:00", "Export Empty": 33938.0}, {"dt": "2007-12-01T00:00:00", "Export Empty": 22334.0}, {"dt": "2008-01-01T00:00:00", "Export Empty": 25934.0}, {"dt": "2008-02-01T00:00:00", "Export Empty": 24422.0}, {"dt": "2008-03-01T00:00:00", "Export Empty": 22193.0}, {"dt": "2008-04-01T00:00:00", "Export Empty": 22617.0}, {"dt": "2008-05-01T00:00:00", "Export Empty": 18416.0}, {"dt": "2008-06-01T00:00:00", "Export Empty": 17647.0}, {"dt": "2008-07-01T00:00:00", "Export Empty": 18190.0}, {"dt": "2008-08-01T00:00:00", "Export Empty": 21421.0}, {"dt": "2008-09-01T00:00:00", "Export Empty": 23589.0}, {"dt": "2008-10-01T00:00:00", "Export Empty": 39372.0}, {"dt": "2008-11-01T00:00:00", "Export Empty": 39277.0}, {"dt": "2008-12-01T00:00:00", "Export Empty": 33897.0}, {"dt": "2009-01-01T00:00:00", "Export Empty": 33690.0}, {"dt": "2009-02-01T00:00:00", "Export Empty": 23181.0}, {"dt": "2009-03-01T00:00:00", "Export Empty": 15684.0}, {"dt": "2009-04-01T00:00:00", "Export Empty": 17161.0}, {"dt": "2009-05-01T00:00:00", "Export Empty": 16941.0}, {"dt": "2009-06-01T00:00:00", "Export Empty": 13370.0}, {"dt": "2009-07-01T00:00:00", "Export Empty": 18963.0}, {"dt": "2009-08-01T00:00:00", "Export Empty": 16829.0}, {"dt": "2009-09-01T00:00:00", "Export Empty": 14460.0}, {"dt": "2009-10-01T00:00:00", "Export Empty": 20605.0}, {"dt": "2009-11-01T00:00:00", "Export Empty": 14525.0}, {"dt": "2009-12-01T00:00:00", "Export Empty": 14358.0}, {"dt": "2010-01-01T00:00:00", "Export Empty": 20412.0}, {"dt": "2010-02-01T00:00:00", "Export Empty": 20451.0}, {"dt": "2010-03-01T00:00:00", "Export Empty": 17930.0}, {"dt": "2010-04-01T00:00:00", "Export Empty": 23573.0}, {"dt": "2010-05-01T00:00:00", "Export Empty": 29217.0}, {"dt": "2010-06-01T00:00:00", "Export Empty": 30088.0}, {"dt": "2010-07-01T00:00:00", "Export Empty": 32332.0}, {"dt": "2010-08-01T00:00:00", "Export Empty": 34777.0}, {"dt": "2010-09-01T00:00:00", "Export Empty": 37796.0}, {"dt": "2010-10-01T00:00:00", "Export Empty": 39503.0}, {"dt": "2010-11-01T00:00:00", "Export Empty": 27922.0}, {"dt": "2010-12-01T00:00:00", "Export Empty": 25455.0}, {"dt": "2011-01-01T00:00:00", "Export Empty": 18681.0}, {"dt": "2011-02-01T00:00:00", "Export Empty": 20296.0}, {"dt": "2011-03-01T00:00:00", "Export Empty": 17541.0}, {"dt": "2011-04-01T00:00:00", "Export Empty": 25772.0}, {"dt": "2011-05-01T00:00:00", "Export Empty": 25562.0}, {"dt": "2011-06-01T00:00:00", "Export Empty": 30477.0}, {"dt": "2011-07-01T00:00:00", "Export Empty": 36104.0}, {"dt": "2011-08-01T00:00:00", "Export Empty": 29663.0}, {"dt": "2011-09-01T00:00:00", "Export Empty": 37907.0}, {"dt": "2011-10-01T00:00:00", "Export Empty": 35901.0}, {"dt": "2011-11-01T00:00:00", "Export Empty": 34221.0}, {"dt": "2011-12-01T00:00:00", "Export Empty": 20877.0}, {"dt": "2012-01-01T00:00:00", "Export Empty": 22554.0}, {"dt": "2012-02-01T00:00:00", "Export Empty": 18387.0}, {"dt": "2012-03-01T00:00:00", "Export Empty": 22264.0}, {"dt": "2012-04-01T00:00:00", "Export Empty": 22634.0}, {"dt": "2012-05-01T00:00:00", "Export Empty": 29618.0}, {"dt": "2012-06-01T00:00:00", "Export Empty": 27190.0}, {"dt": "2012-07-01T00:00:00", "Export Empty": 32118.0}, {"dt": "2012-08-01T00:00:00", "Export Empty": 37341.0}, {"dt": "2012-09-01T00:00:00", "Export Empty": 36889.0}, {"dt": "2012-10-01T00:00:00", "Export Empty": 37501.0}, {"dt": "2012-11-01T00:00:00", "Export Empty": 27679.0}, {"dt": "2012-12-01T00:00:00", "Export Empty": 17761.0}, {"dt": "2013-01-01T00:00:00", "Export Empty": 22643.0}, {"dt": "2013-02-01T00:00:00", "Export Empty": 19122.0}, {"dt": "2013-03-01T00:00:00", "Export Empty": 18952.0}, {"dt": "2013-04-01T00:00:00", "Export Empty": 26032.0}, {"dt": "2013-05-01T00:00:00", "Export Empty": 33672.0}, {"dt": "2013-06-01T00:00:00", "Export Empty": 35060.0}, {"dt": "2013-07-01T00:00:00", "Export Empty": 33351.0}, {"dt": "2013-08-01T00:00:00", "Export Empty": 37926.0}, {"dt": "2013-09-01T00:00:00", "Export Empty": 32778.0}, {"dt": "2013-10-01T00:00:00", "Export Empty": 43253.0}, {"dt": "2013-11-01T00:00:00", "Export Empty": 24906.0}, {"dt": "2013-12-01T00:00:00", "Export Empty": 26955.0}, {"dt": "2014-01-01T00:00:00", "Export Empty": 24064.0}, {"dt": "2014-02-01T00:00:00", "Export Empty": 23036.0}, {"dt": "2014-03-01T00:00:00", "Export Empty": 24842.0}, {"dt": "2014-04-01T00:00:00", "Export Empty": 28317.0}, {"dt": "2014-05-01T00:00:00", "Export Empty": 33828.0}, {"dt": "2014-06-01T00:00:00", "Export Empty": 37589.0}, {"dt": "2014-07-01T00:00:00", "Export Empty": 41382.0}, {"dt": "2014-08-01T00:00:00", "Export Empty": 48864.0}, {"dt": "2014-09-01T00:00:00", "Export Empty": 51507.0}, {"dt": "2014-10-01T00:00:00", "Export Empty": 50021.0}, {"dt": "2014-11-01T00:00:00", "Export Empty": 41203.0}, {"dt": "2014-12-01T00:00:00", "Export Empty": 37699.0}, {"dt": "2015-01-01T00:00:00", "Export Empty": 41629.0}, {"dt": "2015-02-01T00:00:00", "Export Empty": 40365.0}, {"dt": "2015-03-01T00:00:00", "Export Empty": 50153.0}, {"dt": "2015-04-01T00:00:00", "Export Empty": 56706.0}, {"dt": "2015-05-01T00:00:00", "Export Empty": 59880.0}, {"dt": "2015-06-01T00:00:00", "Export Empty": 66175.0}, {"dt": "2015-07-01T00:00:00", "Export Empty": 67637.0}, {"dt": "2015-08-01T00:00:00", "Export Empty": 61845.0}, {"dt": "2015-09-01T00:00:00", "Export Empty": 64894.0}, {"dt": "2015-10-01T00:00:00", "Export Empty": 62354.0}, {"dt": "2015-11-01T00:00:00", "Export Empty": 50110.0}, {"dt": "2015-12-01T00:00:00", "Export Empty": 45641.0}, {"dt": "2016-01-01T00:00:00", "Export Empty": 39939.0}, {"dt": "2016-02-01T00:00:00", "Export Empty": 45926.0}, {"dt": "2016-03-01T00:00:00", "Export Empty": 42682.0}, {"dt": "2016-04-01T00:00:00", "Export Empty": 41426.0}, {"dt": "2016-05-01T00:00:00", "Export Empty": 50039.0}, {"dt": "2016-06-01T00:00:00", "Export Empty": 40102.0}, {"dt": "2016-07-01T00:00:00", "Export Empty": 53732.0}, {"dt": "2016-08-01T00:00:00", "Export Empty": 56567.0}, {"dt": "2016-09-01T00:00:00", "Export Empty": 43996.0}, {"dt": "2016-10-01T00:00:00", "Export Empty": 50652.0}, {"dt": "2016-11-01T00:00:00", "Export Empty": 42728.0}, {"dt": "2016-12-01T00:00:00", "Export Empty": 44322.0}, {"dt": "2017-01-01T00:00:00", "Export Empty": 45689.0}, {"dt": "2017-02-01T00:00:00", "Export Empty": 47956.0}, {"dt": "2017-03-01T00:00:00", "Export Empty": 39132.0}, {"dt": "2017-04-01T00:00:00", "Export Empty": 55360.0}, {"dt": "2017-05-01T00:00:00", "Export Empty": 59704.0}, {"dt": "2017-06-01T00:00:00", "Export Empty": 61794.0}, {"dt": "2017-07-01T00:00:00", "Export Empty": 60646.0}, {"dt": "2017-08-01T00:00:00", "Export Empty": 66108.0}, {"dt": "2017-09-01T00:00:00", "Export Empty": 52820.0}, {"dt": "2017-10-01T00:00:00", "Export Empty": 82291.0}, {"dt": "2017-11-01T00:00:00", "Export Empty": 45418.0}, {"dt": "2017-12-01T00:00:00", "Export Empty": 50120.0}, {"dt": "2018-01-01T00:00:00", "Export Empty": 53045.0}, {"dt": "2018-02-01T00:00:00", "Export Empty": 46235.0}, {"dt": "2018-03-01T00:00:00", "Export Empty": 49599.0}, {"dt": "2018-04-01T00:00:00", "Export Empty": 37872.0}, {"dt": "2018-05-01T00:00:00", "Export Empty": 48897.0}, {"dt": "2018-06-01T00:00:00", "Export Empty": 60546.0}, {"dt": "2018-07-01T00:00:00", "Export Empty": 71216.0}, {"dt": "2018-08-01T00:00:00", "Export Empty": 66258.0}, {"dt": "2018-09-01T00:00:00", "Export Empty": 71164.0}, {"dt": "2018-10-01T00:00:00", "Export Empty": 83817.0}, {"dt": "2018-11-01T00:00:00", "Export Empty": 63235.0}, {"dt": "2018-12-01T00:00:00", "Export Empty": 73782.0}, {"dt": "2019-01-01T00:00:00", "Export Empty": 93907.0}, {"dt": "2019-02-01T00:00:00", "Export Empty": 52633.0}, {"dt": "2019-03-01T00:00:00", "Export Empty": 59089.0}, {"dt": "2019-04-01T00:00:00", "Export Empty": 51707.0}, {"dt": "2019-05-01T00:00:00", "Export Empty": 58461.0}, {"dt": "2019-06-01T00:00:00", "Export Empty": 69056.0}, {"dt": "2019-07-01T00:00:00", "Export Empty": 66491.0}, {"dt": "2019-08-01T00:00:00", "Export Empty": 89076.0}, {"dt": "2019-09-01T00:00:00", "Export Empty": 69683.0}, {"dt": "2019-10-01T00:00:00", "Export Empty": 93250.0}, {"dt": "2019-11-01T00:00:00", "Export Empty": 62592.0}, {"dt": "2019-12-01T00:00:00", "Export Empty": 68002.0}, {"dt": "2020-01-01T00:00:00", "Export Empty": 60000.0}, {"dt": "2020-02-01T00:00:00", "Export Empty": 57404.0}, {"dt": "2020-03-01T00:00:00", "Export Empty": 36685.0}, {"dt": "2020-04-01T00:00:00", "Export Empty": 42486.0}, {"dt": "2020-05-01T00:00:00", "Export Empty": 52664.0}, {"dt": "2020-06-01T00:00:00", "Export Empty": 52357.0}, {"dt": "2020-07-01T00:00:00", "Export Empty": 55175.0}, {"dt": "2020-08-01T00:00:00", "Export Empty": 92615.0}, {"dt": "2020-09-01T00:00:00", "Export Empty": 89992.0}, {"dt": "2020-10-01T00:00:00", "Export Empty": 107878.0}, {"dt": "2020-11-01T00:00:00", "Export Empty": 111707.0}, {"dt": "2020-12-01T00:00:00", "Export Empty": 111791.0}, {"dt": "2021-01-01T00:00:00", "Export Empty": 110099.0}, {"dt": "2021-02-01T00:00:00", "Export Empty": 86410.0}, {"dt": "2021-03-01T00:00:00", "Export Empty": 107260.0}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[27]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_ga_ts</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Georgia&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Export Full&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[27]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-1f0a08ab21d046698e2a4fa0e98d6243"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-1f0a08ab21d046698e2a4fa0e98d6243") {
      outputDiv = document.getElementById("altair-viz-1f0a08ab21d046698e2a4fa0e98d6243");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector017"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Georgia Export Full Container Volume", "transform": [{"window": [{"op": "lag", "field": "Export Full", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Export Full'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt"}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Export Full"}}, "height": 100, "selection": {"selector017": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-8ce708fc3639dfa7fd7b8f19b96fd1df"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-8ce708fc3639dfa7fd7b8f19b96fd1df": [{"dt": "2003-01-01T00:00:00", "Export Full": 46884.0}, {"dt": "2003-02-01T00:00:00", "Export Full": 44875.0}, {"dt": "2003-03-01T00:00:00", "Export Full": 51643.0}, {"dt": "2003-04-01T00:00:00", "Export Full": 48141.0}, {"dt": "2003-05-01T00:00:00", "Export Full": 46008.0}, {"dt": "2003-06-01T00:00:00", "Export Full": 48051.0}, {"dt": "2003-07-01T00:00:00", "Export Full": 49491.0}, {"dt": "2003-08-01T00:00:00", "Export Full": 44605.0}, {"dt": "2003-09-01T00:00:00", "Export Full": 43319.0}, {"dt": "2003-10-01T00:00:00", "Export Full": 47629.0}, {"dt": "2003-11-01T00:00:00", "Export Full": 46814.0}, {"dt": "2003-12-01T00:00:00", "Export Full": 52750.0}, {"dt": "2004-01-01T00:00:00", "Export Full": 51896.0}, {"dt": "2004-02-01T00:00:00", "Export Full": 56145.0}, {"dt": "2004-03-01T00:00:00", "Export Full": 58121.0}, {"dt": "2004-04-01T00:00:00", "Export Full": 59997.0}, {"dt": "2004-05-01T00:00:00", "Export Full": 59182.0}, {"dt": "2004-06-01T00:00:00", "Export Full": 51263.0}, {"dt": "2004-07-01T00:00:00", "Export Full": 51200.0}, {"dt": "2004-08-01T00:00:00", "Export Full": 55844.0}, {"dt": "2004-09-01T00:00:00", "Export Full": 45143.0}, {"dt": "2004-10-01T00:00:00", "Export Full": 55879.0}, {"dt": "2004-11-01T00:00:00", "Export Full": 50967.0}, {"dt": "2004-12-01T00:00:00", "Export Full": 53869.0}, {"dt": "2005-01-01T00:00:00", "Export Full": 58236.0}, {"dt": "2005-02-01T00:00:00", "Export Full": 56167.0}, {"dt": "2005-03-01T00:00:00", "Export Full": 59925.0}, {"dt": "2005-04-01T00:00:00", "Export Full": 61176.0}, {"dt": "2005-05-01T00:00:00", "Export Full": 60246.0}, {"dt": "2005-06-01T00:00:00", "Export Full": 58136.0}, {"dt": "2005-07-01T00:00:00", "Export Full": 62566.0}, {"dt": "2005-08-01T00:00:00", "Export Full": 59631.0}, {"dt": "2005-09-01T00:00:00", "Export Full": 57127.0}, {"dt": "2005-10-01T00:00:00", "Export Full": 61939.0}, {"dt": "2005-11-01T00:00:00", "Export Full": 53555.0}, {"dt": "2005-12-01T00:00:00", "Export Full": 57840.0}, {"dt": "2006-01-01T00:00:00", "Export Full": 63628.0}, {"dt": "2006-02-01T00:00:00", "Export Full": 59258.0}, {"dt": "2006-03-01T00:00:00", "Export Full": 71847.0}, {"dt": "2006-04-01T00:00:00", "Export Full": 65893.0}, {"dt": "2006-05-01T00:00:00", "Export Full": 65682.0}, {"dt": "2006-06-01T00:00:00", "Export Full": 66364.0}, {"dt": "2006-07-01T00:00:00", "Export Full": 67033.0}, {"dt": "2006-08-01T00:00:00", "Export Full": 61948.0}, {"dt": "2006-09-01T00:00:00", "Export Full": 64599.0}, {"dt": "2006-10-01T00:00:00", "Export Full": 65496.0}, {"dt": "2006-11-01T00:00:00", "Export Full": 61249.0}, {"dt": "2006-12-01T00:00:00", "Export Full": 69448.0}, {"dt": "2007-01-01T00:00:00", "Export Full": 65411.0}, {"dt": "2007-02-01T00:00:00", "Export Full": 72735.0}, {"dt": "2007-03-01T00:00:00", "Export Full": 80116.0}, {"dt": "2007-04-01T00:00:00", "Export Full": 82781.0}, {"dt": "2007-05-01T00:00:00", "Export Full": 88340.0}, {"dt": "2007-06-01T00:00:00", "Export Full": 86548.0}, {"dt": "2007-07-01T00:00:00", "Export Full": 88843.0}, {"dt": "2007-08-01T00:00:00", "Export Full": 88718.0}, {"dt": "2007-09-01T00:00:00", "Export Full": 89901.0}, {"dt": "2007-10-01T00:00:00", "Export Full": 89040.0}, {"dt": "2007-11-01T00:00:00", "Export Full": 86338.0}, {"dt": "2007-12-01T00:00:00", "Export Full": 86601.0}, {"dt": "2008-01-01T00:00:00", "Export Full": 90158.0}, {"dt": "2008-02-01T00:00:00", "Export Full": 90117.0}, {"dt": "2008-03-01T00:00:00", "Export Full": 93905.0}, {"dt": "2008-04-01T00:00:00", "Export Full": 93234.0}, {"dt": "2008-05-01T00:00:00", "Export Full": 94551.0}, {"dt": "2008-06-01T00:00:00", "Export Full": 93997.0}, {"dt": "2008-07-01T00:00:00", "Export Full": 96543.0}, {"dt": "2008-08-01T00:00:00", "Export Full": 98873.0}, {"dt": "2008-09-01T00:00:00", "Export Full": 98779.0}, {"dt": "2008-10-01T00:00:00", "Export Full": 86478.0}, {"dt": "2008-11-01T00:00:00", "Export Full": 79217.0}, {"dt": "2008-12-01T00:00:00", "Export Full": 67097.0}, {"dt": "2009-01-01T00:00:00", "Export Full": 66309.0}, {"dt": "2009-02-01T00:00:00", "Export Full": 66612.0}, {"dt": "2009-03-01T00:00:00", "Export Full": 79067.0}, {"dt": "2009-04-01T00:00:00", "Export Full": 81254.0}, {"dt": "2009-05-01T00:00:00", "Export Full": 83043.0}, {"dt": "2009-06-01T00:00:00", "Export Full": 84127.0}, {"dt": "2009-07-01T00:00:00", "Export Full": 91832.0}, {"dt": "2009-08-01T00:00:00", "Export Full": 93895.0}, {"dt": "2009-09-01T00:00:00", "Export Full": 88136.0}, {"dt": "2009-10-01T00:00:00", "Export Full": 102595.0}, {"dt": "2009-11-01T00:00:00", "Export Full": 91422.0}, {"dt": "2009-12-01T00:00:00", "Export Full": 98509.0}, {"dt": "2010-01-01T00:00:00", "Export Full": 95699.0}, {"dt": "2010-02-01T00:00:00", "Export Full": 87670.0}, {"dt": "2010-03-01T00:00:00", "Export Full": 97698.0}, {"dt": "2010-04-01T00:00:00", "Export Full": 103184.0}, {"dt": "2010-05-01T00:00:00", "Export Full": 92067.0}, {"dt": "2010-06-01T00:00:00", "Export Full": 97277.0}, {"dt": "2010-07-01T00:00:00", "Export Full": 101259.0}, {"dt": "2010-08-01T00:00:00", "Export Full": 94226.0}, {"dt": "2010-09-01T00:00:00", "Export Full": 89053.0}, {"dt": "2010-10-01T00:00:00", "Export Full": 104580.0}, {"dt": "2010-11-01T00:00:00", "Export Full": 93689.0}, {"dt": "2010-12-01T00:00:00", "Export Full": 92815.0}, {"dt": "2011-01-01T00:00:00", "Export Full": 106602.0}, {"dt": "2011-02-01T00:00:00", "Export Full": 103268.0}, {"dt": "2011-03-01T00:00:00", "Export Full": 111951.0}, {"dt": "2011-04-01T00:00:00", "Export Full": 111364.0}, {"dt": "2011-05-01T00:00:00", "Export Full": 107750.0}, {"dt": "2011-06-01T00:00:00", "Export Full": 99740.0}, {"dt": "2011-07-01T00:00:00", "Export Full": 104472.0}, {"dt": "2011-08-01T00:00:00", "Export Full": 97219.0}, {"dt": "2011-09-01T00:00:00", "Export Full": 105447.0}, {"dt": "2011-10-01T00:00:00", "Export Full": 101826.0}, {"dt": "2011-11-01T00:00:00", "Export Full": 93661.0}, {"dt": "2011-12-01T00:00:00", "Export Full": 97978.0}, {"dt": "2012-01-01T00:00:00", "Export Full": 106475.0}, {"dt": "2012-02-01T00:00:00", "Export Full": 104113.0}, {"dt": "2012-03-01T00:00:00", "Export Full": 118999.0}, {"dt": "2012-04-01T00:00:00", "Export Full": 106015.0}, {"dt": "2012-05-01T00:00:00", "Export Full": 110038.0}, {"dt": "2012-06-01T00:00:00", "Export Full": 112144.0}, {"dt": "2012-07-01T00:00:00", "Export Full": 99999.0}, {"dt": "2012-08-01T00:00:00", "Export Full": 105906.0}, {"dt": "2012-09-01T00:00:00", "Export Full": 100329.0}, {"dt": "2012-10-01T00:00:00", "Export Full": 89819.0}, {"dt": "2012-11-01T00:00:00", "Export Full": 95681.0}, {"dt": "2012-12-01T00:00:00", "Export Full": 100654.0}, {"dt": "2013-01-01T00:00:00", "Export Full": 95607.0}, {"dt": "2013-02-01T00:00:00", "Export Full": 108495.0}, {"dt": "2013-03-01T00:00:00", "Export Full": 108476.0}, {"dt": "2013-04-01T00:00:00", "Export Full": 108956.0}, {"dt": "2013-05-01T00:00:00", "Export Full": 103913.0}, {"dt": "2013-06-01T00:00:00", "Export Full": 105689.0}, {"dt": "2013-07-01T00:00:00", "Export Full": 97017.0}, {"dt": "2013-08-01T00:00:00", "Export Full": 108814.0}, {"dt": "2013-09-01T00:00:00", "Export Full": 101876.0}, {"dt": "2013-10-01T00:00:00", "Export Full": 107834.0}, {"dt": "2013-11-01T00:00:00", "Export Full": 104127.0}, {"dt": "2013-12-01T00:00:00", "Export Full": 98320.0}, {"dt": "2014-01-01T00:00:00", "Export Full": 108009.0}, {"dt": "2014-02-01T00:00:00", "Export Full": 105486.0}, {"dt": "2014-03-01T00:00:00", "Export Full": 113279.0}, {"dt": "2014-04-01T00:00:00", "Export Full": 113826.0}, {"dt": "2014-05-01T00:00:00", "Export Full": 114496.0}, {"dt": "2014-06-01T00:00:00", "Export Full": 103964.0}, {"dt": "2014-07-01T00:00:00", "Export Full": 108371.0}, {"dt": "2014-08-01T00:00:00", "Export Full": 106746.0}, {"dt": "2014-09-01T00:00:00", "Export Full": 104530.0}, {"dt": "2014-10-01T00:00:00", "Export Full": 110829.0}, {"dt": "2014-11-01T00:00:00", "Export Full": 101322.0}, {"dt": "2014-12-01T00:00:00", "Export Full": 108174.0}, {"dt": "2015-01-01T00:00:00", "Export Full": 104122.0}, {"dt": "2015-02-01T00:00:00", "Export Full": 106345.0}, {"dt": "2015-03-01T00:00:00", "Export Full": 111371.0}, {"dt": "2015-04-01T00:00:00", "Export Full": 118324.0}, {"dt": "2015-05-01T00:00:00", "Export Full": 110719.0}, {"dt": "2015-06-01T00:00:00", "Export Full": 108412.0}, {"dt": "2015-07-01T00:00:00", "Export Full": 100176.0}, {"dt": "2015-08-01T00:00:00", "Export Full": 100664.0}, {"dt": "2015-09-01T00:00:00", "Export Full": 100687.0}, {"dt": "2015-10-01T00:00:00", "Export Full": 102975.0}, {"dt": "2015-11-01T00:00:00", "Export Full": 97542.0}, {"dt": "2015-12-01T00:00:00", "Export Full": 90131.0}, {"dt": "2016-01-01T00:00:00", "Export Full": 100725.0}, {"dt": "2016-02-01T00:00:00", "Export Full": 105745.0}, {"dt": "2016-03-01T00:00:00", "Export Full": 112259.0}, {"dt": "2016-04-01T00:00:00", "Export Full": 111229.0}, {"dt": "2016-05-01T00:00:00", "Export Full": 111687.0}, {"dt": "2016-06-01T00:00:00", "Export Full": 104995.0}, {"dt": "2016-07-01T00:00:00", "Export Full": 103322.0}, {"dt": "2016-08-01T00:00:00", "Export Full": 109218.0}, {"dt": "2016-09-01T00:00:00", "Export Full": 103217.0}, {"dt": "2016-10-01T00:00:00", "Export Full": 100636.0}, {"dt": "2016-11-01T00:00:00", "Export Full": 107145.0}, {"dt": "2016-12-01T00:00:00", "Export Full": 104094.0}, {"dt": "2017-01-01T00:00:00", "Export Full": 117390.0}, {"dt": "2017-02-01T00:00:00", "Export Full": 119090.0}, {"dt": "2017-03-01T00:00:00", "Export Full": 119652.0}, {"dt": "2017-04-01T00:00:00", "Export Full": 114554.0}, {"dt": "2017-05-01T00:00:00", "Export Full": 117261.0}, {"dt": "2017-06-01T00:00:00", "Export Full": 112845.0}, {"dt": "2017-07-01T00:00:00", "Export Full": 106117.0}, {"dt": "2017-08-01T00:00:00", "Export Full": 109243.0}, {"dt": "2017-09-01T00:00:00", "Export Full": 96320.0}, {"dt": "2017-10-01T00:00:00", "Export Full": 128403.0}, {"dt": "2017-11-01T00:00:00", "Export Full": 113278.0}, {"dt": "2017-12-01T00:00:00", "Export Full": 118300.0}, {"dt": "2018-01-01T00:00:00", "Export Full": 107499.0}, {"dt": "2018-02-01T00:00:00", "Export Full": 120734.0}, {"dt": "2018-03-01T00:00:00", "Export Full": 132822.0}, {"dt": "2018-04-01T00:00:00", "Export Full": 141353.0}, {"dt": "2018-05-01T00:00:00", "Export Full": 136252.0}, {"dt": "2018-06-01T00:00:00", "Export Full": 124822.0}, {"dt": "2018-07-01T00:00:00", "Export Full": 118871.0}, {"dt": "2018-08-01T00:00:00", "Export Full": 121582.0}, {"dt": "2018-09-01T00:00:00", "Export Full": 113328.0}, {"dt": "2018-10-01T00:00:00", "Export Full": 120395.0}, {"dt": "2018-11-01T00:00:00", "Export Full": 108240.0}, {"dt": "2018-12-01T00:00:00", "Export Full": 98507.0}, {"dt": "2019-01-01T00:00:00", "Export Full": 124373.0}, {"dt": "2019-02-01T00:00:00", "Export Full": 105260.0}, {"dt": "2019-03-01T00:00:00", "Export Full": 155083.0}, {"dt": "2019-04-01T00:00:00", "Export Full": 129726.0}, {"dt": "2019-05-01T00:00:00", "Export Full": 126895.0}, {"dt": "2019-06-01T00:00:00", "Export Full": 119295.0}, {"dt": "2019-07-01T00:00:00", "Export Full": 117790.0}, {"dt": "2019-08-01T00:00:00", "Export Full": 125558.0}, {"dt": "2019-09-01T00:00:00", "Export Full": 107972.0}, {"dt": "2019-10-01T00:00:00", "Export Full": 127971.0}, {"dt": "2019-11-01T00:00:00", "Export Full": 119126.0}, {"dt": "2019-12-01T00:00:00", "Export Full": 111324.0}, {"dt": "2020-01-01T00:00:00", "Export Full": 121960.0}, {"dt": "2020-02-01T00:00:00", "Export Full": 125953.0}, {"dt": "2020-03-01T00:00:00", "Export Full": 136774.0}, {"dt": "2020-04-01T00:00:00", "Export Full": 120852.0}, {"dt": "2020-05-01T00:00:00", "Export Full": 122271.0}, {"dt": "2020-06-01T00:00:00", "Export Full": 117424.0}, {"dt": "2020-07-01T00:00:00", "Export Full": 112464.0}, {"dt": "2020-08-01T00:00:00", "Export Full": 115665.0}, {"dt": "2020-09-01T00:00:00", "Export Full": 105229.0}, {"dt": "2020-10-01T00:00:00", "Export Full": 117148.0}, {"dt": "2020-11-01T00:00:00", "Export Full": 113357.0}, {"dt": "2020-12-01T00:00:00", "Export Full": 105796.0}, {"dt": "2021-01-01T00:00:00", "Export Full": 113365.0}, {"dt": "2021-02-01T00:00:00", "Export Full": 111045.0}, {"dt": "2021-03-01T00:00:00", "Export Full": 135283.0}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Northwest-Seaport-Alliance-(Ports-of-Seattle-and-Tacoma)">Northwest Seaport Alliance (Ports of Seattle and Tacoma)<a class="anchor-link" href="#Northwest-Seaport-Alliance-(Ports-of-Seattle-and-Tacoma)">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="o">!</span>curl -s <span class="s1">&#39;https://www.nwseaportalliance.com/about-us/cargo-statistics&#39;</span> <span class="p">|</span> grep <span class="s1">&#39;xlsx&#39;</span>

<span class="c1">#pageCount = re.findall(&quot;of ([0-9]+)&quot;, &quot;&quot;.join(rawPg))[0]</span>

<span class="n">currentReport</span> <span class="o">=</span> <span class="p">[</span><span class="n">u</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;href=&quot;([^&quot;]+)&quot;&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">))</span> <span class="k">if</span> <span class="s2">&quot;xls&quot;</span> <span class="ow">in</span> <span class="n">u</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="c1">#print(currentReport)</span>

<span class="n">df_nwsea</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">currentReport</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">df_nwsea</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Month&quot;</span><span class="p">,</span> <span class="s2">&quot;Measure&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df_nwsea</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">2</span><span class="p">:]</span>

<span class="n">df_nwsea</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_nwsea</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ffill</span><span class="p">()</span>

<span class="n">df_nwsea</span> <span class="o">=</span> <span class="n">df_nwsea</span><span class="p">[</span><span class="o">~</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">df_nwsea</span><span class="p">[</span><span class="s1">&#39;Measure&#39;</span><span class="p">])]</span>

<span class="n">df_nwsea</span> <span class="o">=</span> <span class="n">df_nwsea</span><span class="p">[</span><span class="o">~</span><span class="n">df_nwsea</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;%|Total&quot;</span><span class="p">)]</span>

<span class="n">df_nwsea_melt</span> <span class="o">=</span> <span class="n">df_nwsea</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="s1">&#39;Measure&#39;</span><span class="p">])</span>

<span class="n">df_nwsea_melt</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_nwsea_melt</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">df_nwsea_melt</span><span class="p">[</span><span class="s1">&#39;variable&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%b-%Y&#39;</span><span class="p">)</span>\
                        <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">MonthEnd</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1">#df_nwsea_melt.tail(25)</span>

<span class="n">df_nwsea_tab</span> <span class="o">=</span> <span class="n">df_nwsea_melt</span><span class="p">[[</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="s1">&#39;Measure&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Measure&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>
<span class="c1">#df_nwsea_tab.head()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_nwsea_tab</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;International Exports Full&quot;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;Seattle/Tacoma&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[29]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-0d42cc739c9a43f9bd99212473fdc939"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-0d42cc739c9a43f9bd99212473fdc939") {
      outputDiv = document.getElementById("altair-viz-0d42cc739c9a43f9bd99212473fdc939");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 7}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector018"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Seattle/Tacoma International Exports Full Container Volume", "transform": [{"window": [{"op": "lag", "field": "International Exports Full", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['International Exports Full'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt"}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "International Exports Full"}}, "height": 100, "selection": {"selector018": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-aa38e06b00148ed05c4718b5f298afff"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-aa38e06b00148ed05c4718b5f298afff": [{"dt": "2015-01-31T00:00:00", "International Exports Full": 56213.5}, {"dt": "2015-02-28T00:00:00", "International Exports Full": 52155.25}, {"dt": "2015-03-31T00:00:00", "International Exports Full": 88440.25}, {"dt": "2015-04-30T00:00:00", "International Exports Full": 71820.5}, {"dt": "2015-05-31T00:00:00", "International Exports Full": 72556.75}, {"dt": "2015-06-30T00:00:00", "International Exports Full": 76442.75}, {"dt": "2015-07-31T00:00:00", "International Exports Full": 62621.0}, {"dt": "2015-08-31T00:00:00", "International Exports Full": 72068.25}, {"dt": "2015-09-30T00:00:00", "International Exports Full": 83267.75}, {"dt": "2015-10-31T00:00:00", "International Exports Full": 76308.25}, {"dt": "2015-11-30T00:00:00", "International Exports Full": 77814.0}, {"dt": "2015-12-31T00:00:00", "International Exports Full": 81767.75}, {"dt": "2016-01-31T00:00:00", "International Exports Full": 65426.75}, {"dt": "2016-02-29T00:00:00", "International Exports Full": 76455.25}, {"dt": "2016-03-31T00:00:00", "International Exports Full": 91211.0}, {"dt": "2016-04-30T00:00:00", "International Exports Full": 76993.0}, {"dt": "2016-05-31T00:00:00", "International Exports Full": 72193.0}, {"dt": "2016-06-30T00:00:00", "International Exports Full": 86881.5}, {"dt": "2016-07-31T00:00:00", "International Exports Full": 73397.75}, {"dt": "2016-08-31T00:00:00", "International Exports Full": 82926.5}, {"dt": "2016-09-30T00:00:00", "International Exports Full": 88310.75}, {"dt": "2016-10-31T00:00:00", "International Exports Full": 88756.0}, {"dt": "2016-11-30T00:00:00", "International Exports Full": 95440.5}, {"dt": "2016-12-31T00:00:00", "International Exports Full": 86488.5}, {"dt": "2017-01-31T00:00:00", "International Exports Full": 77069.5}, {"dt": "2017-02-28T00:00:00", "International Exports Full": 71240.75}, {"dt": "2017-03-31T00:00:00", "International Exports Full": 99598.0}, {"dt": "2017-04-30T00:00:00", "International Exports Full": 77558.0}, {"dt": "2017-05-31T00:00:00", "International Exports Full": 81185.5}, {"dt": "2017-06-30T00:00:00", "International Exports Full": 77908.75}, {"dt": "2017-07-31T00:00:00", "International Exports Full": 66901.25}, {"dt": "2017-08-31T00:00:00", "International Exports Full": 80392.5}, {"dt": "2017-09-30T00:00:00", "International Exports Full": 82146.0}, {"dt": "2017-10-31T00:00:00", "International Exports Full": 81295.0}, {"dt": "2017-11-30T00:00:00", "International Exports Full": 81906.75}, {"dt": "2017-12-31T00:00:00", "International Exports Full": 86843.25}, {"dt": "2018-01-31T00:00:00", "International Exports Full": 67571.25}, {"dt": "2018-02-28T00:00:00", "International Exports Full": 76088.0}, {"dt": "2018-03-31T00:00:00", "International Exports Full": 92105.0}, {"dt": "2018-04-30T00:00:00", "International Exports Full": 78909.0}, {"dt": "2018-05-31T00:00:00", "International Exports Full": 77103.5}, {"dt": "2018-06-30T00:00:00", "International Exports Full": 85088.0}, {"dt": "2018-07-31T00:00:00", "International Exports Full": 70943.5}, {"dt": "2018-08-31T00:00:00", "International Exports Full": 74157.75}, {"dt": "2018-09-30T00:00:00", "International Exports Full": 88416.5}, {"dt": "2018-10-31T00:00:00", "International Exports Full": 74085.5}, {"dt": "2018-11-30T00:00:00", "International Exports Full": 83677.25}, {"dt": "2018-12-31T00:00:00", "International Exports Full": 85349.75}, {"dt": "2019-01-31T00:00:00", "International Exports Full": 72858.5}, {"dt": "2019-02-28T00:00:00", "International Exports Full": 65610.0}, {"dt": "2019-03-31T00:00:00", "International Exports Full": 86856.25}, {"dt": "2019-04-30T00:00:00", "International Exports Full": 81304.75}, {"dt": "2019-05-31T00:00:00", "International Exports Full": 70541.0}, {"dt": "2019-06-30T00:00:00", "International Exports Full": 76558.75}, {"dt": "2019-07-31T00:00:00", "International Exports Full": 73827.5}, {"dt": "2019-08-31T00:00:00", "International Exports Full": 74851.5}, {"dt": "2019-09-30T00:00:00", "International Exports Full": 82147.5}, {"dt": "2019-10-31T00:00:00", "International Exports Full": 79320.5}, {"dt": "2019-11-30T00:00:00", "International Exports Full": 73588.5}, {"dt": "2019-12-31T00:00:00", "International Exports Full": 75867.5}, {"dt": "2020-01-31T00:00:00", "International Exports Full": 66410.25}, {"dt": "2020-02-29T00:00:00", "International Exports Full": 68553.25}, {"dt": "2020-03-31T00:00:00", "International Exports Full": 79395.25}, {"dt": "2020-04-30T00:00:00", "International Exports Full": 66954.75}, {"dt": "2020-05-31T00:00:00", "International Exports Full": 59594.75}, {"dt": "2020-06-30T00:00:00", "International Exports Full": 70431.25}, {"dt": "2020-07-31T00:00:00", "International Exports Full": 56547.0}, {"dt": "2020-08-31T00:00:00", "International Exports Full": 54918.0}, {"dt": "2020-09-30T00:00:00", "International Exports Full": 66939.25}, {"dt": "2020-10-31T00:00:00", "International Exports Full": 64281.75}, {"dt": "2020-11-30T00:00:00", "International Exports Full": 72745.5}, {"dt": "2020-12-31T00:00:00", "International Exports Full": 63848.5}, {"dt": "2021-01-31T00:00:00", "International Exports Full": 57516.75}, {"dt": "2021-02-28T00:00:00", "International Exports Full": 59218.0}, {"dt": "2021-03-31T00:00:00", "International Exports Full": 70154.25}, {"dt": "2021-04-30T00:00:00", "International Exports Full": 58931.5}, {"dt": "2021-05-31T00:00:00", "International Exports Full": 62527.0}, {"dt": "2021-06-30T00:00:00", "International Exports Full": 56930.0}, {"dt": "2021-07-31T00:00:00", "International Exports Full": 48833.25}, {"dt": "2021-08-31T00:00:00", "International Exports Full": 51486.5}, {"dt": "2021-09-30T00:00:00", "International Exports Full": 57169.25}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_nwsea_tab</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;International Exports Empty&quot;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;Seattle/Tacoma&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[30]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-908c07a0c2834069ad3828cfb7e2edec"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-908c07a0c2834069ad3828cfb7e2edec") {
      outputDiv = document.getElementById("altair-viz-908c07a0c2834069ad3828cfb7e2edec");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 7}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector019"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Seattle/Tacoma International Exports Empty Container Volume", "transform": [{"window": [{"op": "lag", "field": "International Exports Empty", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['International Exports Empty'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt"}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "International Exports Empty"}}, "height": 100, "selection": {"selector019": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-4c7c459aa330cf3a2d71336f4127dd68"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-4c7c459aa330cf3a2d71336f4127dd68": [{"dt": "2015-01-31T00:00:00", "International Exports Empty": 23372.25}, {"dt": "2015-02-28T00:00:00", "International Exports Empty": 25725.5}, {"dt": "2015-03-31T00:00:00", "International Exports Empty": 40714.25}, {"dt": "2015-04-30T00:00:00", "International Exports Empty": 36066.25}, {"dt": "2015-05-31T00:00:00", "International Exports Empty": 30862.0}, {"dt": "2015-06-30T00:00:00", "International Exports Empty": 52640.5}, {"dt": "2015-07-31T00:00:00", "International Exports Empty": 41800.25}, {"dt": "2015-08-31T00:00:00", "International Exports Empty": 44381.75}, {"dt": "2015-09-30T00:00:00", "International Exports Empty": 49336.75}, {"dt": "2015-10-31T00:00:00", "International Exports Empty": 43662.0}, {"dt": "2015-11-30T00:00:00", "International Exports Empty": 31177.75}, {"dt": "2015-12-31T00:00:00", "International Exports Empty": 27829.5}, {"dt": "2016-01-31T00:00:00", "International Exports Empty": 31048.25}, {"dt": "2016-02-29T00:00:00", "International Exports Empty": 26877.75}, {"dt": "2016-03-31T00:00:00", "International Exports Empty": 26393.0}, {"dt": "2016-04-30T00:00:00", "International Exports Empty": 17319.5}, {"dt": "2016-05-31T00:00:00", "International Exports Empty": 27606.25}, {"dt": "2016-06-30T00:00:00", "International Exports Empty": 29811.5}, {"dt": "2016-07-31T00:00:00", "International Exports Empty": 31266.75}, {"dt": "2016-08-31T00:00:00", "International Exports Empty": 35173.5}, {"dt": "2016-09-30T00:00:00", "International Exports Empty": 31862.0}, {"dt": "2016-10-31T00:00:00", "International Exports Empty": 30065.25}, {"dt": "2016-11-30T00:00:00", "International Exports Empty": 37822.75}, {"dt": "2016-12-31T00:00:00", "International Exports Empty": 35896.75}, {"dt": "2017-01-31T00:00:00", "International Exports Empty": 34263.25}, {"dt": "2017-02-28T00:00:00", "International Exports Empty": 36021.5}, {"dt": "2017-03-31T00:00:00", "International Exports Empty": 39109.75}, {"dt": "2017-04-30T00:00:00", "International Exports Empty": 31443.0}, {"dt": "2017-05-31T00:00:00", "International Exports Empty": 47412.5}, {"dt": "2017-06-30T00:00:00", "International Exports Empty": 47711.0}, {"dt": "2017-07-31T00:00:00", "International Exports Empty": 43488.0}, {"dt": "2017-08-31T00:00:00", "International Exports Empty": 55720.75}, {"dt": "2017-09-30T00:00:00", "International Exports Empty": 50795.75}, {"dt": "2017-10-31T00:00:00", "International Exports Empty": 43757.75}, {"dt": "2017-11-30T00:00:00", "International Exports Empty": 44219.25}, {"dt": "2017-12-31T00:00:00", "International Exports Empty": 44215.75}, {"dt": "2018-01-31T00:00:00", "International Exports Empty": 37676.0}, {"dt": "2018-02-28T00:00:00", "International Exports Empty": 32550.0}, {"dt": "2018-03-31T00:00:00", "International Exports Empty": 36166.0}, {"dt": "2018-04-30T00:00:00", "International Exports Empty": 33736.0}, {"dt": "2018-05-31T00:00:00", "International Exports Empty": 37123.0}, {"dt": "2018-06-30T00:00:00", "International Exports Empty": 58132.0}, {"dt": "2018-07-31T00:00:00", "International Exports Empty": 51627.75}, {"dt": "2018-08-31T00:00:00", "International Exports Empty": 47695.5}, {"dt": "2018-09-30T00:00:00", "International Exports Empty": 55166.25}, {"dt": "2018-10-31T00:00:00", "International Exports Empty": 60010.25}, {"dt": "2018-11-30T00:00:00", "International Exports Empty": 46825.25}, {"dt": "2018-12-31T00:00:00", "International Exports Empty": 55399.25}, {"dt": "2019-01-31T00:00:00", "International Exports Empty": 60043.25}, {"dt": "2019-02-28T00:00:00", "International Exports Empty": 44157.25}, {"dt": "2019-03-31T00:00:00", "International Exports Empty": 52437.0}, {"dt": "2019-04-30T00:00:00", "International Exports Empty": 56604.25}, {"dt": "2019-05-31T00:00:00", "International Exports Empty": 51251.75}, {"dt": "2019-06-30T00:00:00", "International Exports Empty": 59432.0}, {"dt": "2019-07-31T00:00:00", "International Exports Empty": 52580.0}, {"dt": "2019-08-31T00:00:00", "International Exports Empty": 58748.75}, {"dt": "2019-09-30T00:00:00", "International Exports Empty": 56313.0}, {"dt": "2019-10-31T00:00:00", "International Exports Empty": 49467.75}, {"dt": "2019-11-30T00:00:00", "International Exports Empty": 33655.0}, {"dt": "2019-12-31T00:00:00", "International Exports Empty": 43298.75}, {"dt": "2020-01-31T00:00:00", "International Exports Empty": 39247.75}, {"dt": "2020-02-29T00:00:00", "International Exports Empty": 39590.75}, {"dt": "2020-03-31T00:00:00", "International Exports Empty": 22167.25}, {"dt": "2020-04-30T00:00:00", "International Exports Empty": 23846.75}, {"dt": "2020-05-31T00:00:00", "International Exports Empty": 29582.75}, {"dt": "2020-06-30T00:00:00", "International Exports Empty": 40902.5}, {"dt": "2020-07-31T00:00:00", "International Exports Empty": 40351.75}, {"dt": "2020-08-31T00:00:00", "International Exports Empty": 46533.25}, {"dt": "2020-09-30T00:00:00", "International Exports Empty": 50494.0}, {"dt": "2020-10-31T00:00:00", "International Exports Empty": 51634.25}, {"dt": "2020-11-30T00:00:00", "International Exports Empty": 48668.0}, {"dt": "2020-12-31T00:00:00", "International Exports Empty": 52841.75}, {"dt": "2021-01-31T00:00:00", "International Exports Empty": 60024.0}, {"dt": "2021-02-28T00:00:00", "International Exports Empty": 46239.5}, {"dt": "2021-03-31T00:00:00", "International Exports Empty": 47867.0}, {"dt": "2021-04-30T00:00:00", "International Exports Empty": 54639.0}, {"dt": "2021-05-31T00:00:00", "International Exports Empty": 62616.0}, {"dt": "2021-06-30T00:00:00", "International Exports Empty": 71828.0}, {"dt": "2021-07-31T00:00:00", "International Exports Empty": 64833.25}, {"dt": "2021-08-31T00:00:00", "International Exports Empty": 66941.0}, {"dt": "2021-09-30T00:00:00", "International Exports Empty": 64136.75}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Port-of-Houston">Port of Houston<a class="anchor-link" href="#Port-of-Houston">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@memory</span><span class="o">.</span><span class="n">cache</span>
<span class="k">def</span> <span class="nf">fetchHouston</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">retries</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">retries</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span> <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="n">uaString</span> <span class="p">})</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>

        <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">,</span> <span class="s2">&quot;Loaded Imports&quot;</span><span class="p">,</span> <span class="s2">&quot;Loaded Exports&quot;</span><span class="p">,</span> <span class="s2">&quot;Loaded Total&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Empty Imports&quot;</span><span class="p">,</span> <span class="s2">&quot;Empty Exports&quot;</span><span class="p">,</span> <span class="s2">&quot;Empty Total&quot;</span><span class="p">,</span> <span class="s2">&quot;Loaded and Empty Total&quot;</span><span class="p">]</span>

        <span class="n">dfs_hs</span> <span class="o">=</span> <span class="n">read_pdf</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">()),</span> <span class="n">pages</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">pandas_options</span><span class="o">=</span><span class="p">{</span> <span class="s1">&#39;names&#39;</span><span class="p">:</span> <span class="n">cols</span> <span class="p">})</span> <span class="c1">#.head(20)</span>

        <span class="n">df_hs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">dfs_hs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">5</span><span class="p">:]]</span> <span class="o">+</span> <span class="n">dfs_hs</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

        <span class="n">df_hs</span><span class="p">[</span><span class="n">df_hs</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]]</span> <span class="o">=</span> <span class="n">df_hs</span><span class="p">[</span><span class="n">df_hs</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]]</span>\
                <span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">v</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">))</span>

        <span class="n">df_hs</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_hs</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%b-%y&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">df_hs</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fetchHouston</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">retries</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">res</span> <span class="o">=</span> <span class="o">!</span>curl -s <span class="s1">&#39;https://porthouston.com/about-us/statistics/&#39;</span> <span class="p">|</span> grep <span class="s1">&#39;TEU-stats&#39;</span>
    
<span class="n">currentUrl</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;href=&quot;([^&quot;]+)&quot;&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">res</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1">#print(currentUrl)</span>
    
<span class="c1"># TODO - automate detection of this url from here: https://porthouston.com/about-us/statistics/</span>
<span class="n">df_hs</span> <span class="o">=</span> <span class="n">fetchHouston</span><span class="p">(</span><span class="n">currentUrl</span><span class="p">)</span>
<span class="c1">#df_hs.tail()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[32]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_hs</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;Empty Imports&quot;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;Houston&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[32]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-4ac793a5f934404193d1a7aacd3593bc"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-4ac793a5f934404193d1a7aacd3593bc") {
      outputDiv = document.getElementById("altair-viz-4ac793a5f934404193d1a7aacd3593bc");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector020"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Houston Empty Imports Container Volume", "transform": [{"window": [{"op": "lag", "field": "Empty Imports", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Empty Imports'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt"}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Empty Imports"}}, "height": 100, "selection": {"selector020": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-2bca9b98cd1c8d1ac97b404b8b0f559c"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-2bca9b98cd1c8d1ac97b404b8b0f559c": [{"dt": "2001-01-01T00:00:00", "Empty Imports": 12618}, {"dt": "2001-02-01T00:00:00", "Empty Imports": 7823}, {"dt": "2001-03-01T00:00:00", "Empty Imports": 9749}, {"dt": "2001-04-01T00:00:00", "Empty Imports": 13525}, {"dt": "2001-05-01T00:00:00", "Empty Imports": 11932}, {"dt": "2001-06-01T00:00:00", "Empty Imports": 12398}, {"dt": "2001-07-01T00:00:00", "Empty Imports": 8108}, {"dt": "2001-08-01T00:00:00", "Empty Imports": 14172}, {"dt": "2001-09-01T00:00:00", "Empty Imports": 11414}, {"dt": "2001-10-01T00:00:00", "Empty Imports": 11172}, {"dt": "2001-11-01T00:00:00", "Empty Imports": 12854}, {"dt": "2001-12-01T00:00:00", "Empty Imports": 15527}, {"dt": "2002-01-01T00:00:00", "Empty Imports": 10915}, {"dt": "2002-02-01T00:00:00", "Empty Imports": 12823}, {"dt": "2002-03-01T00:00:00", "Empty Imports": 13446}, {"dt": "2002-04-01T00:00:00", "Empty Imports": 16098}, {"dt": "2002-05-01T00:00:00", "Empty Imports": 10362}, {"dt": "2002-06-01T00:00:00", "Empty Imports": 10930}, {"dt": "2002-07-01T00:00:00", "Empty Imports": 9162}, {"dt": "2002-08-01T00:00:00", "Empty Imports": 6521}, {"dt": "2002-09-01T00:00:00", "Empty Imports": 7473}, {"dt": "2002-10-01T00:00:00", "Empty Imports": 11570}, {"dt": "2002-11-01T00:00:00", "Empty Imports": 10122}, {"dt": "2002-12-01T00:00:00", "Empty Imports": 10453}, {"dt": "2003-01-01T00:00:00", "Empty Imports": 8325}, {"dt": "2003-02-01T00:00:00", "Empty Imports": 8932}, {"dt": "2003-03-01T00:00:00", "Empty Imports": 12549}, {"dt": "2003-04-01T00:00:00", "Empty Imports": 10012}, {"dt": "2003-05-01T00:00:00", "Empty Imports": 10641}, {"dt": "2003-06-01T00:00:00", "Empty Imports": 7886}, {"dt": "2003-07-01T00:00:00", "Empty Imports": 11789}, {"dt": "2003-08-01T00:00:00", "Empty Imports": 9815}, {"dt": "2003-09-01T00:00:00", "Empty Imports": 12235}, {"dt": "2003-10-01T00:00:00", "Empty Imports": 10533}, {"dt": "2003-11-01T00:00:00", "Empty Imports": 13032}, {"dt": "2003-12-01T00:00:00", "Empty Imports": 14715}, {"dt": "2004-01-01T00:00:00", "Empty Imports": 12241}, {"dt": "2004-02-01T00:00:00", "Empty Imports": 11484}, {"dt": "2004-03-01T00:00:00", "Empty Imports": 13702}, {"dt": "2004-04-01T00:00:00", "Empty Imports": 12248}, {"dt": "2004-05-01T00:00:00", "Empty Imports": 14756}, {"dt": "2004-06-01T00:00:00", "Empty Imports": 13557}, {"dt": "2004-07-01T00:00:00", "Empty Imports": 12147}, {"dt": "2004-08-01T00:00:00", "Empty Imports": 12249}, {"dt": "2004-09-01T00:00:00", "Empty Imports": 11688}, {"dt": "2004-10-01T00:00:00", "Empty Imports": 10704}, {"dt": "2004-11-01T00:00:00", "Empty Imports": 15596}, {"dt": "2004-12-01T00:00:00", "Empty Imports": 11383}, {"dt": "2005-01-01T00:00:00", "Empty Imports": 9071}, {"dt": "2005-02-01T00:00:00", "Empty Imports": 14057}, {"dt": "2005-03-01T00:00:00", "Empty Imports": 14596}, {"dt": "2005-04-01T00:00:00", "Empty Imports": 16718}, {"dt": "2005-05-01T00:00:00", "Empty Imports": 12218}, {"dt": "2005-06-01T00:00:00", "Empty Imports": 12477}, {"dt": "2005-07-01T00:00:00", "Empty Imports": 15708}, {"dt": "2005-08-01T00:00:00", "Empty Imports": 14917}, {"dt": "2005-09-01T00:00:00", "Empty Imports": 14194}, {"dt": "2005-10-01T00:00:00", "Empty Imports": 13399}, {"dt": "2005-11-01T00:00:00", "Empty Imports": 16158}, {"dt": "2005-12-01T00:00:00", "Empty Imports": 13676}, {"dt": "2006-01-01T00:00:00", "Empty Imports": 12748}, {"dt": "2006-02-01T00:00:00", "Empty Imports": 11822}, {"dt": "2006-03-01T00:00:00", "Empty Imports": 15620}, {"dt": "2006-04-01T00:00:00", "Empty Imports": 11440}, {"dt": "2006-05-01T00:00:00", "Empty Imports": 13144}, {"dt": "2006-06-01T00:00:00", "Empty Imports": 12982}, {"dt": "2006-07-01T00:00:00", "Empty Imports": 8840}, {"dt": "2006-08-01T00:00:00", "Empty Imports": 7876}, {"dt": "2006-09-01T00:00:00", "Empty Imports": 7136}, {"dt": "2006-10-01T00:00:00", "Empty Imports": 9657}, {"dt": "2006-11-01T00:00:00", "Empty Imports": 13092}, {"dt": "2006-12-01T00:00:00", "Empty Imports": 13775}, {"dt": "2007-01-01T00:00:00", "Empty Imports": 18507}, {"dt": "2007-02-01T00:00:00", "Empty Imports": 17114}, {"dt": "2007-03-01T00:00:00", "Empty Imports": 23202}, {"dt": "2007-04-01T00:00:00", "Empty Imports": 19695}, {"dt": "2007-05-01T00:00:00", "Empty Imports": 19957}, {"dt": "2007-06-01T00:00:00", "Empty Imports": 23917}, {"dt": "2007-07-01T00:00:00", "Empty Imports": 21370}, {"dt": "2007-08-01T00:00:00", "Empty Imports": 26714}, {"dt": "2007-09-01T00:00:00", "Empty Imports": 26593}, {"dt": "2007-10-01T00:00:00", "Empty Imports": 25445}, {"dt": "2007-11-01T00:00:00", "Empty Imports": 26572}, {"dt": "2007-12-01T00:00:00", "Empty Imports": 31699}, {"dt": "2008-01-01T00:00:00", "Empty Imports": 24098}, {"dt": "2008-02-01T00:00:00", "Empty Imports": 27284}, {"dt": "2008-03-01T00:00:00", "Empty Imports": 29517}, {"dt": "2008-04-01T00:00:00", "Empty Imports": 29980}, {"dt": "2008-05-01T00:00:00", "Empty Imports": 36510}, {"dt": "2008-06-01T00:00:00", "Empty Imports": 36378}, {"dt": "2008-07-01T00:00:00", "Empty Imports": 34714}, {"dt": "2008-08-01T00:00:00", "Empty Imports": 29317}, {"dt": "2008-09-01T00:00:00", "Empty Imports": 22446}, {"dt": "2008-10-01T00:00:00", "Empty Imports": 22563}, {"dt": "2008-11-01T00:00:00", "Empty Imports": 11685}, {"dt": "2008-12-01T00:00:00", "Empty Imports": 10633}, {"dt": "2009-01-01T00:00:00", "Empty Imports": 19533}, {"dt": "2009-02-01T00:00:00", "Empty Imports": 27745}, {"dt": "2009-03-01T00:00:00", "Empty Imports": 39329}, {"dt": "2009-04-01T00:00:00", "Empty Imports": 35915}, {"dt": "2009-05-01T00:00:00", "Empty Imports": 45550}, {"dt": "2009-06-01T00:00:00", "Empty Imports": 49793}, {"dt": "2009-07-01T00:00:00", "Empty Imports": 46395}, {"dt": "2009-08-01T00:00:00", "Empty Imports": 30924}, {"dt": "2009-09-01T00:00:00", "Empty Imports": 41507}, {"dt": "2009-10-01T00:00:00", "Empty Imports": 37453}, {"dt": "2009-11-01T00:00:00", "Empty Imports": 33131}, {"dt": "2009-12-01T00:00:00", "Empty Imports": 40703}, {"dt": "2010-01-01T00:00:00", "Empty Imports": 35951}, {"dt": "2010-02-01T00:00:00", "Empty Imports": 39206}, {"dt": "2010-03-01T00:00:00", "Empty Imports": 46854}, {"dt": "2010-04-01T00:00:00", "Empty Imports": 25786}, {"dt": "2010-05-01T00:00:00", "Empty Imports": 29952}, {"dt": "2010-06-01T00:00:00", "Empty Imports": 27843}, {"dt": "2010-07-01T00:00:00", "Empty Imports": 19165}, {"dt": "2010-08-01T00:00:00", "Empty Imports": 29893}, {"dt": "2010-09-01T00:00:00", "Empty Imports": 36807}, {"dt": "2010-10-01T00:00:00", "Empty Imports": 28292}, {"dt": "2010-11-01T00:00:00", "Empty Imports": 31181}, {"dt": "2010-12-01T00:00:00", "Empty Imports": 34177}, {"dt": "2011-01-01T00:00:00", "Empty Imports": 39797}, {"dt": "2011-02-01T00:00:00", "Empty Imports": 32669}, {"dt": "2011-03-01T00:00:00", "Empty Imports": 53494}, {"dt": "2011-04-01T00:00:00", "Empty Imports": 35148}, {"dt": "2011-05-01T00:00:00", "Empty Imports": 28349}, {"dt": "2011-06-01T00:00:00", "Empty Imports": 22807}, {"dt": "2011-07-01T00:00:00", "Empty Imports": 18145}, {"dt": "2011-08-01T00:00:00", "Empty Imports": 26759}, {"dt": "2011-09-01T00:00:00", "Empty Imports": 33904}, {"dt": "2011-10-01T00:00:00", "Empty Imports": 22684}, {"dt": "2011-11-01T00:00:00", "Empty Imports": 30988}, {"dt": "2011-12-01T00:00:00", "Empty Imports": 32700}, {"dt": "2012-01-01T00:00:00", "Empty Imports": 30828}, {"dt": "2012-02-01T00:00:00", "Empty Imports": 21199}, {"dt": "2012-03-01T00:00:00", "Empty Imports": 28275}, {"dt": "2012-04-01T00:00:00", "Empty Imports": 23947}, {"dt": "2012-05-01T00:00:00", "Empty Imports": 19011}, {"dt": "2012-06-01T00:00:00", "Empty Imports": 23373}, {"dt": "2012-07-01T00:00:00", "Empty Imports": 28486}, {"dt": "2012-08-01T00:00:00", "Empty Imports": 32603}, {"dt": "2012-09-01T00:00:00", "Empty Imports": 26176}, {"dt": "2012-10-01T00:00:00", "Empty Imports": 25752}, {"dt": "2012-11-01T00:00:00", "Empty Imports": 24546}, {"dt": "2012-12-01T00:00:00", "Empty Imports": 29863}, {"dt": "2013-01-01T00:00:00", "Empty Imports": 30728}, {"dt": "2013-02-01T00:00:00", "Empty Imports": 29916}, {"dt": "2013-03-01T00:00:00", "Empty Imports": 25254}, {"dt": "2013-04-01T00:00:00", "Empty Imports": 27048}, {"dt": "2013-05-01T00:00:00", "Empty Imports": 26821}, {"dt": "2013-06-01T00:00:00", "Empty Imports": 27014}, {"dt": "2013-07-01T00:00:00", "Empty Imports": 40084}, {"dt": "2013-08-01T00:00:00", "Empty Imports": 23116}, {"dt": "2013-09-01T00:00:00", "Empty Imports": 20994}, {"dt": "2013-10-01T00:00:00", "Empty Imports": 20611}, {"dt": "2013-11-01T00:00:00", "Empty Imports": 10421}, {"dt": "2013-12-01T00:00:00", "Empty Imports": 24467}, {"dt": "2014-01-01T00:00:00", "Empty Imports": 27402}, {"dt": "2014-02-01T00:00:00", "Empty Imports": 20616}, {"dt": "2014-03-01T00:00:00", "Empty Imports": 19146}, {"dt": "2014-04-01T00:00:00", "Empty Imports": 10396}, {"dt": "2014-05-01T00:00:00", "Empty Imports": 15059}, {"dt": "2014-06-01T00:00:00", "Empty Imports": 19990}, {"dt": "2014-07-01T00:00:00", "Empty Imports": 17206}, {"dt": "2014-08-01T00:00:00", "Empty Imports": 14918}, {"dt": "2014-09-01T00:00:00", "Empty Imports": 12302}, {"dt": "2014-10-01T00:00:00", "Empty Imports": 9446}, {"dt": "2014-11-01T00:00:00", "Empty Imports": 9521}, {"dt": "2014-12-01T00:00:00", "Empty Imports": 11907}, {"dt": "2015-01-01T00:00:00", "Empty Imports": 12771}, {"dt": "2015-02-01T00:00:00", "Empty Imports": 11309}, {"dt": "2015-03-01T00:00:00", "Empty Imports": 14415}, {"dt": "2015-04-01T00:00:00", "Empty Imports": 17359}, {"dt": "2015-05-01T00:00:00", "Empty Imports": 14081}, {"dt": "2015-06-01T00:00:00", "Empty Imports": 8530}, {"dt": "2015-07-01T00:00:00", "Empty Imports": 12095}, {"dt": "2015-08-01T00:00:00", "Empty Imports": 11604}, {"dt": "2015-09-01T00:00:00", "Empty Imports": 10335}, {"dt": "2015-10-01T00:00:00", "Empty Imports": 10145}, {"dt": "2015-11-01T00:00:00", "Empty Imports": 11190}, {"dt": "2015-12-01T00:00:00", "Empty Imports": 15631}, {"dt": "2016-01-01T00:00:00", "Empty Imports": 12515}, {"dt": "2016-02-01T00:00:00", "Empty Imports": 17436}, {"dt": "2016-03-01T00:00:00", "Empty Imports": 19876}, {"dt": "2016-04-01T00:00:00", "Empty Imports": 31987}, {"dt": "2016-05-01T00:00:00", "Empty Imports": 18838}, {"dt": "2016-06-01T00:00:00", "Empty Imports": 18961}, {"dt": "2016-07-01T00:00:00", "Empty Imports": 12890}, {"dt": "2016-08-01T00:00:00", "Empty Imports": 11740}, {"dt": "2016-09-01T00:00:00", "Empty Imports": 14848}, {"dt": "2016-10-01T00:00:00", "Empty Imports": 11804}, {"dt": "2016-11-01T00:00:00", "Empty Imports": 9729}, {"dt": "2016-12-01T00:00:00", "Empty Imports": 11485}, {"dt": "2017-01-01T00:00:00", "Empty Imports": 14930}, {"dt": "2017-02-01T00:00:00", "Empty Imports": 15915}, {"dt": "2017-03-01T00:00:00", "Empty Imports": 25739}, {"dt": "2017-04-01T00:00:00", "Empty Imports": 16204}, {"dt": "2017-05-01T00:00:00", "Empty Imports": 14714}, {"dt": "2017-06-01T00:00:00", "Empty Imports": 12190}, {"dt": "2017-07-01T00:00:00", "Empty Imports": 11408}, {"dt": "2017-08-01T00:00:00", "Empty Imports": 5301}, {"dt": "2017-09-01T00:00:00", "Empty Imports": 11170}, {"dt": "2017-10-01T00:00:00", "Empty Imports": 7751}, {"dt": "2017-11-01T00:00:00", "Empty Imports": 9848}, {"dt": "2017-12-01T00:00:00", "Empty Imports": 7739}, {"dt": "2018-01-01T00:00:00", "Empty Imports": 7370}, {"dt": "2018-02-01T00:00:00", "Empty Imports": 8881}, {"dt": "2018-03-01T00:00:00", "Empty Imports": 21121}, {"dt": "2018-04-01T00:00:00", "Empty Imports": 18604}, {"dt": "2018-05-01T00:00:00", "Empty Imports": 24652}, {"dt": "2018-06-01T00:00:00", "Empty Imports": 15624}, {"dt": "2018-07-01T00:00:00", "Empty Imports": 16351}, {"dt": "2018-08-01T00:00:00", "Empty Imports": 14405}, {"dt": "2018-09-01T00:00:00", "Empty Imports": 10599}, {"dt": "2018-10-01T00:00:00", "Empty Imports": 9101}, {"dt": "2018-11-01T00:00:00", "Empty Imports": 13233}, {"dt": "2018-12-01T00:00:00", "Empty Imports": 9528}, {"dt": "2019-01-01T00:00:00", "Empty Imports": 10975}, {"dt": "2019-02-01T00:00:00", "Empty Imports": 9759}, {"dt": "2019-03-01T00:00:00", "Empty Imports": 35333}, {"dt": "2019-04-01T00:00:00", "Empty Imports": 27182}, {"dt": "2019-05-01T00:00:00", "Empty Imports": 21289}, {"dt": "2019-06-01T00:00:00", "Empty Imports": 20003}, {"dt": "2019-07-01T00:00:00", "Empty Imports": 20426}, {"dt": "2019-08-01T00:00:00", "Empty Imports": 16986}, {"dt": "2019-09-01T00:00:00", "Empty Imports": 22168}, {"dt": "2019-10-01T00:00:00", "Empty Imports": 17720}, {"dt": "2019-11-01T00:00:00", "Empty Imports": 22188}, {"dt": "2019-12-01T00:00:00", "Empty Imports": 28513}, {"dt": "2020-01-01T00:00:00", "Empty Imports": 30252}, {"dt": "2020-02-01T00:00:00", "Empty Imports": 44560}, {"dt": "2020-03-01T00:00:00", "Empty Imports": 37448}, {"dt": "2020-04-01T00:00:00", "Empty Imports": 18422}, {"dt": "2020-05-01T00:00:00", "Empty Imports": 8959}, {"dt": "2020-06-01T00:00:00", "Empty Imports": 17002}, {"dt": "2020-07-01T00:00:00", "Empty Imports": 21677}, {"dt": "2020-08-01T00:00:00", "Empty Imports": 11970}, {"dt": "2020-09-01T00:00:00", "Empty Imports": 10701}, {"dt": "2020-10-01T00:00:00", "Empty Imports": 12871}, {"dt": "2020-11-01T00:00:00", "Empty Imports": 8018}, {"dt": "2020-12-01T00:00:00", "Empty Imports": 14323}, {"dt": "2021-01-01T00:00:00", "Empty Imports": 10264}, {"dt": "2021-02-01T00:00:00", "Empty Imports": 9262}, {"dt": "2021-03-01T00:00:00", "Empty Imports": 18524}, {"dt": "2021-04-01T00:00:00", "Empty Imports": 14431}, {"dt": "2021-05-01T00:00:00", "Empty Imports": 8633}, {"dt": "2021-06-01T00:00:00", "Empty Imports": 12188}, {"dt": "2021-07-01T00:00:00", "Empty Imports": 9003}, {"dt": "2021-08-01T00:00:00", "Empty Imports": 8652}, {"dt": "2021-09-01T00:00:00", "Empty Imports": 10114}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[33]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_hs</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;Empty Exports&quot;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;Houston&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[33]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-80f731df2e5e4357bcb2e834ace1dd4b"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-80f731df2e5e4357bcb2e834ace1dd4b") {
      outputDiv = document.getElementById("altair-viz-80f731df2e5e4357bcb2e834ace1dd4b");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector021"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Houston Empty Exports Container Volume", "transform": [{"window": [{"op": "lag", "field": "Empty Exports", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Empty Exports'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt"}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Empty Exports"}}, "height": 100, "selection": {"selector021": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-8c3d381d181b2645d6e90be2ddbe01f7"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-8c3d381d181b2645d6e90be2ddbe01f7": [{"dt": "2001-01-01T00:00:00", "Empty Exports": 7326}, {"dt": "2001-02-01T00:00:00", "Empty Exports": 4293}, {"dt": "2001-03-01T00:00:00", "Empty Exports": 4698}, {"dt": "2001-04-01T00:00:00", "Empty Exports": 6298}, {"dt": "2001-05-01T00:00:00", "Empty Exports": 6406}, {"dt": "2001-06-01T00:00:00", "Empty Exports": 7153}, {"dt": "2001-07-01T00:00:00", "Empty Exports": 7916}, {"dt": "2001-08-01T00:00:00", "Empty Exports": 7843}, {"dt": "2001-09-01T00:00:00", "Empty Exports": 6664}, {"dt": "2001-10-01T00:00:00", "Empty Exports": 9886}, {"dt": "2001-11-01T00:00:00", "Empty Exports": 8125}, {"dt": "2001-12-01T00:00:00", "Empty Exports": 9875}, {"dt": "2002-01-01T00:00:00", "Empty Exports": 7618}, {"dt": "2002-02-01T00:00:00", "Empty Exports": 7285}, {"dt": "2002-03-01T00:00:00", "Empty Exports": 8384}, {"dt": "2002-04-01T00:00:00", "Empty Exports": 8458}, {"dt": "2002-05-01T00:00:00", "Empty Exports": 11614}, {"dt": "2002-06-01T00:00:00", "Empty Exports": 9083}, {"dt": "2002-07-01T00:00:00", "Empty Exports": 11678}, {"dt": "2002-08-01T00:00:00", "Empty Exports": 13697}, {"dt": "2002-09-01T00:00:00", "Empty Exports": 12234}, {"dt": "2002-10-01T00:00:00", "Empty Exports": 10128}, {"dt": "2002-11-01T00:00:00", "Empty Exports": 12971}, {"dt": "2002-12-01T00:00:00", "Empty Exports": 9813}, {"dt": "2003-01-01T00:00:00", "Empty Exports": 7025}, {"dt": "2003-02-01T00:00:00", "Empty Exports": 4769}, {"dt": "2003-03-01T00:00:00", "Empty Exports": 4940}, {"dt": "2003-04-01T00:00:00", "Empty Exports": 5933}, {"dt": "2003-05-01T00:00:00", "Empty Exports": 9983}, {"dt": "2003-06-01T00:00:00", "Empty Exports": 10134}, {"dt": "2003-07-01T00:00:00", "Empty Exports": 11892}, {"dt": "2003-08-01T00:00:00", "Empty Exports": 12403}, {"dt": "2003-09-01T00:00:00", "Empty Exports": 13067}, {"dt": "2003-10-01T00:00:00", "Empty Exports": 14263}, {"dt": "2003-11-01T00:00:00", "Empty Exports": 11536}, {"dt": "2003-12-01T00:00:00", "Empty Exports": 11819}, {"dt": "2004-01-01T00:00:00", "Empty Exports": 10556}, {"dt": "2004-02-01T00:00:00", "Empty Exports": 9526}, {"dt": "2004-03-01T00:00:00", "Empty Exports": 9013}, {"dt": "2004-04-01T00:00:00", "Empty Exports": 6857}, {"dt": "2004-05-01T00:00:00", "Empty Exports": 9566}, {"dt": "2004-06-01T00:00:00", "Empty Exports": 8212}, {"dt": "2004-07-01T00:00:00", "Empty Exports": 10033}, {"dt": "2004-08-01T00:00:00", "Empty Exports": 10566}, {"dt": "2004-09-01T00:00:00", "Empty Exports": 7719}, {"dt": "2004-10-01T00:00:00", "Empty Exports": 13158}, {"dt": "2004-11-01T00:00:00", "Empty Exports": 5817}, {"dt": "2004-12-01T00:00:00", "Empty Exports": 8345}, {"dt": "2005-01-01T00:00:00", "Empty Exports": 9824}, {"dt": "2005-02-01T00:00:00", "Empty Exports": 6198}, {"dt": "2005-03-01T00:00:00", "Empty Exports": 10661}, {"dt": "2005-04-01T00:00:00", "Empty Exports": 5366}, {"dt": "2005-05-01T00:00:00", "Empty Exports": 6542}, {"dt": "2005-06-01T00:00:00", "Empty Exports": 5417}, {"dt": "2005-07-01T00:00:00", "Empty Exports": 6182}, {"dt": "2005-08-01T00:00:00", "Empty Exports": 11789}, {"dt": "2005-09-01T00:00:00", "Empty Exports": 6704}, {"dt": "2005-10-01T00:00:00", "Empty Exports": 17323}, {"dt": "2005-11-01T00:00:00", "Empty Exports": 17648}, {"dt": "2005-12-01T00:00:00", "Empty Exports": 18303}, {"dt": "2006-01-01T00:00:00", "Empty Exports": 11687}, {"dt": "2006-02-01T00:00:00", "Empty Exports": 9167}, {"dt": "2006-03-01T00:00:00", "Empty Exports": 10848}, {"dt": "2006-04-01T00:00:00", "Empty Exports": 7847}, {"dt": "2006-05-01T00:00:00", "Empty Exports": 6712}, {"dt": "2006-06-01T00:00:00", "Empty Exports": 7069}, {"dt": "2006-07-01T00:00:00", "Empty Exports": 9587}, {"dt": "2006-08-01T00:00:00", "Empty Exports": 8723}, {"dt": "2006-09-01T00:00:00", "Empty Exports": 7002}, {"dt": "2006-10-01T00:00:00", "Empty Exports": 8212}, {"dt": "2006-11-01T00:00:00", "Empty Exports": 9600}, {"dt": "2006-12-01T00:00:00", "Empty Exports": 4965}, {"dt": "2007-01-01T00:00:00", "Empty Exports": 3466}, {"dt": "2007-02-01T00:00:00", "Empty Exports": 7007}, {"dt": "2007-03-01T00:00:00", "Empty Exports": 5523}, {"dt": "2007-04-01T00:00:00", "Empty Exports": 5728}, {"dt": "2007-05-01T00:00:00", "Empty Exports": 4224}, {"dt": "2007-06-01T00:00:00", "Empty Exports": 2174}, {"dt": "2007-07-01T00:00:00", "Empty Exports": 4037}, {"dt": "2007-08-01T00:00:00", "Empty Exports": 6059}, {"dt": "2007-09-01T00:00:00", "Empty Exports": 4865}, {"dt": "2007-10-01T00:00:00", "Empty Exports": 7633}, {"dt": "2007-11-01T00:00:00", "Empty Exports": 9955}, {"dt": "2007-12-01T00:00:00", "Empty Exports": 2748}, {"dt": "2008-01-01T00:00:00", "Empty Exports": 5121}, {"dt": "2008-02-01T00:00:00", "Empty Exports": 2391}, {"dt": "2008-03-01T00:00:00", "Empty Exports": 2357}, {"dt": "2008-04-01T00:00:00", "Empty Exports": 2882}, {"dt": "2008-05-01T00:00:00", "Empty Exports": 2811}, {"dt": "2008-06-01T00:00:00", "Empty Exports": 2005}, {"dt": "2008-07-01T00:00:00", "Empty Exports": 3313}, {"dt": "2008-08-01T00:00:00", "Empty Exports": 4449}, {"dt": "2008-09-01T00:00:00", "Empty Exports": 6349}, {"dt": "2008-10-01T00:00:00", "Empty Exports": 16135}, {"dt": "2008-11-01T00:00:00", "Empty Exports": 11331}, {"dt": "2008-12-01T00:00:00", "Empty Exports": 6195}, {"dt": "2009-01-01T00:00:00", "Empty Exports": 4547}, {"dt": "2009-02-01T00:00:00", "Empty Exports": 4189}, {"dt": "2009-03-01T00:00:00", "Empty Exports": 2768}, {"dt": "2009-04-01T00:00:00", "Empty Exports": 19855}, {"dt": "2009-05-01T00:00:00", "Empty Exports": 3763}, {"dt": "2009-06-01T00:00:00", "Empty Exports": 2953}, {"dt": "2009-07-01T00:00:00", "Empty Exports": 4067}, {"dt": "2009-08-01T00:00:00", "Empty Exports": 3106}, {"dt": "2009-09-01T00:00:00", "Empty Exports": 2750}, {"dt": "2009-10-01T00:00:00", "Empty Exports": 7810}, {"dt": "2009-11-01T00:00:00", "Empty Exports": 7756}, {"dt": "2009-12-01T00:00:00", "Empty Exports": 3939}, {"dt": "2010-01-01T00:00:00", "Empty Exports": 6353}, {"dt": "2010-02-01T00:00:00", "Empty Exports": 6320}, {"dt": "2010-03-01T00:00:00", "Empty Exports": 4980}, {"dt": "2010-04-01T00:00:00", "Empty Exports": 6234}, {"dt": "2010-05-01T00:00:00", "Empty Exports": 5758}, {"dt": "2010-06-01T00:00:00", "Empty Exports": 8921}, {"dt": "2010-07-01T00:00:00", "Empty Exports": 7931}, {"dt": "2010-08-01T00:00:00", "Empty Exports": 6404}, {"dt": "2010-09-01T00:00:00", "Empty Exports": 6804}, {"dt": "2010-10-01T00:00:00", "Empty Exports": 7589}, {"dt": "2010-11-01T00:00:00", "Empty Exports": 6857}, {"dt": "2010-12-01T00:00:00", "Empty Exports": 4106}, {"dt": "2011-01-01T00:00:00", "Empty Exports": 5249}, {"dt": "2011-02-01T00:00:00", "Empty Exports": 5994}, {"dt": "2011-03-01T00:00:00", "Empty Exports": 7365}, {"dt": "2011-04-01T00:00:00", "Empty Exports": 4979}, {"dt": "2011-05-01T00:00:00", "Empty Exports": 7737}, {"dt": "2011-06-01T00:00:00", "Empty Exports": 4955}, {"dt": "2011-07-01T00:00:00", "Empty Exports": 7641}, {"dt": "2011-08-01T00:00:00", "Empty Exports": 7272}, {"dt": "2011-09-01T00:00:00", "Empty Exports": 6443}, {"dt": "2011-10-01T00:00:00", "Empty Exports": 7033}, {"dt": "2011-11-01T00:00:00", "Empty Exports": 9272}, {"dt": "2011-12-01T00:00:00", "Empty Exports": 8232}, {"dt": "2012-01-01T00:00:00", "Empty Exports": 8420}, {"dt": "2012-02-01T00:00:00", "Empty Exports": 11147}, {"dt": "2012-03-01T00:00:00", "Empty Exports": 8692}, {"dt": "2012-04-01T00:00:00", "Empty Exports": 10548}, {"dt": "2012-05-01T00:00:00", "Empty Exports": 9912}, {"dt": "2012-06-01T00:00:00", "Empty Exports": 12200}, {"dt": "2012-07-01T00:00:00", "Empty Exports": 9202}, {"dt": "2012-08-01T00:00:00", "Empty Exports": 12403}, {"dt": "2012-09-01T00:00:00", "Empty Exports": 13361}, {"dt": "2012-10-01T00:00:00", "Empty Exports": 10793}, {"dt": "2012-11-01T00:00:00", "Empty Exports": 11467}, {"dt": "2012-12-01T00:00:00", "Empty Exports": 10535}, {"dt": "2013-01-01T00:00:00", "Empty Exports": 8273}, {"dt": "2013-02-01T00:00:00", "Empty Exports": 6753}, {"dt": "2013-03-01T00:00:00", "Empty Exports": 9801}, {"dt": "2013-04-01T00:00:00", "Empty Exports": 8549}, {"dt": "2013-05-01T00:00:00", "Empty Exports": 9874}, {"dt": "2013-06-01T00:00:00", "Empty Exports": 10903}, {"dt": "2013-07-01T00:00:00", "Empty Exports": 13114}, {"dt": "2013-08-01T00:00:00", "Empty Exports": 14450}, {"dt": "2013-09-01T00:00:00", "Empty Exports": 11126}, {"dt": "2013-10-01T00:00:00", "Empty Exports": 12088}, {"dt": "2013-11-01T00:00:00", "Empty Exports": 9139}, {"dt": "2013-12-01T00:00:00", "Empty Exports": 8219}, {"dt": "2014-01-01T00:00:00", "Empty Exports": 9957}, {"dt": "2014-02-01T00:00:00", "Empty Exports": 7075}, {"dt": "2014-03-01T00:00:00", "Empty Exports": 9743}, {"dt": "2014-04-01T00:00:00", "Empty Exports": 10205}, {"dt": "2014-05-01T00:00:00", "Empty Exports": 14660}, {"dt": "2014-06-01T00:00:00", "Empty Exports": 15550}, {"dt": "2014-07-01T00:00:00", "Empty Exports": 16465}, {"dt": "2014-08-01T00:00:00", "Empty Exports": 15560}, {"dt": "2014-09-01T00:00:00", "Empty Exports": 15981}, {"dt": "2014-10-01T00:00:00", "Empty Exports": 20443}, {"dt": "2014-11-01T00:00:00", "Empty Exports": 18852}, {"dt": "2014-12-01T00:00:00", "Empty Exports": 17738}, {"dt": "2015-01-01T00:00:00", "Empty Exports": 21250}, {"dt": "2015-02-01T00:00:00", "Empty Exports": 18840}, {"dt": "2015-03-01T00:00:00", "Empty Exports": 16507}, {"dt": "2015-04-01T00:00:00", "Empty Exports": 13661}, {"dt": "2015-05-01T00:00:00", "Empty Exports": 22548}, {"dt": "2015-06-01T00:00:00", "Empty Exports": 17804}, {"dt": "2015-07-01T00:00:00", "Empty Exports": 12405}, {"dt": "2015-08-01T00:00:00", "Empty Exports": 15956}, {"dt": "2015-09-01T00:00:00", "Empty Exports": 14298}, {"dt": "2015-10-01T00:00:00", "Empty Exports": 16198}, {"dt": "2015-11-01T00:00:00", "Empty Exports": 10649}, {"dt": "2015-12-01T00:00:00", "Empty Exports": 12737}, {"dt": "2016-01-01T00:00:00", "Empty Exports": 11982}, {"dt": "2016-02-01T00:00:00", "Empty Exports": 13266}, {"dt": "2016-03-01T00:00:00", "Empty Exports": 12868}, {"dt": "2016-04-01T00:00:00", "Empty Exports": 13270}, {"dt": "2016-05-01T00:00:00", "Empty Exports": 14063}, {"dt": "2016-06-01T00:00:00", "Empty Exports": 20884}, {"dt": "2016-07-01T00:00:00", "Empty Exports": 22640}, {"dt": "2016-08-01T00:00:00", "Empty Exports": 15592}, {"dt": "2016-09-01T00:00:00", "Empty Exports": 14888}, {"dt": "2016-10-01T00:00:00", "Empty Exports": 18270}, {"dt": "2016-11-01T00:00:00", "Empty Exports": 16197}, {"dt": "2016-12-01T00:00:00", "Empty Exports": 15780}, {"dt": "2017-01-01T00:00:00", "Empty Exports": 9018}, {"dt": "2017-02-01T00:00:00", "Empty Exports": 11004}, {"dt": "2017-03-01T00:00:00", "Empty Exports": 16482}, {"dt": "2017-04-01T00:00:00", "Empty Exports": 16930}, {"dt": "2017-05-01T00:00:00", "Empty Exports": 26817}, {"dt": "2017-06-01T00:00:00", "Empty Exports": 24944}, {"dt": "2017-07-01T00:00:00", "Empty Exports": 24036}, {"dt": "2017-08-01T00:00:00", "Empty Exports": 25232}, {"dt": "2017-09-01T00:00:00", "Empty Exports": 28494}, {"dt": "2017-10-01T00:00:00", "Empty Exports": 35214}, {"dt": "2017-11-01T00:00:00", "Empty Exports": 23930}, {"dt": "2017-12-01T00:00:00", "Empty Exports": 21867}, {"dt": "2018-01-01T00:00:00", "Empty Exports": 21737}, {"dt": "2018-02-01T00:00:00", "Empty Exports": 19335}, {"dt": "2018-03-01T00:00:00", "Empty Exports": 17221}, {"dt": "2018-04-01T00:00:00", "Empty Exports": 16305}, {"dt": "2018-05-01T00:00:00", "Empty Exports": 20475}, {"dt": "2018-06-01T00:00:00", "Empty Exports": 18216}, {"dt": "2018-07-01T00:00:00", "Empty Exports": 25574}, {"dt": "2018-08-01T00:00:00", "Empty Exports": 28957}, {"dt": "2018-09-01T00:00:00", "Empty Exports": 31283}, {"dt": "2018-10-01T00:00:00", "Empty Exports": 27342}, {"dt": "2018-11-01T00:00:00", "Empty Exports": 22390}, {"dt": "2018-12-01T00:00:00", "Empty Exports": 26783}, {"dt": "2019-01-01T00:00:00", "Empty Exports": 20698}, {"dt": "2019-02-01T00:00:00", "Empty Exports": 15322}, {"dt": "2019-03-01T00:00:00", "Empty Exports": 17489}, {"dt": "2019-04-01T00:00:00", "Empty Exports": 18230}, {"dt": "2019-05-01T00:00:00", "Empty Exports": 17953}, {"dt": "2019-06-01T00:00:00", "Empty Exports": 19897}, {"dt": "2019-07-01T00:00:00", "Empty Exports": 24035}, {"dt": "2019-08-01T00:00:00", "Empty Exports": 22418}, {"dt": "2019-09-01T00:00:00", "Empty Exports": 20777}, {"dt": "2019-10-01T00:00:00", "Empty Exports": 20904}, {"dt": "2019-11-01T00:00:00", "Empty Exports": 14129}, {"dt": "2019-12-01T00:00:00", "Empty Exports": 15322}, {"dt": "2020-01-01T00:00:00", "Empty Exports": 14692}, {"dt": "2020-02-01T00:00:00", "Empty Exports": 10137}, {"dt": "2020-03-01T00:00:00", "Empty Exports": 8118}, {"dt": "2020-04-01T00:00:00", "Empty Exports": 11276}, {"dt": "2020-05-01T00:00:00", "Empty Exports": 13244}, {"dt": "2020-06-01T00:00:00", "Empty Exports": 9392}, {"dt": "2020-07-01T00:00:00", "Empty Exports": 12212}, {"dt": "2020-08-01T00:00:00", "Empty Exports": 21394}, {"dt": "2020-09-01T00:00:00", "Empty Exports": 29781}, {"dt": "2020-10-01T00:00:00", "Empty Exports": 50979}, {"dt": "2020-11-01T00:00:00", "Empty Exports": 29682}, {"dt": "2020-12-01T00:00:00", "Empty Exports": 26619}, {"dt": "2021-01-01T00:00:00", "Empty Exports": 23503}, {"dt": "2021-02-01T00:00:00", "Empty Exports": 17227}, {"dt": "2021-03-01T00:00:00", "Empty Exports": 37869}, {"dt": "2021-04-01T00:00:00", "Empty Exports": 40809}, {"dt": "2021-05-01T00:00:00", "Empty Exports": 51202}, {"dt": "2021-06-01T00:00:00", "Empty Exports": 56337}, {"dt": "2021-07-01T00:00:00", "Empty Exports": 75964}, {"dt": "2021-08-01T00:00:00", "Empty Exports": 65983}, {"dt": "2021-09-01T00:00:00", "Empty Exports": 66234}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[34]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_hs</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;Loaded Total&quot;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;Houston&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[34]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-323168ec94084e8cad63661c46610a52"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-323168ec94084e8cad63661c46610a52") {
      outputDiv = document.getElementById("altair-viz-323168ec94084e8cad63661c46610a52");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector022"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Houston Loaded Total Container Volume", "transform": [{"window": [{"op": "lag", "field": "Loaded Total", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Loaded Total'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt"}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Loaded Total"}}, "height": 100, "selection": {"selector022": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-8c161de88e47a2c4b465b26013596273"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-8c161de88e47a2c4b465b26013596273": [{"dt": "2001-01-01T00:00:00", "Loaded Total": 73929}, {"dt": "2001-02-01T00:00:00", "Loaded Total": 60057}, {"dt": "2001-03-01T00:00:00", "Loaded Total": 78930}, {"dt": "2001-04-01T00:00:00", "Loaded Total": 67214}, {"dt": "2001-05-01T00:00:00", "Loaded Total": 69052}, {"dt": "2001-06-01T00:00:00", "Loaded Total": 68710}, {"dt": "2001-07-01T00:00:00", "Loaded Total": 68510}, {"dt": "2001-08-01T00:00:00", "Loaded Total": 68372}, {"dt": "2001-09-01T00:00:00", "Loaded Total": 67080}, {"dt": "2001-10-01T00:00:00", "Loaded Total": 77775}, {"dt": "2001-11-01T00:00:00", "Loaded Total": 71253}, {"dt": "2001-12-01T00:00:00", "Loaded Total": 72944}, {"dt": "2002-01-01T00:00:00", "Loaded Total": 63972}, {"dt": "2002-02-01T00:00:00", "Loaded Total": 77383}, {"dt": "2002-03-01T00:00:00", "Loaded Total": 71430}, {"dt": "2002-04-01T00:00:00", "Loaded Total": 76927}, {"dt": "2002-05-01T00:00:00", "Loaded Total": 78885}, {"dt": "2002-06-01T00:00:00", "Loaded Total": 73298}, {"dt": "2002-07-01T00:00:00", "Loaded Total": 89056}, {"dt": "2002-08-01T00:00:00", "Loaded Total": 72968}, {"dt": "2002-09-01T00:00:00", "Loaded Total": 72454}, {"dt": "2002-10-01T00:00:00", "Loaded Total": 88598}, {"dt": "2002-11-01T00:00:00", "Loaded Total": 74425}, {"dt": "2002-12-01T00:00:00", "Loaded Total": 67555}, {"dt": "2003-01-01T00:00:00", "Loaded Total": 76664}, {"dt": "2003-02-01T00:00:00", "Loaded Total": 77958}, {"dt": "2003-03-01T00:00:00", "Loaded Total": 79334}, {"dt": "2003-04-01T00:00:00", "Loaded Total": 86183}, {"dt": "2003-05-01T00:00:00", "Loaded Total": 74182}, {"dt": "2003-06-01T00:00:00", "Loaded Total": 71128}, {"dt": "2003-07-01T00:00:00", "Loaded Total": 94191}, {"dt": "2003-08-01T00:00:00", "Loaded Total": 84611}, {"dt": "2003-09-01T00:00:00", "Loaded Total": 86260}, {"dt": "2003-10-01T00:00:00", "Loaded Total": 92869}, {"dt": "2003-11-01T00:00:00", "Loaded Total": 84301}, {"dt": "2003-12-01T00:00:00", "Loaded Total": 87576}, {"dt": "2004-01-01T00:00:00", "Loaded Total": 72466}, {"dt": "2004-02-01T00:00:00", "Loaded Total": 82635}, {"dt": "2004-03-01T00:00:00", "Loaded Total": 93202}, {"dt": "2004-04-01T00:00:00", "Loaded Total": 83572}, {"dt": "2004-05-01T00:00:00", "Loaded Total": 97601}, {"dt": "2004-06-01T00:00:00", "Loaded Total": 90306}, {"dt": "2004-07-01T00:00:00", "Loaded Total": 91056}, {"dt": "2004-08-01T00:00:00", "Loaded Total": 98943}, {"dt": "2004-09-01T00:00:00", "Loaded Total": 103448}, {"dt": "2004-10-01T00:00:00", "Loaded Total": 97863}, {"dt": "2004-11-01T00:00:00", "Loaded Total": 97840}, {"dt": "2004-12-01T00:00:00", "Loaded Total": 110544}, {"dt": "2005-01-01T00:00:00", "Loaded Total": 99006}, {"dt": "2005-02-01T00:00:00", "Loaded Total": 91968}, {"dt": "2005-03-01T00:00:00", "Loaded Total": 106024}, {"dt": "2005-04-01T00:00:00", "Loaded Total": 108030}, {"dt": "2005-05-01T00:00:00", "Loaded Total": 105561}, {"dt": "2005-06-01T00:00:00", "Loaded Total": 113287}, {"dt": "2005-07-01T00:00:00", "Loaded Total": 114731}, {"dt": "2005-08-01T00:00:00", "Loaded Total": 113883}, {"dt": "2005-09-01T00:00:00", "Loaded Total": 95019}, {"dt": "2005-10-01T00:00:00", "Loaded Total": 120169}, {"dt": "2005-11-01T00:00:00", "Loaded Total": 112087}, {"dt": "2005-12-01T00:00:00", "Loaded Total": 113170}, {"dt": "2006-01-01T00:00:00", "Loaded Total": 106880}, {"dt": "2006-02-01T00:00:00", "Loaded Total": 98992}, {"dt": "2006-03-01T00:00:00", "Loaded Total": 103882}, {"dt": "2006-04-01T00:00:00", "Loaded Total": 111688}, {"dt": "2006-05-01T00:00:00", "Loaded Total": 116112}, {"dt": "2006-06-01T00:00:00", "Loaded Total": 117997}, {"dt": "2006-07-01T00:00:00", "Loaded Total": 118656}, {"dt": "2006-08-01T00:00:00", "Loaded Total": 119055}, {"dt": "2006-09-01T00:00:00", "Loaded Total": 98368}, {"dt": "2006-10-01T00:00:00", "Loaded Total": 120330}, {"dt": "2006-11-01T00:00:00", "Loaded Total": 119774}, {"dt": "2006-12-01T00:00:00", "Loaded Total": 109878}, {"dt": "2007-01-01T00:00:00", "Loaded Total": 105678}, {"dt": "2007-02-01T00:00:00", "Loaded Total": 104099}, {"dt": "2007-03-01T00:00:00", "Loaded Total": 122169}, {"dt": "2007-04-01T00:00:00", "Loaded Total": 110577}, {"dt": "2007-05-01T00:00:00", "Loaded Total": 123233}, {"dt": "2007-06-01T00:00:00", "Loaded Total": 112647}, {"dt": "2007-07-01T00:00:00", "Loaded Total": 122475}, {"dt": "2007-08-01T00:00:00", "Loaded Total": 129372}, {"dt": "2007-09-01T00:00:00", "Loaded Total": 116899}, {"dt": "2007-10-01T00:00:00", "Loaded Total": 123114}, {"dt": "2007-11-01T00:00:00", "Loaded Total": 123451}, {"dt": "2007-12-01T00:00:00", "Loaded Total": 115292}, {"dt": "2008-01-01T00:00:00", "Loaded Total": 110057}, {"dt": "2008-02-01T00:00:00", "Loaded Total": 118891}, {"dt": "2008-03-01T00:00:00", "Loaded Total": 121892}, {"dt": "2008-04-01T00:00:00", "Loaded Total": 123963}, {"dt": "2008-05-01T00:00:00", "Loaded Total": 123714}, {"dt": "2008-06-01T00:00:00", "Loaded Total": 125559}, {"dt": "2008-07-01T00:00:00", "Loaded Total": 133440}, {"dt": "2008-08-01T00:00:00", "Loaded Total": 120238}, {"dt": "2008-09-01T00:00:00", "Loaded Total": 97916}, {"dt": "2008-10-01T00:00:00", "Loaded Total": 131950}, {"dt": "2008-11-01T00:00:00", "Loaded Total": 99941}, {"dt": "2008-12-01T00:00:00", "Loaded Total": 106287}, {"dt": "2009-01-01T00:00:00", "Loaded Total": 94164}, {"dt": "2009-02-01T00:00:00", "Loaded Total": 98095}, {"dt": "2009-03-01T00:00:00", "Loaded Total": 104236}, {"dt": "2009-04-01T00:00:00", "Loaded Total": 115815}, {"dt": "2009-05-01T00:00:00", "Loaded Total": 106230}, {"dt": "2009-06-01T00:00:00", "Loaded Total": 102142}, {"dt": "2009-07-01T00:00:00", "Loaded Total": 116772}, {"dt": "2009-08-01T00:00:00", "Loaded Total": 106466}, {"dt": "2009-09-01T00:00:00", "Loaded Total": 117008}, {"dt": "2009-10-01T00:00:00", "Loaded Total": 119860}, {"dt": "2009-11-01T00:00:00", "Loaded Total": 108659}, {"dt": "2009-12-01T00:00:00", "Loaded Total": 104938}, {"dt": "2010-01-01T00:00:00", "Loaded Total": 98861}, {"dt": "2010-02-01T00:00:00", "Loaded Total": 101955}, {"dt": "2010-03-01T00:00:00", "Loaded Total": 123878}, {"dt": "2010-04-01T00:00:00", "Loaded Total": 104394}, {"dt": "2010-05-01T00:00:00", "Loaded Total": 115857}, {"dt": "2010-06-01T00:00:00", "Loaded Total": 115838}, {"dt": "2010-07-01T00:00:00", "Loaded Total": 114397}, {"dt": "2010-08-01T00:00:00", "Loaded Total": 115780}, {"dt": "2010-09-01T00:00:00", "Loaded Total": 116455}, {"dt": "2010-10-01T00:00:00", "Loaded Total": 116921}, {"dt": "2010-11-01T00:00:00", "Loaded Total": 108572}, {"dt": "2010-12-01T00:00:00", "Loaded Total": 115996}, {"dt": "2011-01-01T00:00:00", "Loaded Total": 103727}, {"dt": "2011-02-01T00:00:00", "Loaded Total": 99498}, {"dt": "2011-03-01T00:00:00", "Loaded Total": 143080}, {"dt": "2011-04-01T00:00:00", "Loaded Total": 122783}, {"dt": "2011-05-01T00:00:00", "Loaded Total": 120427}, {"dt": "2011-06-01T00:00:00", "Loaded Total": 115291}, {"dt": "2011-07-01T00:00:00", "Loaded Total": 108180}, {"dt": "2011-08-01T00:00:00", "Loaded Total": 119932}, {"dt": "2011-09-01T00:00:00", "Loaded Total": 119207}, {"dt": "2011-10-01T00:00:00", "Loaded Total": 116413}, {"dt": "2011-11-01T00:00:00", "Loaded Total": 118776}, {"dt": "2011-12-01T00:00:00", "Loaded Total": 119509}, {"dt": "2012-01-01T00:00:00", "Loaded Total": 112529}, {"dt": "2012-02-01T00:00:00", "Loaded Total": 107345}, {"dt": "2012-03-01T00:00:00", "Loaded Total": 125058}, {"dt": "2012-04-01T00:00:00", "Loaded Total": 114292}, {"dt": "2012-05-01T00:00:00", "Loaded Total": 127448}, {"dt": "2012-06-01T00:00:00", "Loaded Total": 120322}, {"dt": "2012-07-01T00:00:00", "Loaded Total": 132069}, {"dt": "2012-08-01T00:00:00", "Loaded Total": 140692}, {"dt": "2012-09-01T00:00:00", "Loaded Total": 129929}, {"dt": "2012-10-01T00:00:00", "Loaded Total": 124259}, {"dt": "2012-11-01T00:00:00", "Loaded Total": 126593}, {"dt": "2012-12-01T00:00:00", "Loaded Total": 119204}, {"dt": "2013-01-01T00:00:00", "Loaded Total": 119942}, {"dt": "2013-02-01T00:00:00", "Loaded Total": 116615}, {"dt": "2013-03-01T00:00:00", "Loaded Total": 132627}, {"dt": "2013-04-01T00:00:00", "Loaded Total": 122481}, {"dt": "2013-05-01T00:00:00", "Loaded Total": 137791}, {"dt": "2013-06-01T00:00:00", "Loaded Total": 128176}, {"dt": "2013-07-01T00:00:00", "Loaded Total": 133765}, {"dt": "2013-08-01T00:00:00", "Loaded Total": 139334}, {"dt": "2013-09-01T00:00:00", "Loaded Total": 118842}, {"dt": "2013-10-01T00:00:00", "Loaded Total": 135093}, {"dt": "2013-11-01T00:00:00", "Loaded Total": 118926}, {"dt": "2013-12-01T00:00:00", "Loaded Total": 117716}, {"dt": "2014-01-01T00:00:00", "Loaded Total": 129165}, {"dt": "2014-02-01T00:00:00", "Loaded Total": 109267}, {"dt": "2014-03-01T00:00:00", "Loaded Total": 138398}, {"dt": "2014-04-01T00:00:00", "Loaded Total": 125054}, {"dt": "2014-05-01T00:00:00", "Loaded Total": 141697}, {"dt": "2014-06-01T00:00:00", "Loaded Total": 136880}, {"dt": "2014-07-01T00:00:00", "Loaded Total": 140776}, {"dt": "2014-08-01T00:00:00", "Loaded Total": 142769}, {"dt": "2014-09-01T00:00:00", "Loaded Total": 134179}, {"dt": "2014-10-01T00:00:00", "Loaded Total": 134708}, {"dt": "2014-11-01T00:00:00", "Loaded Total": 130767}, {"dt": "2014-12-01T00:00:00", "Loaded Total": 127290}, {"dt": "2015-01-01T00:00:00", "Loaded Total": 134633}, {"dt": "2015-02-01T00:00:00", "Loaded Total": 139532}, {"dt": "2015-03-01T00:00:00", "Loaded Total": 155801}, {"dt": "2015-04-01T00:00:00", "Loaded Total": 181653}, {"dt": "2015-05-01T00:00:00", "Loaded Total": 176242}, {"dt": "2015-06-01T00:00:00", "Loaded Total": 153157}, {"dt": "2015-07-01T00:00:00", "Loaded Total": 153411}, {"dt": "2015-08-01T00:00:00", "Loaded Total": 147411}, {"dt": "2015-09-01T00:00:00", "Loaded Total": 136372}, {"dt": "2015-10-01T00:00:00", "Loaded Total": 144462}, {"dt": "2015-11-01T00:00:00", "Loaded Total": 125404}, {"dt": "2015-12-01T00:00:00", "Loaded Total": 140144}, {"dt": "2016-01-01T00:00:00", "Loaded Total": 132290}, {"dt": "2016-02-01T00:00:00", "Loaded Total": 140946}, {"dt": "2016-03-01T00:00:00", "Loaded Total": 149460}, {"dt": "2016-04-01T00:00:00", "Loaded Total": 163965}, {"dt": "2016-05-01T00:00:00", "Loaded Total": 140311}, {"dt": "2016-06-01T00:00:00", "Loaded Total": 153001}, {"dt": "2016-07-01T00:00:00", "Loaded Total": 155937}, {"dt": "2016-08-01T00:00:00", "Loaded Total": 156356}, {"dt": "2016-09-01T00:00:00", "Loaded Total": 155706}, {"dt": "2016-10-01T00:00:00", "Loaded Total": 154181}, {"dt": "2016-11-01T00:00:00", "Loaded Total": 152767}, {"dt": "2016-12-01T00:00:00", "Loaded Total": 145991}, {"dt": "2017-01-01T00:00:00", "Loaded Total": 172992}, {"dt": "2017-02-01T00:00:00", "Loaded Total": 161942}, {"dt": "2017-03-01T00:00:00", "Loaded Total": 179440}, {"dt": "2017-04-01T00:00:00", "Loaded Total": 168670}, {"dt": "2017-05-01T00:00:00", "Loaded Total": 172362}, {"dt": "2017-06-01T00:00:00", "Loaded Total": 175709}, {"dt": "2017-07-01T00:00:00", "Loaded Total": 167566}, {"dt": "2017-08-01T00:00:00", "Loaded Total": 135820}, {"dt": "2017-09-01T00:00:00", "Loaded Total": 186819}, {"dt": "2017-10-01T00:00:00", "Loaded Total": 180162}, {"dt": "2017-11-01T00:00:00", "Loaded Total": 162097}, {"dt": "2017-12-01T00:00:00", "Loaded Total": 178651}, {"dt": "2018-01-01T00:00:00", "Loaded Total": 160589}, {"dt": "2018-02-01T00:00:00", "Loaded Total": 170405}, {"dt": "2018-03-01T00:00:00", "Loaded Total": 190816}, {"dt": "2018-04-01T00:00:00", "Loaded Total": 183890}, {"dt": "2018-05-01T00:00:00", "Loaded Total": 200869}, {"dt": "2018-06-01T00:00:00", "Loaded Total": 190050}, {"dt": "2018-07-01T00:00:00", "Loaded Total": 194107}, {"dt": "2018-08-01T00:00:00", "Loaded Total": 195282}, {"dt": "2018-09-01T00:00:00", "Loaded Total": 188449}, {"dt": "2018-10-01T00:00:00", "Loaded Total": 204539}, {"dt": "2018-11-01T00:00:00", "Loaded Total": 190720}, {"dt": "2018-12-01T00:00:00", "Loaded Total": 185047}, {"dt": "2019-01-01T00:00:00", "Loaded Total": 183279}, {"dt": "2019-02-01T00:00:00", "Loaded Total": 173413}, {"dt": "2019-03-01T00:00:00", "Loaded Total": 227899}, {"dt": "2019-04-01T00:00:00", "Loaded Total": 207281}, {"dt": "2019-05-01T00:00:00", "Loaded Total": 223819}, {"dt": "2019-06-01T00:00:00", "Loaded Total": 211588}, {"dt": "2019-07-01T00:00:00", "Loaded Total": 215532}, {"dt": "2019-08-01T00:00:00", "Loaded Total": 219706}, {"dt": "2019-09-01T00:00:00", "Loaded Total": 208579}, {"dt": "2019-10-01T00:00:00", "Loaded Total": 219947}, {"dt": "2019-11-01T00:00:00", "Loaded Total": 209421}, {"dt": "2019-12-01T00:00:00", "Loaded Total": 209995}, {"dt": "2020-01-01T00:00:00", "Loaded Total": 223829}, {"dt": "2020-02-01T00:00:00", "Loaded Total": 200777}, {"dt": "2020-03-01T00:00:00", "Loaded Total": 203274}, {"dt": "2020-04-01T00:00:00", "Loaded Total": 191842}, {"dt": "2020-05-01T00:00:00", "Loaded Total": 200047}, {"dt": "2020-06-01T00:00:00", "Loaded Total": 184538}, {"dt": "2020-07-01T00:00:00", "Loaded Total": 200848}, {"dt": "2020-08-01T00:00:00", "Loaded Total": 215266}, {"dt": "2020-09-01T00:00:00", "Loaded Total": 213923}, {"dt": "2020-10-01T00:00:00", "Loaded Total": 232360}, {"dt": "2020-11-01T00:00:00", "Loaded Total": 225230}, {"dt": "2020-12-01T00:00:00", "Loaded Total": 235501}, {"dt": "2021-01-01T00:00:00", "Loaded Total": 221272}, {"dt": "2021-02-01T00:00:00", "Loaded Total": 172274}, {"dt": "2021-03-01T00:00:00", "Loaded Total": 241004}, {"dt": "2021-04-01T00:00:00", "Loaded Total": 220600}, {"dt": "2021-05-01T00:00:00", "Loaded Total": 228292}, {"dt": "2021-06-01T00:00:00", "Loaded Total": 224062}, {"dt": "2021-07-01T00:00:00", "Loaded Total": 212654}, {"dt": "2021-08-01T00:00:00", "Loaded Total": 245451}, {"dt": "2021-09-01T00:00:00", "Loaded Total": 205152}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Port-of-Charleston">Port of Charleston<a class="anchor-link" href="#Port-of-Charleston">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[35]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">fetchCharleston</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">retries</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">retries</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span> <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="n">uaString</span> <span class="p">})</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

        <span class="n">dfs_ch</span> <span class="o">=</span> <span class="n">read_pdf</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">()),</span> <span class="n">pages</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>

        <span class="c1"># noop</span>
        <span class="n">dfs_ch</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="k">return</span> <span class="n">dfs_ch</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Response code: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">getcode</span><span class="p">()))</span>
        <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fetchCharleston</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">retries</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">URLError</span><span class="p">:</span>
        <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fetchCharleston</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">retries</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">dfs_ch</span> <span class="o">=</span> <span class="n">fetchCharleston</span><span class="p">(</span><span class="s2">&quot;http://scspa.com/wp-content/uploads/gl078-pc-teu-history.pdf&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[36]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">fixColumns</span><span class="p">(</span><span class="n">df_</span><span class="p">):</span>
    <span class="n">firstDataRow</span> <span class="o">=</span> <span class="mi">2</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">df_</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
     
    <span class="c1"># Standardize column count</span>
    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
        <span class="c1"># Standardize rail moves column location</span>
        <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
        
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">res</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">firstDataRow</span><span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
    
    <span class="c1">#print(df.iloc[firstDataRow:, 2].values)</span>
    
    <span class="c1"># split rail column </span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">firstDataRow</span><span class="p">:,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">expand</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    
    <span class="c1">#print(_)</span>

    <span class="n">res</span><span class="p">[</span><span class="s2">&quot;RAIL-MOVES&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">res</span><span class="p">[</span><span class="s2">&quot;RAIL-RATIO&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
        
    <span class="c1">#res = pd.concat([df.iloc[firstDataRow:, 0:4], res.iloc[:, 2:]], axis=1)</span>

    <span class="c1"># split pier loaded column </span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">firstDataRow</span><span class="p">:,</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">expand</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> 

    <span class="n">res</span><span class="p">[</span><span class="s2">&quot;PIER-LOADED-EXPORT&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> 

    <span class="k">try</span><span class="p">:</span>
        <span class="n">res</span><span class="p">[</span><span class="s2">&quot;PIER-LOADED-IMPORT&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> 
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
        
    <span class="c1">#res = pd.concat([res, res.iloc[:, -2:]], axis=1)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># split pier empty column </span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">firstDataRow</span><span class="p">:,</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">expand</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> 

        <span class="n">res</span><span class="p">[</span><span class="s2">&quot;PIER-EMPTY-EXPORT&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">res</span><span class="p">[</span><span class="s2">&quot;PIER-EMPTY-IMPORT&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="n">res</span><span class="p">[</span><span class="s2">&quot;PIER-EMPTY-EXPORT&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">res</span><span class="p">[</span><span class="s2">&quot;PIER-EMPTY-IMPORT&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="c1">#res[&quot;PIER-TOTAL&quot;]= _[2] </span>

    <span class="c1">#res = pd.concat([df.iloc[firstDataRow:, 0], res.iloc[:, 2:]], axis=1)</span>

    <span class="c1"># split loaded teu column </span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">firstDataRow</span><span class="p">:,</span> <span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">expand</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> 

    <span class="n">res</span><span class="p">[</span><span class="s2">&quot;TEU-LOADED-EXPORT&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">res</span><span class="p">[</span><span class="s2">&quot;TEU-LOADED-IMPORT&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="c1">#res = pd.concat([df.iloc[firstDataRow:, 0], df.iloc[firstDataRow:, 4:6], res.iloc[:, 8:10], df.iloc[firstDataRow:, -1]], axis=1)</span>

    <span class="c1">#print(res)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># split empty teu column </span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">firstDataRow</span><span class="p">:,</span> <span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">expand</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> 

        <span class="n">res</span><span class="p">[</span><span class="s2">&quot;TEU-EMPTY-EXPORT&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">res</span><span class="p">[</span><span class="s2">&quot;TEU-EMPTY-IMPORT&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="n">res</span><span class="p">[</span><span class="s2">&quot;TEU-EMPTY-EXPORT&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">res</span><span class="p">[</span><span class="s2">&quot;TEU-EMPTY-IMPORT&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1">#res = pd.concat([df.iloc[firstDataRow:, 0], df.iloc[firstDataRow:, 4:6], res.iloc[:, 8:], df.iloc[firstDataRow:, -1]], axis=1)</span>

    <span class="n">res</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">res</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
                     <span class="n">res</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
                     <span class="n">res</span><span class="p">[</span><span class="s2">&quot;RAIL-MOVES&quot;</span><span class="p">],</span>
                     <span class="n">res</span><span class="p">[</span><span class="s2">&quot;RAIL-RATIO&quot;</span><span class="p">],</span>
                     <span class="n">res</span><span class="p">[</span><span class="s2">&quot;PIER-LOADED-EXPORT&quot;</span><span class="p">],</span>
                     <span class="n">res</span><span class="p">[</span><span class="s2">&quot;PIER-LOADED-IMPORT&quot;</span><span class="p">],</span>
                     <span class="n">res</span><span class="p">[</span><span class="s2">&quot;PIER-EMPTY-EXPORT&quot;</span><span class="p">],</span>
                     <span class="n">res</span><span class="p">[</span><span class="s2">&quot;PIER-EMPTY-IMPORT&quot;</span><span class="p">],</span>
                     <span class="n">res</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">5</span><span class="p">],</span>
                     <span class="n">res</span><span class="p">[</span><span class="s2">&quot;TEU-LOADED-EXPORT&quot;</span><span class="p">],</span>
                     <span class="n">res</span><span class="p">[</span><span class="s2">&quot;TEU-LOADED-IMPORT&quot;</span><span class="p">],</span>
                     <span class="n">res</span><span class="p">[</span><span class="s2">&quot;TEU-EMPTY-EXPORT&quot;</span><span class="p">],</span>
                     <span class="n">res</span><span class="p">[</span><span class="s2">&quot;TEU-EMPTY-IMPORT&quot;</span><span class="p">],</span>
                     <span class="n">res</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">8</span><span class="p">],</span>
                    <span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">res</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DATE&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;RAIL-DRAYS&#39;</span><span class="p">,</span> <span class="s1">&#39;RAIL-MOVES&#39;</span><span class="p">,</span> <span class="s1">&#39;RAIL-RATIO&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;PIER-LOADED-EXPORT&#39;</span><span class="p">,</span> <span class="s1">&#39;PIER-LOADED-IMPORT&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;PIER-EMPTY-EXPORT&#39;</span><span class="p">,</span> <span class="s1">&#39;PIER-EMPTY-IMPORT&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;PIER-TOTAL&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;TEU-LOADED-EXPORT&#39;</span><span class="p">,</span> <span class="s1">&#39;TEU-LOADED-IMPORT&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;TEU-EMPTY-EXPORT&#39;</span><span class="p">,</span> <span class="s1">&#39;TEU-EMPTY-IMPORT&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;TEU-TOTAL&#39;</span><span class="p">]</span>
    <span class="c1">#print(res)</span>
    
    <span class="c1"># fix remaining column labels</span>
    <span class="c1">#res.columns = [&#39;DATE&#39;, &#39;RAIL-DRAYS&#39;, &#39;RAIL-MOVES&#39;] + res.columns.to_list()[3:-1] + [&quot;TEU-TOTAL&quot;]</span>

    <span class="c1"># convert all columns to numeric</span>
    <span class="n">res</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>\
            <span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">v</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">))</span>

    
    <span class="n">res</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">:]</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">:]</span>\
            <span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">v</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">))</span>

    <span class="n">res</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%B, %Y&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">res</span>

<span class="n">df_ch</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">fixColumns</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dfs_ch</span><span class="p">[:</span><span class="mi">2</span><span class="p">]])</span>

<span class="c1">#df_ch.head()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>  Unnamed: 0  Unnamed: 1  Unnamed: 2                    Unnamed: 3  \
0        NaN         NaN         NaN                           NaN   
1        NaN         NaN         NaN                           NaN   
2        NaN         NaN         NaN  CONTAINER RAIL MOVES HISTORY   
3     PERIOD  RAIL DRAYS         NaN          CHS RAIL MOVES RATIO   
4        NaN         NaN         NaN                           NaN   

  RAIL MOVE, PIER CONTAINER &amp; TEU HISTORY Unnamed: 4   Unnamed: 5     GL078  
0                                     NaN        NaN          NaN  10/08/21  
1                                     NaN        NaN          NaN   8:01:16  
2                  PIER CONTAINER HISTORY        NaN  TEU HISTORY       NaN  
3                            LOADED EMPTY        NaN          NaN       NaN  
4             EXPORT IMPORT EXPORT IMPORT        NaN          NaN       NaN  
  Unnamed: 0  Unnamed: 1 CONTAINER RAIL MOVES HISTORY     Unnamed: 3  \
0     PERIOD  RAIL DRAYS         CHS RAIL MOVES RATIO         LOADED   
1        NaN         NaN                          NaN  EXPORT IMPORT   
2        NaN         NaN                          NaN            NaN   
3        NaN         NaN                          NaN            NaN   
4        NaN         NaN                          NaN            NaN   

  PIER CONTAINER HISTORY Unnamed: 4     Unnamed: 5    TEU HISTORY Unnamed: 6  
0                  EMPTY        NaN            NaN            NaN        NaN  
1          EXPORT IMPORT        NaN            NaN            NaN        NaN  
2                    NaN      TOTAL         LOADED          EMPTY        NaN  
3                    NaN        NaN  EXPORT IMPORT  EXPORT IMPORT        NaN  
4                    NaN        NaN            NaN            NaN      TOTAL  
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-green-fg">/var/folders/gf/01jzxy9d4_7f26pgq7d9fxch0000gp/T/ipykernel_75362/3328239332.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">    127</span>     <span class="ansi-green-fg">return</span> res
<span class="ansi-green-intense-fg ansi-bold">    128</span> 
<span class="ansi-green-fg">--&gt; 129</span><span class="ansi-red-fg"> </span>df_ch <span class="ansi-blue-fg">=</span> pd<span class="ansi-blue-fg">.</span>concat<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">[</span>fixColumns<span class="ansi-blue-fg">(</span>d<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> d <span class="ansi-green-fg">in</span> dfs_ch<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">:</span><span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    130</span> 
<span class="ansi-green-intense-fg ansi-bold">    131</span> <span class="ansi-red-fg">#df_ch.head()</span>

<span class="ansi-green-fg">~/opt/anaconda3/lib/python3.8/site-packages/pandas/util/_decorators.py</span> in <span class="ansi-cyan-fg">wrapper</span><span class="ansi-blue-fg">(*args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    309</span>                     stacklevel<span class="ansi-blue-fg">=</span>stacklevel<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    310</span>                 )
<span class="ansi-green-fg">--&gt; 311</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">return</span> func<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    312</span> 
<span class="ansi-green-intense-fg ansi-bold">    313</span>         <span class="ansi-green-fg">return</span> wrapper

<span class="ansi-green-fg">~/opt/anaconda3/lib/python3.8/site-packages/pandas/core/reshape/concat.py</span> in <span class="ansi-cyan-fg">concat</span><span class="ansi-blue-fg">(objs, axis, join, ignore_index, keys, levels, names, verify_integrity, sort, copy)</span>
<span class="ansi-green-intense-fg ansi-bold">    292</span>     ValueError<span class="ansi-blue-fg">:</span> Indexes have overlapping values<span class="ansi-blue-fg">:</span> <span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;a&#39;</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">    293</span>     &#34;&#34;&#34;
<span class="ansi-green-fg">--&gt; 294</span><span class="ansi-red-fg">     op = _Concatenator(
</span><span class="ansi-green-intense-fg ansi-bold">    295</span>         objs<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    296</span>         axis<span class="ansi-blue-fg">=</span>axis<span class="ansi-blue-fg">,</span>

<span class="ansi-green-fg">~/opt/anaconda3/lib/python3.8/site-packages/pandas/core/reshape/concat.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">(self, objs, axis, join, keys, levels, names, ignore_index, verify_integrity, copy, sort)</span>
<span class="ansi-green-intense-fg ansi-bold">    372</span> 
<span class="ansi-green-intense-fg ansi-bold">    373</span>         <span class="ansi-green-fg">if</span> len<span class="ansi-blue-fg">(</span>objs<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">==</span> <span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 374</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">raise</span> ValueError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;All objects passed were None&#34;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    375</span> 
<span class="ansi-green-intense-fg ansi-bold">    376</span>         <span class="ansi-red-fg"># figure out what our result ndim is going to be</span>

<span class="ansi-red-fg">ValueError</span>: All objects passed were None</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_ch</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;TEU-LOADED-EXPORT&#39;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Charleston&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_ch</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;TEU-LOADED-IMPORT&#39;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Charleston&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_ch</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;TEU-TOTAL&#39;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Charleston&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Port-of-Virginia">Port of Virginia<a class="anchor-link" href="#Port-of-Virginia">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[42]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># http://www.portofvirginia.com/who-we-are/port-stats/</span>

<span class="c1">#raise RuntimeError(&quot;Broken&quot;)</span>

<span class="c1">#result = !curl -sL &#39;http://www.portofvirginia.com/who-we-are/port-stats/&#39; | grep &#39;xlsx&#39;</span>

<span class="c1">#currentReport = [u for u in re.findall(&#39;href=&quot;([^&quot;]+)&quot;&#39;, &quot;&quot;.join(result)) if &quot;xls&quot; in u][0]</span>

<span class="n">baseUrl</span> <span class="o">=</span> <span class="s2">&quot;http://www.portofvirginia.com/who-we-are/port-stats/&quot;</span>

<span class="k">def</span> <span class="nf">fetchCurrentReport</span><span class="p">():</span> 
    <span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">executable_path</span><span class="o">=</span><span class="s1">&#39;/usr/local/bin/chromedriver&#39;</span><span class="p">,</span>
                              <span class="n">options</span><span class="o">=</span><span class="n">chrome_options</span><span class="p">)</span>

    <span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">baseUrl</span><span class="p">)</span>
    
    <span class="n">wait</span> <span class="o">=</span> <span class="n">WebDriverWait</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
    
    <span class="c1">#wait.until(ajaxComplete)</span>

    <span class="n">wait</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">CSS_SELECTOR</span><span class="p">,</span> <span class="s2">&quot;#container&quot;</span><span class="p">)))</span>
    
    <span class="n">reportLink</span> <span class="o">=</span> <span class="s2">&quot;#container &gt; div &gt; section &gt; article &gt; div &gt; ul &gt; li:nth-child(2) &gt; a&quot;</span>

    <span class="k">return</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_css_selector</span><span class="p">(</span><span class="n">reportLink</span><span class="p">)</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span>

<span class="n">currentReport</span> <span class="o">=</span> <span class="n">fetchCurrentReport</span><span class="p">()</span>

<span class="c1">#print(currentReport)</span>

<span class="n">oldUrl</span> <span class="o">=</span> <span class="s2">&quot;http://www.portofvirginia.com/excel/Port_of_Virginia_Statistics.xlsx&quot;</span>

<span class="n">url</span> <span class="o">=</span> <span class="n">currentReport</span> <span class="c1">#&quot;https://web.archive.org/web/20191218025738if_/http://www.portofvirginia.com/excel/Port_of_Virginia_Statistics.xlsx&quot;</span>
<span class="n">df_va</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_va</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="s1">&#39;Key&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df_va</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()[</span><span class="mi">2</span><span class="p">:]</span>

<span class="n">df_va</span> <span class="o">=</span> <span class="n">df_va</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">71</span><span class="p">]</span>
<span class="n">df_va</span> <span class="o">=</span> <span class="n">df_va</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">df_va</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_va</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ffill</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1">#df_va.head(20)</span>

<span class="n">df_va_melted</span> <span class="o">=</span> <span class="n">df_va</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="s1">&#39;Key&#39;</span><span class="p">])</span>
<span class="n">df_va_melted</span> <span class="o">=</span> <span class="n">df_va_melted</span><span class="p">[</span><span class="o">~</span><span class="n">df_va_melted</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
<span class="n">df_va_melted</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_va_melted</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">df_va_melted</span><span class="p">[</span><span class="s1">&#39;variable&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%b %Y&quot;</span><span class="p">)</span>

<span class="n">df_va_clean</span> <span class="o">=</span> <span class="n">df_va_melted</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Key&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[43]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_va_clean</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Virgina&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Export Empties&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[43]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-b6e7e7afdfcc4de2908edd00b587bd82"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-b6e7e7afdfcc4de2908edd00b587bd82") {
      outputDiv = document.getElementById("altair-viz-b6e7e7afdfcc4de2908edd00b587bd82");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector025"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Virgina Export Empties Container Volume", "transform": [{"window": [{"op": "lag", "field": "Export Empties", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Export Empties'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt"}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Export Empties"}}, "height": 100, "selection": {"selector025": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-f2e79820c08e047bddf7bda3c4518eff"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-f2e79820c08e047bddf7bda3c4518eff": [{"dt": "2009-01-01T00:00:00", "Export Empties": 21532.0}, {"dt": "2009-02-01T00:00:00", "Export Empties": 11786.0}, {"dt": "2009-03-01T00:00:00", "Export Empties": 9678.0}, {"dt": "2009-04-01T00:00:00", "Export Empties": 9799.0}, {"dt": "2009-05-01T00:00:00", "Export Empties": 9867.0}, {"dt": "2009-06-01T00:00:00", "Export Empties": 9871.0}, {"dt": "2009-07-01T00:00:00", "Export Empties": 9360.0}, {"dt": "2009-08-01T00:00:00", "Export Empties": 11700.0}, {"dt": "2009-09-01T00:00:00", "Export Empties": 13262.0}, {"dt": "2009-10-01T00:00:00", "Export Empties": 10762.0}, {"dt": "2009-11-01T00:00:00", "Export Empties": 10634.0}, {"dt": "2009-12-01T00:00:00", "Export Empties": 8278.0}, {"dt": "2010-01-01T00:00:00", "Export Empties": 10705.0}, {"dt": "2010-02-01T00:00:00", "Export Empties": 9442.0}, {"dt": "2010-03-01T00:00:00", "Export Empties": 9582.0}, {"dt": "2010-04-01T00:00:00", "Export Empties": 10398.0}, {"dt": "2010-05-01T00:00:00", "Export Empties": 14605.0}, {"dt": "2010-06-01T00:00:00", "Export Empties": 16800.0}, {"dt": "2010-07-01T00:00:00", "Export Empties": 20056.0}, {"dt": "2010-08-01T00:00:00", "Export Empties": 24547.0}, {"dt": "2010-09-01T00:00:00", "Export Empties": 21075.0}, {"dt": "2010-10-01T00:00:00", "Export Empties": 16932.0}, {"dt": "2010-11-01T00:00:00", "Export Empties": 14190.0}, {"dt": "2010-12-01T00:00:00", "Export Empties": 12707.0}, {"dt": "2011-01-01T00:00:00", "Export Empties": 11648.0}, {"dt": "2011-02-01T00:00:00", "Export Empties": 14368.0}, {"dt": "2011-03-01T00:00:00", "Export Empties": 13509.0}, {"dt": "2011-04-01T00:00:00", "Export Empties": 12182.0}, {"dt": "2011-05-01T00:00:00", "Export Empties": 12886.0}, {"dt": "2011-06-01T00:00:00", "Export Empties": 13284.5}, {"dt": "2011-07-01T00:00:00", "Export Empties": 15686.0}, {"dt": "2011-08-01T00:00:00", "Export Empties": 15387.0}, {"dt": "2011-09-01T00:00:00", "Export Empties": 18860.0}, {"dt": "2011-10-01T00:00:00", "Export Empties": 17720.0}, {"dt": "2011-11-01T00:00:00", "Export Empties": 17757.0}, {"dt": "2011-12-01T00:00:00", "Export Empties": 13515.0}, {"dt": "2012-01-01T00:00:00", "Export Empties": 13559.0}, {"dt": "2012-02-01T00:00:00", "Export Empties": 9976.0}, {"dt": "2012-03-01T00:00:00", "Export Empties": 10840.0}, {"dt": "2012-04-01T00:00:00", "Export Empties": 15513.0}, {"dt": "2012-05-01T00:00:00", "Export Empties": 14763.25}, {"dt": "2012-06-01T00:00:00", "Export Empties": 14054.0}, {"dt": "2012-07-01T00:00:00", "Export Empties": 20690.0}, {"dt": "2012-08-01T00:00:00", "Export Empties": 20761.0}, {"dt": "2012-09-01T00:00:00", "Export Empties": 20493.25}, {"dt": "2012-10-01T00:00:00", "Export Empties": 22334.0}, {"dt": "2012-11-01T00:00:00", "Export Empties": 18065.0}, {"dt": "2012-12-01T00:00:00", "Export Empties": 14518.75}, {"dt": "2013-01-01T00:00:00", "Export Empties": 12171.75}, {"dt": "2013-02-01T00:00:00", "Export Empties": 12404.0}, {"dt": "2013-03-01T00:00:00", "Export Empties": 11722.0}, {"dt": "2013-04-01T00:00:00", "Export Empties": 13132.75}, {"dt": "2013-05-01T00:00:00", "Export Empties": 18376.5}, {"dt": "2013-06-01T00:00:00", "Export Empties": 16621.0}, {"dt": "2013-07-01T00:00:00", "Export Empties": 17964.5}, {"dt": "2013-08-01T00:00:00", "Export Empties": 17371.75}, {"dt": "2013-09-01T00:00:00", "Export Empties": 17217.0}, {"dt": "2013-10-01T00:00:00", "Export Empties": 17439.5}, {"dt": "2013-11-01T00:00:00", "Export Empties": 17710.75}, {"dt": "2013-12-01T00:00:00", "Export Empties": 16257.25}, {"dt": "2014-01-01T00:00:00", "Export Empties": 12731.75}, {"dt": "2014-02-01T00:00:00", "Export Empties": 13725.5}, {"dt": "2014-03-01T00:00:00", "Export Empties": 14422.5}, {"dt": "2014-04-01T00:00:00", "Export Empties": 16490.0}, {"dt": "2014-05-01T00:00:00", "Export Empties": 20495.0}, {"dt": "2014-06-01T00:00:00", "Export Empties": 23123.5}, {"dt": "2014-07-01T00:00:00", "Export Empties": 23502.0}, {"dt": "2014-08-01T00:00:00", "Export Empties": 34269.0}, {"dt": "2014-09-01T00:00:00", "Export Empties": 32521.5}, {"dt": "2014-10-01T00:00:00", "Export Empties": 30847.75}, {"dt": "2014-11-01T00:00:00", "Export Empties": 23212.25}, {"dt": "2014-12-01T00:00:00", "Export Empties": 18521.75}, {"dt": "2015-01-01T00:00:00", "Export Empties": 23108.25}, {"dt": "2015-02-01T00:00:00", "Export Empties": 17263.5}, {"dt": "2015-03-01T00:00:00", "Export Empties": 17134.25}, {"dt": "2015-04-01T00:00:00", "Export Empties": 23099.5}, {"dt": "2015-05-01T00:00:00", "Export Empties": 35742.25}, {"dt": "2015-06-01T00:00:00", "Export Empties": 38626.5}, {"dt": "2015-07-01T00:00:00", "Export Empties": 39246.5}, {"dt": "2015-08-01T00:00:00", "Export Empties": 43513.0}, {"dt": "2015-09-01T00:00:00", "Export Empties": 42798.25}, {"dt": "2015-10-01T00:00:00", "Export Empties": 50516.25}, {"dt": "2015-11-01T00:00:00", "Export Empties": 32209.75}, {"dt": "2015-12-01T00:00:00", "Export Empties": 31125.75}, {"dt": "2016-01-01T00:00:00", "Export Empties": 26786.0}, {"dt": "2016-02-01T00:00:00", "Export Empties": 35020.75}, {"dt": "2016-03-01T00:00:00", "Export Empties": 28672.5}, {"dt": "2016-04-01T00:00:00", "Export Empties": 35977.75}, {"dt": "2016-05-01T00:00:00", "Export Empties": 39818.5}, {"dt": "2016-06-01T00:00:00", "Export Empties": 35632.5}, {"dt": "2016-07-01T00:00:00", "Export Empties": 37541.0}, {"dt": "2016-08-01T00:00:00", "Export Empties": 40049.0}, {"dt": "2016-09-01T00:00:00", "Export Empties": 35027.5}, {"dt": "2016-10-01T00:00:00", "Export Empties": 32711.75}, {"dt": "2016-11-01T00:00:00", "Export Empties": 36412.0}, {"dt": "2016-12-01T00:00:00", "Export Empties": 39193.75}, {"dt": "2017-01-01T00:00:00", "Export Empties": 31465.5}, {"dt": "2017-02-01T00:00:00", "Export Empties": 30437.0}, {"dt": "2017-03-01T00:00:00", "Export Empties": 32487.75}, {"dt": "2017-04-01T00:00:00", "Export Empties": 34927.25}, {"dt": "2017-05-01T00:00:00", "Export Empties": 56015.75}, {"dt": "2017-06-01T00:00:00", "Export Empties": 44037.0}, {"dt": "2017-07-01T00:00:00", "Export Empties": 46854.75}, {"dt": "2017-08-01T00:00:00", "Export Empties": 50063.75}, {"dt": "2017-09-01T00:00:00", "Export Empties": 49844.25}, {"dt": "2017-10-01T00:00:00", "Export Empties": 51182.5}, {"dt": "2017-11-01T00:00:00", "Export Empties": 40057.25}, {"dt": "2017-12-01T00:00:00", "Export Empties": 39364.0}, {"dt": "2018-01-01T00:00:00", "Export Empties": 37882.5}, {"dt": "2018-02-01T00:00:00", "Export Empties": 34156.0}, {"dt": "2018-03-01T00:00:00", "Export Empties": 38151.5}, {"dt": "2018-04-01T00:00:00", "Export Empties": 33311.0}, {"dt": "2018-05-01T00:00:00", "Export Empties": 40552.0}, {"dt": "2018-06-01T00:00:00", "Export Empties": 35615.0}, {"dt": "2018-07-01T00:00:00", "Export Empties": 48182.0}, {"dt": "2018-08-01T00:00:00", "Export Empties": 56726.75}, {"dt": "2018-09-01T00:00:00", "Export Empties": 44970.25}, {"dt": "2018-10-01T00:00:00", "Export Empties": 58615.75}, {"dt": "2018-11-01T00:00:00", "Export Empties": 47841.0}, {"dt": "2018-12-01T00:00:00", "Export Empties": 52045.5}, {"dt": "2019-01-01T00:00:00", "Export Empties": 50537.75}, {"dt": "2019-02-01T00:00:00", "Export Empties": 44037.75}, {"dt": "2019-03-01T00:00:00", "Export Empties": 41711.75}, {"dt": "2019-04-01T00:00:00", "Export Empties": 38579.5}, {"dt": "2019-05-01T00:00:00", "Export Empties": 51173.25}, {"dt": "2019-06-01T00:00:00", "Export Empties": 48622.25}, {"dt": "2019-07-01T00:00:00", "Export Empties": 56696.0}, {"dt": "2019-08-01T00:00:00", "Export Empties": 54405.25}, {"dt": "2019-09-01T00:00:00", "Export Empties": 52765.5}, {"dt": "2019-10-01T00:00:00", "Export Empties": 57427.25}, {"dt": "2019-11-01T00:00:00", "Export Empties": 44991.5}, {"dt": "2019-12-01T00:00:00", "Export Empties": 41854.25}, {"dt": "2020-01-01T00:00:00", "Export Empties": 36655.5}, {"dt": "2020-02-01T00:00:00", "Export Empties": 27917.5}, {"dt": "2020-03-01T00:00:00", "Export Empties": 26347.25}, {"dt": "2020-04-01T00:00:00", "Export Empties": 32604.5}, {"dt": "2020-05-01T00:00:00", "Export Empties": 39940.0}, {"dt": "2020-06-01T00:00:00", "Export Empties": 41840.75}, {"dt": "2020-07-01T00:00:00", "Export Empties": 45383.5}, {"dt": "2020-08-01T00:00:00", "Export Empties": 50159.75}, {"dt": "2020-09-01T00:00:00", "Export Empties": 57704.0}, {"dt": "2020-10-01T00:00:00", "Export Empties": 57644.25}, {"dt": "2020-11-01T00:00:00", "Export Empties": 64844.25}, {"dt": "2020-12-01T00:00:00", "Export Empties": 53175.25}, {"dt": "2021-01-01T00:00:00", "Export Empties": 54730.0}, {"dt": "2021-02-01T00:00:00", "Export Empties": 48493.5}, {"dt": "2021-03-01T00:00:00", "Export Empties": 51092.0}, {"dt": "2021-04-01T00:00:00", "Export Empties": 50909.0}, {"dt": "2021-05-01T00:00:00", "Export Empties": 67970.0}, {"dt": "2021-06-01T00:00:00", "Export Empties": 61368.75}, {"dt": "2021-07-01T00:00:00", "Export Empties": 66842.0}, {"dt": "2021-08-01T00:00:00", "Export Empties": 75925.0}, {"dt": "2021-09-01T00:00:00", "Export Empties": 70927.75}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[44]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_va_clean</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Virgina&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Import Loads&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[44]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-08ae1a02f4304f78a5d998c3f1207008"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-08ae1a02f4304f78a5d998c3f1207008") {
      outputDiv = document.getElementById("altair-viz-08ae1a02f4304f78a5d998c3f1207008");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector026"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Virgina Import Loads Container Volume", "transform": [{"window": [{"op": "lag", "field": "Import Loads", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Import Loads'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt"}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Import Loads"}}, "height": 100, "selection": {"selector026": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-8dd9a1bf07cfe8bdf4e78836b3a4485b"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-8dd9a1bf07cfe8bdf4e78836b3a4485b": [{"dt": "2009-01-01T00:00:00", "Import Loads": 55634.0}, {"dt": "2009-02-01T00:00:00", "Import Loads": 55223.0}, {"dt": "2009-03-01T00:00:00", "Import Loads": 53377.0}, {"dt": "2009-04-01T00:00:00", "Import Loads": 54487.0}, {"dt": "2009-05-01T00:00:00", "Import Loads": 54293.0}, {"dt": "2009-06-01T00:00:00", "Import Loads": 54490.0}, {"dt": "2009-07-01T00:00:00", "Import Loads": 58313.0}, {"dt": "2009-08-01T00:00:00", "Import Loads": 60431.0}, {"dt": "2009-09-01T00:00:00", "Import Loads": 63706.0}, {"dt": "2009-10-01T00:00:00", "Import Loads": 63222.0}, {"dt": "2009-11-01T00:00:00", "Import Loads": 59463.0}, {"dt": "2009-12-01T00:00:00", "Import Loads": 57292.0}, {"dt": "2010-01-01T00:00:00", "Import Loads": 51330.0}, {"dt": "2010-02-01T00:00:00", "Import Loads": 60737.0}, {"dt": "2010-03-01T00:00:00", "Import Loads": 63306.0}, {"dt": "2010-04-01T00:00:00", "Import Loads": 56636.0}, {"dt": "2010-05-01T00:00:00", "Import Loads": 65445.0}, {"dt": "2010-06-01T00:00:00", "Import Loads": 67022.0}, {"dt": "2010-07-01T00:00:00", "Import Loads": 65771.0}, {"dt": "2010-08-01T00:00:00", "Import Loads": 72959.0}, {"dt": "2010-09-01T00:00:00", "Import Loads": 65747.0}, {"dt": "2010-10-01T00:00:00", "Import Loads": 75750.0}, {"dt": "2010-11-01T00:00:00", "Import Loads": 67159.0}, {"dt": "2010-12-01T00:00:00", "Import Loads": 54818.0}, {"dt": "2011-01-01T00:00:00", "Import Loads": 64939.0}, {"dt": "2011-02-01T00:00:00", "Import Loads": 61659.0}, {"dt": "2011-03-01T00:00:00", "Import Loads": 60139.5}, {"dt": "2011-04-01T00:00:00", "Import Loads": 64573.25}, {"dt": "2011-05-01T00:00:00", "Import Loads": 62843.0}, {"dt": "2011-06-01T00:00:00", "Import Loads": 60048.5}, {"dt": "2011-07-01T00:00:00", "Import Loads": 68534.0}, {"dt": "2011-08-01T00:00:00", "Import Loads": 62959.5}, {"dt": "2011-09-01T00:00:00", "Import Loads": 67022.0}, {"dt": "2011-10-01T00:00:00", "Import Loads": 71694.5}, {"dt": "2011-11-01T00:00:00", "Import Loads": 66387.0}, {"dt": "2011-12-01T00:00:00", "Import Loads": 58074.0}, {"dt": "2012-01-01T00:00:00", "Import Loads": 62271.0}, {"dt": "2012-02-01T00:00:00", "Import Loads": 62751.75}, {"dt": "2012-03-01T00:00:00", "Import Loads": 68116.5}, {"dt": "2012-04-01T00:00:00", "Import Loads": 68954.0}, {"dt": "2012-05-01T00:00:00", "Import Loads": 72083.75}, {"dt": "2012-06-01T00:00:00", "Import Loads": 71130.0}, {"dt": "2012-07-01T00:00:00", "Import Loads": 78709.0}, {"dt": "2012-08-01T00:00:00", "Import Loads": 81770.25}, {"dt": "2012-09-01T00:00:00", "Import Loads": 76750.0}, {"dt": "2012-10-01T00:00:00", "Import Loads": 72946.0}, {"dt": "2012-11-01T00:00:00", "Import Loads": 85116.25}, {"dt": "2012-12-01T00:00:00", "Import Loads": 69719.0}, {"dt": "2013-01-01T00:00:00", "Import Loads": 62405.0}, {"dt": "2013-02-01T00:00:00", "Import Loads": 68595.0}, {"dt": "2013-03-01T00:00:00", "Import Loads": 70953.75}, {"dt": "2013-04-01T00:00:00", "Import Loads": 74000.5}, {"dt": "2013-05-01T00:00:00", "Import Loads": 77914.5}, {"dt": "2013-06-01T00:00:00", "Import Loads": 72839.25}, {"dt": "2013-07-01T00:00:00", "Import Loads": 89410.5}, {"dt": "2013-08-01T00:00:00", "Import Loads": 90565.25}, {"dt": "2013-09-01T00:00:00", "Import Loads": 80028.75}, {"dt": "2013-10-01T00:00:00", "Import Loads": 92093.0}, {"dt": "2013-11-01T00:00:00", "Import Loads": 79328.5}, {"dt": "2013-12-01T00:00:00", "Import Loads": 75984.5}, {"dt": "2014-01-01T00:00:00", "Import Loads": 69836.0}, {"dt": "2014-02-01T00:00:00", "Import Loads": 77646.5}, {"dt": "2014-03-01T00:00:00", "Import Loads": 80519.5}, {"dt": "2014-04-01T00:00:00", "Import Loads": 87112.5}, {"dt": "2014-05-01T00:00:00", "Import Loads": 84854.5}, {"dt": "2014-06-01T00:00:00", "Import Loads": 77135.0}, {"dt": "2014-07-01T00:00:00", "Import Loads": 95080.25}, {"dt": "2014-08-01T00:00:00", "Import Loads": 89698.25}, {"dt": "2014-09-01T00:00:00", "Import Loads": 87039.5}, {"dt": "2014-10-01T00:00:00", "Import Loads": 98066.0}, {"dt": "2014-11-01T00:00:00", "Import Loads": 84585.5}, {"dt": "2014-12-01T00:00:00", "Import Loads": 86305.0}, {"dt": "2015-01-01T00:00:00", "Import Loads": 79732.75}, {"dt": "2015-02-01T00:00:00", "Import Loads": 76846.25}, {"dt": "2015-03-01T00:00:00", "Import Loads": 105719.0}, {"dt": "2015-04-01T00:00:00", "Import Loads": 87124.0}, {"dt": "2015-05-01T00:00:00", "Import Loads": 94614.75}, {"dt": "2015-06-01T00:00:00", "Import Loads": 87172.5}, {"dt": "2015-07-01T00:00:00", "Import Loads": 96918.5}, {"dt": "2015-08-01T00:00:00", "Import Loads": 93043.75}, {"dt": "2015-09-01T00:00:00", "Import Loads": 92721.5}, {"dt": "2015-10-01T00:00:00", "Import Loads": 100230.25}, {"dt": "2015-11-01T00:00:00", "Import Loads": 85371.25}, {"dt": "2015-12-01T00:00:00", "Import Loads": 83025.5}, {"dt": "2016-01-01T00:00:00", "Import Loads": 84185.5}, {"dt": "2016-02-01T00:00:00", "Import Loads": 99882.75}, {"dt": "2016-03-01T00:00:00", "Import Loads": 91059.0}, {"dt": "2016-04-01T00:00:00", "Import Loads": 92429.0}, {"dt": "2016-05-01T00:00:00", "Import Loads": 92438.5}, {"dt": "2016-06-01T00:00:00", "Import Loads": 93629.5}, {"dt": "2016-07-01T00:00:00", "Import Loads": 100105.5}, {"dt": "2016-08-01T00:00:00", "Import Loads": 107268.0}, {"dt": "2016-09-01T00:00:00", "Import Loads": 100229.25}, {"dt": "2016-10-01T00:00:00", "Import Loads": 114093.0}, {"dt": "2016-11-01T00:00:00", "Import Loads": 101860.75}, {"dt": "2016-12-01T00:00:00", "Import Loads": 97712.25}, {"dt": "2017-01-01T00:00:00", "Import Loads": 101301.5}, {"dt": "2017-02-01T00:00:00", "Import Loads": 96921.25}, {"dt": "2017-03-01T00:00:00", "Import Loads": 99664.75}, {"dt": "2017-04-01T00:00:00", "Import Loads": 101113.75}, {"dt": "2017-05-01T00:00:00", "Import Loads": 100593.5}, {"dt": "2017-06-01T00:00:00", "Import Loads": 103006.0}, {"dt": "2017-07-01T00:00:00", "Import Loads": 109215.25}, {"dt": "2017-08-01T00:00:00", "Import Loads": 113187.75}, {"dt": "2017-09-01T00:00:00", "Import Loads": 109716.0}, {"dt": "2017-10-01T00:00:00", "Import Loads": 125075.25}, {"dt": "2017-11-01T00:00:00", "Import Loads": 110672.75}, {"dt": "2017-12-01T00:00:00", "Import Loads": 105866.75}, {"dt": "2018-01-01T00:00:00", "Import Loads": 104149.75}, {"dt": "2018-02-01T00:00:00", "Import Loads": 100367.75}, {"dt": "2018-03-01T00:00:00", "Import Loads": 113122.5}, {"dt": "2018-04-01T00:00:00", "Import Loads": 97606.75}, {"dt": "2018-05-01T00:00:00", "Import Loads": 108592.25}, {"dt": "2018-06-01T00:00:00", "Import Loads": 105955.0}, {"dt": "2018-07-01T00:00:00", "Import Loads": 120132.0}, {"dt": "2018-08-01T00:00:00", "Import Loads": 117041.5}, {"dt": "2018-09-01T00:00:00", "Import Loads": 108980.5}, {"dt": "2018-10-01T00:00:00", "Import Loads": 127676.5}, {"dt": "2018-11-01T00:00:00", "Import Loads": 112218.25}, {"dt": "2018-12-01T00:00:00", "Import Loads": 111566.0}, {"dt": "2019-01-01T00:00:00", "Import Loads": 109756.5}, {"dt": "2019-02-01T00:00:00", "Import Loads": 105356.75}, {"dt": "2019-03-01T00:00:00", "Import Loads": 107039.5}, {"dt": "2019-04-01T00:00:00", "Import Loads": 119265.75}, {"dt": "2019-05-01T00:00:00", "Import Loads": 119591.75}, {"dt": "2019-06-01T00:00:00", "Import Loads": 112663.75}, {"dt": "2019-07-01T00:00:00", "Import Loads": 125259.5}, {"dt": "2019-08-01T00:00:00", "Import Loads": 121542.25}, {"dt": "2019-09-01T00:00:00", "Import Loads": 114642.5}, {"dt": "2019-10-01T00:00:00", "Import Loads": 124142.25}, {"dt": "2019-11-01T00:00:00", "Import Loads": 103410.0}, {"dt": "2019-12-01T00:00:00", "Import Loads": 103710.5}, {"dt": "2020-01-01T00:00:00", "Import Loads": 108884.0}, {"dt": "2020-02-01T00:00:00", "Import Loads": 97559.0}, {"dt": "2020-03-01T00:00:00", "Import Loads": 99129.0}, {"dt": "2020-04-01T00:00:00", "Import Loads": 100310.25}, {"dt": "2020-05-01T00:00:00", "Import Loads": 87669.25}, {"dt": "2020-06-01T00:00:00", "Import Loads": 95502.25}, {"dt": "2020-07-01T00:00:00", "Import Loads": 105691.75}, {"dt": "2020-08-01T00:00:00", "Import Loads": 120913.75}, {"dt": "2020-09-01T00:00:00", "Import Loads": 121114.75}, {"dt": "2020-10-01T00:00:00", "Import Loads": 131769.75}, {"dt": "2020-11-01T00:00:00", "Import Loads": 125214.25}, {"dt": "2020-12-01T00:00:00", "Import Loads": 123217.5}, {"dt": "2021-01-01T00:00:00", "Import Loads": 130776.75}, {"dt": "2021-02-01T00:00:00", "Import Loads": 110274.25}, {"dt": "2021-03-01T00:00:00", "Import Loads": 130066.25}, {"dt": "2021-04-01T00:00:00", "Import Loads": 137954.0}, {"dt": "2021-05-01T00:00:00", "Import Loads": 144916.25}, {"dt": "2021-06-01T00:00:00", "Import Loads": 138737.25}, {"dt": "2021-07-01T00:00:00", "Import Loads": 142962.75}, {"dt": "2021-08-01T00:00:00", "Import Loads": 144226.0}, {"dt": "2021-09-01T00:00:00", "Import Loads": 152196.5}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[45]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_va_clean</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Virgina&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Export Loads&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[45]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-07c63c466bc94b6a927c6a76ed68a07a"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-07c63c466bc94b6a927c6a76ed68a07a") {
      outputDiv = document.getElementById("altair-viz-07c63c466bc94b6a927c6a76ed68a07a");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector027"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Virgina Export Loads Container Volume", "transform": [{"window": [{"op": "lag", "field": "Export Loads", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Export Loads'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt"}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Export Loads"}}, "height": 100, "selection": {"selector027": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-2df463b71d125af7663991fb1c3ab76f"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-2df463b71d125af7663991fb1c3ab76f": [{"dt": "2009-01-01T00:00:00", "Export Loads": 54809.0}, {"dt": "2009-02-01T00:00:00", "Export Loads": 58763.0}, {"dt": "2009-03-01T00:00:00", "Export Loads": 64383.0}, {"dt": "2009-04-01T00:00:00", "Export Loads": 65024.0}, {"dt": "2009-05-01T00:00:00", "Export Loads": 64106.0}, {"dt": "2009-06-01T00:00:00", "Export Loads": 65992.0}, {"dt": "2009-07-01T00:00:00", "Export Loads": 65423.0}, {"dt": "2009-08-01T00:00:00", "Export Loads": 68823.0}, {"dt": "2009-09-01T00:00:00", "Export Loads": 70008.0}, {"dt": "2009-10-01T00:00:00", "Export Loads": 70232.0}, {"dt": "2009-11-01T00:00:00", "Export Loads": 73163.0}, {"dt": "2009-12-01T00:00:00", "Export Loads": 71105.0}, {"dt": "2010-01-01T00:00:00", "Export Loads": 64664.0}, {"dt": "2010-02-01T00:00:00", "Export Loads": 72858.0}, {"dt": "2010-03-01T00:00:00", "Export Loads": 77834.0}, {"dt": "2010-04-01T00:00:00", "Export Loads": 69329.0}, {"dt": "2010-05-01T00:00:00", "Export Loads": 72525.0}, {"dt": "2010-06-01T00:00:00", "Export Loads": 68316.0}, {"dt": "2010-07-01T00:00:00", "Export Loads": 61111.0}, {"dt": "2010-08-01T00:00:00", "Export Loads": 68069.0}, {"dt": "2010-09-01T00:00:00", "Export Loads": 60866.0}, {"dt": "2010-10-01T00:00:00", "Export Loads": 73317.0}, {"dt": "2010-11-01T00:00:00", "Export Loads": 72511.0}, {"dt": "2010-12-01T00:00:00", "Export Loads": 62931.0}, {"dt": "2011-01-01T00:00:00", "Export Loads": 71433.0}, {"dt": "2011-02-01T00:00:00", "Export Loads": 67183.0}, {"dt": "2011-03-01T00:00:00", "Export Loads": 76702.0}, {"dt": "2011-04-01T00:00:00", "Export Loads": 73538.0}, {"dt": "2011-05-01T00:00:00", "Export Loads": 71395.0}, {"dt": "2011-06-01T00:00:00", "Export Loads": 69525.5}, {"dt": "2011-07-01T00:00:00", "Export Loads": 71247.0}, {"dt": "2011-08-01T00:00:00", "Export Loads": 66532.0}, {"dt": "2011-09-01T00:00:00", "Export Loads": 68437.0}, {"dt": "2011-10-01T00:00:00", "Export Loads": 73366.5}, {"dt": "2011-11-01T00:00:00", "Export Loads": 71594.0}, {"dt": "2011-12-01T00:00:00", "Export Loads": 74381.0}, {"dt": "2012-01-01T00:00:00", "Export Loads": 69867.0}, {"dt": "2012-02-01T00:00:00", "Export Loads": 75707.75}, {"dt": "2012-03-01T00:00:00", "Export Loads": 79521.0}, {"dt": "2012-04-01T00:00:00", "Export Loads": 75192.5}, {"dt": "2012-05-01T00:00:00", "Export Loads": 83205.75}, {"dt": "2012-06-01T00:00:00", "Export Loads": 75581.0}, {"dt": "2012-07-01T00:00:00", "Export Loads": 73709.0}, {"dt": "2012-08-01T00:00:00", "Export Loads": 78028.75}, {"dt": "2012-09-01T00:00:00", "Export Loads": 78224.0}, {"dt": "2012-10-01T00:00:00", "Export Loads": 73756.0}, {"dt": "2012-11-01T00:00:00", "Export Loads": 86419.25}, {"dt": "2012-12-01T00:00:00", "Export Loads": 87596.0}, {"dt": "2013-01-01T00:00:00", "Export Loads": 72685.25}, {"dt": "2013-02-01T00:00:00", "Export Loads": 79139.0}, {"dt": "2013-03-01T00:00:00", "Export Loads": 87648.75}, {"dt": "2013-04-01T00:00:00", "Export Loads": 83128.25}, {"dt": "2013-05-01T00:00:00", "Export Loads": 84840.75}, {"dt": "2013-06-01T00:00:00", "Export Loads": 76399.0}, {"dt": "2013-07-01T00:00:00", "Export Loads": 88398.75}, {"dt": "2013-08-01T00:00:00", "Export Loads": 83210.0}, {"dt": "2013-09-01T00:00:00", "Export Loads": 80569.75}, {"dt": "2013-10-01T00:00:00", "Export Loads": 90190.0}, {"dt": "2013-11-01T00:00:00", "Export Loads": 89169.0}, {"dt": "2013-12-01T00:00:00", "Export Loads": 83464.75}, {"dt": "2014-01-01T00:00:00", "Export Loads": 78065.0}, {"dt": "2014-02-01T00:00:00", "Export Loads": 81435.5}, {"dt": "2014-03-01T00:00:00", "Export Loads": 93016.25}, {"dt": "2014-04-01T00:00:00", "Export Loads": 91701.25}, {"dt": "2014-05-01T00:00:00", "Export Loads": 91686.25}, {"dt": "2014-06-01T00:00:00", "Export Loads": 81780.5}, {"dt": "2014-07-01T00:00:00", "Export Loads": 82534.25}, {"dt": "2014-08-01T00:00:00", "Export Loads": 85852.25}, {"dt": "2014-09-01T00:00:00", "Export Loads": 77345.5}, {"dt": "2014-10-01T00:00:00", "Export Loads": 86908.5}, {"dt": "2014-11-01T00:00:00", "Export Loads": 93442.0}, {"dt": "2014-12-01T00:00:00", "Export Loads": 90759.0}, {"dt": "2015-01-01T00:00:00", "Export Loads": 83349.25}, {"dt": "2015-02-01T00:00:00", "Export Loads": 76149.5}, {"dt": "2015-03-01T00:00:00", "Export Loads": 96564.5}, {"dt": "2015-04-01T00:00:00", "Export Loads": 92568.25}, {"dt": "2015-05-01T00:00:00", "Export Loads": 91801.5}, {"dt": "2015-06-01T00:00:00", "Export Loads": 81363.0}, {"dt": "2015-07-01T00:00:00", "Export Loads": 83437.75}, {"dt": "2015-08-01T00:00:00", "Export Loads": 77388.0}, {"dt": "2015-09-01T00:00:00", "Export Loads": 76253.5}, {"dt": "2015-10-01T00:00:00", "Export Loads": 78780.0}, {"dt": "2015-11-01T00:00:00", "Export Loads": 81038.5}, {"dt": "2015-12-01T00:00:00", "Export Loads": 79134.25}, {"dt": "2016-01-01T00:00:00", "Export Loads": 76359.75}, {"dt": "2016-02-01T00:00:00", "Export Loads": 82064.75}, {"dt": "2016-03-01T00:00:00", "Export Loads": 89454.5}, {"dt": "2016-04-01T00:00:00", "Export Loads": 82322.5}, {"dt": "2016-05-01T00:00:00", "Export Loads": 80729.0}, {"dt": "2016-06-01T00:00:00", "Export Loads": 81809.75}, {"dt": "2016-07-01T00:00:00", "Export Loads": 77174.0}, {"dt": "2016-08-01T00:00:00", "Export Loads": 84430.75}, {"dt": "2016-09-01T00:00:00", "Export Loads": 81902.0}, {"dt": "2016-10-01T00:00:00", "Export Loads": 88796.25}, {"dt": "2016-11-01T00:00:00", "Export Loads": 94158.5}, {"dt": "2016-12-01T00:00:00", "Export Loads": 86917.0}, {"dt": "2017-01-01T00:00:00", "Export Loads": 89766.5}, {"dt": "2017-02-01T00:00:00", "Export Loads": 85826.5}, {"dt": "2017-03-01T00:00:00", "Export Loads": 92384.0}, {"dt": "2017-04-01T00:00:00", "Export Loads": 85623.0}, {"dt": "2017-05-01T00:00:00", "Export Loads": 85824.0}, {"dt": "2017-06-01T00:00:00", "Export Loads": 81533.75}, {"dt": "2017-07-01T00:00:00", "Export Loads": 75702.75}, {"dt": "2017-08-01T00:00:00", "Export Loads": 75430.0}, {"dt": "2017-09-01T00:00:00", "Export Loads": 76794.25}, {"dt": "2017-10-01T00:00:00", "Export Loads": 87749.75}, {"dt": "2017-11-01T00:00:00", "Export Loads": 87695.0}, {"dt": "2017-12-01T00:00:00", "Export Loads": 90240.75}, {"dt": "2018-01-01T00:00:00", "Export Loads": 76293.5}, {"dt": "2018-02-01T00:00:00", "Export Loads": 82103.75}, {"dt": "2018-03-01T00:00:00", "Export Loads": 98648.25}, {"dt": "2018-04-01T00:00:00", "Export Loads": 86251.25}, {"dt": "2018-05-01T00:00:00", "Export Loads": 85157.25}, {"dt": "2018-06-01T00:00:00", "Export Loads": 80595.5}, {"dt": "2018-07-01T00:00:00", "Export Loads": 82853.0}, {"dt": "2018-08-01T00:00:00", "Export Loads": 83512.25}, {"dt": "2018-09-01T00:00:00", "Export Loads": 65587.75}, {"dt": "2018-10-01T00:00:00", "Export Loads": 83576.75}, {"dt": "2018-11-01T00:00:00", "Export Loads": 77788.75}, {"dt": "2018-12-01T00:00:00", "Export Loads": 75418.0}, {"dt": "2019-01-01T00:00:00", "Export Loads": 77948.25}, {"dt": "2019-02-01T00:00:00", "Export Loads": 76641.75}, {"dt": "2019-03-01T00:00:00", "Export Loads": 89282.0}, {"dt": "2019-04-01T00:00:00", "Export Loads": 85378.0}, {"dt": "2019-05-01T00:00:00", "Export Loads": 88064.5}, {"dt": "2019-06-01T00:00:00", "Export Loads": 76535.25}, {"dt": "2019-07-01T00:00:00", "Export Loads": 80954.75}, {"dt": "2019-08-01T00:00:00", "Export Loads": 80654.75}, {"dt": "2019-09-01T00:00:00", "Export Loads": 71560.5}, {"dt": "2019-10-01T00:00:00", "Export Loads": 83556.5}, {"dt": "2019-11-01T00:00:00", "Export Loads": 77241.0}, {"dt": "2019-12-01T00:00:00", "Export Loads": 78284.75}, {"dt": "2020-01-01T00:00:00", "Export Loads": 79328.0}, {"dt": "2020-02-01T00:00:00", "Export Loads": 80834.0}, {"dt": "2020-03-01T00:00:00", "Export Loads": 90761.0}, {"dt": "2020-04-01T00:00:00", "Export Loads": 71158.25}, {"dt": "2020-05-01T00:00:00", "Export Loads": 72160.0}, {"dt": "2020-06-01T00:00:00", "Export Loads": 71591.0}, {"dt": "2020-07-01T00:00:00", "Export Loads": 68593.75}, {"dt": "2020-08-01T00:00:00", "Export Loads": 75325.0}, {"dt": "2020-09-01T00:00:00", "Export Loads": 75525.75}, {"dt": "2020-10-01T00:00:00", "Export Loads": 83705.0}, {"dt": "2020-11-01T00:00:00", "Export Loads": 89031.75}, {"dt": "2020-12-01T00:00:00", "Export Loads": 82670.25}, {"dt": "2021-01-01T00:00:00", "Export Loads": 84688.0}, {"dt": "2021-02-01T00:00:00", "Export Loads": 87466.25}, {"dt": "2021-03-01T00:00:00", "Export Loads": 94845.75}, {"dt": "2021-04-01T00:00:00", "Export Loads": 95618.25}, {"dt": "2021-05-01T00:00:00", "Export Loads": 99717.25}, {"dt": "2021-06-01T00:00:00", "Export Loads": 78853.0}, {"dt": "2021-07-01T00:00:00", "Export Loads": 81067.5}, {"dt": "2021-08-01T00:00:00", "Export Loads": 85256.25}, {"dt": "2021-09-01T00:00:00", "Export Loads": 80696.5}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[46]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_va_clean</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Virgina&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Total TEUs&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[46]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-1c54de85f78b44bca4105b0638b61956"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-1c54de85f78b44bca4105b0638b61956") {
      outputDiv = document.getElementById("altair-viz-1c54de85f78b44bca4105b0638b61956");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector028"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Virgina Total TEUs Container Volume", "transform": [{"window": [{"op": "lag", "field": "Total TEUs", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Total TEUs'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt"}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Total TEUs"}}, "height": 100, "selection": {"selector028": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-b244f4c92ed302125a4b0500c12a5b04"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-b244f4c92ed302125a4b0500c12a5b04": [{"dt": "2009-01-01T00:00:00", "Total TEUs": 137994.0}, {"dt": "2009-02-01T00:00:00", "Total TEUs": 133359.0}, {"dt": "2009-03-01T00:00:00", "Total TEUs": 136736.0}, {"dt": "2009-04-01T00:00:00", "Total TEUs": 144074.0}, {"dt": "2009-05-01T00:00:00", "Total TEUs": 141437.0}, {"dt": "2009-06-01T00:00:00", "Total TEUs": 138452.0}, {"dt": "2009-07-01T00:00:00", "Total TEUs": 142170.0}, {"dt": "2009-08-01T00:00:00", "Total TEUs": 151005.0}, {"dt": "2009-09-01T00:00:00", "Total TEUs": 157443.0}, {"dt": "2009-10-01T00:00:00", "Total TEUs": 159782.0}, {"dt": "2009-11-01T00:00:00", "Total TEUs": 154577.0}, {"dt": "2009-12-01T00:00:00", "Total TEUs": 148199.0}, {"dt": "2010-01-01T00:00:00", "Total TEUs": 144097.0}, {"dt": "2010-02-01T00:00:00", "Total TEUs": 155049.0}, {"dt": "2010-03-01T00:00:00", "Total TEUs": 167262.0}, {"dt": "2010-04-01T00:00:00", "Total TEUs": 147119.0}, {"dt": "2010-05-01T00:00:00", "Total TEUs": 161536.0}, {"dt": "2010-06-01T00:00:00", "Total TEUs": 160701.0}, {"dt": "2010-07-01T00:00:00", "Total TEUs": 153945.0}, {"dt": "2010-08-01T00:00:00", "Total TEUs": 175122.0}, {"dt": "2010-09-01T00:00:00", "Total TEUs": 153006.0}, {"dt": "2010-10-01T00:00:00", "Total TEUs": 175518.0}, {"dt": "2010-11-01T00:00:00", "Total TEUs": 163211.0}, {"dt": "2010-12-01T00:00:00", "Total TEUs": 138452.0}, {"dt": "2011-01-01T00:00:00", "Total TEUs": 159265.0}, {"dt": "2011-02-01T00:00:00", "Total TEUs": 153646.0}, {"dt": "2011-03-01T00:00:00", "Total TEUs": 159754.0}, {"dt": "2011-04-01T00:00:00", "Total TEUs": 161254.25}, {"dt": "2011-05-01T00:00:00", "Total TEUs": 158539.0}, {"dt": "2011-06-01T00:00:00", "Total TEUs": 151449.0}, {"dt": "2011-07-01T00:00:00", "Total TEUs": 167076.0}, {"dt": "2011-08-01T00:00:00", "Total TEUs": 151974.5}, {"dt": "2011-09-01T00:00:00", "Total TEUs": 164050.0}, {"dt": "2011-10-01T00:00:00", "Total TEUs": 172776.25}, {"dt": "2011-11-01T00:00:00", "Total TEUs": 163945.0}, {"dt": "2011-12-01T00:00:00", "Total TEUs": 154300.0}, {"dt": "2012-01-01T00:00:00", "Total TEUs": 154299.75}, {"dt": "2012-02-01T00:00:00", "Total TEUs": 157049.5}, {"dt": "2012-03-01T00:00:00", "Total TEUs": 166718.5}, {"dt": "2012-04-01T00:00:00", "Total TEUs": 169643.5}, {"dt": "2012-05-01T00:00:00", "Total TEUs": 178583.75}, {"dt": "2012-06-01T00:00:00", "Total TEUs": 168430.0}, {"dt": "2012-07-01T00:00:00", "Total TEUs": 180384.0}, {"dt": "2012-08-01T00:00:00", "Total TEUs": 188657.5}, {"dt": "2012-09-01T00:00:00", "Total TEUs": 182317.75}, {"dt": "2012-10-01T00:00:00", "Total TEUs": 175330.0}, {"dt": "2012-11-01T00:00:00", "Total TEUs": 198719.5}, {"dt": "2012-12-01T00:00:00", "Total TEUs": 185750.25}, {"dt": "2013-01-01T00:00:00", "Total TEUs": 158766.25}, {"dt": "2013-02-01T00:00:00", "Total TEUs": 169391.0}, {"dt": "2013-03-01T00:00:00", "Total TEUs": 179517.75}, {"dt": "2013-04-01T00:00:00", "Total TEUs": 179369.5}, {"dt": "2013-05-01T00:00:00", "Total TEUs": 191367.5}, {"dt": "2013-06-01T00:00:00", "Total TEUs": 175864.25}, {"dt": "2013-07-01T00:00:00", "Total TEUs": 205137.25}, {"dt": "2013-08-01T00:00:00", "Total TEUs": 198329.0}, {"dt": "2013-09-01T00:00:00", "Total TEUs": 185184.5}, {"dt": "2013-10-01T00:00:00", "Total TEUs": 206597.25}, {"dt": "2013-11-01T00:00:00", "Total TEUs": 192917.75}, {"dt": "2013-12-01T00:00:00", "Total TEUs": 181090.5}, {"dt": "2014-01-01T00:00:00", "Total TEUs": 167271.5}, {"dt": "2014-02-01T00:00:00", "Total TEUs": 179523.5}, {"dt": "2014-03-01T00:00:00", "Total TEUs": 197833.5}, {"dt": "2014-04-01T00:00:00", "Total TEUs": 201390.25}, {"dt": "2014-05-01T00:00:00", "Total TEUs": 204232.25}, {"dt": "2014-06-01T00:00:00", "Total TEUs": 186403.25}, {"dt": "2014-07-01T00:00:00", "Total TEUs": 207771.0}, {"dt": "2014-08-01T00:00:00", "Total TEUs": 214355.25}, {"dt": "2014-09-01T00:00:00", "Total TEUs": 201113.25}, {"dt": "2014-10-01T00:00:00", "Total TEUs": 221104.75}, {"dt": "2014-11-01T00:00:00", "Total TEUs": 208763.5}, {"dt": "2014-12-01T00:00:00", "Total TEUs": 203275.75}, {"dt": "2015-01-01T00:00:00", "Total TEUs": 191996.0}, {"dt": "2015-02-01T00:00:00", "Total TEUs": 178104.75}, {"dt": "2015-03-01T00:00:00", "Total TEUs": 229410.0}, {"dt": "2015-04-01T00:00:00", "Total TEUs": 210177.0}, {"dt": "2015-05-01T00:00:00", "Total TEUs": 230510.75}, {"dt": "2015-06-01T00:00:00", "Total TEUs": 213517.25}, {"dt": "2015-07-01T00:00:00", "Total TEUs": 225988.25}, {"dt": "2015-08-01T00:00:00", "Total TEUs": 220069.0}, {"dt": "2015-09-01T00:00:00", "Total TEUs": 215520.25}, {"dt": "2015-10-01T00:00:00", "Total TEUs": 233466.0}, {"dt": "2015-11-01T00:00:00", "Total TEUs": 203471.75}, {"dt": "2015-12-01T00:00:00", "Total TEUs": 197039.0}, {"dt": "2016-01-01T00:00:00", "Total TEUs": 192844.25}, {"dt": "2016-02-01T00:00:00", "Total TEUs": 220726.25}, {"dt": "2016-03-01T00:00:00", "Total TEUs": 213186.0}, {"dt": "2016-04-01T00:00:00", "Total TEUs": 215253.75}, {"dt": "2016-05-01T00:00:00", "Total TEUs": 219398.25}, {"dt": "2016-06-01T00:00:00", "Total TEUs": 216672.0}, {"dt": "2016-07-01T00:00:00", "Total TEUs": 217909.75}, {"dt": "2016-08-01T00:00:00", "Total TEUs": 235511.0}, {"dt": "2016-09-01T00:00:00", "Total TEUs": 219857.25}, {"dt": "2016-10-01T00:00:00", "Total TEUs": 238567.25}, {"dt": "2016-11-01T00:00:00", "Total TEUs": 236155.25}, {"dt": "2016-12-01T00:00:00", "Total TEUs": 229624.25}, {"dt": "2017-01-01T00:00:00", "Total TEUs": 228516.0}, {"dt": "2017-02-01T00:00:00", "Total TEUs": 220375.5}, {"dt": "2017-03-01T00:00:00", "Total TEUs": 232148.25}, {"dt": "2017-04-01T00:00:00", "Total TEUs": 225196.25}, {"dt": "2017-05-01T00:00:00", "Total TEUs": 246871.25}, {"dt": "2017-06-01T00:00:00", "Total TEUs": 231674.75}, {"dt": "2017-07-01T00:00:00", "Total TEUs": 234230.0}, {"dt": "2017-08-01T00:00:00", "Total TEUs": 240604.5}, {"dt": "2017-09-01T00:00:00", "Total TEUs": 237815.5}, {"dt": "2017-10-01T00:00:00", "Total TEUs": 265489.75}, {"dt": "2017-11-01T00:00:00", "Total TEUs": 240570.0}, {"dt": "2017-12-01T00:00:00", "Total TEUs": 237524.5}, {"dt": "2018-01-01T00:00:00", "Total TEUs": 220533.75}, {"dt": "2018-02-01T00:00:00", "Total TEUs": 218726.5}, {"dt": "2018-03-01T00:00:00", "Total TEUs": 252230.25}, {"dt": "2018-04-01T00:00:00", "Total TEUs": 219281.0}, {"dt": "2018-05-01T00:00:00", "Total TEUs": 236890.5}, {"dt": "2018-06-01T00:00:00", "Total TEUs": 223839.5}, {"dt": "2018-07-01T00:00:00", "Total TEUs": 252679.0}, {"dt": "2018-08-01T00:00:00", "Total TEUs": 258820.5}, {"dt": "2018-09-01T00:00:00", "Total TEUs": 221354.75}, {"dt": "2018-10-01T00:00:00", "Total TEUs": 270538.0}, {"dt": "2018-11-01T00:00:00", "Total TEUs": 239890.0}, {"dt": "2018-12-01T00:00:00", "Total TEUs": 241120.5}, {"dt": "2019-01-01T00:00:00", "Total TEUs": 240110.5}, {"dt": "2019-02-01T00:00:00", "Total TEUs": 228151.25}, {"dt": "2019-03-01T00:00:00", "Total TEUs": 240035.25}, {"dt": "2019-04-01T00:00:00", "Total TEUs": 245933.25}, {"dt": "2019-05-01T00:00:00", "Total TEUs": 260893.5}, {"dt": "2019-06-01T00:00:00", "Total TEUs": 239329.0}, {"dt": "2019-07-01T00:00:00", "Total TEUs": 265559.25}, {"dt": "2019-08-01T00:00:00", "Total TEUs": 257675.25}, {"dt": "2019-09-01T00:00:00", "Total TEUs": 241415.5}, {"dt": "2019-10-01T00:00:00", "Total TEUs": 266976.0}, {"dt": "2019-11-01T00:00:00", "Total TEUs": 226981.5}, {"dt": "2019-12-01T00:00:00", "Total TEUs": 224901.75}, {"dt": "2020-01-01T00:00:00", "Total TEUs": 227233.5}, {"dt": "2020-02-01T00:00:00", "Total TEUs": 207815.75}, {"dt": "2020-03-01T00:00:00", "Total TEUs": 219315.25}, {"dt": "2020-04-01T00:00:00", "Total TEUs": 207244.25}, {"dt": "2020-05-01T00:00:00", "Total TEUs": 201837.25}, {"dt": "2020-06-01T00:00:00", "Total TEUs": 210669.25}, {"dt": "2020-07-01T00:00:00", "Total TEUs": 221028.0}, {"dt": "2020-08-01T00:00:00", "Total TEUs": 247348.5}, {"dt": "2020-09-01T00:00:00", "Total TEUs": 256438.5}, {"dt": "2020-10-01T00:00:00", "Total TEUs": 274215.0}, {"dt": "2020-11-01T00:00:00", "Total TEUs": 279868.25}, {"dt": "2020-12-01T00:00:00", "Total TEUs": 260401.0}, {"dt": "2021-01-01T00:00:00", "Total TEUs": 270968.75}, {"dt": "2021-02-01T00:00:00", "Total TEUs": 248525.5}, {"dt": "2021-03-01T00:00:00", "Total TEUs": 279514.0}, {"dt": "2021-04-01T00:00:00", "Total TEUs": 286405.25}, {"dt": "2021-05-01T00:00:00", "Total TEUs": 314941.5}, {"dt": "2021-06-01T00:00:00", "Total TEUs": 281346.0}, {"dt": "2021-07-01T00:00:00", "Total TEUs": 293126.25}, {"dt": "2021-08-01T00:00:00", "Total TEUs": 307023.25}, {"dt": "2021-09-01T00:00:00", "Total TEUs": 306215.75}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[47]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># https://www.oaklandseaport.com/performance/facts-figures/</span>

<span class="n">df_oakland</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;https://www.oaklandseaport.com/files/PDF/Oakland%20Monthly%20TEUs%201998-2020.xlsx&quot;</span><span class="p">,</span>
                           <span class="n">skiprows</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">df_oakland</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;[^A-z]+&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df_oakland</span><span class="p">]</span>

<span class="n">df_oakland</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_oakland</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="n">df_oakland</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y%B&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>

<span class="n">df_oakland</span> <span class="o">=</span> <span class="n">df_oakland</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="n">df_oakland</span> <span class="o">=</span> <span class="n">df_oakland</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Month&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">df_oakland</span> <span class="o">=</span> <span class="n">df_oakland</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;dt&#39;</span><span class="p">)</span>

<span class="c1">#df_oakland.tail()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[48]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;curl -s &#39;https://www.oaklandseaport.com/performance/facts-figures/&#39; | egrep &#39;class=</span><span class="se">\&quot;</span><span class="s2">(number|chart-subtitle)</span><span class="se">\&quot;</span><span class="s2">&#39;&quot;</span>

<span class="n">df_oak_latest_res</span> <span class="o">=</span> <span class="o">!</span><span class="nv">$command</span>

<span class="n">df_oak_latest_raw</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_oak_latest_res</span><span class="p">)</span>

<span class="n">extractMonthAndValue</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;title=&quot;([A-z]+)&quot;&gt;&lt;span class=&quot;number&quot;&gt;([0-9,.]+)&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">getLabel</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;Import-Full&#39;</span>
    <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;Export-Full&#39;</span>
    <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;Import-Empty&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;Export-Empty&#39;</span> 

<span class="n">df_oak_latest_stg</span> <span class="o">=</span> <span class="p">[(</span><span class="n">getLabel</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">extractMonthAndValue</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;class=&quot;chart-subtitle&quot;&#39;</span><span class="p">,</span> <span class="n">df_oak_latest_raw</span><span class="p">))</span> <span class="k">if</span> <span class="s2">&quot;number&quot;</span> <span class="ow">in</span> <span class="n">v</span><span class="p">]</span>

<span class="n">currentYear</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">year</span>

<span class="n">df_oak_latest</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="k">for</span> <span class="n">kind</span><span class="p">,</span> <span class="n">vals</span> <span class="ow">in</span> <span class="n">df_oak_latest_stg</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">continue</span>
        
    <span class="c1">#print(kind, vals)</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>
    <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">currentYear</span><span class="si">}</span><span class="s2">-&quot;</span> <span class="o">+</span> <span class="n">tmp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y-%b&quot;</span><span class="p">)</span>
    <span class="n">tmp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)))</span>
    <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">kind</span><span class="p">)</span>
    <span class="n">tmp</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">]</span>
    <span class="n">df_oak_latest</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_oak_latest</span><span class="p">,</span> <span class="n">tmp</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[49]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_oak_latest_tab</span> <span class="o">=</span> <span class="n">df_oak_latest</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>

<span class="n">df_oak_latest_tab</span><span class="p">[</span><span class="s1">&#39;Total-Full&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_oak_latest_tab</span><span class="p">[</span><span class="s1">&#39;Import-Full&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df_oak_latest_tab</span><span class="p">[</span><span class="s1">&#39;Export-Full&#39;</span><span class="p">]</span>
<span class="n">df_oak_latest_tab</span><span class="p">[</span><span class="s1">&#39;Total-Empty&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_oak_latest_tab</span><span class="p">[</span><span class="s1">&#39;Import-Empty&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df_oak_latest_tab</span><span class="p">[</span><span class="s1">&#39;Export-Empty&#39;</span><span class="p">]</span>
<span class="n">df_oak_latest_tab</span><span class="p">[</span><span class="s1">&#39;Grand-Total&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_oak_latest_tab</span><span class="p">[</span><span class="s1">&#39;Total-Full&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df_oak_latest_tab</span><span class="p">[</span><span class="s1">&#39;Total-Empty&#39;</span><span class="p">]</span>

<span class="c1">#df_oak_latest_tab.head()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[50]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_oak_combined</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_oakland</span><span class="p">,</span> <span class="n">df_oak_latest_tab</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Port-of-Oakland">Port of Oakland<a class="anchor-link" href="#Port-of-Oakland">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[51]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_oak_combined</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Total-Full&#39;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Oakland&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[51]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-05e97783137a4660a438c12043805a66"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-05e97783137a4660a438c12043805a66") {
      outputDiv = document.getElementById("altair-viz-05e97783137a4660a438c12043805a66");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector029"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Oakland Total-Full Container Volume", "transform": [{"window": [{"op": "lag", "field": "Total-Full", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Total-Full'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt"}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Total-Full"}}, "height": 100, "selection": {"selector029": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-8f57d1b0fe48cf1385cef81db5784516"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-8f57d1b0fe48cf1385cef81db5784516": [{"dt": "1998-01-01T00:00:00", "Total-Full": 86188.0}, {"dt": "1998-02-01T00:00:00", "Total-Full": 88844.0}, {"dt": "1998-03-01T00:00:00", "Total-Full": 100414.0}, {"dt": "1998-04-01T00:00:00", "Total-Full": 99899.0}, {"dt": "1998-05-01T00:00:00", "Total-Full": 96945.0}, {"dt": "1998-06-01T00:00:00", "Total-Full": 100986.0}, {"dt": "1998-07-01T00:00:00", "Total-Full": 97761.0}, {"dt": "1998-08-01T00:00:00", "Total-Full": 101024.0}, {"dt": "1998-09-01T00:00:00", "Total-Full": 104411.0}, {"dt": "1998-10-01T00:00:00", "Total-Full": 114363.0}, {"dt": "1998-11-01T00:00:00", "Total-Full": 107865.0}, {"dt": "1998-12-01T00:00:00", "Total-Full": 106834.0}, {"dt": "1999-01-01T00:00:00", "Total-Full": 95520.0}, {"dt": "1999-02-01T00:00:00", "Total-Full": 95377.0}, {"dt": "1999-03-01T00:00:00", "Total-Full": 102177.0}, {"dt": "1999-04-01T00:00:00", "Total-Full": 104401.0}, {"dt": "1999-05-01T00:00:00", "Total-Full": 106613.0}, {"dt": "1999-06-01T00:00:00", "Total-Full": 110073.0}, {"dt": "1999-07-01T00:00:00", "Total-Full": 97433.0}, {"dt": "1999-08-01T00:00:00", "Total-Full": 109702.0}, {"dt": "1999-09-01T00:00:00", "Total-Full": 110148.0}, {"dt": "1999-10-01T00:00:00", "Total-Full": 110643.0}, {"dt": "1999-11-01T00:00:00", "Total-Full": 108782.0}, {"dt": "1999-12-01T00:00:00", "Total-Full": 108230.0}, {"dt": "2000-01-01T00:00:00", "Total-Full": 99762.0}, {"dt": "2000-02-01T00:00:00", "Total-Full": 100865.0}, {"dt": "2000-03-01T00:00:00", "Total-Full": 109763.0}, {"dt": "2000-04-01T00:00:00", "Total-Full": 105920.0}, {"dt": "2000-05-01T00:00:00", "Total-Full": 111222.0}, {"dt": "2000-06-01T00:00:00", "Total-Full": 114096.0}, {"dt": "2000-07-01T00:00:00", "Total-Full": 113774.0}, {"dt": "2000-08-01T00:00:00", "Total-Full": 125351.0}, {"dt": "2000-09-01T00:00:00", "Total-Full": 111302.0}, {"dt": "2000-10-01T00:00:00", "Total-Full": 118691.0}, {"dt": "2000-11-01T00:00:00", "Total-Full": 107005.0}, {"dt": "2000-12-01T00:00:00", "Total-Full": 104628.0}, {"dt": "2001-01-01T00:00:00", "Total-Full": 102881.0}, {"dt": "2001-02-01T00:00:00", "Total-Full": 91193.0}, {"dt": "2001-03-01T00:00:00", "Total-Full": 108842.0}, {"dt": "2001-04-01T00:00:00", "Total-Full": 102567.0}, {"dt": "2001-05-01T00:00:00", "Total-Full": 105380.0}, {"dt": "2001-06-01T00:00:00", "Total-Full": 99695.0}, {"dt": "2001-07-01T00:00:00", "Total-Full": 107751.0}, {"dt": "2001-08-01T00:00:00", "Total-Full": 113425.0}, {"dt": "2001-09-01T00:00:00", "Total-Full": 103980.0}, {"dt": "2001-10-01T00:00:00", "Total-Full": 114768.0}, {"dt": "2001-11-01T00:00:00", "Total-Full": 98227.0}, {"dt": "2001-12-01T00:00:00", "Total-Full": 96638.0}, {"dt": "2002-01-01T00:00:00", "Total-Full": 89500.0}, {"dt": "2002-02-01T00:00:00", "Total-Full": 90349.0}, {"dt": "2002-03-01T00:00:00", "Total-Full": 99630.0}, {"dt": "2002-04-01T00:00:00", "Total-Full": 103546.0}, {"dt": "2002-05-01T00:00:00", "Total-Full": 111757.0}, {"dt": "2002-06-01T00:00:00", "Total-Full": 113130.0}, {"dt": "2002-07-01T00:00:00", "Total-Full": 107987.0}, {"dt": "2002-08-01T00:00:00", "Total-Full": 119239.0}, {"dt": "2002-09-01T00:00:00", "Total-Full": 111635.0}, {"dt": "2002-10-01T00:00:00", "Total-Full": 103555.0}, {"dt": "2002-11-01T00:00:00", "Total-Full": 118775.0}, {"dt": "2002-12-01T00:00:00", "Total-Full": 110664.0}, {"dt": "2003-01-01T00:00:00", "Total-Full": 108125.0}, {"dt": "2003-02-01T00:00:00", "Total-Full": 106315.0}, {"dt": "2003-03-01T00:00:00", "Total-Full": 117347.0}, {"dt": "2003-04-01T00:00:00", "Total-Full": 115082.0}, {"dt": "2003-05-01T00:00:00", "Total-Full": 115248.0}, {"dt": "2003-06-01T00:00:00", "Total-Full": 118914.0}, {"dt": "2003-07-01T00:00:00", "Total-Full": 124005.0}, {"dt": "2003-08-01T00:00:00", "Total-Full": 117423.0}, {"dt": "2003-09-01T00:00:00", "Total-Full": 118502.0}, {"dt": "2003-10-01T00:00:00", "Total-Full": 125491.0}, {"dt": "2003-11-01T00:00:00", "Total-Full": 118109.0}, {"dt": "2003-12-01T00:00:00", "Total-Full": 114396.0}, {"dt": "2004-01-01T00:00:00", "Total-Full": 111064.0}, {"dt": "2004-02-01T00:00:00", "Total-Full": 96958.0}, {"dt": "2004-03-01T00:00:00", "Total-Full": 121614.0}, {"dt": "2004-04-01T00:00:00", "Total-Full": 119838.0}, {"dt": "2004-05-01T00:00:00", "Total-Full": 117302.0}, {"dt": "2004-06-01T00:00:00", "Total-Full": 121548.0}, {"dt": "2004-07-01T00:00:00", "Total-Full": 127749.0}, {"dt": "2004-08-01T00:00:00", "Total-Full": 137081.0}, {"dt": "2004-09-01T00:00:00", "Total-Full": 127583.0}, {"dt": "2004-10-01T00:00:00", "Total-Full": 141500.0}, {"dt": "2004-11-01T00:00:00", "Total-Full": 143701.0}, {"dt": "2004-12-01T00:00:00", "Total-Full": 142092.0}, {"dt": "2005-01-01T00:00:00", "Total-Full": 132386.0}, {"dt": "2005-02-01T00:00:00", "Total-Full": 131870.0}, {"dt": "2005-03-01T00:00:00", "Total-Full": 132229.0}, {"dt": "2005-04-01T00:00:00", "Total-Full": 135082.0}, {"dt": "2005-05-01T00:00:00", "Total-Full": 141653.0}, {"dt": "2005-06-01T00:00:00", "Total-Full": 135443.0}, {"dt": "2005-07-01T00:00:00", "Total-Full": 143756.0}, {"dt": "2005-08-01T00:00:00", "Total-Full": 147639.0}, {"dt": "2005-09-01T00:00:00", "Total-Full": 144075.0}, {"dt": "2005-10-01T00:00:00", "Total-Full": 147632.0}, {"dt": "2005-11-01T00:00:00", "Total-Full": 144672.0}, {"dt": "2005-12-01T00:00:00", "Total-Full": 146400.0}, {"dt": "2006-01-01T00:00:00", "Total-Full": 137379.0}, {"dt": "2006-02-01T00:00:00", "Total-Full": 130345.0}, {"dt": "2006-03-01T00:00:00", "Total-Full": 148790.0}, {"dt": "2006-04-01T00:00:00", "Total-Full": 140514.0}, {"dt": "2006-05-01T00:00:00", "Total-Full": 145368.0}, {"dt": "2006-06-01T00:00:00", "Total-Full": 146611.0}, {"dt": "2006-07-01T00:00:00", "Total-Full": 141304.0}, {"dt": "2006-08-01T00:00:00", "Total-Full": 154634.0}, {"dt": "2006-09-01T00:00:00", "Total-Full": 141921.0}, {"dt": "2006-10-01T00:00:00", "Total-Full": 150941.0}, {"dt": "2006-11-01T00:00:00", "Total-Full": 142551.0}, {"dt": "2006-12-01T00:00:00", "Total-Full": 137565.0}, {"dt": "2007-01-01T00:00:00", "Total-Full": 142796.0}, {"dt": "2007-02-01T00:00:00", "Total-Full": 127658.0}, {"dt": "2007-03-01T00:00:00", "Total-Full": 142839.0}, {"dt": "2007-04-01T00:00:00", "Total-Full": 142970.0}, {"dt": "2007-05-01T00:00:00", "Total-Full": 149224.0}, {"dt": "2007-06-01T00:00:00", "Total-Full": 148119.0}, {"dt": "2007-07-01T00:00:00", "Total-Full": 157539.0}, {"dt": "2007-08-01T00:00:00", "Total-Full": 158481.0}, {"dt": "2007-09-01T00:00:00", "Total-Full": 149211.0}, {"dt": "2007-10-01T00:00:00", "Total-Full": 160329.0}, {"dt": "2007-11-01T00:00:00", "Total-Full": 156820.0}, {"dt": "2007-12-01T00:00:00", "Total-Full": 143931.0}, {"dt": "2008-01-01T00:00:00", "Total-Full": 140852.0}, {"dt": "2008-02-01T00:00:00", "Total-Full": 145080.0}, {"dt": "2008-03-01T00:00:00", "Total-Full": 139491.0}, {"dt": "2008-04-01T00:00:00", "Total-Full": 150537.0}, {"dt": "2008-05-01T00:00:00", "Total-Full": 147424.0}, {"dt": "2008-06-01T00:00:00", "Total-Full": 152309.0}, {"dt": "2008-07-01T00:00:00", "Total-Full": 154174.0}, {"dt": "2008-08-01T00:00:00", "Total-Full": 146270.0}, {"dt": "2008-09-01T00:00:00", "Total-Full": 145754.0}, {"dt": "2008-10-01T00:00:00", "Total-Full": 141970.0}, {"dt": "2008-11-01T00:00:00", "Total-Full": 122130.0}, {"dt": "2008-12-01T00:00:00", "Total-Full": 121113.0}, {"dt": "2009-01-01T00:00:00", "Total-Full": 122012.0}, {"dt": "2009-02-01T00:00:00", "Total-Full": 106005.0}, {"dt": "2009-03-01T00:00:00", "Total-Full": 134411.0}, {"dt": "2009-04-01T00:00:00", "Total-Full": 135229.0}, {"dt": "2009-05-01T00:00:00", "Total-Full": 135479.0}, {"dt": "2009-06-01T00:00:00", "Total-Full": 141066.0}, {"dt": "2009-07-01T00:00:00", "Total-Full": 149467.0}, {"dt": "2009-08-01T00:00:00", "Total-Full": 148292.0}, {"dt": "2009-09-01T00:00:00", "Total-Full": 147535.0}, {"dt": "2009-10-01T00:00:00", "Total-Full": 147694.0}, {"dt": "2009-11-01T00:00:00", "Total-Full": 144818.0}, {"dt": "2009-12-01T00:00:00", "Total-Full": 156375.0}, {"dt": "2010-01-01T00:00:00", "Total-Full": 128962.0}, {"dt": "2010-02-01T00:00:00", "Total-Full": 125891.0}, {"dt": "2010-03-01T00:00:00", "Total-Full": 141586.0}, {"dt": "2010-04-01T00:00:00", "Total-Full": 143350.0}, {"dt": "2010-05-01T00:00:00", "Total-Full": 146708.0}, {"dt": "2010-06-01T00:00:00", "Total-Full": 148705.0}, {"dt": "2010-07-01T00:00:00", "Total-Full": 154572.0}, {"dt": "2010-08-01T00:00:00", "Total-Full": 156483.0}, {"dt": "2010-09-01T00:00:00", "Total-Full": 153579.0}, {"dt": "2010-10-01T00:00:00", "Total-Full": 154227.0}, {"dt": "2010-11-01T00:00:00", "Total-Full": 155416.0}, {"dt": "2010-12-01T00:00:00", "Total-Full": 148757.0}, {"dt": "2011-01-01T00:00:00", "Total-Full": 139349.0}, {"dt": "2011-02-01T00:00:00", "Total-Full": 134691.0}, {"dt": "2011-03-01T00:00:00", "Total-Full": 147608.0}, {"dt": "2011-04-01T00:00:00", "Total-Full": 150426.0}, {"dt": "2011-05-01T00:00:00", "Total-Full": 151669.0}, {"dt": "2011-06-01T00:00:00", "Total-Full": 152183.0}, {"dt": "2011-07-01T00:00:00", "Total-Full": 147852.0}, {"dt": "2011-08-01T00:00:00", "Total-Full": 160716.0}, {"dt": "2011-09-01T00:00:00", "Total-Full": 150506.0}, {"dt": "2011-10-01T00:00:00", "Total-Full": 151245.0}, {"dt": "2011-11-01T00:00:00", "Total-Full": 157012.0}, {"dt": "2011-12-01T00:00:00", "Total-Full": 147841.0}, {"dt": "2012-01-01T00:00:00", "Total-Full": 152675.0}, {"dt": "2012-02-01T00:00:00", "Total-Full": 128521.0}, {"dt": "2012-03-01T00:00:00", "Total-Full": 154467.0}, {"dt": "2012-04-01T00:00:00", "Total-Full": 143672.0}, {"dt": "2012-05-01T00:00:00", "Total-Full": 156233.0}, {"dt": "2012-06-01T00:00:00", "Total-Full": 146109.0}, {"dt": "2012-07-01T00:00:00", "Total-Full": 148963.0}, {"dt": "2012-08-01T00:00:00", "Total-Full": 151793.0}, {"dt": "2012-09-01T00:00:00", "Total-Full": 141124.0}, {"dt": "2012-10-01T00:00:00", "Total-Full": 157131.0}, {"dt": "2012-11-01T00:00:00", "Total-Full": 144219.0}, {"dt": "2012-12-01T00:00:00", "Total-Full": 153217.0}, {"dt": "2013-01-01T00:00:00", "Total-Full": 150019.0}, {"dt": "2013-02-01T00:00:00", "Total-Full": 148201.0}, {"dt": "2013-03-01T00:00:00", "Total-Full": 141497.0}, {"dt": "2013-04-01T00:00:00", "Total-Full": 149440.0}, {"dt": "2013-05-01T00:00:00", "Total-Full": 155674.0}, {"dt": "2013-06-01T00:00:00", "Total-Full": 152471.0}, {"dt": "2013-07-01T00:00:00", "Total-Full": 154512.0}, {"dt": "2013-08-01T00:00:00", "Total-Full": 157539.0}, {"dt": "2013-09-01T00:00:00", "Total-Full": 153123.0}, {"dt": "2013-10-01T00:00:00", "Total-Full": 156544.0}, {"dt": "2013-11-01T00:00:00", "Total-Full": 154365.0}, {"dt": "2013-12-01T00:00:00", "Total-Full": 144725.0}, {"dt": "2014-01-01T00:00:00", "Total-Full": 150654.0}, {"dt": "2014-02-01T00:00:00", "Total-Full": 138413.0}, {"dt": "2014-03-01T00:00:00", "Total-Full": 147812.0}, {"dt": "2014-04-01T00:00:00", "Total-Full": 156831.0}, {"dt": "2014-05-01T00:00:00", "Total-Full": 160156.0}, {"dt": "2014-06-01T00:00:00", "Total-Full": 157885.0}, {"dt": "2014-07-01T00:00:00", "Total-Full": 147537.0}, {"dt": "2014-08-01T00:00:00", "Total-Full": 149652.0}, {"dt": "2014-09-01T00:00:00", "Total-Full": 151676.0}, {"dt": "2014-10-01T00:00:00", "Total-Full": 159189.0}, {"dt": "2014-11-01T00:00:00", "Total-Full": 145694.0}, {"dt": "2014-12-01T00:00:00", "Total-Full": 149689.0}, {"dt": "2015-01-01T00:00:00", "Total-Full": 101750.0}, {"dt": "2015-02-01T00:00:00", "Total-Full": 90868.0}, {"dt": "2015-03-01T00:00:00", "Total-Full": 157286.0}, {"dt": "2015-04-01T00:00:00", "Total-Full": 148217.0}, {"dt": "2015-05-01T00:00:00", "Total-Full": 158791.0}, {"dt": "2015-06-01T00:00:00", "Total-Full": 153460.0}, {"dt": "2015-07-01T00:00:00", "Total-Full": 154625.0}, {"dt": "2015-08-01T00:00:00", "Total-Full": 160149.0}, {"dt": "2015-09-01T00:00:00", "Total-Full": 142844.0}, {"dt": "2015-10-01T00:00:00", "Total-Full": 144989.0}, {"dt": "2015-11-01T00:00:00", "Total-Full": 150356.0}, {"dt": "2015-12-01T00:00:00", "Total-Full": 139045.0}, {"dt": "2016-01-01T00:00:00", "Total-Full": 144911.0}, {"dt": "2016-02-01T00:00:00", "Total-Full": 144075.0}, {"dt": "2016-03-01T00:00:00", "Total-Full": 137178.0}, {"dt": "2016-04-01T00:00:00", "Total-Full": 150907.0}, {"dt": "2016-05-01T00:00:00", "Total-Full": 165262.0}, {"dt": "2016-06-01T00:00:00", "Total-Full": 150046.0}, {"dt": "2016-07-01T00:00:00", "Total-Full": 158058.0}, {"dt": "2016-08-01T00:00:00", "Total-Full": 161487.0}, {"dt": "2016-09-01T00:00:00", "Total-Full": 146629.0}, {"dt": "2016-10-01T00:00:00", "Total-Full": 161475.0}, {"dt": "2016-11-01T00:00:00", "Total-Full": 159091.0}, {"dt": "2016-12-01T00:00:00", "Total-Full": 152597.0}, {"dt": "2017-01-01T00:00:00", "Total-Full": 153769.15}, {"dt": "2017-02-01T00:00:00", "Total-Full": 136687.2}, {"dt": "2017-03-01T00:00:00", "Total-Full": 149998.59999999998}, {"dt": "2017-04-01T00:00:00", "Total-Full": 153766.75}, {"dt": "2017-05-01T00:00:00", "Total-Full": 161023.85}, {"dt": "2017-06-01T00:00:00", "Total-Full": 155713.59999999998}, {"dt": "2017-07-01T00:00:00", "Total-Full": 159656.0}, {"dt": "2017-08-01T00:00:00", "Total-Full": 155039.15000000002}, {"dt": "2017-09-01T00:00:00", "Total-Full": 153496.25}, {"dt": "2017-10-01T00:00:00", "Total-Full": 162634.3}, {"dt": "2017-11-01T00:00:00", "Total-Full": 149372.34999999998}, {"dt": "2017-12-01T00:00:00", "Total-Full": 159192.8}, {"dt": "2018-01-01T00:00:00", "Total-Full": 150019.0}, {"dt": "2018-02-01T00:00:00", "Total-Full": 147570.75}, {"dt": "2018-03-01T00:00:00", "Total-Full": 148256.65}, {"dt": "2018-04-01T00:00:00", "Total-Full": 153365.3}, {"dt": "2018-05-01T00:00:00", "Total-Full": 154511.84999999998}, {"dt": "2018-06-01T00:00:00", "Total-Full": 159101.55}, {"dt": "2018-07-01T00:00:00", "Total-Full": 153679.84999999998}, {"dt": "2018-08-01T00:00:00", "Total-Full": 160014.05}, {"dt": "2018-09-01T00:00:00", "Total-Full": 155540.25}, {"dt": "2018-10-01T00:00:00", "Total-Full": 161249.40000000002}, {"dt": "2018-11-01T00:00:00", "Total-Full": 160649.35}, {"dt": "2018-12-01T00:00:00", "Total-Full": 159445.55}, {"dt": "2019-01-01T00:00:00", "Total-Full": 157243.3}, {"dt": "2019-02-01T00:00:00", "Total-Full": 137814.05}, {"dt": "2019-03-01T00:00:00", "Total-Full": 162916.45}, {"dt": "2019-04-01T00:00:00", "Total-Full": 159993.3}, {"dt": "2019-05-01T00:00:00", "Total-Full": 164039.45}, {"dt": "2019-06-01T00:00:00", "Total-Full": 155795.65}, {"dt": "2019-07-01T00:00:00", "Total-Full": 167012.25}, {"dt": "2019-08-01T00:00:00", "Total-Full": 163404.55}, {"dt": "2019-09-01T00:00:00", "Total-Full": 156963.45}, {"dt": "2019-10-01T00:00:00", "Total-Full": 165975.1}, {"dt": "2019-11-01T00:00:00", "Total-Full": 159147.2}, {"dt": "2019-12-01T00:00:00", "Total-Full": 155923.75}, {"dt": "2020-01-01T00:00:00", "Total-Full": 165801.5}, {"dt": "2020-02-01T00:00:00", "Total-Full": 141847.45}, {"dt": "2020-03-01T00:00:00", "Total-Full": 150816.25}, {"dt": "2020-04-01T00:00:00", "Total-Full": 162166.9}, {"dt": "2020-05-01T00:00:00", "Total-Full": 143142.5}, {"dt": "2020-06-01T00:00:00", "Total-Full": 153102.2}, {"dt": "2020-07-01T00:00:00", "Total-Full": 167944.8}, {"dt": "2020-08-01T00:00:00", "Total-Full": 172408.65}, {"dt": "2020-09-01T00:00:00", "Total-Full": 169588.0}, {"dt": "2020-10-01T00:00:00", "Total-Full": 173694.75}, {"dt": "2020-11-01T00:00:00", "Total-Full": 157715.2}, {"dt": "2020-12-01T00:00:00", "Total-Full": 165547.5}, {"dt": "2021-01-01T00:00:00", "Total-Full": 146550.0}, {"dt": "2021-02-01T00:00:00", "Total-Full": 149724.0}, {"dt": "2021-03-01T00:00:00", "Total-Full": 191705.0}, {"dt": "2021-04-01T00:00:00", "Total-Full": 182176.0}, {"dt": "2021-05-01T00:00:00", "Total-Full": 167284.0}, {"dt": "2021-06-01T00:00:00", "Total-Full": 166252.0}, {"dt": "2021-07-01T00:00:00", "Total-Full": 162898.0}, {"dt": "2021-08-01T00:00:00", "Total-Full": 169603.0}, {"dt": "2021-09-01T00:00:00", "Total-Full": 143992.0}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[52]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_oak_combined</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Total-Empty&#39;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Oakland&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[52]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-9dbda525b4bd4e028da2bca200edcc2e"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-9dbda525b4bd4e028da2bca200edcc2e") {
      outputDiv = document.getElementById("altair-viz-9dbda525b4bd4e028da2bca200edcc2e");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector030"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Oakland Total-Empty Container Volume", "transform": [{"window": [{"op": "lag", "field": "Total-Empty", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Total-Empty'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt"}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Total-Empty"}}, "height": 100, "selection": {"selector030": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-f24ee14ea6109e797283c17ff8df6753"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-f24ee14ea6109e797283c17ff8df6753": [{"dt": "1998-01-01T00:00:00", "Total-Empty": 27528.0}, {"dt": "1998-02-01T00:00:00", "Total-Empty": 26068.0}, {"dt": "1998-03-01T00:00:00", "Total-Empty": 32252.0}, {"dt": "1998-04-01T00:00:00", "Total-Empty": 33037.0}, {"dt": "1998-05-01T00:00:00", "Total-Empty": 26986.0}, {"dt": "1998-06-01T00:00:00", "Total-Empty": 30398.0}, {"dt": "1998-07-01T00:00:00", "Total-Empty": 29448.0}, {"dt": "1998-08-01T00:00:00", "Total-Empty": 29616.0}, {"dt": "1998-09-01T00:00:00", "Total-Empty": 30123.0}, {"dt": "1998-10-01T00:00:00", "Total-Empty": 35157.0}, {"dt": "1998-11-01T00:00:00", "Total-Empty": 33617.0}, {"dt": "1998-12-01T00:00:00", "Total-Empty": 35642.0}, {"dt": "1999-01-01T00:00:00", "Total-Empty": 30130.0}, {"dt": "1999-02-01T00:00:00", "Total-Empty": 27589.0}, {"dt": "1999-03-01T00:00:00", "Total-Empty": 32937.0}, {"dt": "1999-04-01T00:00:00", "Total-Empty": 36696.0}, {"dt": "1999-05-01T00:00:00", "Total-Empty": 32599.0}, {"dt": "1999-06-01T00:00:00", "Total-Empty": 35355.0}, {"dt": "1999-07-01T00:00:00", "Total-Empty": 29394.0}, {"dt": "1999-08-01T00:00:00", "Total-Empty": 40137.0}, {"dt": "1999-09-01T00:00:00", "Total-Empty": 33394.0}, {"dt": "1999-10-01T00:00:00", "Total-Empty": 33626.0}, {"dt": "1999-11-01T00:00:00", "Total-Empty": 36345.0}, {"dt": "1999-12-01T00:00:00", "Total-Empty": 36455.0}, {"dt": "2000-01-01T00:00:00", "Total-Empty": 37328.0}, {"dt": "2000-02-01T00:00:00", "Total-Empty": 34529.0}, {"dt": "2000-03-01T00:00:00", "Total-Empty": 34159.0}, {"dt": "2000-04-01T00:00:00", "Total-Empty": 37702.0}, {"dt": "2000-05-01T00:00:00", "Total-Empty": 43832.0}, {"dt": "2000-06-01T00:00:00", "Total-Empty": 39435.0}, {"dt": "2000-07-01T00:00:00", "Total-Empty": 37482.0}, {"dt": "2000-08-01T00:00:00", "Total-Empty": 44349.0}, {"dt": "2000-09-01T00:00:00", "Total-Empty": 33330.0}, {"dt": "2000-10-01T00:00:00", "Total-Empty": 40752.0}, {"dt": "2000-11-01T00:00:00", "Total-Empty": 38646.0}, {"dt": "2000-12-01T00:00:00", "Total-Empty": 32999.0}, {"dt": "2001-01-01T00:00:00", "Total-Empty": 32210.0}, {"dt": "2001-02-01T00:00:00", "Total-Empty": 27000.0}, {"dt": "2001-03-01T00:00:00", "Total-Empty": 32027.0}, {"dt": "2001-04-01T00:00:00", "Total-Empty": 35443.0}, {"dt": "2001-05-01T00:00:00", "Total-Empty": 35505.0}, {"dt": "2001-06-01T00:00:00", "Total-Empty": 30726.0}, {"dt": "2001-07-01T00:00:00", "Total-Empty": 33422.0}, {"dt": "2001-08-01T00:00:00", "Total-Empty": 39526.0}, {"dt": "2001-09-01T00:00:00", "Total-Empty": 33872.0}, {"dt": "2001-10-01T00:00:00", "Total-Empty": 34947.0}, {"dt": "2001-11-01T00:00:00", "Total-Empty": 32545.0}, {"dt": "2001-12-01T00:00:00", "Total-Empty": 31015.0}, {"dt": "2002-01-01T00:00:00", "Total-Empty": 33394.0}, {"dt": "2002-02-01T00:00:00", "Total-Empty": 28337.0}, {"dt": "2002-03-01T00:00:00", "Total-Empty": 31037.0}, {"dt": "2002-04-01T00:00:00", "Total-Empty": 32083.0}, {"dt": "2002-05-01T00:00:00", "Total-Empty": 40350.0}, {"dt": "2002-06-01T00:00:00", "Total-Empty": 37390.0}, {"dt": "2002-07-01T00:00:00", "Total-Empty": 44852.0}, {"dt": "2002-08-01T00:00:00", "Total-Empty": 48983.0}, {"dt": "2002-09-01T00:00:00", "Total-Empty": 36641.0}, {"dt": "2002-10-01T00:00:00", "Total-Empty": 28287.0}, {"dt": "2002-11-01T00:00:00", "Total-Empty": 31647.0}, {"dt": "2002-12-01T00:00:00", "Total-Empty": 35059.0}, {"dt": "2003-01-01T00:00:00", "Total-Empty": 42682.0}, {"dt": "2003-02-01T00:00:00", "Total-Empty": 35806.0}, {"dt": "2003-03-01T00:00:00", "Total-Empty": 38751.0}, {"dt": "2003-04-01T00:00:00", "Total-Empty": 46054.0}, {"dt": "2003-05-01T00:00:00", "Total-Empty": 56710.0}, {"dt": "2003-06-01T00:00:00", "Total-Empty": 45462.0}, {"dt": "2003-07-01T00:00:00", "Total-Empty": 48315.0}, {"dt": "2003-08-01T00:00:00", "Total-Empty": 50284.0}, {"dt": "2003-09-01T00:00:00", "Total-Empty": 41436.0}, {"dt": "2003-10-01T00:00:00", "Total-Empty": 37609.0}, {"dt": "2003-11-01T00:00:00", "Total-Empty": 37339.0}, {"dt": "2003-12-01T00:00:00", "Total-Empty": 43699.0}, {"dt": "2004-01-01T00:00:00", "Total-Empty": 37522.0}, {"dt": "2004-02-01T00:00:00", "Total-Empty": 33741.0}, {"dt": "2004-03-01T00:00:00", "Total-Empty": 37678.0}, {"dt": "2004-04-01T00:00:00", "Total-Empty": 43473.0}, {"dt": "2004-05-01T00:00:00", "Total-Empty": 37031.0}, {"dt": "2004-06-01T00:00:00", "Total-Empty": 44521.0}, {"dt": "2004-07-01T00:00:00", "Total-Empty": 52467.0}, {"dt": "2004-08-01T00:00:00", "Total-Empty": 56517.0}, {"dt": "2004-09-01T00:00:00", "Total-Empty": 46082.0}, {"dt": "2004-10-01T00:00:00", "Total-Empty": 49402.0}, {"dt": "2004-11-01T00:00:00", "Total-Empty": 45697.0}, {"dt": "2004-12-01T00:00:00", "Total-Empty": 55343.0}, {"dt": "2005-01-01T00:00:00", "Total-Empty": 48587.0}, {"dt": "2005-02-01T00:00:00", "Total-Empty": 33450.0}, {"dt": "2005-03-01T00:00:00", "Total-Empty": 47029.0}, {"dt": "2005-04-01T00:00:00", "Total-Empty": 44005.0}, {"dt": "2005-05-01T00:00:00", "Total-Empty": 52182.0}, {"dt": "2005-06-01T00:00:00", "Total-Empty": 46812.0}, {"dt": "2005-07-01T00:00:00", "Total-Empty": 46404.0}, {"dt": "2005-08-01T00:00:00", "Total-Empty": 60538.0}, {"dt": "2005-09-01T00:00:00", "Total-Empty": 56936.0}, {"dt": "2005-10-01T00:00:00", "Total-Empty": 57926.0}, {"dt": "2005-11-01T00:00:00", "Total-Empty": 48923.0}, {"dt": "2005-12-01T00:00:00", "Total-Empty": 48361.0}, {"dt": "2006-01-01T00:00:00", "Total-Empty": 50806.0}, {"dt": "2006-02-01T00:00:00", "Total-Empty": 48277.0}, {"dt": "2006-03-01T00:00:00", "Total-Empty": 54795.0}, {"dt": "2006-04-01T00:00:00", "Total-Empty": 52017.0}, {"dt": "2006-05-01T00:00:00", "Total-Empty": 64656.0}, {"dt": "2006-06-01T00:00:00", "Total-Empty": 58051.0}, {"dt": "2006-07-01T00:00:00", "Total-Empty": 51979.0}, {"dt": "2006-08-01T00:00:00", "Total-Empty": 73362.0}, {"dt": "2006-09-01T00:00:00", "Total-Empty": 54917.0}, {"dt": "2006-10-01T00:00:00", "Total-Empty": 62611.0}, {"dt": "2006-11-01T00:00:00", "Total-Empty": 59172.0}, {"dt": "2006-12-01T00:00:00", "Total-Empty": 43179.0}, {"dt": "2007-01-01T00:00:00", "Total-Empty": 53451.0}, {"dt": "2007-02-01T00:00:00", "Total-Empty": 43530.0}, {"dt": "2007-03-01T00:00:00", "Total-Empty": 45437.0}, {"dt": "2007-04-01T00:00:00", "Total-Empty": 44997.0}, {"dt": "2007-05-01T00:00:00", "Total-Empty": 53496.0}, {"dt": "2007-06-01T00:00:00", "Total-Empty": 49857.0}, {"dt": "2007-07-01T00:00:00", "Total-Empty": 55260.0}, {"dt": "2007-08-01T00:00:00", "Total-Empty": 56177.0}, {"dt": "2007-09-01T00:00:00", "Total-Empty": 55707.0}, {"dt": "2007-10-01T00:00:00", "Total-Empty": 56756.0}, {"dt": "2007-11-01T00:00:00", "Total-Empty": 45296.0}, {"dt": "2007-12-01T00:00:00", "Total-Empty": 48030.0}, {"dt": "2008-01-01T00:00:00", "Total-Empty": 46454.0}, {"dt": "2008-02-01T00:00:00", "Total-Empty": 35747.0}, {"dt": "2008-03-01T00:00:00", "Total-Empty": 38078.0}, {"dt": "2008-04-01T00:00:00", "Total-Empty": 39882.0}, {"dt": "2008-05-01T00:00:00", "Total-Empty": 36376.0}, {"dt": "2008-06-01T00:00:00", "Total-Empty": 46268.0}, {"dt": "2008-07-01T00:00:00", "Total-Empty": 47097.0}, {"dt": "2008-08-01T00:00:00", "Total-Empty": 48530.0}, {"dt": "2008-09-01T00:00:00", "Total-Empty": 43306.0}, {"dt": "2008-10-01T00:00:00", "Total-Empty": 51989.0}, {"dt": "2008-11-01T00:00:00", "Total-Empty": 46695.0}, {"dt": "2008-12-01T00:00:00", "Total-Empty": 46007.0}, {"dt": "2009-01-01T00:00:00", "Total-Empty": 35929.0}, {"dt": "2009-02-01T00:00:00", "Total-Empty": 26753.0}, {"dt": "2009-03-01T00:00:00", "Total-Empty": 34539.0}, {"dt": "2009-04-01T00:00:00", "Total-Empty": 33732.0}, {"dt": "2009-05-01T00:00:00", "Total-Empty": 27320.0}, {"dt": "2009-06-01T00:00:00", "Total-Empty": 28699.0}, {"dt": "2009-07-01T00:00:00", "Total-Empty": 35137.0}, {"dt": "2009-08-01T00:00:00", "Total-Empty": 29563.0}, {"dt": "2009-09-01T00:00:00", "Total-Empty": 34555.0}, {"dt": "2009-10-01T00:00:00", "Total-Empty": 31414.0}, {"dt": "2009-11-01T00:00:00", "Total-Empty": 28656.0}, {"dt": "2009-12-01T00:00:00", "Total-Empty": 30531.0}, {"dt": "2010-01-01T00:00:00", "Total-Empty": 28070.0}, {"dt": "2010-02-01T00:00:00", "Total-Empty": 29833.0}, {"dt": "2010-03-01T00:00:00", "Total-Empty": 45370.0}, {"dt": "2010-04-01T00:00:00", "Total-Empty": 42963.0}, {"dt": "2010-05-01T00:00:00", "Total-Empty": 47542.0}, {"dt": "2010-06-01T00:00:00", "Total-Empty": 56822.0}, {"dt": "2010-07-01T00:00:00", "Total-Empty": 60074.0}, {"dt": "2010-08-01T00:00:00", "Total-Empty": 61150.0}, {"dt": "2010-09-01T00:00:00", "Total-Empty": 60782.0}, {"dt": "2010-10-01T00:00:00", "Total-Empty": 54301.0}, {"dt": "2010-11-01T00:00:00", "Total-Empty": 46112.0}, {"dt": "2010-12-01T00:00:00", "Total-Empty": 39202.0}, {"dt": "2011-01-01T00:00:00", "Total-Empty": 42688.0}, {"dt": "2011-02-01T00:00:00", "Total-Empty": 40917.0}, {"dt": "2011-03-01T00:00:00", "Total-Empty": 49795.0}, {"dt": "2011-04-01T00:00:00", "Total-Empty": 41155.0}, {"dt": "2011-05-01T00:00:00", "Total-Empty": 42352.0}, {"dt": "2011-06-01T00:00:00", "Total-Empty": 48549.0}, {"dt": "2011-07-01T00:00:00", "Total-Empty": 49721.0}, {"dt": "2011-08-01T00:00:00", "Total-Empty": 55560.0}, {"dt": "2011-09-01T00:00:00", "Total-Empty": 49730.0}, {"dt": "2011-10-01T00:00:00", "Total-Empty": 46022.0}, {"dt": "2011-11-01T00:00:00", "Total-Empty": 42767.0}, {"dt": "2011-12-01T00:00:00", "Total-Empty": 42172.0}, {"dt": "2012-01-01T00:00:00", "Total-Empty": 43022.0}, {"dt": "2012-02-01T00:00:00", "Total-Empty": 38383.0}, {"dt": "2012-03-01T00:00:00", "Total-Empty": 42890.0}, {"dt": "2012-04-01T00:00:00", "Total-Empty": 44403.0}, {"dt": "2012-05-01T00:00:00", "Total-Empty": 47207.0}, {"dt": "2012-06-01T00:00:00", "Total-Empty": 51226.0}, {"dt": "2012-07-01T00:00:00", "Total-Empty": 53030.0}, {"dt": "2012-08-01T00:00:00", "Total-Empty": 55173.0}, {"dt": "2012-09-01T00:00:00", "Total-Empty": 50371.0}, {"dt": "2012-10-01T00:00:00", "Total-Empty": 50496.0}, {"dt": "2012-11-01T00:00:00", "Total-Empty": 45863.0}, {"dt": "2012-12-01T00:00:00", "Total-Empty": 43715.0}, {"dt": "2013-01-01T00:00:00", "Total-Empty": 42479.0}, {"dt": "2013-02-01T00:00:00", "Total-Empty": 39500.0}, {"dt": "2013-03-01T00:00:00", "Total-Empty": 43276.0}, {"dt": "2013-04-01T00:00:00", "Total-Empty": 41287.0}, {"dt": "2013-05-01T00:00:00", "Total-Empty": 44836.0}, {"dt": "2013-06-01T00:00:00", "Total-Empty": 44129.0}, {"dt": "2013-07-01T00:00:00", "Total-Empty": 46473.0}, {"dt": "2013-08-01T00:00:00", "Total-Empty": 51599.0}, {"dt": "2013-09-01T00:00:00", "Total-Empty": 48498.0}, {"dt": "2013-10-01T00:00:00", "Total-Empty": 42246.0}, {"dt": "2013-11-01T00:00:00", "Total-Empty": 40604.0}, {"dt": "2013-12-01T00:00:00", "Total-Empty": 43527.0}, {"dt": "2014-01-01T00:00:00", "Total-Empty": 45768.0}, {"dt": "2014-02-01T00:00:00", "Total-Empty": 39428.0}, {"dt": "2014-03-01T00:00:00", "Total-Empty": 45922.0}, {"dt": "2014-04-01T00:00:00", "Total-Empty": 40953.0}, {"dt": "2014-05-01T00:00:00", "Total-Empty": 45321.0}, {"dt": "2014-06-01T00:00:00", "Total-Empty": 47807.0}, {"dt": "2014-07-01T00:00:00", "Total-Empty": 55982.0}, {"dt": "2014-08-01T00:00:00", "Total-Empty": 55027.0}, {"dt": "2014-09-01T00:00:00", "Total-Empty": 55723.0}, {"dt": "2014-10-01T00:00:00", "Total-Empty": 47238.0}, {"dt": "2014-11-01T00:00:00", "Total-Empty": 47421.0}, {"dt": "2014-12-01T00:00:00", "Total-Empty": 52291.0}, {"dt": "2015-01-01T00:00:00", "Total-Empty": 36315.0}, {"dt": "2015-02-01T00:00:00", "Total-Empty": 31110.0}, {"dt": "2015-03-01T00:00:00", "Total-Empty": 52121.0}, {"dt": "2015-04-01T00:00:00", "Total-Empty": 52883.0}, {"dt": "2015-05-01T00:00:00", "Total-Empty": 54462.0}, {"dt": "2015-06-01T00:00:00", "Total-Empty": 50163.0}, {"dt": "2015-07-01T00:00:00", "Total-Empty": 50895.0}, {"dt": "2015-08-01T00:00:00", "Total-Empty": 56762.0}, {"dt": "2015-09-01T00:00:00", "Total-Empty": 54639.0}, {"dt": "2015-10-01T00:00:00", "Total-Empty": 47294.0}, {"dt": "2015-11-01T00:00:00", "Total-Empty": 42228.0}, {"dt": "2015-12-01T00:00:00", "Total-Empty": 46269.0}, {"dt": "2016-01-01T00:00:00", "Total-Empty": 46244.0}, {"dt": "2016-02-01T00:00:00", "Total-Empty": 44064.0}, {"dt": "2016-03-01T00:00:00", "Total-Empty": 41767.0}, {"dt": "2016-04-01T00:00:00", "Total-Empty": 37393.0}, {"dt": "2016-05-01T00:00:00", "Total-Empty": 46507.0}, {"dt": "2016-06-01T00:00:00", "Total-Empty": 44232.0}, {"dt": "2016-07-01T00:00:00", "Total-Empty": 48542.0}, {"dt": "2016-08-01T00:00:00", "Total-Empty": 59060.0}, {"dt": "2016-09-01T00:00:00", "Total-Empty": 40910.0}, {"dt": "2016-10-01T00:00:00", "Total-Empty": 44694.0}, {"dt": "2016-11-01T00:00:00", "Total-Empty": 37889.0}, {"dt": "2016-12-01T00:00:00", "Total-Empty": 46558.0}, {"dt": "2017-01-01T00:00:00", "Total-Empty": 43540.45}, {"dt": "2017-02-01T00:00:00", "Total-Empty": 38214.5}, {"dt": "2017-03-01T00:00:00", "Total-Empty": 49077.95}, {"dt": "2017-04-01T00:00:00", "Total-Empty": 43734.0}, {"dt": "2017-05-01T00:00:00", "Total-Empty": 49936.100000000006}, {"dt": "2017-06-01T00:00:00", "Total-Empty": 48541.5}, {"dt": "2017-07-01T00:00:00", "Total-Empty": 50233.5}, {"dt": "2017-08-01T00:00:00", "Total-Empty": 57615.95}, {"dt": "2017-09-01T00:00:00", "Total-Empty": 57973.899999999994}, {"dt": "2017-10-01T00:00:00", "Total-Empty": 47279.25}, {"dt": "2017-11-01T00:00:00", "Total-Empty": 36696.5}, {"dt": "2017-12-01T00:00:00", "Total-Empty": 47642.95}, {"dt": "2018-01-01T00:00:00", "Total-Empty": 55821.25}, {"dt": "2018-02-01T00:00:00", "Total-Empty": 40603.95}, {"dt": "2018-03-01T00:00:00", "Total-Empty": 45084.25}, {"dt": "2018-04-01T00:00:00", "Total-Empty": 50651.75}, {"dt": "2018-05-01T00:00:00", "Total-Empty": 50254.75}, {"dt": "2018-06-01T00:00:00", "Total-Empty": 56394.45}, {"dt": "2018-07-01T00:00:00", "Total-Empty": 63727.5}, {"dt": "2018-08-01T00:00:00", "Total-Empty": 71174.25}, {"dt": "2018-09-01T00:00:00", "Total-Empty": 64527.95}, {"dt": "2018-10-01T00:00:00", "Total-Empty": 64803.0}, {"dt": "2018-11-01T00:00:00", "Total-Empty": 58475.25}, {"dt": "2018-12-01T00:00:00", "Total-Empty": 61476.75}, {"dt": "2019-01-01T00:00:00", "Total-Empty": 55250.0}, {"dt": "2019-02-01T00:00:00", "Total-Empty": 47870.7}, {"dt": "2019-03-01T00:00:00", "Total-Empty": 51056.0}, {"dt": "2019-04-01T00:00:00", "Total-Empty": 56009.5}, {"dt": "2019-05-01T00:00:00", "Total-Empty": 59061.7}, {"dt": "2019-06-01T00:00:00", "Total-Empty": 47934.5}, {"dt": "2019-07-01T00:00:00", "Total-Empty": 51179.2}, {"dt": "2019-08-01T00:00:00", "Total-Empty": 61132.45}, {"dt": "2019-09-01T00:00:00", "Total-Empty": 49580.75}, {"dt": "2019-10-01T00:00:00", "Total-Empty": 38904.7}, {"dt": "2019-11-01T00:00:00", "Total-Empty": 38213.15}, {"dt": "2019-12-01T00:00:00", "Total-Empty": 38039.55}, {"dt": "2020-01-01T00:00:00", "Total-Empty": 45449.45}, {"dt": "2020-02-01T00:00:00", "Total-Empty": 38377.45}, {"dt": "2020-03-01T00:00:00", "Total-Empty": 39371.45}, {"dt": "2020-04-01T00:00:00", "Total-Empty": 39751.5}, {"dt": "2020-05-01T00:00:00", "Total-Empty": 42452.2}, {"dt": "2020-06-01T00:00:00", "Total-Empty": 45909.25}, {"dt": "2020-07-01T00:00:00", "Total-Empty": 51135.5}, {"dt": "2020-08-01T00:00:00", "Total-Empty": 53080.5}, {"dt": "2020-09-01T00:00:00", "Total-Empty": 56218.5}, {"dt": "2020-10-01T00:00:00", "Total-Empty": 42969.25}, {"dt": "2020-11-01T00:00:00", "Total-Empty": 39979.5}, {"dt": "2020-12-01T00:00:00", "Total-Empty": 42791.75}, {"dt": "2021-01-01T00:00:00", "Total-Empty": 52548.0}, {"dt": "2021-02-01T00:00:00", "Total-Empty": 40765.0}, {"dt": "2021-03-01T00:00:00", "Total-Empty": 49763.0}, {"dt": "2021-04-01T00:00:00", "Total-Empty": 39662.0}, {"dt": "2021-05-01T00:00:00", "Total-Empty": 59122.0}, {"dt": "2021-06-01T00:00:00", "Total-Empty": 56231.0}, {"dt": "2021-07-01T00:00:00", "Total-Empty": 48498.0}, {"dt": "2021-08-01T00:00:00", "Total-Empty": 50449.0}, {"dt": "2021-09-01T00:00:00", "Total-Empty": 38943.0}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[53]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doYoyChart</span><span class="p">(</span><span class="n">df_oak_combined</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Grand-Total&#39;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Oakland&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[53]:</div>



   
        
            
<div class="output_html rendered_html output_subarea output_execute_result">
<div id="altair-viz-7e7781ca4ccc4193865b455efc649250"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-7e7781ca4ccc4193865b455efc649250") {
      outputDiv = document.getElementById("altair-viz-7e7781ca4ccc4193865b455efc649250");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"mark": {"type": "bar", "color": "blue", "width": 2}, "encoding": {"color": {"condition": {"value": "lightsalmon", "test": "datum['yoy'] < 0"}, "value": "royalblue"}, "tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt", "impute": {"value": null}, "scale": {"domain": {"selection": "selector031"}}}, "y": {"type": "quantitative", "axis": {"title": "Year-over-Year Volume Growth [%]"}, "field": "yoy", "impute": {"keyvals": [400, 1000], "method": "value"}}}, "height": 400, "title": "Port of Oakland Grand-Total Container Volume", "transform": [{"window": [{"op": "lag", "field": "Grand-Total", "param": 12, "as": "previous"}], "sort": [{"field": "dt"}]}, {"calculate": "((datum['Grand-Total'] - datum.previous) / datum.previous) * 100", "as": "yoy"}], "width": 750}, {"mark": {"type": "line", "color": "purple"}, "encoding": {"tooltip": [{"type": "temporal", "field": "dt", "format": "%b %Y"}, {"type": "quantitative", "field": "nolarge", "format": ",.02f"}], "x": {"type": "temporal", "axis": {"title": ""}, "field": "dt"}, "y": {"type": "quantitative", "axis": {"title": "Volume [TEUs]"}, "field": "Grand-Total"}}, "height": 100, "selection": {"selector031": {"type": "interval", "encodings": ["x"]}}, "width": 750}], "background": "white", "data": {"name": "data-3a64b7f4837f5efd28ce13199fb863f7"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-3a64b7f4837f5efd28ce13199fb863f7": [{"dt": "1998-01-01T00:00:00", "Grand-Total": 113716.0}, {"dt": "1998-02-01T00:00:00", "Grand-Total": 114912.0}, {"dt": "1998-03-01T00:00:00", "Grand-Total": 132666.0}, {"dt": "1998-04-01T00:00:00", "Grand-Total": 132936.0}, {"dt": "1998-05-01T00:00:00", "Grand-Total": 123931.0}, {"dt": "1998-06-01T00:00:00", "Grand-Total": 131384.0}, {"dt": "1998-07-01T00:00:00", "Grand-Total": 127209.0}, {"dt": "1998-08-01T00:00:00", "Grand-Total": 130640.0}, {"dt": "1998-09-01T00:00:00", "Grand-Total": 134534.0}, {"dt": "1998-10-01T00:00:00", "Grand-Total": 149520.0}, {"dt": "1998-11-01T00:00:00", "Grand-Total": 141482.0}, {"dt": "1998-12-01T00:00:00", "Grand-Total": 142476.0}, {"dt": "1999-01-01T00:00:00", "Grand-Total": 125650.0}, {"dt": "1999-02-01T00:00:00", "Grand-Total": 122966.0}, {"dt": "1999-03-01T00:00:00", "Grand-Total": 135114.0}, {"dt": "1999-04-01T00:00:00", "Grand-Total": 141097.0}, {"dt": "1999-05-01T00:00:00", "Grand-Total": 139212.0}, {"dt": "1999-06-01T00:00:00", "Grand-Total": 145428.0}, {"dt": "1999-07-01T00:00:00", "Grand-Total": 126827.0}, {"dt": "1999-08-01T00:00:00", "Grand-Total": 149839.0}, {"dt": "1999-09-01T00:00:00", "Grand-Total": 143542.0}, {"dt": "1999-10-01T00:00:00", "Grand-Total": 144269.0}, {"dt": "1999-11-01T00:00:00", "Grand-Total": 145127.0}, {"dt": "1999-12-01T00:00:00", "Grand-Total": 144685.0}, {"dt": "2000-01-01T00:00:00", "Grand-Total": 137090.0}, {"dt": "2000-02-01T00:00:00", "Grand-Total": 135394.0}, {"dt": "2000-03-01T00:00:00", "Grand-Total": 143922.0}, {"dt": "2000-04-01T00:00:00", "Grand-Total": 143622.0}, {"dt": "2000-05-01T00:00:00", "Grand-Total": 155054.0}, {"dt": "2000-06-01T00:00:00", "Grand-Total": 153531.0}, {"dt": "2000-07-01T00:00:00", "Grand-Total": 151256.0}, {"dt": "2000-08-01T00:00:00", "Grand-Total": 169700.0}, {"dt": "2000-09-01T00:00:00", "Grand-Total": 144632.0}, {"dt": "2000-10-01T00:00:00", "Grand-Total": 159443.0}, {"dt": "2000-11-01T00:00:00", "Grand-Total": 145651.0}, {"dt": "2000-12-01T00:00:00", "Grand-Total": 137627.0}, {"dt": "2001-01-01T00:00:00", "Grand-Total": 135091.0}, {"dt": "2001-02-01T00:00:00", "Grand-Total": 118193.0}, {"dt": "2001-03-01T00:00:00", "Grand-Total": 140869.0}, {"dt": "2001-04-01T00:00:00", "Grand-Total": 138010.0}, {"dt": "2001-05-01T00:00:00", "Grand-Total": 140885.0}, {"dt": "2001-06-01T00:00:00", "Grand-Total": 130421.0}, {"dt": "2001-07-01T00:00:00", "Grand-Total": 141173.0}, {"dt": "2001-08-01T00:00:00", "Grand-Total": 152951.0}, {"dt": "2001-09-01T00:00:00", "Grand-Total": 137852.0}, {"dt": "2001-10-01T00:00:00", "Grand-Total": 149715.0}, {"dt": "2001-11-01T00:00:00", "Grand-Total": 130772.0}, {"dt": "2001-12-01T00:00:00", "Grand-Total": 127653.0}, {"dt": "2002-01-01T00:00:00", "Grand-Total": 122894.0}, {"dt": "2002-02-01T00:00:00", "Grand-Total": 118686.0}, {"dt": "2002-03-01T00:00:00", "Grand-Total": 130667.0}, {"dt": "2002-04-01T00:00:00", "Grand-Total": 135629.0}, {"dt": "2002-05-01T00:00:00", "Grand-Total": 152107.0}, {"dt": "2002-06-01T00:00:00", "Grand-Total": 150520.0}, {"dt": "2002-07-01T00:00:00", "Grand-Total": 152839.0}, {"dt": "2002-08-01T00:00:00", "Grand-Total": 168222.0}, {"dt": "2002-09-01T00:00:00", "Grand-Total": 148276.0}, {"dt": "2002-10-01T00:00:00", "Grand-Total": 131842.0}, {"dt": "2002-11-01T00:00:00", "Grand-Total": 150422.0}, {"dt": "2002-12-01T00:00:00", "Grand-Total": 145723.0}, {"dt": "2003-01-01T00:00:00", "Grand-Total": 150807.0}, {"dt": "2003-02-01T00:00:00", "Grand-Total": 142121.0}, {"dt": "2003-03-01T00:00:00", "Grand-Total": 156098.0}, {"dt": "2003-04-01T00:00:00", "Grand-Total": 161136.0}, {"dt": "2003-05-01T00:00:00", "Grand-Total": 171958.0}, {"dt": "2003-06-01T00:00:00", "Grand-Total": 164376.0}, {"dt": "2003-07-01T00:00:00", "Grand-Total": 172320.0}, {"dt": "2003-08-01T00:00:00", "Grand-Total": 167707.0}, {"dt": "2003-09-01T00:00:00", "Grand-Total": 159938.0}, {"dt": "2003-10-01T00:00:00", "Grand-Total": 163100.0}, {"dt": "2003-11-01T00:00:00", "Grand-Total": 155448.0}, {"dt": "2003-12-01T00:00:00", "Grand-Total": 158095.0}, {"dt": "2004-01-01T00:00:00", "Grand-Total": 148586.0}, {"dt": "2004-02-01T00:00:00", "Grand-Total": 130699.0}, {"dt": "2004-03-01T00:00:00", "Grand-Total": 159292.0}, {"dt": "2004-04-01T00:00:00", "Grand-Total": 163311.0}, {"dt": "2004-05-01T00:00:00", "Grand-Total": 154333.0}, {"dt": "2004-06-01T00:00:00", "Grand-Total": 166069.0}, {"dt": "2004-07-01T00:00:00", "Grand-Total": 180216.0}, {"dt": "2004-08-01T00:00:00", "Grand-Total": 193598.0}, {"dt": "2004-09-01T00:00:00", "Grand-Total": 173665.0}, {"dt": "2004-10-01T00:00:00", "Grand-Total": 190902.0}, {"dt": "2004-11-01T00:00:00", "Grand-Total": 189398.0}, {"dt": "2004-12-01T00:00:00", "Grand-Total": 197435.0}, {"dt": "2005-01-01T00:00:00", "Grand-Total": 180973.0}, {"dt": "2005-02-01T00:00:00", "Grand-Total": 165320.0}, {"dt": "2005-03-01T00:00:00", "Grand-Total": 179258.0}, {"dt": "2005-04-01T00:00:00", "Grand-Total": 179087.0}, {"dt": "2005-05-01T00:00:00", "Grand-Total": 193835.0}, {"dt": "2005-06-01T00:00:00", "Grand-Total": 182255.0}, {"dt": "2005-07-01T00:00:00", "Grand-Total": 190160.0}, {"dt": "2005-08-01T00:00:00", "Grand-Total": 208177.0}, {"dt": "2005-09-01T00:00:00", "Grand-Total": 201011.0}, {"dt": "2005-10-01T00:00:00", "Grand-Total": 205558.0}, {"dt": "2005-11-01T00:00:00", "Grand-Total": 193595.0}, {"dt": "2005-12-01T00:00:00", "Grand-Total": 194761.0}, {"dt": "2006-01-01T00:00:00", "Grand-Total": 188185.0}, {"dt": "2006-02-01T00:00:00", "Grand-Total": 178622.0}, {"dt": "2006-03-01T00:00:00", "Grand-Total": 203585.0}, {"dt": "2006-04-01T00:00:00", "Grand-Total": 192531.0}, {"dt": "2006-05-01T00:00:00", "Grand-Total": 210024.0}, {"dt": "2006-06-01T00:00:00", "Grand-Total": 204662.0}, {"dt": "2006-07-01T00:00:00", "Grand-Total": 193283.0}, {"dt": "2006-08-01T00:00:00", "Grand-Total": 227996.0}, {"dt": "2006-09-01T00:00:00", "Grand-Total": 196838.0}, {"dt": "2006-10-01T00:00:00", "Grand-Total": 213552.0}, {"dt": "2006-11-01T00:00:00", "Grand-Total": 201723.0}, {"dt": "2006-12-01T00:00:00", "Grand-Total": 180744.0}, {"dt": "2007-01-01T00:00:00", "Grand-Total": 196247.0}, {"dt": "2007-02-01T00:00:00", "Grand-Total": 171188.0}, {"dt": "2007-03-01T00:00:00", "Grand-Total": 188276.0}, {"dt": "2007-04-01T00:00:00", "Grand-Total": 187967.0}, {"dt": "2007-05-01T00:00:00", "Grand-Total": 202720.0}, {"dt": "2007-06-01T00:00:00", "Grand-Total": 197976.0}, {"dt": "2007-07-01T00:00:00", "Grand-Total": 212799.0}, {"dt": "2007-08-01T00:00:00", "Grand-Total": 214658.0}, {"dt": "2007-09-01T00:00:00", "Grand-Total": 204918.0}, {"dt": "2007-10-01T00:00:00", "Grand-Total": 217085.0}, {"dt": "2007-11-01T00:00:00", "Grand-Total": 202116.0}, {"dt": "2007-12-01T00:00:00", "Grand-Total": 191961.0}, {"dt": "2008-01-01T00:00:00", "Grand-Total": 187306.0}, {"dt": "2008-02-01T00:00:00", "Grand-Total": 180827.0}, {"dt": "2008-03-01T00:00:00", "Grand-Total": 177569.0}, {"dt": "2008-04-01T00:00:00", "Grand-Total": 190419.0}, {"dt": "2008-05-01T00:00:00", "Grand-Total": 183800.0}, {"dt": "2008-06-01T00:00:00", "Grand-Total": 198577.0}, {"dt": "2008-07-01T00:00:00", "Grand-Total": 201271.0}, {"dt": "2008-08-01T00:00:00", "Grand-Total": 194800.0}, {"dt": "2008-09-01T00:00:00", "Grand-Total": 189060.0}, {"dt": "2008-10-01T00:00:00", "Grand-Total": 193959.0}, {"dt": "2008-11-01T00:00:00", "Grand-Total": 168825.0}, {"dt": "2008-12-01T00:00:00", "Grand-Total": 167120.0}, {"dt": "2009-01-01T00:00:00", "Grand-Total": 157941.0}, {"dt": "2009-02-01T00:00:00", "Grand-Total": 132758.0}, {"dt": "2009-03-01T00:00:00", "Grand-Total": 168950.0}, {"dt": "2009-04-01T00:00:00", "Grand-Total": 168961.0}, {"dt": "2009-05-01T00:00:00", "Grand-Total": 162799.0}, {"dt": "2009-06-01T00:00:00", "Grand-Total": 169765.0}, {"dt": "2009-07-01T00:00:00", "Grand-Total": 184604.0}, {"dt": "2009-08-01T00:00:00", "Grand-Total": 177855.0}, {"dt": "2009-09-01T00:00:00", "Grand-Total": 182090.0}, {"dt": "2009-10-01T00:00:00", "Grand-Total": 179108.0}, {"dt": "2009-11-01T00:00:00", "Grand-Total": 173474.0}, {"dt": "2009-12-01T00:00:00", "Grand-Total": 186906.0}, {"dt": "2010-01-01T00:00:00", "Grand-Total": 157032.0}, {"dt": "2010-02-01T00:00:00", "Grand-Total": 155724.0}, {"dt": "2010-03-01T00:00:00", "Grand-Total": 186956.0}, {"dt": "2010-04-01T00:00:00", "Grand-Total": 186313.0}, {"dt": "2010-05-01T00:00:00", "Grand-Total": 194250.0}, {"dt": "2010-06-01T00:00:00", "Grand-Total": 205527.0}, {"dt": "2010-07-01T00:00:00", "Grand-Total": 214646.0}, {"dt": "2010-08-01T00:00:00", "Grand-Total": 217633.0}, {"dt": "2010-09-01T00:00:00", "Grand-Total": 214361.0}, {"dt": "2010-10-01T00:00:00", "Grand-Total": 208528.0}, {"dt": "2010-11-01T00:00:00", "Grand-Total": 201528.0}, {"dt": "2010-12-01T00:00:00", "Grand-Total": 187959.0}, {"dt": "2011-01-01T00:00:00", "Grand-Total": 182037.0}, {"dt": "2011-02-01T00:00:00", "Grand-Total": 175608.0}, {"dt": "2011-03-01T00:00:00", "Grand-Total": 197403.0}, {"dt": "2011-04-01T00:00:00", "Grand-Total": 191581.0}, {"dt": "2011-05-01T00:00:00", "Grand-Total": 194021.0}, {"dt": "2011-06-01T00:00:00", "Grand-Total": 200732.0}, {"dt": "2011-07-01T00:00:00", "Grand-Total": 197573.0}, {"dt": "2011-08-01T00:00:00", "Grand-Total": 216276.0}, {"dt": "2011-09-01T00:00:00", "Grand-Total": 200236.0}, {"dt": "2011-10-01T00:00:00", "Grand-Total": 197267.0}, {"dt": "2011-11-01T00:00:00", "Grand-Total": 199779.0}, {"dt": "2011-12-01T00:00:00", "Grand-Total": 190013.0}, {"dt": "2012-01-01T00:00:00", "Grand-Total": 195697.0}, {"dt": "2012-02-01T00:00:00", "Grand-Total": 166904.0}, {"dt": "2012-03-01T00:00:00", "Grand-Total": 197357.0}, {"dt": "2012-04-01T00:00:00", "Grand-Total": 188075.0}, {"dt": "2012-05-01T00:00:00", "Grand-Total": 203440.0}, {"dt": "2012-06-01T00:00:00", "Grand-Total": 197335.0}, {"dt": "2012-07-01T00:00:00", "Grand-Total": 201993.0}, {"dt": "2012-08-01T00:00:00", "Grand-Total": 206966.0}, {"dt": "2012-09-01T00:00:00", "Grand-Total": 191495.0}, {"dt": "2012-10-01T00:00:00", "Grand-Total": 207627.0}, {"dt": "2012-11-01T00:00:00", "Grand-Total": 190082.0}, {"dt": "2012-12-01T00:00:00", "Grand-Total": 196932.0}, {"dt": "2013-01-01T00:00:00", "Grand-Total": 192498.0}, {"dt": "2013-02-01T00:00:00", "Grand-Total": 187701.0}, {"dt": "2013-03-01T00:00:00", "Grand-Total": 184773.0}, {"dt": "2013-04-01T00:00:00", "Grand-Total": 190727.0}, {"dt": "2013-05-01T00:00:00", "Grand-Total": 200510.0}, {"dt": "2013-06-01T00:00:00", "Grand-Total": 196600.0}, {"dt": "2013-07-01T00:00:00", "Grand-Total": 200985.0}, {"dt": "2013-08-01T00:00:00", "Grand-Total": 209138.0}, {"dt": "2013-09-01T00:00:00", "Grand-Total": 201621.0}, {"dt": "2013-10-01T00:00:00", "Grand-Total": 198790.0}, {"dt": "2013-11-01T00:00:00", "Grand-Total": 194969.0}, {"dt": "2013-12-01T00:00:00", "Grand-Total": 188252.0}, {"dt": "2014-01-01T00:00:00", "Grand-Total": 196422.0}, {"dt": "2014-02-01T00:00:00", "Grand-Total": 177841.0}, {"dt": "2014-03-01T00:00:00", "Grand-Total": 193734.0}, {"dt": "2014-04-01T00:00:00", "Grand-Total": 197784.0}, {"dt": "2014-05-01T00:00:00", "Grand-Total": 205477.0}, {"dt": "2014-06-01T00:00:00", "Grand-Total": 205692.0}, {"dt": "2014-07-01T00:00:00", "Grand-Total": 203519.0}, {"dt": "2014-08-01T00:00:00", "Grand-Total": 204679.0}, {"dt": "2014-09-01T00:00:00", "Grand-Total": 207399.0}, {"dt": "2014-10-01T00:00:00", "Grand-Total": 206427.0}, {"dt": "2014-11-01T00:00:00", "Grand-Total": 193115.0}, {"dt": "2014-12-01T00:00:00", "Grand-Total": 201980.0}, {"dt": "2015-01-01T00:00:00", "Grand-Total": 138065.0}, {"dt": "2015-02-01T00:00:00", "Grand-Total": 121978.0}, {"dt": "2015-03-01T00:00:00", "Grand-Total": 209407.0}, {"dt": "2015-04-01T00:00:00", "Grand-Total": 201100.0}, {"dt": "2015-05-01T00:00:00", "Grand-Total": 213253.0}, {"dt": "2015-06-01T00:00:00", "Grand-Total": 203623.0}, {"dt": "2015-07-01T00:00:00", "Grand-Total": 205520.0}, {"dt": "2015-08-01T00:00:00", "Grand-Total": 216911.0}, {"dt": "2015-09-01T00:00:00", "Grand-Total": 197483.0}, {"dt": "2015-10-01T00:00:00", "Grand-Total": 192283.0}, {"dt": "2015-11-01T00:00:00", "Grand-Total": 192584.0}, {"dt": "2015-12-01T00:00:00", "Grand-Total": 185314.0}, {"dt": "2016-01-01T00:00:00", "Grand-Total": 191155.0}, {"dt": "2016-02-01T00:00:00", "Grand-Total": 188139.0}, {"dt": "2016-03-01T00:00:00", "Grand-Total": 178945.0}, {"dt": "2016-04-01T00:00:00", "Grand-Total": 188300.0}, {"dt": "2016-05-01T00:00:00", "Grand-Total": 211769.0}, {"dt": "2016-06-01T00:00:00", "Grand-Total": 194278.0}, {"dt": "2016-07-01T00:00:00", "Grand-Total": 206600.0}, {"dt": "2016-08-01T00:00:00", "Grand-Total": 220547.0}, {"dt": "2016-09-01T00:00:00", "Grand-Total": 187539.0}, {"dt": "2016-10-01T00:00:00", "Grand-Total": 206169.0}, {"dt": "2016-11-01T00:00:00", "Grand-Total": 196980.0}, {"dt": "2016-12-01T00:00:00", "Grand-Total": 199155.0}, {"dt": "2017-01-01T00:00:00", "Grand-Total": 197309.59999999998}, {"dt": "2017-02-01T00:00:00", "Grand-Total": 174901.7}, {"dt": "2017-03-01T00:00:00", "Grand-Total": 199076.55}, {"dt": "2017-04-01T00:00:00", "Grand-Total": 197500.75}, {"dt": "2017-05-01T00:00:00", "Grand-Total": 210959.95}, {"dt": "2017-06-01T00:00:00", "Grand-Total": 204255.09999999998}, {"dt": "2017-07-01T00:00:00", "Grand-Total": 209889.5}, {"dt": "2017-08-01T00:00:00", "Grand-Total": 212655.10000000003}, {"dt": "2017-09-01T00:00:00", "Grand-Total": 211470.15}, {"dt": "2017-10-01T00:00:00", "Grand-Total": 209913.55}, {"dt": "2017-11-01T00:00:00", "Grand-Total": 186068.84999999998}, {"dt": "2017-12-01T00:00:00", "Grand-Total": 206835.75}, {"dt": "2018-01-01T00:00:00", "Grand-Total": 205840.25}, {"dt": "2018-02-01T00:00:00", "Grand-Total": 188174.7}, {"dt": "2018-03-01T00:00:00", "Grand-Total": 193340.9}, {"dt": "2018-04-01T00:00:00", "Grand-Total": 204017.05}, {"dt": "2018-05-01T00:00:00", "Grand-Total": 204766.59999999998}, {"dt": "2018-06-01T00:00:00", "Grand-Total": 215496.0}, {"dt": "2018-07-01T00:00:00", "Grand-Total": 217407.34999999998}, {"dt": "2018-08-01T00:00:00", "Grand-Total": 231188.3}, {"dt": "2018-09-01T00:00:00", "Grand-Total": 220068.2}, {"dt": "2018-10-01T00:00:00", "Grand-Total": 226052.40000000002}, {"dt": "2018-11-01T00:00:00", "Grand-Total": 219124.6}, {"dt": "2018-12-01T00:00:00", "Grand-Total": 220922.3}, {"dt": "2019-01-01T00:00:00", "Grand-Total": 212493.3}, {"dt": "2019-02-01T00:00:00", "Grand-Total": 185684.75}, {"dt": "2019-03-01T00:00:00", "Grand-Total": 213972.45}, {"dt": "2019-04-01T00:00:00", "Grand-Total": 216002.8}, {"dt": "2019-05-01T00:00:00", "Grand-Total": 223101.15000000002}, {"dt": "2019-06-01T00:00:00", "Grand-Total": 203730.15}, {"dt": "2019-07-01T00:00:00", "Grand-Total": 218191.45}, {"dt": "2019-08-01T00:00:00", "Grand-Total": 224537.0}, {"dt": "2019-09-01T00:00:00", "Grand-Total": 206544.2}, {"dt": "2019-10-01T00:00:00", "Grand-Total": 204879.8}, {"dt": "2019-11-01T00:00:00", "Grand-Total": 197360.35}, {"dt": "2019-12-01T00:00:00", "Grand-Total": 193963.3}, {"dt": "2020-01-01T00:00:00", "Grand-Total": 211250.95}, {"dt": "2020-02-01T00:00:00", "Grand-Total": 180224.90000000002}, {"dt": "2020-03-01T00:00:00", "Grand-Total": 190187.7}, {"dt": "2020-04-01T00:00:00", "Grand-Total": 201918.4}, {"dt": "2020-05-01T00:00:00", "Grand-Total": 185594.7}, {"dt": "2020-06-01T00:00:00", "Grand-Total": 199011.45}, {"dt": "2020-07-01T00:00:00", "Grand-Total": 219080.3}, {"dt": "2020-08-01T00:00:00", "Grand-Total": 225489.15}, {"dt": "2020-09-01T00:00:00", "Grand-Total": 225806.5}, {"dt": "2020-10-01T00:00:00", "Grand-Total": 216664.0}, {"dt": "2020-11-01T00:00:00", "Grand-Total": 197694.7}, {"dt": "2020-12-01T00:00:00", "Grand-Total": 208339.25}, {"dt": "2021-01-01T00:00:00", "Grand-Total": 199098.0}, {"dt": "2021-02-01T00:00:00", "Grand-Total": 190489.0}, {"dt": "2021-03-01T00:00:00", "Grand-Total": 241468.0}, {"dt": "2021-04-01T00:00:00", "Grand-Total": 221838.0}, {"dt": "2021-05-01T00:00:00", "Grand-Total": 226406.0}, {"dt": "2021-06-01T00:00:00", "Grand-Total": 222483.0}, {"dt": "2021-07-01T00:00:00", "Grand-Total": 211396.0}, {"dt": "2021-08-01T00:00:00", "Grand-Total": 220052.0}, {"dt": "2021-09-01T00:00:00", "Grand-Total": 182935.0}]}}, {"mode": "vega-lite"});
</script></div>

        
    
        
    
        
    
        
    
        
    

</div>

</div>
</div>

</div>
<hr>
&copy; <script>document.write(`${new Date().getFullYear()}`);</script> kdunn926
</div>
</div>
</body>


<script>
// TODO - some, or all of this could be moved to pre-rendering sed/regex
// add bootstrap table styles to pandoc tables (notebooks)
$(document).ready( () => {

  $('tr').parent('thead').parent('table').addClass('table table-condensed');
  $('tr').parent('thead').parent('table').removeAttr('border');
  $('tr').parent('thead').parent('table').removeClass('dataframe');

  $('.output_area .output_html table thead tr').removeAttr('style');
  $('.output_area .output_html table thead tr th').attr("scope", "col");

  $('.output_area .output_html table tbody tr th').attr("scope", "row");


  // Change the input cell gutter text, make it a link
  $('.input .input_prompt').map((n, e) => {
    e.innerHTML = `<a href="#" >Show Code Cell [${n + 1}]</a>`;
  });

  // Attach an event listener to the above link for show/hide
  $('.input .input_prompt a').map((n, e) => {
    const showOrHide = e => {
      e.preventDefault();
      $(`#code-${n}`).find('.inner_cell').toggleClass('collapse');
      const v = $(`#code-${n}`).find('.input_prompt a');
      if (v.html().includes('Show')) {
        v.html(`Hide Code Cell [${n+1}]`);
      } else {
        v.html(`Show Code Cell [${n+1}]`);
      }
    }

    e.addEventListener("click", showOrHide, false);
  });

  // Annotate parent cells of input cells with id/classes
  $('.input .inner_cell').map((n, e) => {
    $('.input .inner_cell').parent('div').toArray()[n].id = `code-${n}`;
  });
  $('.input .inner_cell')
    .addClass("collapse")
    .after('<div class="inner_cell" style="font-size: 150%; padding-left: 5px;">...</div>');

});
</script>
    

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-9902895-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-9902895-3');
</script>

</html>
